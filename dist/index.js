module.exports=function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=114)}([function(t,e,r){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var i=r(119),n=r(120),s=r(121);function o(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=a.prototype:(null===t&&(t=new a(e)),t.length=e),t}function a(t,e,r){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return u(this,t)}return c(this,t,e,r)}function c(t,e,r,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,i){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,r):new Uint8Array(e,r,i);a.TYPED_ARRAY_SUPPORT?(t=e).__proto__=a.prototype:t=d(t,e);return t}(t,e,r,i):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!a.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|b(e,r),n=(t=f(t,i)).write(e,r);n!==i&&(t=t.slice(0,n));return t}(t,e,r):function(t,e){if(a.isBuffer(e)){var r=0|l(e.length);return 0===(t=f(t,r)).length||e.copy(t,0,0,r),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?f(t,0):d(t,e);if("Buffer"===e.type&&s(e.data))return d(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t,e){if(h(e),t=f(t,e<0?0:0|l(e)),!a.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function d(t,e){var r=e.length<0?0:0|l(e.length);t=f(t,r);for(var i=0;i<r;i+=1)t[i]=255&e[i];return t}function l(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function b(t,e){if(a.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return K(t).length;default:if(i)return L(t).length;e=(""+e).toLowerCase(),i=!0}}function p(t,e,r){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,e,r);case"utf8":case"utf-8":return _(this,e,r);case"ascii":return x(this,e,r);case"latin1":case"binary":return B(this,e,r);case"base64":return I(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function m(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function g(t,e,r,i,n){if(0===t.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof e&&(e=a.from(e,i)),a.isBuffer(e))return 0===e.length?-1:w(t,e,r,i,n);if("number"==typeof e)return e&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):w(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function w(t,e,r,i,n){var s,o=1,f=t.length,a=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;o=2,f/=2,a/=2,r/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(n){var h=-1;for(s=r;s<f;s++)if(c(t,s)===c(e,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===a)return h*o}else-1!==h&&(s-=s-h),h=-1}else for(r+a>f&&(r=f-a),s=r;s>=0;s--){for(var u=!0,d=0;d<a;d++)if(c(t,s+d)!==c(e,d)){u=!1;break}if(u)return s}return-1}function y(t,e,r,i){r=Number(r)||0;var n=t.length-r;i?(i=Number(i))>n&&(i=n):i=n;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;o<i;++o){var f=parseInt(e.substr(2*o,2),16);if(isNaN(f))return o;t[r+o]=f}return o}function v(t,e,r,i){return H(L(e,t.length-r),t,r,i)}function S(t,e,r,i){return H(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,i)}function E(t,e,r,i){return S(t,e,r,i)}function M(t,e,r,i){return H(K(e),t,r,i)}function A(t,e,r,i){return H(function(t,e){for(var r,i,n,s=[],o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),i=r>>8,n=r%256,s.push(n),s.push(i);return s}(e,t.length-r),t,r,i)}function I(t,e,r){return 0===e&&r===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,r))}function _(t,e,r){r=Math.min(t.length,r);for(var i=[],n=e;n<r;){var s,o,f,a,c=t[n],h=null,u=c>239?4:c>223?3:c>191?2:1;if(n+u<=r)switch(u){case 1:c<128&&(h=c);break;case 2:128==(192&(s=t[n+1]))&&(a=(31&c)<<6|63&s)>127&&(h=a);break;case 3:s=t[n+1],o=t[n+2],128==(192&s)&&128==(192&o)&&(a=(15&c)<<12|(63&s)<<6|63&o)>2047&&(a<55296||a>57343)&&(h=a);break;case 4:s=t[n+1],o=t[n+2],f=t[n+3],128==(192&s)&&128==(192&o)&&128==(192&f)&&(a=(15&c)<<18|(63&s)<<12|(63&o)<<6|63&f)>65535&&a<1114112&&(h=a)}null===h?(h=65533,u=1):h>65535&&(h-=65536,i.push(h>>>10&1023|55296),h=56320|1023&h),i.push(h),n+=u}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=4096));return r}(i)}e.Buffer=a,e.SlowBuffer=function(t){+t!=t&&(t=0);return a.alloc(+t)},e.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),a.poolSize=8192,a._augment=function(t){return t.__proto__=a.prototype,t},a.from=function(t,e,r){return c(null,t,e,r)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(t,e,r){return function(t,e,r,i){return h(e),e<=0?f(t,e):void 0!==r?"string"==typeof i?f(t,e).fill(r,i):f(t,e).fill(r):f(t,e)}(null,t,e,r)},a.allocUnsafe=function(t){return u(null,t)},a.allocUnsafeSlow=function(t){return u(null,t)},a.isBuffer=function(t){return!(null==t||!t._isBuffer)},a.compare=function(t,e){if(!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,i=e.length,n=0,s=Math.min(r,i);n<s;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:i<r?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var i=a.allocUnsafe(e),n=0;for(r=0;r<t.length;++r){var o=t[r];if(!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,n),n+=o.length}return i},a.byteLength=b,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},a.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},a.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},a.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?_(this,0,t):p.apply(this,arguments)},a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},a.prototype.compare=function(t,e,r,i,n){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),e<0||r>t.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&e>=r)return 0;if(i>=n)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(n>>>=0)-(i>>>=0),o=(r>>>=0)-(e>>>=0),f=Math.min(s,o),c=this.slice(i,n),h=t.slice(e,r),u=0;u<f;++u)if(c[u]!==h[u]){s=c[u],o=h[u];break}return s<o?-1:o<s?1:0},a.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},a.prototype.indexOf=function(t,e,r){return g(this,t,e,r,!0)},a.prototype.lastIndexOf=function(t,e,r){return g(this,t,e,r,!1)},a.prototype.write=function(t,e,r,i){if(void 0===e)i="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)i=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-e;if((void 0===r||r>n)&&(r=n),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return y(this,t,e,r);case"utf8":case"utf-8":return v(this,t,e,r);case"ascii":return S(this,t,e,r);case"latin1":case"binary":return E(this,t,e,r);case"base64":return M(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function x(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(127&t[n]);return i}function B(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function k(t,e,r){var i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);for(var n="",s=e;s<r;++s)n+=D(t[s]);return n}function z(t,e,r){for(var i=t.slice(e,r),n="",s=0;s<i.length;s+=2)n+=String.fromCharCode(i[s]+256*i[s+1]);return n}function q(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function N(t,e,r,i,n,s){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function P(t,e,r,i){e<0&&(e=65535+e+1);for(var n=0,s=Math.min(t.length-r,2);n<s;++n)t[r+n]=(e&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}function R(t,e,r,i){e<0&&(e=4294967295+e+1);for(var n=0,s=Math.min(t.length-r,4);n<s;++n)t[r+n]=e>>>8*(i?n:3-n)&255}function O(t,e,r,i,n,s){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function U(t,e,r,i,s){return s||O(t,0,r,4),n.write(t,e,r,i,23,4),r+4}function C(t,e,r,i,s){return s||O(t,0,r,8),n.write(t,e,r,i,52,8),r+8}a.prototype.slice=function(t,e){var r,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),a.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=a.prototype;else{var n=e-t;r=new a(n,void 0);for(var s=0;s<n;++s)r[s]=this[s+t]}return r},a.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||q(t,e,this.length);for(var i=this[t],n=1,s=0;++s<e&&(n*=256);)i+=this[t+s]*n;return i},a.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||q(t,e,this.length);for(var i=this[t+--e],n=1;e>0&&(n*=256);)i+=this[t+--e]*n;return i},a.prototype.readUInt8=function(t,e){return e||q(t,1,this.length),this[t]},a.prototype.readUInt16LE=function(t,e){return e||q(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUInt16BE=function(t,e){return e||q(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUInt32LE=function(t,e){return e||q(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUInt32BE=function(t,e){return e||q(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||q(t,e,this.length);for(var i=this[t],n=1,s=0;++s<e&&(n*=256);)i+=this[t+s]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*e)),i},a.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||q(t,e,this.length);for(var i=e,n=1,s=this[t+--i];i>0&&(n*=256);)s+=this[t+--i]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*e)),s},a.prototype.readInt8=function(t,e){return e||q(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,e){e||q(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(t,e){e||q(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(t,e){return e||q(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return e||q(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readFloatLE=function(t,e){return e||q(t,4,this.length),n.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return e||q(t,4,this.length),n.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return e||q(t,8,this.length),n.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return e||q(t,8,this.length),n.read(this,t,!1,52,8)},a.prototype.writeUIntLE=function(t,e,r,i){(t=+t,e|=0,r|=0,i)||N(this,t,e,r,Math.pow(2,8*r)-1,0);var n=1,s=0;for(this[e]=255&t;++s<r&&(n*=256);)this[e+s]=t/n&255;return e+r},a.prototype.writeUIntBE=function(t,e,r,i){(t=+t,e|=0,r|=0,i)||N(this,t,e,r,Math.pow(2,8*r)-1,0);var n=r-1,s=1;for(this[e+n]=255&t;--n>=0&&(s*=256);)this[e+n]=t/s&255;return e+r},a.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||N(this,t,e,1,255,0),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},a.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||N(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):P(this,t,e,!0),e+2},a.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||N(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):P(this,t,e,!1),e+2},a.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||N(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):R(this,t,e,!0),e+4},a.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||N(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},a.prototype.writeIntLE=function(t,e,r,i){if(t=+t,e|=0,!i){var n=Math.pow(2,8*r-1);N(this,t,e,r,n-1,-n)}var s=0,o=1,f=0;for(this[e]=255&t;++s<r&&(o*=256);)t<0&&0===f&&0!==this[e+s-1]&&(f=1),this[e+s]=(t/o>>0)-f&255;return e+r},a.prototype.writeIntBE=function(t,e,r,i){if(t=+t,e|=0,!i){var n=Math.pow(2,8*r-1);N(this,t,e,r,n-1,-n)}var s=r-1,o=1,f=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===f&&0!==this[e+s+1]&&(f=1),this[e+s]=(t/o>>0)-f&255;return e+r},a.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||N(this,t,e,1,127,-128),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},a.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||N(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):P(this,t,e,!0),e+2},a.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||N(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):P(this,t,e,!1),e+2},a.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||N(this,t,e,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):R(this,t,e,!0),e+4},a.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||N(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},a.prototype.writeFloatLE=function(t,e,r){return U(this,t,e,!0,r)},a.prototype.writeFloatBE=function(t,e,r){return U(this,t,e,!1,r)},a.prototype.writeDoubleLE=function(t,e,r){return C(this,t,e,!0,r)},a.prototype.writeDoubleBE=function(t,e,r){return C(this,t,e,!1,r)},a.prototype.copy=function(t,e,r,i){if(r||(r=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var n,s=i-r;if(this===t&&r<e&&e<i)for(n=s-1;n>=0;--n)t[n+e]=this[n+r];else if(s<1e3||!a.TYPED_ARRAY_SUPPORT)for(n=0;n<s;++n)t[n+e]=this[n+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+s),e);return s},a.prototype.fill=function(t,e,r,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===t.length){var n=t.charCodeAt(0);n<256&&(t=n)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!a.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var o=a.isBuffer(t)?t:L(new a(t,i).toString()),f=o.length;for(s=0;s<r-e;++s)this[s+e]=o[s%f]}return this};var T=/[^+\/0-9A-Za-z-_]/g;function D(t){return t<16?"0"+t.toString(16):t.toString(16)}function L(t,e){var r;e=e||1/0;for(var i=t.length,n=null,s=[],o=0;o<i;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function K(t){return i.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(T,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function H(t,e,r,i){for(var n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}}).call(this,r(13))},function(t,e,r){"use strict";
/*!
 * assert.js - assert for bcrypto
 * Copyright (c) 2020, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=function t(e,r){if(!e){const e=new Error(r||"Assertion failed");throw Error.captureStackTrace&&Error.captureStackTrace(e,t),e}}},function(t,e,r){(function(e){var i;t.exports=(i=i||function(t,i){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==e&&e.crypto&&(n=e.crypto),!n)try{n=r(58)}catch(t){}var s=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function t(){}return function(e){var r;return t.prototype=e,r=new t,t.prototype=null,r}}(),f={},a=f.lib={},c=a.Base={extend:function(t){var e=o(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},h=a.WordArray=c.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||d).stringify(this)},concat:function(t){var e=this.words,r=t.words,i=this.sigBytes,n=t.sigBytes;if(this.clamp(),i%4)for(var s=0;s<n;s++){var o=r[s>>>2]>>>24-s%4*8&255;e[i+s>>>2]|=o<<24-(i+s)%4*8}else for(var f=0;f<n;f+=4)e[i+f>>>2]=r[f>>>2];return this.sigBytes+=n,this},clamp:function(){var e=this.words,r=this.sigBytes;e[r>>>2]&=4294967295<<32-r%4*8,e.length=t.ceil(r/4)},clone:function(){var t=c.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],r=0;r<t;r+=4)e.push(s());return new h.init(e,t)}}),u=f.enc={},d=u.Hex={stringify:function(t){for(var e=t.words,r=t.sigBytes,i=[],n=0;n<r;n++){var s=e[n>>>2]>>>24-n%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,r=[],i=0;i<e;i+=2)r[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new h.init(r,e/2)}},l=u.Latin1={stringify:function(t){for(var e=t.words,r=t.sigBytes,i=[],n=0;n<r;n++){var s=e[n>>>2]>>>24-n%4*8&255;i.push(String.fromCharCode(s))}return i.join("")},parse:function(t){for(var e=t.length,r=[],i=0;i<e;i++)r[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new h.init(r,e)}},b=u.Utf8={stringify:function(t){try{return decodeURIComponent(escape(l.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return l.parse(unescape(encodeURIComponent(t)))}},p=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=b.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var r,i=this._data,n=i.words,s=i.sigBytes,o=this.blockSize,f=s/(4*o),a=(f=e?t.ceil(f):t.max((0|f)-this._minBufferSize,0))*o,c=t.min(4*a,s);if(a){for(var u=0;u<a;u+=o)this._doProcessBlock(n,u);r=n.splice(0,a),i.sigBytes-=c}return new h.init(r,c)},clone:function(){var t=c.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),m=(a.Hasher=p.extend({cfg:c.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function(t){return function(e,r){return new m.HMAC.init(t,r).finalize(e)}}}),f.algo={});return f}(Math),i)}).call(this,r(13))},function(t,e,r){"use strict";(function(e){
/*!
 * hmac.js - hmac for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/hash.js:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/hash.js
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/HMAC
 *   https://tools.ietf.org/html/rfc2104
 *   https://github.com/indutny/hash.js/blob/master/lib/hash/hmac.js
 */
const i=r(1);t.exports=class{constructor(t,e,r=[],n=[]){i("function"==typeof t),i(e>>>0===e),i(Array.isArray(r)),i(Array.isArray(n)),this.hash=t,this.size=e,this.x=r,this.y=n,this.inner=new t,this.outer=new t}init(t){if(i(e.isBuffer(t)),t.length>this.size){const e=new(0,this.hash);e.init(...this.x),e.update(t),t=e.final(...this.y),i(t.length<=this.size)}const r=e.alloc(this.size);for(let e=0;e<t.length;e++)r[e]=54^t[e];for(let e=t.length;e<r.length;e++)r[e]=54;this.inner.init(...this.x),this.inner.update(r);for(let e=0;e<t.length;e++)r[e]=92^t[e];for(let e=t.length;e<r.length;e++)r[e]=92;return this.outer.init(...this.x),this.outer.update(r),this}update(t){return this.inner.update(t),this}final(){return this.outer.update(this.inner.final(...this.y)),this.outer.final(...this.y)}}}).call(this,r(0).Buffer)},function(t,e,r){var i,n,s,o,f,a,c,h,u,d,l,b,p,m,g,w,y,v,S;t.exports=(i=r(2),r(15),void(i.lib.Cipher||(n=i,s=n.lib,o=s.Base,f=s.WordArray,a=s.BufferedBlockAlgorithm,c=n.enc,c.Utf8,h=c.Base64,u=n.algo.EvpKDF,d=s.Cipher=a.extend({cfg:o.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,r){this.cfg=this.cfg.extend(r),this._xformMode=t,this._key=e,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function t(t){return"string"==typeof t?S:y}return function(e){return{encrypt:function(r,i,n){return t(i).encrypt(e,r,i,n)},decrypt:function(r,i,n){return t(i).decrypt(e,r,i,n)}}}}()}),s.StreamCipher=d.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),l=n.mode={},b=s.BlockCipherMode=o.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),p=l.CBC=function(){var t=b.extend();function e(t,e,r){var i,n=this._iv;n?(i=n,this._iv=void 0):i=this._prevBlock;for(var s=0;s<r;s++)t[e+s]^=i[s]}return t.Encryptor=t.extend({processBlock:function(t,r){var i=this._cipher,n=i.blockSize;e.call(this,t,r,n),i.encryptBlock(t,r),this._prevBlock=t.slice(r,r+n)}}),t.Decryptor=t.extend({processBlock:function(t,r){var i=this._cipher,n=i.blockSize,s=t.slice(r,r+n);i.decryptBlock(t,r),e.call(this,t,r,n),this._prevBlock=s}}),t}(),m=(n.pad={}).Pkcs7={pad:function(t,e){for(var r=4*e,i=r-t.sigBytes%r,n=i<<24|i<<16|i<<8|i,s=[],o=0;o<i;o+=4)s.push(n);var a=f.create(s,i);t.concat(a)},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},s.BlockCipher=d.extend({cfg:d.cfg.extend({mode:p,padding:m}),reset:function(){var t;d.reset.call(this);var e=this.cfg,r=e.iv,i=e.mode;this._xformMode==this._ENC_XFORM_MODE?t=i.createEncryptor:(t=i.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==t?this._mode.init(this,r&&r.words):(this._mode=t.call(i,this,r&&r.words),this._mode.__creator=t)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t,e=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(e.pad(this._data,this.blockSize),t=this._process(!0)):(t=this._process(!0),e.unpad(t)),t},blockSize:4}),g=s.CipherParams=o.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),w=(n.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext,r=t.salt;return(r?f.create([1398893684,1701076831]).concat(r).concat(e):e).toString(h)},parse:function(t){var e,r=h.parse(t),i=r.words;return 1398893684==i[0]&&1701076831==i[1]&&(e=f.create(i.slice(2,4)),i.splice(0,4),r.sigBytes-=16),g.create({ciphertext:r,salt:e})}},y=s.SerializableCipher=o.extend({cfg:o.extend({format:w}),encrypt:function(t,e,r,i){i=this.cfg.extend(i);var n=t.createEncryptor(r,i),s=n.finalize(e),o=n.cfg;return g.create({ciphertext:s,key:r,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:i.format})},decrypt:function(t,e,r,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),t.createDecryptor(r,i).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),v=(n.kdf={}).OpenSSL={execute:function(t,e,r,i){i||(i=f.random(8));var n=u.create({keySize:e+r}).compute(t,i),s=f.create(n.words.slice(e),4*r);return n.sigBytes=4*e,g.create({key:n,iv:s,salt:i})}},S=s.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:v}),encrypt:function(t,e,r,i){var n=(i=this.cfg.extend(i)).kdf.execute(r,t.keySize,t.ivSize);i.iv=n.iv;var s=y.encrypt.call(this,t,e,n.key,i);return s.mixIn(n),s},decrypt:function(t,e,r,i){i=this.cfg.extend(i),e=this._parse(e,i.format);var n=i.kdf.execute(r,t.keySize,t.ivSize,e.salt);return i.iv=n.iv,y.decrypt.call(this,t,e,n.key,i)}}))))},function(t,e,r){"use strict";
/*!
 * random.js - random for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(193)},function(t,e,r){"use strict";
/*!
 * bn.js - big numbers for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(185)},function(t,e,r){"use strict";var i=e,n=r(12),s=r(16),o=r(61);i.assert=s,i.toArray=o.toArray,i.zero2=o.zero2,i.toHex=o.toHex,i.encode=o.encode,i.getNAF=function(t,e,r){var i=new Array(Math.max(t.bitLength(),r)+1);i.fill(0);for(var n=1<<e+1,s=t.clone(),o=0;o<i.length;o++){var f,a=s.andln(n-1);s.isOdd()?(f=a>(n>>1)-1?(n>>1)-a:a,s.isubn(f)):f=0,i[o]=f,s.iushrn(1)}return i},i.getJSF=function(t,e){var r=[[],[]];t=t.clone(),e=e.clone();for(var i,n=0,s=0;t.cmpn(-n)>0||e.cmpn(-s)>0;){var o,f,a=t.andln(3)+n&3,c=e.andln(3)+s&3;3===a&&(a=-1),3===c&&(c=-1),o=0==(1&a)?0:3!==(i=t.andln(7)+n&7)&&5!==i||2!==c?a:-a,r[0].push(o),f=0==(1&c)?0:3!==(i=e.andln(7)+s&7)&&5!==i||2!==a?c:-c,r[1].push(f),2*n===o+1&&(n=1-n),2*s===f+1&&(s=1-s),t.iushrn(1),e.iushrn(1)}return r},i.cachedProperty=function(t,e,r){var i="_"+e;t.prototype[e]=function(){return void 0!==this[i]?this[i]:this[i]=r.call(this)}},i.parseBytes=function(t){return"string"==typeof t?i.toArray(t,"hex"):t},i.intFromLE=function(t){return new n(t,"hex","le")}},function(t,e){t.exports=function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=4)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hexBoundaries=e.hexToBytes=e.hexLE=e.hexFixBytes=void 0;var i=r(2);e.hexFixBytes=function(t){return t.length%2==0?t:t.padStart(2*Math.ceil(t.length/2),"0")};var n=function(t){return t.length%2==0&&!/[^a-fA-F0-9]/u.test(t)};e.hexLE=function(t){return(0,i.bytesToHex)((0,e.hexToBytes)(t).reverse())},e.hexToBytes=function(t){return Uint8Array.from(function(t){if(!n(t))throw"hexToHexBytes: invalid hex string";var e=t.match(/.{1,2}/g);return null===e?[]:e.map((function(t){return t}))}(t).map((function(t){return function(t){if(!n(t))throw"hexToByte: invalid hex string";return parseInt(t,16)}(t)})))},e.hexBoundaries=function(t){var e=Math.pow(2,8*t-9),r=Math.pow(2,8*t-1);if(0<t&&t<5)return{minPos:e,maxPos:r-1,minNeg:1-r,maxNeg:-1*e}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_INTEGER=void 0,e.MAX_INTEGER=2147483647},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.bytesToBin=e.bytesToNumber=e.bytesToString=e.bytesToHex=void 0;var i=r(0),n=r(3);e.bytesToHex=function(t){return t.reduce((function(t,e){return t+function(t){if(!function(t){return 0<=t&&t<=255}(t))throw"byteToHex: invalid byte number";return t.toString(16).padStart(2,"0")}(e)}),"")},e.bytesToString=function(t){for(var e=[],r=0,i=0;r<t.length;){var n=t[r++];if(n<128)e[i++]=String.fromCharCode(n);else if(n>191&&n<224){var s=t[r++];e[i++]=String.fromCharCode((31&n)<<6|63&s)}else if(n>239&&n<365){var o=((7&n)<<18|(63&(s=t[r++]))<<12|(63&(f=t[r++]))<<6|63&t[r++])-65536;e[i++]=String.fromCharCode(55296+(o>>10)),e[i++]=String.fromCharCode(56320+(1023&o))}else{s=t[r++];var f=t[r++];e[i++]=String.fromCharCode((15&n)<<12|(63&s)<<6|63&f)}}return e.join("")},e.bytesToNumber=function(t){if(0==t.length)return 0;if(!(4<t.length)){var r=(0,e.bytesToHex)(t);if((0,n.numberIsValid)(r,t.length)){var s=(0,i.hexBoundaries)(t.length);if(void 0!==s){var o=parseInt((0,i.hexLE)(r),16);return s.minPos<=o&&o<=s.maxPos||0===o?o:Math.pow(2,8*t.length-1)-o}}}},e.bytesToBin=function(t){return t.reduce((function(t,e){return e.toString(2).padStart(8,"0")+t}),"")}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.numberIsValid=e.numberToBytes=void 0;var i=r(0),n=function(t,e){return Math.log(e)/Math.log(t)},s=function(t,e){var r=t%e;return{numeral:r,nextValue:(t-r)/e}};e.numberToBytes=function(t){var e,r=0===(e=t)?0:0<e?Math.ceil((n(2,e+1)+1)/8):e<0?Math.floor((n(2,-e)+1)/8+1):0;return function(t,e){var r=new Uint8Array(e);if(t.length>e){var i=Math.pow(2,8)-1;r.fill(i)}else r.set(t);return r}(function(t){for(var e=Math.pow(2,8),r=t,i=[];r>=e;){var n=s(r,e),o=n.numeral,f=n.nextValue;i.push(o),r=f}return r>0&&i.push(r),Uint8Array.from(i)}(t<0?Math.pow(2,8*r-1)-t:t),r)},e.numberIsValid=function(t,e){var r=parseInt((0,i.hexLE)(t),16);return!(1===e&&(0==r||128==r)||2===e&&(1<=r&&r<=127||32768<=r&&r<=32895)||3===e&&(1<=r&&r<=32767||8388608<=r&&r<=8421375)||4===e&&(1<=r&&r<=8388607||2147483648<=r&&r<=2155872255))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_INTEGER=e.hexLE=void 0;var i=r(1);Object.defineProperty(e,"MAX_INTEGER",{enumerable:!0,get:function(){return i.MAX_INTEGER}});var n=r(0);Object.defineProperty(e,"hexLE",{enumerable:!0,get:function(){return n.hexLE}});var s=r(5);e.default=s.WizData},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WizData=void 0;var i=r(1),n=r(6),s=r(2),o=r(0),f=r(3),a=r(7),c=function(){function t(t,e,r,c,h){var u="",d=new Uint8Array([]),l="",b="",p=void 0,m=void 0;void 0!==t?(u="0x"+t,d=(0,o.hexToBytes)(t),l=(0,s.bytesToBin)(d),b=t,p=(0,s.bytesToNumber)(d)):void 0!==e?(u="0b"+e,d=(0,n.binToBytes)(e),l=e,b=(0,s.bytesToHex)(d),p=(0,s.bytesToNumber)(d)):void 0!==r?(u=r,d=(0,f.numberToBytes)(r),l=(0,s.bytesToBin)(d),b=(0,s.bytesToHex)(d),p=r):void 0!==c?(u=c,d=(0,a.stringToBytes)(c),l=(0,s.bytesToBin)(d),b=(0,s.bytesToHex)(d),p=(0,s.bytesToNumber)(d),m=c):void 0!==h&&(u=h,d=h,l=(0,s.bytesToBin)(d),b=(0,s.bytesToHex)(h),p=(0,s.bytesToNumber)(d)),this.input=u,this.bytes=d,this.bin=l,this.hex=b,void 0!==p&&-i.MAX_INTEGER<=p&&p<=i.MAX_INTEGER&&(this.number=p),this.text=m}return t.fromHex=function(e){return new t(e,void 0,void 0,void 0)},t.fromBin=function(e){return new t(void 0,e,void 0,void 0)},t.fromNumber=function(e){return new t(void 0,void 0,e,void 0)},t.fromText=function(e){return new t(void 0,void 0,void 0,e)},t.fromBytes=function(e){return new t(void 0,void 0,void 0,void 0,e)},t}();e.WizData=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.binToBytes=e.binFixBytes=void 0,e.binFixBytes=function(t){return t.length%8==0?t:t.padStart(8*Math.ceil(t.length/8),"0")},e.binToBytes=function(t){return Uint8Array.from(function(t){if(!function(t){return!/[^01]/u.test(t)&&t.length%8==0}(t))throw"binToBinBytes: invalid bin string";var e=t.match(/.{1,8}/g);return null===e?[]:e.map((function(t){return t}))}(t).reverse().map((function(t){return function(t){return parseInt(t,2)}(t)})))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.stringToBytes=void 0,e.stringToBytes=function(t){for(var e=[],r=0,i=0;i<t.length;i++){var n=t.charCodeAt(i);n<128?e[r++]=n:n<2048?(e[r++]=n>>6|192,e[r++]=63&n|128):55296==(64512&n)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(n=65536+((1023&n)<<10)+(1023&t.charCodeAt(i+=1)),e[r++]=n>>18|240,e[r++]=n>>12&63|128,e[r++]=n>>6&63|128,e[r++]=63&n|128):(e[r++]=n>>12|224,e[r++]=n>>6&63|128,e[r++]=63&n|128)}return new Uint8Array(e)}}])},function(t,e,r){"use strict";(function(t){
/*!
 * pem.js - PEM for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail
 *   https://tools.ietf.org/html/rfc1421
 *   https://tools.ietf.org/html/rfc1422
 *   https://tools.ietf.org/html/rfc1423
 *   https://tools.ietf.org/html/rfc1424
 *   https://tools.ietf.org/html/rfc4880
 *   https://tls.mbed.org/kb/cryptography/asn1-key-structures-in-der-and-pem
 *   https://github.com/crypto-browserify/EVP_BytesToKey/blob/master/index.js
 *   https://github.com/openssl/openssl/blob/master/include/openssl/pem.h
 *   https://github.com/openssl/openssl/blob/master/crypto/pem/pem_lib.c
 *   https://github.com/openssl/openssl/blob/master/crypto/evp/evp_key.c
 *   https://github.com/openssl/openssl/blob/master/crypto/pem/pem_pkey.c
 */
const i=r(1),n=r(40),s=r(93),o=t.alloc(0);class f{constructor(e,r){null==e&&(e="PRIVACY-ENHANCED MESSAGE"),null==r&&(r=o),i("string"==typeof e),i(t.isBuffer(r)),this.type=e,this.headers=new Map,this.data=r}toString(t){return h(this.type,this.headers,this.data,t)}fromString(t,e){const r=u(t,e).next();if(r.done)throw new Error("No PEM data found.");const i=r.value;return this.type=i.type,this.headers=i.headers,this.data=i.data,this}getProcType(){const t=this.headers.get("Proc-Type");return t?a.fromString(t):null}setProcType(t,e){i(null!=t&&e);const r=new a(t,e);return this.headers.set("Proc-Type",r.toString()),this}unsetProcType(){return this.headers.delete("Proc-Type"),this}getDEKInfo(){const t=this.headers.get("DEK-Info");return t?c.fromString(t):null}setDEKInfo(t,e){i(t);const r=new c(t,e);return this.headers.set("DEK-Info",r.toString()),this}unsetDEKInfo(){return this.headers.delete("DEK-Info"),this}isEncrypted(){let t;try{t=this.getProcType()}catch(t){return!1}return!!t&&(4===t.version&&"ENCRYPTED"===t.state)}static fromString(t,e){return(new this).fromString(t,e)}}class a{constructor(t,e){null==t&&(t=0),null==e&&(e="NONE"),i(t>>>0===t),i("string"==typeof e),this.version=t,this.state=e.toUpperCase()}toString(){return`${this.version},${this.state}`}fromString(t){i("string"==typeof t);const e=t.split(",",3);if(2!==e.length)throw new Error("Invalid Proc-Type.");return this.version=function(t){if(i("string"==typeof t),t.length<1||t.length>10)throw new Error("Invalid integer.");let e=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);if(i<48||i>57)throw new Error("Invalid integer.");if(e*=10,e+=i-48,r>0&&0===e)throw new Error("Invalid integer.");if(e>4294967295)throw new Error("Invalid integer.")}return e}(e[0]),this.state=e[1].toUpperCase(),this}static fromString(t){return(new this).fromString(t)}}class c{constructor(e,r){null==e&&(e="AES-128-ECB"),null==r&&(r=o),i("string"==typeof e),i(t.isBuffer(r)),this.name=e.toUpperCase(),this.iv=r}toString(){const t=this.name;if(0===this.iv.length)return t;return`${t},${this.iv.toString("hex").toUpperCase()}`}fromString(e){i("string"==typeof e);const r=e.split(",",3);if(r.length<1||r.length>2)throw new Error("Invalid DEK-Info.");const n=r[0];if(0===n.length)throw new Error("Invalid DEK-Info name.");if(this.name=n.toUpperCase(),this.iv=o,r.length>1){const e=r[1],i=t.from(e,"hex");if(i.length!==e.length>>>1)throw new Error("Invalid DEK-Info IV.");this.iv=i}return this}static fromString(t){return(new this).fromString(t)}}function h(e,r,s,o=!1){i("string"==typeof e),i(r instanceof Map),i(t.isBuffer(s)),i("boolean"==typeof o);let f="";if(f+=`-----BEGIN ${e}-----\n`,r.size>0){for(const[t,e]of r)f+=`${t}: ${e}\n`;f+="\n"}const a=n.encode(s);for(let t=0;t<a.length;t+=64)f+=a.substring(t,t+64)+"\n";if(o){const t=d(s);f+=`=${n.encode(t)}\n`}return f+=`-----END ${e}-----\n`,f}function*u(t,e=!1){i("string"==typeof t),i("boolean"==typeof e);let r="",o=null,a=null;for(const[,i]of s(t)){const t=i.indexOf(":");if(-1===t){if(i.length>=15&&"-----"===i.substring(0,5)){if("-----"!==i.slice(-5))throw new Error("PEM parse error (invalid preamble).");const t=i.slice(5,-5);if("BEGIN "===t.substring(0,6)){if(o)throw new Error("PEM parse error (un-ended block).");const e=t.substring(6).trim();o=new f,o.type=e;continue}if("END "===t.substring(0,4)){if(!o)throw new Error("PEM parse error (unexpected end).");const e=t.substring(4).trim();if(o.type!==e)throw new Error("PEM parse error (type mismatch).");if(o.data=n.decode(r),a&&!d(o.data).equals(a))throw new Error("PEM parse error (invalid armor checksum).");yield o,r="",o=null,a=null;continue}throw new Error("PEM parse error (unknown preamble).")}if(!o)throw new Error("PEM parse error (unexpected data).");if(5!==i.length||61!==i.charCodeAt(0)){if(i.length>96)throw new Error("PEM parse error (line too long).");r+=i.replace(/[\t\v ]/g,"")}else{if(!e)continue;if(a)throw new Error("PEM parse error (unexpected armor checksum).");a=n.decode(i.substring(1))}}else{if(!o)throw new Error("PEM parse error (misplaced header).");const e=i.substring(0,t).trim(),r=i.substring(t+1).trim();o.headers.set(e,r)}}if(o||a)throw new Error("PEM parse error (un-ended block).");if(0!==r.length)throw new Error("PEM parse error (trailing data).")}function d(e){i(t.isBuffer(e));let r=11994318;for(let t=0;t<e.length;t++){r^=e[t]<<16;for(let t=0;t<8;t++)r<<=1,16777216&r&&(r^=25578747)}r&=16777215;const n=t.alloc(3);return n[2]=r,r>>>=8,n[1]=r,r>>>=8,n[0]=r,n}e.PEMBlock=f,e.ProcType=a,e.DEKInfo=c,e.encode=h,e.decode=u,e.toPEM=function(e,r,n){i(t.isBuffer(e)),i("string"==typeof r);const s=new f;return s.type=r,s.data=e,s.toString(n)},e.fromPEM=function(t,e,r){i("string"==typeof t),i("string"==typeof e);const n=f.fromString(t,r);if(n.type!==e)throw new Error("PEM type mismatch.");return n.data}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";var i=r(16),n=r(32);function s(t,e){return 55296==(64512&t.charCodeAt(e))&&(!(e<0||e+1>=t.length)&&56320==(64512&t.charCodeAt(e+1)))}function o(t){return(t>>>24|t>>>8&65280|t<<8&16711680|(255&t)<<24)>>>0}function f(t){return 1===t.length?"0"+t:t}function a(t){return 7===t.length?"0"+t:6===t.length?"00"+t:5===t.length?"000"+t:4===t.length?"0000"+t:3===t.length?"00000"+t:2===t.length?"000000"+t:1===t.length?"0000000"+t:t}e.inherits=n,e.toArray=function(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if("string"==typeof t)if(e){if("hex"===e)for((t=t.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(t="0"+t),n=0;n<t.length;n+=2)r.push(parseInt(t[n]+t[n+1],16))}else for(var i=0,n=0;n<t.length;n++){var o=t.charCodeAt(n);o<128?r[i++]=o:o<2048?(r[i++]=o>>6|192,r[i++]=63&o|128):s(t,n)?(o=65536+((1023&o)<<10)+(1023&t.charCodeAt(++n)),r[i++]=o>>18|240,r[i++]=o>>12&63|128,r[i++]=o>>6&63|128,r[i++]=63&o|128):(r[i++]=o>>12|224,r[i++]=o>>6&63|128,r[i++]=63&o|128)}else for(n=0;n<t.length;n++)r[n]=0|t[n];return r},e.toHex=function(t){for(var e="",r=0;r<t.length;r++)e+=f(t[r].toString(16));return e},e.htonl=o,e.toHex32=function(t,e){for(var r="",i=0;i<t.length;i++){var n=t[i];"little"===e&&(n=o(n)),r+=a(n.toString(16))}return r},e.zero2=f,e.zero8=a,e.join32=function(t,e,r,n){var s=r-e;i(s%4==0);for(var o=new Array(s/4),f=0,a=e;f<o.length;f++,a+=4){var c;c="big"===n?t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3]:t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a],o[f]=c>>>0}return o},e.split32=function(t,e){for(var r=new Array(4*t.length),i=0,n=0;i<t.length;i++,n+=4){var s=t[i];"big"===e?(r[n]=s>>>24,r[n+1]=s>>>16&255,r[n+2]=s>>>8&255,r[n+3]=255&s):(r[n+3]=s>>>24,r[n+2]=s>>>16&255,r[n+1]=s>>>8&255,r[n]=255&s)}return r},e.rotr32=function(t,e){return t>>>e|t<<32-e},e.rotl32=function(t,e){return t<<e|t>>>32-e},e.sum32=function(t,e){return t+e>>>0},e.sum32_3=function(t,e,r){return t+e+r>>>0},e.sum32_4=function(t,e,r,i){return t+e+r+i>>>0},e.sum32_5=function(t,e,r,i,n){return t+e+r+i+n>>>0},e.sum64=function(t,e,r,i){var n=t[e],s=i+t[e+1]>>>0,o=(s<i?1:0)+r+n;t[e]=o>>>0,t[e+1]=s},e.sum64_hi=function(t,e,r,i){return(e+i>>>0<e?1:0)+t+r>>>0},e.sum64_lo=function(t,e,r,i){return e+i>>>0},e.sum64_4_hi=function(t,e,r,i,n,s,o,f){var a=0,c=e;return a+=(c=c+i>>>0)<e?1:0,a+=(c=c+s>>>0)<s?1:0,t+r+n+o+(a+=(c=c+f>>>0)<f?1:0)>>>0},e.sum64_4_lo=function(t,e,r,i,n,s,o,f){return e+i+s+f>>>0},e.sum64_5_hi=function(t,e,r,i,n,s,o,f,a,c){var h=0,u=e;return h+=(u=u+i>>>0)<e?1:0,h+=(u=u+s>>>0)<s?1:0,h+=(u=u+f>>>0)<f?1:0,t+r+n+o+a+(h+=(u=u+c>>>0)<c?1:0)>>>0},e.sum64_5_lo=function(t,e,r,i,n,s,o,f,a,c){return e+i+s+f+c>>>0},e.rotr64_hi=function(t,e,r){return(e<<32-r|t>>>r)>>>0},e.rotr64_lo=function(t,e,r){return(t<<32-r|e>>>r)>>>0},e.shr64_hi=function(t,e,r){return t>>>r},e.shr64_lo=function(t,e,r){return(t<<32-r|e>>>r)>>>0}},function(t,e,r){"use strict";
/*!
 * sha256.js - sha256 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(36)},function(t,e,r){(function(t){!function(t,e){"use strict";function i(t,e){if(!t)throw new Error(e||"Assertion failed")}function n(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}function s(t,e,r){if(s.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(r=e,e=10),this._init(t||0,e||10,r||"be"))}var o;"object"==typeof t?t.exports=s:e.BN=s,s.BN=s,s.wordSize=26;try{o="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:r(149).Buffer}catch(t){}function f(t,e){var r=t.charCodeAt(e);return r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:r-48&15}function a(t,e,r){var i=f(t,r);return r-1>=e&&(i|=f(t,r-1)<<4),i}function c(t,e,r,i){for(var n=0,s=Math.min(t.length,r),o=e;o<s;o++){var f=t.charCodeAt(o)-48;n*=i,n+=f>=49?f-49+10:f>=17?f-17+10:f}return n}s.isBN=function(t){return t instanceof s||null!==t&&"object"==typeof t&&t.constructor.wordSize===s.wordSize&&Array.isArray(t.words)},s.max=function(t,e){return t.cmp(e)>0?t:e},s.min=function(t,e){return t.cmp(e)<0?t:e},s.prototype._init=function(t,e,r){if("number"==typeof t)return this._initNumber(t,e,r);if("object"==typeof t)return this._initArray(t,e,r);"hex"===e&&(e=16),i(e===(0|e)&&e>=2&&e<=36);var n=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&(n++,this.negative=1),n<t.length&&(16===e?this._parseHex(t,n,r):(this._parseBase(t,e,n),"le"===r&&this._initArray(this.toArray(),e,r)))},s.prototype._initNumber=function(t,e,r){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(i(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),e,r)},s.prototype._initArray=function(t,e,r){if(i("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var s,o,f=0;if("be"===r)for(n=t.length-1,s=0;n>=0;n-=3)o=t[n]|t[n-1]<<8|t[n-2]<<16,this.words[s]|=o<<f&67108863,this.words[s+1]=o>>>26-f&67108863,(f+=24)>=26&&(f-=26,s++);else if("le"===r)for(n=0,s=0;n<t.length;n+=3)o=t[n]|t[n+1]<<8|t[n+2]<<16,this.words[s]|=o<<f&67108863,this.words[s+1]=o>>>26-f&67108863,(f+=24)>=26&&(f-=26,s++);return this.strip()},s.prototype._parseHex=function(t,e,r){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var n,s=0,o=0;if("be"===r)for(i=t.length-1;i>=e;i-=2)n=a(t,e,i)<<s,this.words[o]|=67108863&n,s>=18?(s-=18,o+=1,this.words[o]|=n>>>26):s+=8;else for(i=(t.length-e)%2==0?e+1:e;i<t.length;i+=2)n=a(t,e,i)<<s,this.words[o]|=67108863&n,s>=18?(s-=18,o+=1,this.words[o]|=n>>>26):s+=8;this.strip()},s.prototype._parseBase=function(t,e,r){this.words=[0],this.length=1;for(var i=0,n=1;n<=67108863;n*=e)i++;i--,n=n/e|0;for(var s=t.length-r,o=s%i,f=Math.min(s,s-o)+r,a=0,h=r;h<f;h+=i)a=c(t,h,h+i,e),this.imuln(n),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a);if(0!==o){var u=1;for(a=c(t,h,t.length,e),h=0;h<o;h++)u*=e;this.imuln(u),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a)}this.strip()},s.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},s.prototype.clone=function(){var t=new s(null);return this.copy(t),t},s.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],d=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function l(t,e,r){r.negative=e.negative^t.negative;var i=t.length+e.length|0;r.length=i,i=i-1|0;var n=0|t.words[0],s=0|e.words[0],o=n*s,f=67108863&o,a=o/67108864|0;r.words[0]=f;for(var c=1;c<i;c++){for(var h=a>>>26,u=67108863&a,d=Math.min(c,e.length-1),l=Math.max(0,c-t.length+1);l<=d;l++){var b=c-l|0;h+=(o=(n=0|t.words[b])*(s=0|e.words[l])+u)/67108864|0,u=67108863&o}r.words[c]=0|u,a=0|h}return 0!==a?r.words[c]=0|a:r.length--,r.strip()}s.prototype.toString=function(t,e){var r;if(e=0|e||1,16===(t=t||10)||"hex"===t){r="";for(var n=0,s=0,o=0;o<this.length;o++){var f=this.words[o],a=(16777215&(f<<n|s)).toString(16);r=0!==(s=f>>>24-n&16777215)||o!==this.length-1?h[6-a.length]+a+r:a+r,(n+=2)>=26&&(n-=26,o--)}for(0!==s&&(r=s.toString(16)+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(t===(0|t)&&t>=2&&t<=36){var c=u[t],l=d[t];r="";var b=this.clone();for(b.negative=0;!b.isZero();){var p=b.modn(l).toString(t);r=(b=b.idivn(l)).isZero()?p+r:h[c-p.length]+p+r}for(this.isZero()&&(r="0"+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(t,e){return i(void 0!==o),this.toArrayLike(o,t,e)},s.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)},s.prototype.toArrayLike=function(t,e,r){var n=this.byteLength(),s=r||Math.max(1,n);i(n<=s,"byte array longer than desired length"),i(s>0,"Requested array length <= 0"),this.strip();var o,f,a="le"===e,c=new t(s),h=this.clone();if(a){for(f=0;!h.isZero();f++)o=h.andln(255),h.iushrn(8),c[f]=o;for(;f<s;f++)c[f]=0}else{for(f=0;f<s-n;f++)c[f]=0;for(f=0;!h.isZero();f++)o=h.andln(255),h.iushrn(8),c[s-f-1]=o}return c},Math.clz32?s.prototype._countBits=function(t){return 32-Math.clz32(t)}:s.prototype._countBits=function(t){var e=t,r=0;return e>=4096&&(r+=13,e>>>=13),e>=64&&(r+=7,e>>>=7),e>=8&&(r+=4,e>>>=4),e>=2&&(r+=2,e>>>=2),r+e},s.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,r=0;return 0==(8191&e)&&(r+=13,e>>>=13),0==(127&e)&&(r+=7,e>>>=7),0==(15&e)&&(r+=4,e>>>=4),0==(3&e)&&(r+=2,e>>>=2),0==(1&e)&&r++,r},s.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var r=this._zeroBits(this.words[e]);if(t+=r,26!==r)break}return t},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},s.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this.strip()},s.prototype.ior=function(t){return i(0==(this.negative|t.negative)),this.iuor(t)},s.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},s.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},s.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var r=0;r<e.length;r++)this.words[r]=this.words[r]&t.words[r];return this.length=e.length,this.strip()},s.prototype.iand=function(t){return i(0==(this.negative|t.negative)),this.iuand(t)},s.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},s.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},s.prototype.iuxor=function(t){var e,r;this.length>t.length?(e=this,r=t):(e=t,r=this);for(var i=0;i<r.length;i++)this.words[i]=e.words[i]^r.words[i];if(this!==e)for(;i<e.length;i++)this.words[i]=e.words[i];return this.length=e.length,this.strip()},s.prototype.ixor=function(t){return i(0==(this.negative|t.negative)),this.iuxor(t)},s.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},s.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},s.prototype.inotn=function(t){i("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),r=t%26;this._expand(e),r>0&&e--;for(var n=0;n<e;n++)this.words[n]=67108863&~this.words[n];return r>0&&(this.words[n]=~this.words[n]&67108863>>26-r),this.strip()},s.prototype.notn=function(t){return this.clone().inotn(t)},s.prototype.setn=function(t,e){i("number"==typeof t&&t>=0);var r=t/26|0,n=t%26;return this._expand(r+1),this.words[r]=e?this.words[r]|1<<n:this.words[r]&~(1<<n),this.strip()},s.prototype.iadd=function(t){var e,r,i;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(r=this,i=t):(r=t,i=this);for(var n=0,s=0;s<i.length;s++)e=(0|r.words[s])+(0|i.words[s])+n,this.words[s]=67108863&e,n=e>>>26;for(;0!==n&&s<r.length;s++)e=(0|r.words[s])+n,this.words[s]=67108863&e,n=e>>>26;if(this.length=r.length,0!==n)this.words[this.length]=n,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},s.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},s.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var r,i,n=this.cmp(t);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(r=this,i=t):(r=t,i=this);for(var s=0,o=0;o<i.length;o++)s=(e=(0|r.words[o])-(0|i.words[o])+s)>>26,this.words[o]=67108863&e;for(;0!==s&&o<r.length;o++)s=(e=(0|r.words[o])+s)>>26,this.words[o]=67108863&e;if(0===s&&o<r.length&&r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=Math.max(this.length,o),r!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(t){return this.clone().isub(t)};var b=function(t,e,r){var i,n,s,o=t.words,f=e.words,a=r.words,c=0,h=0|o[0],u=8191&h,d=h>>>13,l=0|o[1],b=8191&l,p=l>>>13,m=0|o[2],g=8191&m,w=m>>>13,y=0|o[3],v=8191&y,S=y>>>13,E=0|o[4],M=8191&E,A=E>>>13,I=0|o[5],_=8191&I,x=I>>>13,B=0|o[6],k=8191&B,z=B>>>13,q=0|o[7],N=8191&q,P=q>>>13,R=0|o[8],O=8191&R,U=R>>>13,C=0|o[9],T=8191&C,D=C>>>13,L=0|f[0],K=8191&L,H=L>>>13,j=0|f[1],F=8191&j,Z=j>>>13,V=0|f[2],G=8191&V,J=V>>>13,Y=0|f[3],X=8191&Y,W=Y>>>13,$=0|f[4],Q=8191&$,tt=$>>>13,et=0|f[5],rt=8191&et,it=et>>>13,nt=0|f[6],st=8191&nt,ot=nt>>>13,ft=0|f[7],at=8191&ft,ct=ft>>>13,ht=0|f[8],ut=8191&ht,dt=ht>>>13,lt=0|f[9],bt=8191&lt,pt=lt>>>13;r.negative=t.negative^e.negative,r.length=19;var mt=(c+(i=Math.imul(u,K))|0)+((8191&(n=(n=Math.imul(u,H))+Math.imul(d,K)|0))<<13)|0;c=((s=Math.imul(d,H))+(n>>>13)|0)+(mt>>>26)|0,mt&=67108863,i=Math.imul(b,K),n=(n=Math.imul(b,H))+Math.imul(p,K)|0,s=Math.imul(p,H);var gt=(c+(i=i+Math.imul(u,F)|0)|0)+((8191&(n=(n=n+Math.imul(u,Z)|0)+Math.imul(d,F)|0))<<13)|0;c=((s=s+Math.imul(d,Z)|0)+(n>>>13)|0)+(gt>>>26)|0,gt&=67108863,i=Math.imul(g,K),n=(n=Math.imul(g,H))+Math.imul(w,K)|0,s=Math.imul(w,H),i=i+Math.imul(b,F)|0,n=(n=n+Math.imul(b,Z)|0)+Math.imul(p,F)|0,s=s+Math.imul(p,Z)|0;var wt=(c+(i=i+Math.imul(u,G)|0)|0)+((8191&(n=(n=n+Math.imul(u,J)|0)+Math.imul(d,G)|0))<<13)|0;c=((s=s+Math.imul(d,J)|0)+(n>>>13)|0)+(wt>>>26)|0,wt&=67108863,i=Math.imul(v,K),n=(n=Math.imul(v,H))+Math.imul(S,K)|0,s=Math.imul(S,H),i=i+Math.imul(g,F)|0,n=(n=n+Math.imul(g,Z)|0)+Math.imul(w,F)|0,s=s+Math.imul(w,Z)|0,i=i+Math.imul(b,G)|0,n=(n=n+Math.imul(b,J)|0)+Math.imul(p,G)|0,s=s+Math.imul(p,J)|0;var yt=(c+(i=i+Math.imul(u,X)|0)|0)+((8191&(n=(n=n+Math.imul(u,W)|0)+Math.imul(d,X)|0))<<13)|0;c=((s=s+Math.imul(d,W)|0)+(n>>>13)|0)+(yt>>>26)|0,yt&=67108863,i=Math.imul(M,K),n=(n=Math.imul(M,H))+Math.imul(A,K)|0,s=Math.imul(A,H),i=i+Math.imul(v,F)|0,n=(n=n+Math.imul(v,Z)|0)+Math.imul(S,F)|0,s=s+Math.imul(S,Z)|0,i=i+Math.imul(g,G)|0,n=(n=n+Math.imul(g,J)|0)+Math.imul(w,G)|0,s=s+Math.imul(w,J)|0,i=i+Math.imul(b,X)|0,n=(n=n+Math.imul(b,W)|0)+Math.imul(p,X)|0,s=s+Math.imul(p,W)|0;var vt=(c+(i=i+Math.imul(u,Q)|0)|0)+((8191&(n=(n=n+Math.imul(u,tt)|0)+Math.imul(d,Q)|0))<<13)|0;c=((s=s+Math.imul(d,tt)|0)+(n>>>13)|0)+(vt>>>26)|0,vt&=67108863,i=Math.imul(_,K),n=(n=Math.imul(_,H))+Math.imul(x,K)|0,s=Math.imul(x,H),i=i+Math.imul(M,F)|0,n=(n=n+Math.imul(M,Z)|0)+Math.imul(A,F)|0,s=s+Math.imul(A,Z)|0,i=i+Math.imul(v,G)|0,n=(n=n+Math.imul(v,J)|0)+Math.imul(S,G)|0,s=s+Math.imul(S,J)|0,i=i+Math.imul(g,X)|0,n=(n=n+Math.imul(g,W)|0)+Math.imul(w,X)|0,s=s+Math.imul(w,W)|0,i=i+Math.imul(b,Q)|0,n=(n=n+Math.imul(b,tt)|0)+Math.imul(p,Q)|0,s=s+Math.imul(p,tt)|0;var St=(c+(i=i+Math.imul(u,rt)|0)|0)+((8191&(n=(n=n+Math.imul(u,it)|0)+Math.imul(d,rt)|0))<<13)|0;c=((s=s+Math.imul(d,it)|0)+(n>>>13)|0)+(St>>>26)|0,St&=67108863,i=Math.imul(k,K),n=(n=Math.imul(k,H))+Math.imul(z,K)|0,s=Math.imul(z,H),i=i+Math.imul(_,F)|0,n=(n=n+Math.imul(_,Z)|0)+Math.imul(x,F)|0,s=s+Math.imul(x,Z)|0,i=i+Math.imul(M,G)|0,n=(n=n+Math.imul(M,J)|0)+Math.imul(A,G)|0,s=s+Math.imul(A,J)|0,i=i+Math.imul(v,X)|0,n=(n=n+Math.imul(v,W)|0)+Math.imul(S,X)|0,s=s+Math.imul(S,W)|0,i=i+Math.imul(g,Q)|0,n=(n=n+Math.imul(g,tt)|0)+Math.imul(w,Q)|0,s=s+Math.imul(w,tt)|0,i=i+Math.imul(b,rt)|0,n=(n=n+Math.imul(b,it)|0)+Math.imul(p,rt)|0,s=s+Math.imul(p,it)|0;var Et=(c+(i=i+Math.imul(u,st)|0)|0)+((8191&(n=(n=n+Math.imul(u,ot)|0)+Math.imul(d,st)|0))<<13)|0;c=((s=s+Math.imul(d,ot)|0)+(n>>>13)|0)+(Et>>>26)|0,Et&=67108863,i=Math.imul(N,K),n=(n=Math.imul(N,H))+Math.imul(P,K)|0,s=Math.imul(P,H),i=i+Math.imul(k,F)|0,n=(n=n+Math.imul(k,Z)|0)+Math.imul(z,F)|0,s=s+Math.imul(z,Z)|0,i=i+Math.imul(_,G)|0,n=(n=n+Math.imul(_,J)|0)+Math.imul(x,G)|0,s=s+Math.imul(x,J)|0,i=i+Math.imul(M,X)|0,n=(n=n+Math.imul(M,W)|0)+Math.imul(A,X)|0,s=s+Math.imul(A,W)|0,i=i+Math.imul(v,Q)|0,n=(n=n+Math.imul(v,tt)|0)+Math.imul(S,Q)|0,s=s+Math.imul(S,tt)|0,i=i+Math.imul(g,rt)|0,n=(n=n+Math.imul(g,it)|0)+Math.imul(w,rt)|0,s=s+Math.imul(w,it)|0,i=i+Math.imul(b,st)|0,n=(n=n+Math.imul(b,ot)|0)+Math.imul(p,st)|0,s=s+Math.imul(p,ot)|0;var Mt=(c+(i=i+Math.imul(u,at)|0)|0)+((8191&(n=(n=n+Math.imul(u,ct)|0)+Math.imul(d,at)|0))<<13)|0;c=((s=s+Math.imul(d,ct)|0)+(n>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,i=Math.imul(O,K),n=(n=Math.imul(O,H))+Math.imul(U,K)|0,s=Math.imul(U,H),i=i+Math.imul(N,F)|0,n=(n=n+Math.imul(N,Z)|0)+Math.imul(P,F)|0,s=s+Math.imul(P,Z)|0,i=i+Math.imul(k,G)|0,n=(n=n+Math.imul(k,J)|0)+Math.imul(z,G)|0,s=s+Math.imul(z,J)|0,i=i+Math.imul(_,X)|0,n=(n=n+Math.imul(_,W)|0)+Math.imul(x,X)|0,s=s+Math.imul(x,W)|0,i=i+Math.imul(M,Q)|0,n=(n=n+Math.imul(M,tt)|0)+Math.imul(A,Q)|0,s=s+Math.imul(A,tt)|0,i=i+Math.imul(v,rt)|0,n=(n=n+Math.imul(v,it)|0)+Math.imul(S,rt)|0,s=s+Math.imul(S,it)|0,i=i+Math.imul(g,st)|0,n=(n=n+Math.imul(g,ot)|0)+Math.imul(w,st)|0,s=s+Math.imul(w,ot)|0,i=i+Math.imul(b,at)|0,n=(n=n+Math.imul(b,ct)|0)+Math.imul(p,at)|0,s=s+Math.imul(p,ct)|0;var At=(c+(i=i+Math.imul(u,ut)|0)|0)+((8191&(n=(n=n+Math.imul(u,dt)|0)+Math.imul(d,ut)|0))<<13)|0;c=((s=s+Math.imul(d,dt)|0)+(n>>>13)|0)+(At>>>26)|0,At&=67108863,i=Math.imul(T,K),n=(n=Math.imul(T,H))+Math.imul(D,K)|0,s=Math.imul(D,H),i=i+Math.imul(O,F)|0,n=(n=n+Math.imul(O,Z)|0)+Math.imul(U,F)|0,s=s+Math.imul(U,Z)|0,i=i+Math.imul(N,G)|0,n=(n=n+Math.imul(N,J)|0)+Math.imul(P,G)|0,s=s+Math.imul(P,J)|0,i=i+Math.imul(k,X)|0,n=(n=n+Math.imul(k,W)|0)+Math.imul(z,X)|0,s=s+Math.imul(z,W)|0,i=i+Math.imul(_,Q)|0,n=(n=n+Math.imul(_,tt)|0)+Math.imul(x,Q)|0,s=s+Math.imul(x,tt)|0,i=i+Math.imul(M,rt)|0,n=(n=n+Math.imul(M,it)|0)+Math.imul(A,rt)|0,s=s+Math.imul(A,it)|0,i=i+Math.imul(v,st)|0,n=(n=n+Math.imul(v,ot)|0)+Math.imul(S,st)|0,s=s+Math.imul(S,ot)|0,i=i+Math.imul(g,at)|0,n=(n=n+Math.imul(g,ct)|0)+Math.imul(w,at)|0,s=s+Math.imul(w,ct)|0,i=i+Math.imul(b,ut)|0,n=(n=n+Math.imul(b,dt)|0)+Math.imul(p,ut)|0,s=s+Math.imul(p,dt)|0;var It=(c+(i=i+Math.imul(u,bt)|0)|0)+((8191&(n=(n=n+Math.imul(u,pt)|0)+Math.imul(d,bt)|0))<<13)|0;c=((s=s+Math.imul(d,pt)|0)+(n>>>13)|0)+(It>>>26)|0,It&=67108863,i=Math.imul(T,F),n=(n=Math.imul(T,Z))+Math.imul(D,F)|0,s=Math.imul(D,Z),i=i+Math.imul(O,G)|0,n=(n=n+Math.imul(O,J)|0)+Math.imul(U,G)|0,s=s+Math.imul(U,J)|0,i=i+Math.imul(N,X)|0,n=(n=n+Math.imul(N,W)|0)+Math.imul(P,X)|0,s=s+Math.imul(P,W)|0,i=i+Math.imul(k,Q)|0,n=(n=n+Math.imul(k,tt)|0)+Math.imul(z,Q)|0,s=s+Math.imul(z,tt)|0,i=i+Math.imul(_,rt)|0,n=(n=n+Math.imul(_,it)|0)+Math.imul(x,rt)|0,s=s+Math.imul(x,it)|0,i=i+Math.imul(M,st)|0,n=(n=n+Math.imul(M,ot)|0)+Math.imul(A,st)|0,s=s+Math.imul(A,ot)|0,i=i+Math.imul(v,at)|0,n=(n=n+Math.imul(v,ct)|0)+Math.imul(S,at)|0,s=s+Math.imul(S,ct)|0,i=i+Math.imul(g,ut)|0,n=(n=n+Math.imul(g,dt)|0)+Math.imul(w,ut)|0,s=s+Math.imul(w,dt)|0;var _t=(c+(i=i+Math.imul(b,bt)|0)|0)+((8191&(n=(n=n+Math.imul(b,pt)|0)+Math.imul(p,bt)|0))<<13)|0;c=((s=s+Math.imul(p,pt)|0)+(n>>>13)|0)+(_t>>>26)|0,_t&=67108863,i=Math.imul(T,G),n=(n=Math.imul(T,J))+Math.imul(D,G)|0,s=Math.imul(D,J),i=i+Math.imul(O,X)|0,n=(n=n+Math.imul(O,W)|0)+Math.imul(U,X)|0,s=s+Math.imul(U,W)|0,i=i+Math.imul(N,Q)|0,n=(n=n+Math.imul(N,tt)|0)+Math.imul(P,Q)|0,s=s+Math.imul(P,tt)|0,i=i+Math.imul(k,rt)|0,n=(n=n+Math.imul(k,it)|0)+Math.imul(z,rt)|0,s=s+Math.imul(z,it)|0,i=i+Math.imul(_,st)|0,n=(n=n+Math.imul(_,ot)|0)+Math.imul(x,st)|0,s=s+Math.imul(x,ot)|0,i=i+Math.imul(M,at)|0,n=(n=n+Math.imul(M,ct)|0)+Math.imul(A,at)|0,s=s+Math.imul(A,ct)|0,i=i+Math.imul(v,ut)|0,n=(n=n+Math.imul(v,dt)|0)+Math.imul(S,ut)|0,s=s+Math.imul(S,dt)|0;var xt=(c+(i=i+Math.imul(g,bt)|0)|0)+((8191&(n=(n=n+Math.imul(g,pt)|0)+Math.imul(w,bt)|0))<<13)|0;c=((s=s+Math.imul(w,pt)|0)+(n>>>13)|0)+(xt>>>26)|0,xt&=67108863,i=Math.imul(T,X),n=(n=Math.imul(T,W))+Math.imul(D,X)|0,s=Math.imul(D,W),i=i+Math.imul(O,Q)|0,n=(n=n+Math.imul(O,tt)|0)+Math.imul(U,Q)|0,s=s+Math.imul(U,tt)|0,i=i+Math.imul(N,rt)|0,n=(n=n+Math.imul(N,it)|0)+Math.imul(P,rt)|0,s=s+Math.imul(P,it)|0,i=i+Math.imul(k,st)|0,n=(n=n+Math.imul(k,ot)|0)+Math.imul(z,st)|0,s=s+Math.imul(z,ot)|0,i=i+Math.imul(_,at)|0,n=(n=n+Math.imul(_,ct)|0)+Math.imul(x,at)|0,s=s+Math.imul(x,ct)|0,i=i+Math.imul(M,ut)|0,n=(n=n+Math.imul(M,dt)|0)+Math.imul(A,ut)|0,s=s+Math.imul(A,dt)|0;var Bt=(c+(i=i+Math.imul(v,bt)|0)|0)+((8191&(n=(n=n+Math.imul(v,pt)|0)+Math.imul(S,bt)|0))<<13)|0;c=((s=s+Math.imul(S,pt)|0)+(n>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,i=Math.imul(T,Q),n=(n=Math.imul(T,tt))+Math.imul(D,Q)|0,s=Math.imul(D,tt),i=i+Math.imul(O,rt)|0,n=(n=n+Math.imul(O,it)|0)+Math.imul(U,rt)|0,s=s+Math.imul(U,it)|0,i=i+Math.imul(N,st)|0,n=(n=n+Math.imul(N,ot)|0)+Math.imul(P,st)|0,s=s+Math.imul(P,ot)|0,i=i+Math.imul(k,at)|0,n=(n=n+Math.imul(k,ct)|0)+Math.imul(z,at)|0,s=s+Math.imul(z,ct)|0,i=i+Math.imul(_,ut)|0,n=(n=n+Math.imul(_,dt)|0)+Math.imul(x,ut)|0,s=s+Math.imul(x,dt)|0;var kt=(c+(i=i+Math.imul(M,bt)|0)|0)+((8191&(n=(n=n+Math.imul(M,pt)|0)+Math.imul(A,bt)|0))<<13)|0;c=((s=s+Math.imul(A,pt)|0)+(n>>>13)|0)+(kt>>>26)|0,kt&=67108863,i=Math.imul(T,rt),n=(n=Math.imul(T,it))+Math.imul(D,rt)|0,s=Math.imul(D,it),i=i+Math.imul(O,st)|0,n=(n=n+Math.imul(O,ot)|0)+Math.imul(U,st)|0,s=s+Math.imul(U,ot)|0,i=i+Math.imul(N,at)|0,n=(n=n+Math.imul(N,ct)|0)+Math.imul(P,at)|0,s=s+Math.imul(P,ct)|0,i=i+Math.imul(k,ut)|0,n=(n=n+Math.imul(k,dt)|0)+Math.imul(z,ut)|0,s=s+Math.imul(z,dt)|0;var zt=(c+(i=i+Math.imul(_,bt)|0)|0)+((8191&(n=(n=n+Math.imul(_,pt)|0)+Math.imul(x,bt)|0))<<13)|0;c=((s=s+Math.imul(x,pt)|0)+(n>>>13)|0)+(zt>>>26)|0,zt&=67108863,i=Math.imul(T,st),n=(n=Math.imul(T,ot))+Math.imul(D,st)|0,s=Math.imul(D,ot),i=i+Math.imul(O,at)|0,n=(n=n+Math.imul(O,ct)|0)+Math.imul(U,at)|0,s=s+Math.imul(U,ct)|0,i=i+Math.imul(N,ut)|0,n=(n=n+Math.imul(N,dt)|0)+Math.imul(P,ut)|0,s=s+Math.imul(P,dt)|0;var qt=(c+(i=i+Math.imul(k,bt)|0)|0)+((8191&(n=(n=n+Math.imul(k,pt)|0)+Math.imul(z,bt)|0))<<13)|0;c=((s=s+Math.imul(z,pt)|0)+(n>>>13)|0)+(qt>>>26)|0,qt&=67108863,i=Math.imul(T,at),n=(n=Math.imul(T,ct))+Math.imul(D,at)|0,s=Math.imul(D,ct),i=i+Math.imul(O,ut)|0,n=(n=n+Math.imul(O,dt)|0)+Math.imul(U,ut)|0,s=s+Math.imul(U,dt)|0;var Nt=(c+(i=i+Math.imul(N,bt)|0)|0)+((8191&(n=(n=n+Math.imul(N,pt)|0)+Math.imul(P,bt)|0))<<13)|0;c=((s=s+Math.imul(P,pt)|0)+(n>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,i=Math.imul(T,ut),n=(n=Math.imul(T,dt))+Math.imul(D,ut)|0,s=Math.imul(D,dt);var Pt=(c+(i=i+Math.imul(O,bt)|0)|0)+((8191&(n=(n=n+Math.imul(O,pt)|0)+Math.imul(U,bt)|0))<<13)|0;c=((s=s+Math.imul(U,pt)|0)+(n>>>13)|0)+(Pt>>>26)|0,Pt&=67108863;var Rt=(c+(i=Math.imul(T,bt))|0)+((8191&(n=(n=Math.imul(T,pt))+Math.imul(D,bt)|0))<<13)|0;return c=((s=Math.imul(D,pt))+(n>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,a[0]=mt,a[1]=gt,a[2]=wt,a[3]=yt,a[4]=vt,a[5]=St,a[6]=Et,a[7]=Mt,a[8]=At,a[9]=It,a[10]=_t,a[11]=xt,a[12]=Bt,a[13]=kt,a[14]=zt,a[15]=qt,a[16]=Nt,a[17]=Pt,a[18]=Rt,0!==c&&(a[19]=c,r.length++),r};function p(t,e,r){return(new m).mulp(t,e,r)}function m(t,e){this.x=t,this.y=e}Math.imul||(b=l),s.prototype.mulTo=function(t,e){var r=this.length+t.length;return 10===this.length&&10===t.length?b(this,t,e):r<63?l(this,t,e):r<1024?function(t,e,r){r.negative=e.negative^t.negative,r.length=t.length+e.length;for(var i=0,n=0,s=0;s<r.length-1;s++){var o=n;n=0;for(var f=67108863&i,a=Math.min(s,e.length-1),c=Math.max(0,s-t.length+1);c<=a;c++){var h=s-c,u=(0|t.words[h])*(0|e.words[c]),d=67108863&u;f=67108863&(d=d+f|0),n+=(o=(o=o+(u/67108864|0)|0)+(d>>>26)|0)>>>26,o&=67108863}r.words[s]=f,i=o,o=n}return 0!==i?r.words[s]=i:r.length--,r.strip()}(this,t,e):p(this,t,e)},m.prototype.makeRBT=function(t){for(var e=new Array(t),r=s.prototype._countBits(t)-1,i=0;i<t;i++)e[i]=this.revBin(i,r,t);return e},m.prototype.revBin=function(t,e,r){if(0===t||t===r-1)return t;for(var i=0,n=0;n<e;n++)i|=(1&t)<<e-n-1,t>>=1;return i},m.prototype.permute=function(t,e,r,i,n,s){for(var o=0;o<s;o++)i[o]=e[t[o]],n[o]=r[t[o]]},m.prototype.transform=function(t,e,r,i,n,s){this.permute(s,t,e,r,i,n);for(var o=1;o<n;o<<=1)for(var f=o<<1,a=Math.cos(2*Math.PI/f),c=Math.sin(2*Math.PI/f),h=0;h<n;h+=f)for(var u=a,d=c,l=0;l<o;l++){var b=r[h+l],p=i[h+l],m=r[h+l+o],g=i[h+l+o],w=u*m-d*g;g=u*g+d*m,m=w,r[h+l]=b+m,i[h+l]=p+g,r[h+l+o]=b-m,i[h+l+o]=p-g,l!==f&&(w=a*u-c*d,d=a*d+c*u,u=w)}},m.prototype.guessLen13b=function(t,e){var r=1|Math.max(e,t),i=1&r,n=0;for(r=r/2|0;r;r>>>=1)n++;return 1<<n+1+i},m.prototype.conjugate=function(t,e,r){if(!(r<=1))for(var i=0;i<r/2;i++){var n=t[i];t[i]=t[r-i-1],t[r-i-1]=n,n=e[i],e[i]=-e[r-i-1],e[r-i-1]=-n}},m.prototype.normalize13b=function(t,e){for(var r=0,i=0;i<e/2;i++){var n=8192*Math.round(t[2*i+1]/e)+Math.round(t[2*i]/e)+r;t[i]=67108863&n,r=n<67108864?0:n/67108864|0}return t},m.prototype.convert13b=function(t,e,r,n){for(var s=0,o=0;o<e;o++)s+=0|t[o],r[2*o]=8191&s,s>>>=13,r[2*o+1]=8191&s,s>>>=13;for(o=2*e;o<n;++o)r[o]=0;i(0===s),i(0==(-8192&s))},m.prototype.stub=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=0;return e},m.prototype.mulp=function(t,e,r){var i=2*this.guessLen13b(t.length,e.length),n=this.makeRBT(i),s=this.stub(i),o=new Array(i),f=new Array(i),a=new Array(i),c=new Array(i),h=new Array(i),u=new Array(i),d=r.words;d.length=i,this.convert13b(t.words,t.length,o,i),this.convert13b(e.words,e.length,c,i),this.transform(o,s,f,a,i,n),this.transform(c,s,h,u,i,n);for(var l=0;l<i;l++){var b=f[l]*h[l]-a[l]*u[l];a[l]=f[l]*u[l]+a[l]*h[l],f[l]=b}return this.conjugate(f,a,i),this.transform(f,a,d,s,i,n),this.conjugate(d,s,i),this.normalize13b(d,i),r.negative=t.negative^e.negative,r.length=t.length+e.length,r.strip()},s.prototype.mul=function(t){var e=new s(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},s.prototype.mulf=function(t){var e=new s(null);return e.words=new Array(this.length+t.length),p(this,t,e)},s.prototype.imul=function(t){return this.clone().mulTo(t,this)},s.prototype.imuln=function(t){i("number"==typeof t),i(t<67108864);for(var e=0,r=0;r<this.length;r++){var n=(0|this.words[r])*t,s=(67108863&n)+(67108863&e);e>>=26,e+=n/67108864|0,e+=s>>>26,this.words[r]=67108863&s}return 0!==e&&(this.words[r]=e,this.length++),this},s.prototype.muln=function(t){return this.clone().imuln(t)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),r=0;r<e.length;r++){var i=r/26|0,n=r%26;e[r]=(t.words[i]&1<<n)>>>n}return e}(t);if(0===e.length)return new s(1);for(var r=this,i=0;i<e.length&&0===e[i];i++,r=r.sqr());if(++i<e.length)for(var n=r.sqr();i<e.length;i++,n=n.sqr())0!==e[i]&&(r=r.mul(n));return r},s.prototype.iushln=function(t){i("number"==typeof t&&t>=0);var e,r=t%26,n=(t-r)/26,s=67108863>>>26-r<<26-r;if(0!==r){var o=0;for(e=0;e<this.length;e++){var f=this.words[e]&s,a=(0|this.words[e])-f<<r;this.words[e]=a|o,o=f>>>26-r}o&&(this.words[e]=o,this.length++)}if(0!==n){for(e=this.length-1;e>=0;e--)this.words[e+n]=this.words[e];for(e=0;e<n;e++)this.words[e]=0;this.length+=n}return this.strip()},s.prototype.ishln=function(t){return i(0===this.negative),this.iushln(t)},s.prototype.iushrn=function(t,e,r){var n;i("number"==typeof t&&t>=0),n=e?(e-e%26)/26:0;var s=t%26,o=Math.min((t-s)/26,this.length),f=67108863^67108863>>>s<<s,a=r;if(n-=o,n=Math.max(0,n),a){for(var c=0;c<o;c++)a.words[c]=this.words[c];a.length=o}if(0===o);else if(this.length>o)for(this.length-=o,c=0;c<this.length;c++)this.words[c]=this.words[c+o];else this.words[0]=0,this.length=1;var h=0;for(c=this.length-1;c>=0&&(0!==h||c>=n);c--){var u=0|this.words[c];this.words[c]=h<<26-s|u>>>s,h=u&f}return a&&0!==h&&(a.words[a.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(t,e,r){return i(0===this.negative),this.iushrn(t,e,r)},s.prototype.shln=function(t){return this.clone().ishln(t)},s.prototype.ushln=function(t){return this.clone().iushln(t)},s.prototype.shrn=function(t){return this.clone().ishrn(t)},s.prototype.ushrn=function(t){return this.clone().iushrn(t)},s.prototype.testn=function(t){i("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26,n=1<<e;return!(this.length<=r)&&!!(this.words[r]&n)},s.prototype.imaskn=function(t){i("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26;if(i(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==e&&r++,this.length=Math.min(r,this.length),0!==e){var n=67108863^67108863>>>e<<e;this.words[this.length-1]&=n}return this.strip()},s.prototype.maskn=function(t){return this.clone().imaskn(t)},s.prototype.iaddn=function(t){return i("number"==typeof t),i(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},s.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},s.prototype.isubn=function(t){if(i("number"==typeof t),i(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this.strip()},s.prototype.addn=function(t){return this.clone().iaddn(t)},s.prototype.subn=function(t){return this.clone().isubn(t)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(t,e,r){var n,s,o=t.length+r;this._expand(o);var f=0;for(n=0;n<t.length;n++){s=(0|this.words[n+r])+f;var a=(0|t.words[n])*e;f=((s-=67108863&a)>>26)-(a/67108864|0),this.words[n+r]=67108863&s}for(;n<this.length-r;n++)f=(s=(0|this.words[n+r])+f)>>26,this.words[n+r]=67108863&s;if(0===f)return this.strip();for(i(-1===f),f=0,n=0;n<this.length;n++)f=(s=-(0|this.words[n])+f)>>26,this.words[n]=67108863&s;return this.negative=1,this.strip()},s.prototype._wordDiv=function(t,e){var r=(this.length,t.length),i=this.clone(),n=t,o=0|n.words[n.length-1];0!==(r=26-this._countBits(o))&&(n=n.ushln(r),i.iushln(r),o=0|n.words[n.length-1]);var f,a=i.length-n.length;if("mod"!==e){(f=new s(null)).length=a+1,f.words=new Array(f.length);for(var c=0;c<f.length;c++)f.words[c]=0}var h=i.clone()._ishlnsubmul(n,1,a);0===h.negative&&(i=h,f&&(f.words[a]=1));for(var u=a-1;u>=0;u--){var d=67108864*(0|i.words[n.length+u])+(0|i.words[n.length+u-1]);for(d=Math.min(d/o|0,67108863),i._ishlnsubmul(n,d,u);0!==i.negative;)d--,i.negative=0,i._ishlnsubmul(n,1,u),i.isZero()||(i.negative^=1);f&&(f.words[u]=d)}return f&&f.strip(),i.strip(),"div"!==e&&0!==r&&i.iushrn(r),{div:f||null,mod:i}},s.prototype.divmod=function(t,e,r){return i(!t.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===t.negative?(f=this.neg().divmod(t,e),"mod"!==e&&(n=f.div.neg()),"div"!==e&&(o=f.mod.neg(),r&&0!==o.negative&&o.iadd(t)),{div:n,mod:o}):0===this.negative&&0!==t.negative?(f=this.divmod(t.neg(),e),"mod"!==e&&(n=f.div.neg()),{div:n,mod:f.mod}):0!=(this.negative&t.negative)?(f=this.neg().divmod(t.neg(),e),"div"!==e&&(o=f.mod.neg(),r&&0!==o.negative&&o.isub(t)),{div:f.div,mod:o}):t.length>this.length||this.cmp(t)<0?{div:new s(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new s(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new s(this.modn(t.words[0]))}:this._wordDiv(t,e);var n,o,f},s.prototype.div=function(t){return this.divmod(t,"div",!1).div},s.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},s.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},s.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var r=0!==e.div.negative?e.mod.isub(t):e.mod,i=t.ushrn(1),n=t.andln(1),s=r.cmp(i);return s<0||1===n&&0===s?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},s.prototype.modn=function(t){i(t<=67108863);for(var e=(1<<26)%t,r=0,n=this.length-1;n>=0;n--)r=(e*r+(0|this.words[n]))%t;return r},s.prototype.idivn=function(t){i(t<=67108863);for(var e=0,r=this.length-1;r>=0;r--){var n=(0|this.words[r])+67108864*e;this.words[r]=n/t|0,e=n%t}return this.strip()},s.prototype.divn=function(t){return this.clone().idivn(t)},s.prototype.egcd=function(t){i(0===t.negative),i(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var n=new s(1),o=new s(0),f=new s(0),a=new s(1),c=0;e.isEven()&&r.isEven();)e.iushrn(1),r.iushrn(1),++c;for(var h=r.clone(),u=e.clone();!e.isZero();){for(var d=0,l=1;0==(e.words[0]&l)&&d<26;++d,l<<=1);if(d>0)for(e.iushrn(d);d-- >0;)(n.isOdd()||o.isOdd())&&(n.iadd(h),o.isub(u)),n.iushrn(1),o.iushrn(1);for(var b=0,p=1;0==(r.words[0]&p)&&b<26;++b,p<<=1);if(b>0)for(r.iushrn(b);b-- >0;)(f.isOdd()||a.isOdd())&&(f.iadd(h),a.isub(u)),f.iushrn(1),a.iushrn(1);e.cmp(r)>=0?(e.isub(r),n.isub(f),o.isub(a)):(r.isub(e),f.isub(n),a.isub(o))}return{a:f,b:a,gcd:r.iushln(c)}},s.prototype._invmp=function(t){i(0===t.negative),i(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var n,o=new s(1),f=new s(0),a=r.clone();e.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,h=1;0==(e.words[0]&h)&&c<26;++c,h<<=1);if(c>0)for(e.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(a),o.iushrn(1);for(var u=0,d=1;0==(r.words[0]&d)&&u<26;++u,d<<=1);if(u>0)for(r.iushrn(u);u-- >0;)f.isOdd()&&f.iadd(a),f.iushrn(1);e.cmp(r)>=0?(e.isub(r),o.isub(f)):(r.isub(e),f.isub(o))}return(n=0===e.cmpn(1)?o:f).cmpn(0)<0&&n.iadd(t),n},s.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),r=t.clone();e.negative=0,r.negative=0;for(var i=0;e.isEven()&&r.isEven();i++)e.iushrn(1),r.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;r.isEven();)r.iushrn(1);var n=e.cmp(r);if(n<0){var s=e;e=r,r=s}else if(0===n||0===r.cmpn(1))break;e.isub(r)}return r.iushln(i)},s.prototype.invm=function(t){return this.egcd(t).a.umod(t)},s.prototype.isEven=function(){return 0==(1&this.words[0])},s.prototype.isOdd=function(){return 1==(1&this.words[0])},s.prototype.andln=function(t){return this.words[0]&t},s.prototype.bincn=function(t){i("number"==typeof t);var e=t%26,r=(t-e)/26,n=1<<e;if(this.length<=r)return this._expand(r+1),this.words[r]|=n,this;for(var s=n,o=r;0!==s&&o<this.length;o++){var f=0|this.words[o];s=(f+=s)>>>26,f&=67108863,this.words[o]=f}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(t){var e,r=t<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this.strip(),this.length>1)e=1;else{r&&(t=-t),i(t<=67108863,"Number is too big");var n=0|this.words[0];e=n===t?0:n<t?-1:1}return 0!==this.negative?0|-e:e},s.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},s.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,r=this.length-1;r>=0;r--){var i=0|this.words[r],n=0|t.words[r];if(i!==n){i<n?e=-1:i>n&&(e=1);break}}return e},s.prototype.gtn=function(t){return 1===this.cmpn(t)},s.prototype.gt=function(t){return 1===this.cmp(t)},s.prototype.gten=function(t){return this.cmpn(t)>=0},s.prototype.gte=function(t){return this.cmp(t)>=0},s.prototype.ltn=function(t){return-1===this.cmpn(t)},s.prototype.lt=function(t){return-1===this.cmp(t)},s.prototype.lten=function(t){return this.cmpn(t)<=0},s.prototype.lte=function(t){return this.cmp(t)<=0},s.prototype.eqn=function(t){return 0===this.cmpn(t)},s.prototype.eq=function(t){return 0===this.cmp(t)},s.red=function(t){return new M(t)},s.prototype.toRed=function(t){return i(!this.red,"Already a number in reduction context"),i(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(t){return this.red=t,this},s.prototype.forceRed=function(t){return i(!this.red,"Already a number in reduction context"),this._forceRed(t)},s.prototype.redAdd=function(t){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},s.prototype.redIAdd=function(t){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},s.prototype.redSub=function(t){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},s.prototype.redISub=function(t){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},s.prototype.redShl=function(t){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},s.prototype.redMul=function(t){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},s.prototype.redIMul=function(t){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(t){return i(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var g={k256:null,p224:null,p192:null,p25519:null};function w(t,e){this.name=t,this.p=new s(e,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function y(){w.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function v(){w.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function S(){w.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function E(){w.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function M(t){if("string"==typeof t){var e=s._prime(t);this.m=e.p,this.prime=e}else i(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function A(t){M.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}w.prototype._tmp=function(){var t=new s(null);return t.words=new Array(Math.ceil(this.n/13)),t},w.prototype.ireduce=function(t){var e,r=t;do{this.split(r,this.tmp),e=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(e>this.n);var i=e<this.n?-1:r.ucmp(this.p);return 0===i?(r.words[0]=0,r.length=1):i>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},w.prototype.split=function(t,e){t.iushrn(this.n,0,e)},w.prototype.imulK=function(t){return t.imul(this.k)},n(y,w),y.prototype.split=function(t,e){for(var r=Math.min(t.length,9),i=0;i<r;i++)e.words[i]=t.words[i];if(e.length=r,t.length<=9)return t.words[0]=0,void(t.length=1);var n=t.words[9];for(e.words[e.length++]=4194303&n,i=10;i<t.length;i++){var s=0|t.words[i];t.words[i-10]=(4194303&s)<<4|n>>>22,n=s}n>>>=22,t.words[i-10]=n,0===n&&t.length>10?t.length-=10:t.length-=9},y.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,r=0;r<t.length;r++){var i=0|t.words[r];e+=977*i,t.words[r]=67108863&e,e=64*i+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},n(v,w),n(S,w),n(E,w),E.prototype.imulK=function(t){for(var e=0,r=0;r<t.length;r++){var i=19*(0|t.words[r])+e,n=67108863&i;i>>>=26,t.words[r]=n,e=i}return 0!==e&&(t.words[t.length++]=e),t},s._prime=function(t){if(g[t])return g[t];var e;if("k256"===t)e=new y;else if("p224"===t)e=new v;else if("p192"===t)e=new S;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new E}return g[t]=e,e},M.prototype._verify1=function(t){i(0===t.negative,"red works only with positives"),i(t.red,"red works only with red numbers")},M.prototype._verify2=function(t,e){i(0==(t.negative|e.negative),"red works only with positives"),i(t.red&&t.red===e.red,"red works only with red numbers")},M.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},M.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},M.prototype.add=function(t,e){this._verify2(t,e);var r=t.add(e);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},M.prototype.iadd=function(t,e){this._verify2(t,e);var r=t.iadd(e);return r.cmp(this.m)>=0&&r.isub(this.m),r},M.prototype.sub=function(t,e){this._verify2(t,e);var r=t.sub(e);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},M.prototype.isub=function(t,e){this._verify2(t,e);var r=t.isub(e);return r.cmpn(0)<0&&r.iadd(this.m),r},M.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},M.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},M.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},M.prototype.isqr=function(t){return this.imul(t,t.clone())},M.prototype.sqr=function(t){return this.mul(t,t)},M.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(i(e%2==1),3===e){var r=this.m.add(new s(1)).iushrn(2);return this.pow(t,r)}for(var n=this.m.subn(1),o=0;!n.isZero()&&0===n.andln(1);)o++,n.iushrn(1);i(!n.isZero());var f=new s(1).toRed(this),a=f.redNeg(),c=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new s(2*h*h).toRed(this);0!==this.pow(h,c).cmp(a);)h.redIAdd(a);for(var u=this.pow(h,n),d=this.pow(t,n.addn(1).iushrn(1)),l=this.pow(t,n),b=o;0!==l.cmp(f);){for(var p=l,m=0;0!==p.cmp(f);m++)p=p.redSqr();i(m<b);var g=this.pow(u,new s(1).iushln(b-m-1));d=d.redMul(g),u=g.redSqr(),l=l.redMul(u),b=m}return d},M.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},M.prototype.pow=function(t,e){if(e.isZero())return new s(1).toRed(this);if(0===e.cmpn(1))return t.clone();var r=new Array(16);r[0]=new s(1).toRed(this),r[1]=t;for(var i=2;i<r.length;i++)r[i]=this.mul(r[i-1],t);var n=r[0],o=0,f=0,a=e.bitLength()%26;for(0===a&&(a=26),i=e.length-1;i>=0;i--){for(var c=e.words[i],h=a-1;h>=0;h--){var u=c>>h&1;n!==r[0]&&(n=this.sqr(n)),0!==u||0!==o?(o<<=1,o|=u,(4===++f||0===i&&0===h)&&(n=this.mul(n,r[o]),f=0,o=0)):f=0}a=26}return n},M.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},M.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},s.mont=function(t){return new A(t)},n(A,M),A.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},A.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},A.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var r=t.imul(e),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(i).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},A.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new s(0)._forceRed(this);var r=t.mul(e),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(i).iushrn(this.shift),o=n;return n.cmp(this.m)>=0?o=n.isub(this.m):n.cmpn(0)<0&&(o=n.iadd(this.m)),o._forceRed(this)},A.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(t,this)}).call(this,r(56)(t))},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";(function(t){
/*!
 * asn1.js - ASN1 encoding for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/asn1.js:
 *   Copyright Fedor Indutny, 2013.
 *   https://github.com/indutny/asn1.js
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009 The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One
 *   https://en.wikipedia.org/wiki/X.690#BER_encoding
 *   https://en.wikipedia.org/wiki/X.690#DER_encoding
 *   http://luca.ntop.org/Teaching/Appunti/asn1.html
 *   ftp://ftp.rsasecurity.com/pub/pkcs/ascii/layman.asc
 *   https://tools.ietf.org/html/rfc2560
 *   https://tools.ietf.org/html/rfc5280
 *   https://github.com/indutny/asn1.js/blob/master/rfc/2560/index.js
 *   https://github.com/indutny/asn1.js/blob/master/rfc/5280/index.js
 *   https://github.com/indutny/asn1.js/blob/master/lib/asn1/base/node.js
 *   https://github.com/indutny/asn1.js/blob/master/lib/asn1/encoders/der.js
 *   https://github.com/indutny/asn1.js/blob/master/lib/asn1/decoders/der.js
 *   https://github.com/openssl/openssl/blob/master/include/openssl/asn1.h
 *   https://github.com/golang/go/blob/master/src/encoding/asn1/asn1.go
 *   https://github.com/golang/go/blob/master/src/encoding/asn1/marshal.go
 */
const i=r(1),n=r(52),s=r(219),o=t.alloc(0),f=t.alloc(1,0),a=new Uint32Array(2),c={BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTSTRING:4,NULL:5,OID:6,ENUM:10,UTF8STRING:12,SEQUENCE:16,SET:17,NUMSTRING:18,PRINTSTRING:19,T61STRING:20,IA5STRING:22,UTCTIME:23,GENTIME:24,GENSTRING:27},h={UNIVERSAL:0,APPLICATION:1,CONTEXT:2,PRIVATE:3};class u extends n.Struct{constructor(){super(),this.flags=0}get mode(){return 130560&this.flags}set mode(t){this.flags&=-130561,this.flags|=t}get opt(){return 0!=(256&this.flags)}set opt(t){t?this.flags|=256:this.flags&=-257}get target(){return 255&this.flags}set target(t){this.flags&=-256,this.flags|=t}get isRaw(){return!1}explicit(t){return i(t>>>0===t),this.mode=512,this.target=t,this}implicit(t){return i(t>>>0===t),this.mode=1024,this.target=t,this}optional(t=!0){return i("boolean"==typeof t),this.opt=t,this}clean(){return!1}getBodySize(t){return 0}writeBody(t,e){return t}readBody(t,e){return this}encodeBody(t){const e=this.getBodySize(),r=n.write(e);return this.writeBody(r,t),r.render()}decodeBody(t,e){const r=n.read(t);return this.readBody(r,e)}set(){return this}from(t,...e){return null==t?this:this.set(t,...e)}error(t){if(this.opt)return this;const e=new Error(t);throw Error.captureStackTrace&&Error.captureStackTrace(e,this.error),e}getSize(t){if(this.opt&&this.clean())return 0;const e=this.getBodySize(t);let r=0;return r+=P(e),r+=e,512===this.mode&&(r+=P(r)),r}write(t,e){if(this.opt&&this.clean())return t;const r=this.getBodySize();switch(this.mode){case 512:{const e=P(r)+r;R(t,this.target,h.CONTEXT,!1,e)}case 0:{const e=this.type!==c.SEQUENCE&&this.type!==c.SET;R(t,this.type,h.UNIVERSAL,e,r);break}case 1024:{const e=this.type!==c.SEQUENCE&&this.type!==c.SET;R(t,this.target,h.CONTEXT,e,r);break}default:throw new i.AssertionError("Invalid mode.")}return this.writeBody(t,e)}read(t,e){switch(this.mode){case 512:{const e=U(t,this.opt);if(!e)return this;if(e.cls!==h.CONTEXT)return this.error(`Unexpected class: ${e.cls}.`);if(e.primitive)return this.error("Unexpected primitive flag.");if(e.type!==this.target)return this.error(`Unexpected type: ${e.type}.`);t.seek(e.len),t=t.readChild(e.size)}case 0:{const r=U(t,this.opt);if(!r)return this;if(r.cls!==h.UNIVERSAL)return this.error(`Unexpected class: ${r.cls}.`);const i=this.type!==c.SEQUENCE&&this.type!==c.SET;if(r.primitive!==i)return this.error("Unexpected primitive flag.");if(r.type!==this.type)return this.error(`Unexpected type: ${r.type}.`);if(this.isRaw){const e=r.len+r.size;this.raw=t.readBytes(e),t.seek(-e)}t.seek(r.len);const n=t.readChild(r.size);return this.readBody(n,e)}case 1024:{const r=U(t,this.opt);if(!r)return this;if(r.cls!==h.CONTEXT)return this.error(`Unexpected class: ${r.cls}.`);const i=this.type!==c.SEQUENCE&&this.type!==c.SET;if(r.primitive!==i)return this.error("Unexpected primitive flag.");if(r.type!==this.target)return this.error(`Unexpected type: ${r.type}.`);t.seek(r.len);const n=t.readChild(r.size);return this.readBody(n,e)}default:throw new i.AssertionError("Invalid mode.")}}fromArray(t){return this}fromNumber(t){return this}fromPEM(t){return this}static decodeBody(t){return(new this).decodeBody(t)}static fromArray(t){return(new this).fromArray(t)}static fromNumber(t){return(new this).fromNumber(t)}static fromPEM(t){return(new this).fromPEM(t)}}class d extends u{constructor(...t){super(),this.node=new w,this.raw=null,this.from(...t)}get isRaw(){return!0}explicit(t){throw new Error("Cannot set explicit on any.")}implicit(t){throw new Error("Cannot set implicit on any.")}get type(){return this.node.type}getSize(t){return this.node.flags=this.flags,this.node.getSize(t)}write(t,e){return i(t),i(0===this.mode),this.node.flags=this.flags,this.node.write(t,e),t}read(t,e){i(t),i(0===this.mode);const r=U(t,this.opt);if(!r)return this.node.flags=this.flags,this;const n=N(r.type);return this.node=new n,this.node.flags=this.flags,this.node.read(t,e),this}getBodySize(t){return this.node.flags=this.flags,this.node.getBodySize(t)}writeBody(t,e){return this.node.flags=this.flags,this.node.writeBody(t,e),t}readBody(t,e){return this.node.flags=this.flags,this.node.readBody(t,e),this}set(t){return null==t&&(t=new w),i(t instanceof u),this.node=t,this.node.flags=this.flags,this}clean(){return this.node.type===c.NULL}format(){return{type:this.constructor.name,node:this.node}}}const l=class extends u{constructor(...t){super(),this.value="",this.from(...t)}get encoding(){return"binary"}getBodySize(){return t.byteLength(this.value,this.encoding)}writeBody(t){return t.writeString(this.value,this.encoding),t}readBody(t){const e=t.readString(t.left(),this.encoding);switch(this.type){case c.NUMSTRING:if(!function(t){i("string"==typeof t);for(let e=0;e<t.length;e++){const r=t.charCodeAt(e);if(!(r>=48&&r<=57)&&32!==r)return!1}return!0}(e))throw new Error("Invalid num string.");break;case c.PRINTSTRING:if(!function(t){i("string"==typeof t);for(let e=0;e<t.length;e++){const r=t.charCodeAt(e);if(!(r>=48&&r<=57)&&!(r>=65&&r<=90||r>=97&&r<=122)){switch(r){case 32:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 61:case 63:continue}return!1}}return!0}(e))throw new Error("Invalid print string.");break;case c.IA5STRING:if(!function(t){i("string"==typeof t);for(let e=0;e<t.length;e++){if(t.charCodeAt(e)>=128)return!1}return!0}(e))throw new Error("Invalid print string.")}return this.value=e,this}set(t){return null==t&&(t=""),i("string"==typeof t),this.value=t,this}clean(){return 0===this.value.length}format(){return`<${this.constructor.name}: ${this.value}>`}},b=class extends u{constructor(...t){super(),this.value=!1,this.from(...t)}get type(){return c.BOOLEAN}getBodySize(){return 1}writeBody(t){return t.writeU8(this.value?255:0),t}readBody(t){if(1!==t.left())throw new Error("Non-minimal boolean.");const e=t.readU8();if(0!==e&&255!==e)throw new Error("Invalid boolean.");return this.value=255===e,this}set(t){return null==t&&(t=!1),i("boolean"==typeof t),this.value=t,this}clean(){return!1===this.value}format(){return`<${this.constructor.name}: ${this.value}>`}};class p extends u{constructor(...t){super(),this.value=f,this.negative=!1,this.from(...t)}get type(){return c.INTEGER}getBodySize(){const t=this.value;if(0===t.length)return 1;let e=0,r=0;if(!this.negative&&t[0]>127)e=1;else if(this.negative)if(t[0]>128)e=1;else if(128===t[0]){e=0;for(let r=1;r<t.length;r++)e|=t[r];e=e?1:0}return r+=e,r+=t.length,r}writeBody(t){const e=this.value;if(0===e.length)return t.writeU8(0),t;let r=0,i=0;if(!this.negative&&e[0]>127)r=1,i=0;else if(this.negative)if(i=255,e[0]>128)r=1;else if(128===e[0]){r=0;for(let t=1;t<e.length;t++)r|=e[t];i=0!==r?255:0,r=1&i}r&&t.writeU8(i);const n=t.offset;return t.writeBytes(e),i&&F(t.data,n,t.offset),this}readBody(t){let e=t.readBytes(t.left());if(0===e.length)throw new Error("Zero length integer.");const r=128&e[0];if(1===e.length)return r&&(e[0]=1+(255^e[0])),this.negative=0!==r,this.value=e,this;if(0===e[0]&&0==(128&e[1]))throw new Error("Non-minimal integer.");if(255===e[0]&&128==(128&e[1]))throw new Error("Non-minimal integer.");let i=0;if(0===e[0])i=1;else if(255===e[0]){for(let t=1;t<e.length;t++)i|=e[t];i=0!==i?1:0}if(i&&r===(128&e[1]))throw new Error("Invalid integer padding.");return i&&(e=e.slice(1)),r&&F(e,0,e.length),this.negative=0!==r,this.value=j(e),this}set(e,r){return"number"==typeof e?this.fromNumber(e):(null==e&&(e=f),i(t.isBuffer(e)),this.value=j(e),this.negative=!1,null!=r&&(i("boolean"==typeof r),this.negative=r),this)}clean(){return!this.negative&&this.value.equals(f)}formatValue(){return this.value.toString("hex")}toNumber(){let t=n.readUBE(this.value,0,this.value.length);return this.negative&&(t=-t),t}fromNumber(e){i(Number.isSafeInteger(e));const r=t.alloc(8);let s=!1;return e<0&&(s=!0,e=-e),n.writeU64BE(r,e,0),this.value=j(r),this.negative=s,this}format(){const t=this.constructor.name;if(this.value.length<=6)return`<${t}: ${this.toNumber()}>`;return`<${t}: ${this.negative?"-":""}0x${this.value.toString("hex")}>`}}class m extends u{constructor(...t){super(),this.bits=0,this.value=o,this.from(...t)}get type(){return c.BITSTRING}getBodySize(){return 1+this.value.length}writeBody(t){const e=8-(7&this.bits)&7;return t.writeU8(e),t.writeBytes(this.value),t}readBody(t){const e=t.readBytes(t.left());if(0===e.length)throw new Error("Zero length bit string.");const r=e[0];if(r>7||1===e.length&&r>0||0!=(e[e.length-1]&(1<<r)-1))throw new Error("Invalid padding bits.");return this.bits=8*(e.length-1)-r,this.value=e.slice(1),this}rightAlign(){const e=this.value,r=8-(7&this.bits);if(8===r||0===e.length)return e;const i=t.alloc(e.length);i[0]=e[0]>>>r;for(let t=1;t<e.length;t++)i[t]=e[t-1]<<8-r,i[t]|=e[t]>>>r;return i}getBit(t){if(i(t>>>0===t),t<0||t>this.bits)return 0;const e=t>>>3,r=7-(7&t);return this.value[e]>>>r&1}setBit(t,e){if(i(t>>>0===t),t<0||t>this.bits)return this;const r=t>>>3,n=7-(7&t);return e?this.value[r]|=1<<n:this.value[r]&=~(1<<n),this}set(e){return null==e&&(e=o),"number"==typeof e?(i(e>>>0===e),this.bits=e,this.value=t.alloc(e+7>>>3)):(i(t.isBuffer(e)),this.bits=8*e.length,this.value=e),this}clean(){return 0===this.bits&&0===this.value.length}format(){let t=this.rightAlign();return t.length>32&&(t=t.slice(0,32)),`<${this.constructor.name}: ${this.bits}:${t.toString("hex")}>`}}class g extends u{constructor(...t){super(),this.value=o,this.from(...t)}get type(){return c.OCTSTRING}getBodySize(){return this.value.length}writeBody(t){return t.writeBytes(this.value),t}readBody(t){return this.value=t.readBytes(t.left()),this}set(e){return null==e&&(e=o),i(t.isBuffer(e)),this.value=e,this}clean(){return 0===this.value.length}format(){let t=this.value;return t.length>32&&(t=t.slice(0,32)),`<${this.constructor.name}: ${t.toString("hex")}>`}}class w extends u{constructor(...t){super(),this.from(...t)}get type(){return c.NULL}getBodySize(){return 0}writeBody(t){return t}readBody(t){if(0!==t.left())throw new Error("Non-minimal NULL.");return this}clean(){return!0}format(){return`<${this.constructor.name}>`}}class y extends u{constructor(...t){super(),this.value=a,this.from(...t)}get type(){return c.OID}getBodySize(){const t=this.value;if(t.length<2||t[0]>2||t[0]<2&&t[1]>=40)throw new Error("Invalid OID.");let e=C(40*t[0]+t[1]);for(let r=2;r<t.length;r++)e+=C(t[r]);return e}writeBody(t){const e=this.value,r=t.data;if(e.length<2||e[0]>2||e[0]<2&&e[1]>=40)throw new Error("Invalid OID.");let i=t.offset;i=T(r,40*e[0]+e[1],i);for(let t=2;t<e.length;t++)i=T(r,e[t],i);return t.offset=i,t}readBody(t){const e=t.readBytes(t.left(),!0);if(0===e.length)throw new Error("Zero length OID.");const r=new Uint32Array(e.length+1);let[i,n]=D(e,0);i<80?(r[0]=i/40>>>0,r[1]=i%40):(r[0]=2,r[1]=i-80);let s=2;for(;n<e.length;s++)[i,n]=D(e,n),r[s]=i;return this.value=r.subarray(0,s),this}equals(t){return i(t instanceof y),H(this.value,t.value)}set(t){return null==t&&(t=a),"string"==typeof t?this.fromString(t):Array.isArray(t)?this.fromArray(t):(i(t instanceof Uint32Array),this.value=t,this)}clean(){return H(this.value,a)}toArray(){const t=[];for(let e=0;e<this.value.length;e++)t.push(this.value[e]);return t}fromArray(t){i(Array.isArray(t));const e=new Uint32Array(t.length);for(let r=0;r<t.length;r++){const n=t[r];i(n>>>0===n),e[r]=n}return this.value=e,this}toString(){let t="";for(let e=0;e<this.value.length;e++)e>0&&(t+="."),t+=this.value[e].toString(10);return t}fromString(t){i("string"==typeof t),s.attrs.hasOwnProperty(t)?t=s.attrs[t]:s.keyAlgs.hasOwnProperty(t)?t=s.keyAlgs[t]:s.hashes.hasOwnProperty(t)?t=s.hashes[t]:s.curves.hasOwnProperty(t)&&(t=s.curves[t]);const e=t.split("."),r=new Uint32Array(e.length);for(let t=0;t<e.length;t++){const i=e[t];r[t]=K(i)}return this.value=r,this}getAttributeName(){return s.attrsByVal[this.toString()]||null}getSignatureAlgorithmName(){return s.sigAlgsByVal[this.toString()]||null}getSignatureHash(){return s.sigToHash[this.toString()]||null}getSignatureHashName(){const t=this.getSignatureHash();return t&&s.hashesByVal[t]||null}getKeyAlgorithmName(){return s.keyAlgsByVal[this.toString()]||null}getHashName(){return s.hashesByVal[this.toString()]||null}getCurveName(){return s.curvesByVal[this.toString()]||null}format(){const t=this.toString(),e=`${t} (${s.attrsByVal[t]||s.sigAlgsByVal[t]||s.keyAlgsByVal[t]||s.hashesByVal[t]||s.curvesByVal[t]||"UNKNOWN"})`;return`<${this.constructor.name}: ${e}>`}}class v extends p{constructor(...t){super(...t)}get type(){return c.ENUM}}class S extends l{constructor(...t){super(...t)}get type(){return c.UTF8STRING}get encoding(){return"utf8"}}class E extends u{constructor(...t){super(),this.value=o,this.from(...t)}get type(){return c.SEQUENCE}getBodySize(){return this.value.length}writeBody(t){return t.writeBytes(this.value),t}readBody(t){return this.value=t.readBytes(t.left()),this}set(e){return null==e&&(e=o),Array.isArray(e)?this.fromArray(e):(i(t.isBuffer(e)),this.value=e,this)}clean(){return 0===this.value.length}*children(){const t=n.read(this.value);for(;t.left();)yield d.read(t).node}toArray(){const t=[];for(const e of this.children())t.push(e);return t}fromArray(t){i(Array.isArray(t));let e=0;for(const r of t)i(r instanceof u),e+=r.getSize();const r=n.write(e);for(const e of t)e.write(r);return this.value=r.render(),this}format(){return this.toArray()}}class M extends E{constructor(...t){super(...t)}get type(){return c.SET}}class A extends l{constructor(...t){super(...t)}get type(){return c.NUMSTRING}}class I extends l{constructor(...t){super(...t)}get type(){return c.PRINTSTRING}}class _ extends l{constructor(...t){super(...t)}get type(){return c.T61STRING}}class x extends l{constructor(...t){super(...t)}get type(){return c.IA5STRING}}class B extends u{constructor(...t){super(),this.value=0,this.offset=0,this.from(...t)}set(t,e){return null==t&&(t=0),null==e&&(e=0),"string"==typeof t?this.fromString(t):(i(Z(t)),i(G(e)),this.value=t,this.offset=e,this)}clean(){return 0===this.value&&0===this.offset}unix(){return this.value-this.offset}toString(){return new Date(1e3*this.value).toISOString().slice(0,-5)+J(this.offset)}fromString(t){i("string"==typeof t);const e=Date.parse(t);if(e!=e)throw new Error("Invalid date string.");const r=Math.floor(e/1e3);if(!Z(r))throw new Error("Invalid time.");return this.value=r,this.offset=0,this}format(){const t=this.constructor.name,e=this.value;let r=this.offset.toString(10);return this.offset>=0&&(r="+"+r),`<${t}: ${e}${r} (${this.toString()})>`}}class k extends B{constructor(...t){super(...t)}get type(){return c.UTCTIME}getBodySize(){return 0===this.offset?13:17}writeBody(t){i(Z(this.value));const e=new Date(1e3*this.value);let r="";return r+=L(e.getUTCFullYear()%100),r+=L(e.getUTCMonth()+1),r+=L(e.getUTCDate()),r+=L(e.getUTCHours()),r+=L(e.getUTCMinutes()),r+=L(e.getUTCSeconds()),r+=J(this.offset),t.writeString(r,"binary"),t}readBody(t){const e=t.left();if(13!==e&&17!==e)throw new Error("Invalid UTCTIME.");const r=t.readString(e,"binary"),i=K(r.substring(0,2)),n=K(r.substring(2,4)),s=K(r.substring(4,6)),o=K(r.substring(6,8)),f=K(r.substring(8,10)),a=K(r.substring(10,12));return this.value=V(i,n,s,o,f,a,!0),this.offset=Y(r.substring(12)),this}}class z extends B{constructor(...t){super(...t)}get type(){return c.GENTIME}getBodySize(){return 0===this.offset?15:19}writeBody(t){i(Z(this.value));const e=new Date(1e3*this.value);let r="";return r+=e.getUTCFullYear().toString(10),r+=L(e.getUTCMonth()+1),r+=L(e.getUTCDate()),r+=L(e.getUTCHours()),r+=L(e.getUTCMinutes()),r+=L(e.getUTCSeconds()),r+=J(this.offset),t.writeString(r,"binary"),t}readBody(t){const e=t.left();if(15!==e&&19!==e)throw new Error("Invalid GENTIME.");const r=t.readString(e,"binary"),i=K(r.substring(0,4)),n=K(r.substring(4,6)),s=K(r.substring(6,8)),o=K(r.substring(8,10)),f=K(r.substring(10,12)),a=K(r.substring(12,14));return this.value=V(i,n,s,o,f,a,!1),this.offset=Y(r.substring(14)),this}}class q extends l{constructor(...t){super(...t)}get type(){return c.GENSTRING}}function N(t){switch(i(t>>>0===t),t){case c.BOOLEAN:return b;case c.INTEGER:return p;case c.BITSTRING:return m;case c.OCTSTRING:return g;case c.NULL:return w;case c.OID:return y;case c.ENUM:return v;case c.UTF8STRING:return S;case c.SEQUENCE:return E;case c.SET:return M;case c.NUMSTRING:return A;case c.PRINTSTRING:return I;case c.T61STRING:return _;case c.IA5STRING:return x;case c.UTCTIME:return k;case c.GENTIME:return z;case c.GENSTRING:return q;default:throw new Error(`Unknown type: ${t}.`)}}function P(t){return i(t>>>0===t),t<=127?2:t<=255?3:t<=65535?4:(i(t<=16777215),5)}function R(t,e,r,n,s){return i(t),i(e>>>0===e),i(r>>>0===r),i("boolean"==typeof n),i(s>>>0===s),n||(e|=32),e|=r<<6,s<=127?(t.writeU8(e),t.writeU8(s),t):s<=255?(t.writeU8(e),t.writeU8(129),t.writeU8(s),t):s<=65535?(t.writeU8(e),t.writeU8(130),t.writeU16BE(s),t):(i(s<=16777215),t.writeU8(e),t.writeU8(131),t.writeU24BE(s),t)}function O(t){const e=t.offset,r=t.readU8(),i=r>>>6,n=0==(32&r);let s=31&r;if(31===s&&([s,t.offset]=D(t.data,t.offset),s<31))throw new Error("Non-minimal type.");switch(i){case h.UNIVERSAL:case h.CONTEXT:break;default:throw new Error("Unknown class.")}const o=function(t){const e=t.readU8(),r=127&e;if(0==(128&e))return r;if(0===r)throw new Error("Indefinite length.");let i=0;for(let e=0;e<r;e++){const e=t.readU8();if(i>=1<<24)throw new Error("Length too large.");if(i*=256,i+=e,0===i)throw new Error("Unexpected leading zeroes.")}if(i<128)throw new Error("Non-minimal length.");return i}(t);return{type:s,cls:i,primitive:n,size:o,len:t.offset-e}}function U(t,e){const r=t.offset;let i=null,n=null;try{i=O(t)}catch(t){n=t}if(t.offset=r,!e&&!i)throw n;return i}function C(t){if(i(t>>>0===t),0===t)return 1;let e=0;for(;t>0;)e+=1,t>>>=7;return e}function T(e,r,s){i(t.isBuffer(e)),i(r>>>0===r),i(s>>>0===s);for(let t=C(r)-1;t>=0;t--){let i=r>>>7*t;if(i&=127,0!==t&&(i|=128),s>=e.length)throw new n.EncodingError(s,"Out of bounds write");e[s]=i,s+=1}return s}function D(e,r){i(t.isBuffer(e)),i(r>>>0===r);let n=0,s=0;for(;r<e.length;n++){if(5===n)throw new Error("Base128 integer too large.");const t=e[r];if(s*=128,s+=127&t,r+=1,0==(128&t)){if(s>4294967295)throw new Error("Base128 integer too large.");return[s,r]}}throw new Error("Base128 integer too short.")}function L(t){return t<10?"0"+t.toString(10):t.toString(10)}function K(t){i("string"==typeof t);let e=0;if(0===t.length||t.length>10)throw new Error("Invalid integer.");for(let r=0;r<t.length;r++){const i=t.charCodeAt(r)-48;if(i<0||i>9)throw new Error("Invalid integer.");if(e*=10,e+=i,e>4294967295)throw new Error("Invalid integer.")}return e}function H(t,e){if(i(t instanceof Uint32Array),i(e instanceof Uint32Array),t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function j(e){if(i(t.isBuffer(e)),0===e.length)return t.from([0]);if(0!==e[0])return e;for(let t=1;t<e.length;t++)if(0!==e[t])return e.slice(t);return e.slice(-1)}function F(e,r,n){i(t.isBuffer(e)),i(r>>>0===r),i(n>>>0===n),i(r<=n);let s=1;for(let t=n-1;t>=r;t--)s+=255^e[t],e[t]=255&s,s>>>=8;return e}function Z(t){return!!Number.isSafeInteger(t)&&!(t<-62167219200||t>253402300799)}function V(t,e,r,n,s,o,f){if(i(t>>>0===t),i(e>>>0===e),i(r>>>0===r),i(n>>>0===n),i(s>>>0===s),i(o>>>0===o),i("boolean"==typeof f),f&&(t=t<70?2e3+t:1900+t),t>275760)throw new Error("Invalid year.");if(e<1||e>12||r<1||r>32)throw new Error("Invalid month or day.");if(n>23||s>59||o>59)throw new Error("Invalid hours, minutes, or seconds.");const a=Date.UTC(t,e-1,r,n,s,o,0);i(a==a);const c=a/1e3;return i(Z(c)),c}function G(t){return!!Number.isSafeInteger(t)&&!(t<-43200||t>50400)}function J(t){if(i(G(t)),0===t)return"Z";let e="";t<0?(e+="-",t=-t):e+="+";const r=t/60>>>0,n=r%60;return e+=L(r/60>>>0),e+=L(n),e}function Y(t){if(i("string"==typeof t),0===t.length)throw new Error("Invalid time offset.");const e=t[0];switch(e){case"Z":if(1!==t.length)throw new Error("Non-minimal time offset.");return 0;case"+":case"-":{if(5!==t.length)throw new Error("Non-minimal time offset.");let r=60*(60*K(t.substring(1,3))+K(t.substring(3,5)));if("-"===e&&(r=-r),!G(r))throw new Error("Not a time zone.");return r}}throw new Error("Invalid time offset.")}e.EMPTY=o,e.ZERO=f,e.EMPTY_OID=a,e.types=c,e.typesByVal={1:"BOOLEAN",2:"INTEGER",3:"BITSTRING",4:"OCTSTRING",5:"NULL",6:"OID",10:"ENUM",12:"UTF8STRING",16:"SEQUENCE",17:"SET",18:"NUMSTRING",19:"PRINTSTRING",20:"T61STRING",22:"IA5STRING",23:"UTCTIME",24:"GENTIME",27:"GENSTRING"},e.classes=h,e.classesByVal={0:"UNIVERSAL",1:"APPLICATION",2:"CONTEXT",3:"PRIVATE"},e.objects=s,e.TARGET=255,e.OPTIONAL=256,e.MODE=130560,e.NORMAL=0,e.EXPLICIT=512,e.IMPLICIT=1024,e.Node=u,e.Sequence=class extends u{constructor(...t){super(),this.raw=null,this.from(...t)}get type(){return c.SEQUENCE}},e.Set=class extends u{constructor(...t){super(),this.raw=null,this.from(...t)}get type(){return c.SET}},e.Any=d,e.Choice=class extends u{constructor(t,...e){super(),i(t instanceof u),this.node=t,this.from(...e)}get type(){return this.node.type}choices(){throw new Error("Unimplemented.")}getSize(t){return this.node.getSize(t)}write(t,e){return i(t),this.node.flags=this.flags,this.node.write(t,e),t}read(t,e){i(t);const r=this.choices();i(Array.isArray(r)),i(r.length>=1);const n=U(t,this.opt);if(!n)return this;if(-1===r.indexOf(n.type))throw new Error(`Could not satisfy choice for: ${n.type}.`);const s=new(N(n.type));return s.flags=this.flags,this.node=s.read(t,e),this}getBodySize(t){return this.node.getBodySize(t)}writeBody(t,e){return this.node.writeBody(t,e),t}readBody(t,e){return this.node.readBody(t,e),this}set(...t){return this.node.set(...t)}clean(){return this.node.clean()}format(){return{type:this.constructor.name,node:this.node}}},e.Str=l,e.String=l,e.Bool=b,e.Boolean=b,e.Integer=p,e.Unsigned=class extends p{constructor(...t){super(...t)}getBodySize(){return i(!this.negative),super.getBodySize()}writeBody(t){return i(!this.negative),super.writeBody(t)}readBody(t){return super.readBody(t),i(!this.negative),this}set(t){return super.set(t)}toNumber(){return i(!this.negative),super.toNumber()}fromNumber(t){return super.fromNumber(t),i(!this.negative),this}},e.BitString=m,e.OctString=g,e.Null=w,e.OID=y,e.Enum=v,e.Utf8String=S,e.RawSequence=E,e.RawSet=M,e.NumString=A,e.PrintString=I,e.T61String=_,e.IA5String=x,e.Time=B,e.UTCTime=k,e.GenTime=z,e.GenString=q,e.typeToClass=N}).call(this,r(0).Buffer)},function(t,e,r){var i,n,s,o,f,a,c,h;t.exports=(h=r(2),r(43),r(44),n=(i=h).lib,s=n.Base,o=n.WordArray,f=i.algo,a=f.MD5,c=f.EvpKDF=s.extend({cfg:s.extend({keySize:4,hasher:a,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var r,i=this.cfg,n=i.hasher.create(),s=o.create(),f=s.words,a=i.keySize,c=i.iterations;f.length<a;){r&&n.update(r),r=n.update(t).finalize(e),n.reset();for(var h=1;h<c;h++)r=n.finalize(r),n.reset();s.concat(r)}return s.sigBytes=4*a,s}}),i.EvpKDF=function(t,e,r){return c.create(r).compute(t,e)},h.EvpKDF)},function(t,e){function r(t,e){if(!t)throw new Error(e||"Assertion failed")}t.exports=r,r.equal=function(t,e,r){if(t!=e)throw new Error(r||"Assertion failed: "+t+" != "+e)}},function(t,e,r){"use strict";
/*!
 * keccak.js - keccak for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(83)},function(t,e,r){var i,n,s;t.exports=(s=r(2),n=(i=s).lib.WordArray,i.enc.Base64={stringify:function(t){var e=t.words,r=t.sigBytes,i=this._map;t.clamp();for(var n=[],s=0;s<r;s+=3)for(var o=(e[s>>>2]>>>24-s%4*8&255)<<16|(e[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|e[s+2>>>2]>>>24-(s+2)%4*8&255,f=0;f<4&&s+.75*f<r;f++)n.push(i.charAt(o>>>6*(3-f)&63));var a=i.charAt(64);if(a)for(;n.length%4;)n.push(a);return n.join("")},parse:function(t){var e=t.length,r=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var s=0;s<r.length;s++)i[r.charCodeAt(s)]=s}var o=r.charAt(64);if(o){var f=t.indexOf(o);-1!==f&&(e=f)}return function(t,e,r){for(var i=[],s=0,o=0;o<e;o++)if(o%4){var f=r[t.charCodeAt(o-1)]<<o%4*2,a=r[t.charCodeAt(o)]>>>6-o%4*2,c=f|a;i[s>>>2]|=c<<24-s%4*8,s++}return n.create(i,s)}(t,e,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},s.enc.Base64)},function(t,e,r){var i;t.exports=(i=r(2),function(t){var e=i,r=e.lib,n=r.WordArray,s=r.Hasher,o=e.algo,f=[];!function(){for(var e=0;e<64;e++)f[e]=4294967296*t.abs(t.sin(e+1))|0}();var a=o.MD5=s.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var r=0;r<16;r++){var i=e+r,n=t[i];t[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}var s=this._hash.words,o=t[e+0],a=t[e+1],l=t[e+2],b=t[e+3],p=t[e+4],m=t[e+5],g=t[e+6],w=t[e+7],y=t[e+8],v=t[e+9],S=t[e+10],E=t[e+11],M=t[e+12],A=t[e+13],I=t[e+14],_=t[e+15],x=s[0],B=s[1],k=s[2],z=s[3];x=c(x,B,k,z,o,7,f[0]),z=c(z,x,B,k,a,12,f[1]),k=c(k,z,x,B,l,17,f[2]),B=c(B,k,z,x,b,22,f[3]),x=c(x,B,k,z,p,7,f[4]),z=c(z,x,B,k,m,12,f[5]),k=c(k,z,x,B,g,17,f[6]),B=c(B,k,z,x,w,22,f[7]),x=c(x,B,k,z,y,7,f[8]),z=c(z,x,B,k,v,12,f[9]),k=c(k,z,x,B,S,17,f[10]),B=c(B,k,z,x,E,22,f[11]),x=c(x,B,k,z,M,7,f[12]),z=c(z,x,B,k,A,12,f[13]),k=c(k,z,x,B,I,17,f[14]),x=h(x,B=c(B,k,z,x,_,22,f[15]),k,z,a,5,f[16]),z=h(z,x,B,k,g,9,f[17]),k=h(k,z,x,B,E,14,f[18]),B=h(B,k,z,x,o,20,f[19]),x=h(x,B,k,z,m,5,f[20]),z=h(z,x,B,k,S,9,f[21]),k=h(k,z,x,B,_,14,f[22]),B=h(B,k,z,x,p,20,f[23]),x=h(x,B,k,z,v,5,f[24]),z=h(z,x,B,k,I,9,f[25]),k=h(k,z,x,B,b,14,f[26]),B=h(B,k,z,x,y,20,f[27]),x=h(x,B,k,z,A,5,f[28]),z=h(z,x,B,k,l,9,f[29]),k=h(k,z,x,B,w,14,f[30]),x=u(x,B=h(B,k,z,x,M,20,f[31]),k,z,m,4,f[32]),z=u(z,x,B,k,y,11,f[33]),k=u(k,z,x,B,E,16,f[34]),B=u(B,k,z,x,I,23,f[35]),x=u(x,B,k,z,a,4,f[36]),z=u(z,x,B,k,p,11,f[37]),k=u(k,z,x,B,w,16,f[38]),B=u(B,k,z,x,S,23,f[39]),x=u(x,B,k,z,A,4,f[40]),z=u(z,x,B,k,o,11,f[41]),k=u(k,z,x,B,b,16,f[42]),B=u(B,k,z,x,g,23,f[43]),x=u(x,B,k,z,v,4,f[44]),z=u(z,x,B,k,M,11,f[45]),k=u(k,z,x,B,_,16,f[46]),x=d(x,B=u(B,k,z,x,l,23,f[47]),k,z,o,6,f[48]),z=d(z,x,B,k,w,10,f[49]),k=d(k,z,x,B,I,15,f[50]),B=d(B,k,z,x,m,21,f[51]),x=d(x,B,k,z,M,6,f[52]),z=d(z,x,B,k,b,10,f[53]),k=d(k,z,x,B,S,15,f[54]),B=d(B,k,z,x,a,21,f[55]),x=d(x,B,k,z,y,6,f[56]),z=d(z,x,B,k,_,10,f[57]),k=d(k,z,x,B,g,15,f[58]),B=d(B,k,z,x,A,21,f[59]),x=d(x,B,k,z,p,6,f[60]),z=d(z,x,B,k,E,10,f[61]),k=d(k,z,x,B,l,15,f[62]),B=d(B,k,z,x,v,21,f[63]),s[0]=s[0]+x|0,s[1]=s[1]+B|0,s[2]=s[2]+k|0,s[3]=s[3]+z|0},_doFinalize:function(){var e=this._data,r=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;r[n>>>5]|=128<<24-n%32;var s=t.floor(i/4294967296),o=i;r[15+(n+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),r[14+(n+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),e.sigBytes=4*(r.length+1),this._process();for(var f=this._hash,a=f.words,c=0;c<4;c++){var h=a[c];a[c]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8)}return f},clone:function(){var t=s.clone.call(this);return t._hash=this._hash.clone(),t}});function c(t,e,r,i,n,s,o){var f=t+(e&r|~e&i)+n+o;return(f<<s|f>>>32-s)+e}function h(t,e,r,i,n,s,o){var f=t+(e&i|r&~i)+n+o;return(f<<s|f>>>32-s)+e}function u(t,e,r,i,n,s,o){var f=t+(e^r^i)+n+o;return(f<<s|f>>>32-s)+e}function d(t,e,r,i,n,s,o){var f=t+(r^(e|~i))+n+o;return(f<<s|f>>>32-s)+e}e.MD5=s._createHelper(a),e.HmacMD5=s._createHmacHelper(a)}(Math),i.MD5)},function(t,e,r){"use strict";
/*!
 * enforce.js - type enforcement for bcoin
 * Copyright (c) 2014-2017, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */t.exports=function t(e,r,i){if(!e){const e=new TypeError(`'${r}' must be a(n) ${i}.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,t),e}}},function(t,e,r){"use strict";(function(e){
/*!
 * ecdsa.js - ECDSA for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/elliptic:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/elliptic
 *
 * References:
 *
 *   [SEC1] SEC 1: Elliptic Curve Cryptography, Version 2.0
 *     Certicom Research
 *     http://www.secg.org/sec1-v2.pdf
 *
 *   [FIPS186] Suite B Implementer's Guide to FIPS 186-3 (ECDSA)
 *     https://tinyurl.com/fips186-guide
 *
 *   [GECC] Guide to Elliptic Curve Cryptography
 *     D. Hankerson, A. Menezes, and S. Vanstone
 *     https://tinyurl.com/guide-to-ecc
 *
 *   [RFC6979] Deterministic Usage of the Digital Signature
 *             Algorithm (DSA) and Elliptic Curve Digital
 *             Signature Algorithm (ECDSA)
 *     T. Pornin
 *     https://tools.ietf.org/html/rfc6979
 */
const i=r(1),n=r(6),s=r(5),o=r(49),f=r(263),a=r(48),c=r(33);t.exports=class{constructor(t,e,r,n){i("string"==typeof t),i(e),i(r),this.id=t,this.type="ecdsa",this.hash=e,this.xof=r,this.native=0,this._pre=n||null,this._curve=null,this._schnorr=null}get curve(){return this._curve||(this._curve=c.curve(this.id,this._pre),this._curve.precompute(s),this._pre=null),this._curve}get schnorr(){return this._schnorr||(this._schnorr=new f(this.curve,this.xof)),this._schnorr}get size(){return this.curve.fieldSize}get bits(){return this.curve.fieldBits}privateKeyGenerate(){const t=this.curve.randomScalar(s);return this.curve.encodeScalar(t)}privateKeyVerify(t){let r;i(e.isBuffer(t));try{r=this.curve.decodeScalar(t)}catch(t){return!1}return!r.isZero()&&r.cmp(this.curve.n)<0}privateKeyExport(t){const r=this.publicKeyCreate(t,!1),{x:i,y:n}=this.publicKeyExport(r);return{d:e.from(t),x:i,y:n}}privateKeyImport(t){i(t&&"object"==typeof t);const e=n.decode(t.d,this.curve.endian);if(e.isZero()||e.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");return this.curve.encodeScalar(e)}privateKeyTweakAdd(t,e){const r=this.curve.decodeScalar(e);if(r.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");const i=this.curve.decodeScalar(t);if(i.isZero()||i.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const n=i.add(r).imod(this.curve.n);if(n.isZero())throw new Error("Invalid private key.");return this.curve.encodeScalar(n)}privateKeyTweakMul(t,e){const r=this.curve.decodeScalar(e);if(r.isZero()||r.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");const i=this.curve.decodeScalar(t);if(i.isZero()||i.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const n=i.mul(r).imod(this.curve.n);if(n.isZero())throw new Error("Invalid private key.");return this.curve.encodeScalar(n)}privateKeyNegate(t){const e=this.curve.decodeScalar(t);if(e.isZero()||e.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const r=e.neg().imod(this.curve.n);return this.curve.encodeScalar(r)}privateKeyInvert(t){const e=this.curve.decodeScalar(t);if(e.isZero()||e.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const r=e.invert(this.curve.n);return this.curve.encodeScalar(r)}publicKeyCreate(t,e){const r=this.curve.decodeScalar(t);if(r.isZero()||r.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");return this.curve.g.mulBlind(r).encode(e)}publicKeyConvert(t,e){return this.curve.decodePoint(t).encode(e)}publicKeyFromUniform(t,e){const r=this.curve.decodeUniform(t);return this.curve.pointFromUniform(r).encode(e)}publicKeyToUniform(t,e=s.randomInt()){const r=this.curve.decodePoint(t),i=this.curve.pointToUniform(r,e);return this.curve.encodeUniform(i,e>>>8)}publicKeyFromHash(t,e){return this.curve.pointFromHash(t).encode(e)}publicKeyToHash(t){const e=this.curve.decodePoint(t);return this.curve.pointToHash(e,0,s)}publicKeyVerify(t){i(e.isBuffer(t));try{this.curve.decodePoint(t)}catch(t){return!1}return!0}publicKeyExport(t){const{x:e,y:r}=this.curve.decodePoint(t);return{x:this.curve.encodeField(e.fromRed()),y:this.curve.encodeField(r.fromRed())}}publicKeyImport(t,e){i(t&&"object"==typeof t);const r=n.decode(t.x,this.curve.endian);if(r.cmp(this.curve.p)>=0)throw new Error("Invalid point.");if(null!=t.y){const i=n.decode(t.y,this.curve.endian);if(i.cmp(this.curve.p)>=0)throw new Error("Invalid point.");const s=this.curve.point(r,i);if(!s.validate())throw new Error("Invalid point.");return s.encode(e)}return this.curve.pointFromX(r,t.sign).encode(e)}publicKeyTweakAdd(t,e,r){const i=this.curve.decodeScalar(e);if(i.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");const n=this.curve.decodePoint(t);return this.curve.g.jmul(i).add(n).encode(r)}publicKeyTweakMul(t,e,r){const i=this.curve.decodeScalar(e);if(i.isZero()||i.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");return this.curve.decodePoint(t).mul(i).encode(r)}publicKeyCombine(t,e){i(Array.isArray(t));let r=this.curve.jpoint();for(const e of t){const t=this.curve.decodePoint(e);r=r.add(t)}return r.encode(e)}publicKeyNegate(t,e){return this.curve.decodePoint(t).neg().encode(e)}signatureNormalize(t){const[e,r]=this._decodeCompact(t);return r.cmp(this.curve.nh)>0&&r.ineg().imod(this.curve.n),this._encodeCompact(e,r)}signatureNormalizeDER(t){const[e,r]=this._decodeDER(t,!1);return r.cmp(this.curve.nh)>0&&r.ineg().imod(this.curve.n),this._encodeDER(e,r)}signatureExport(t){const[e,r]=this._decodeCompact(t);return this._encodeDER(e,r)}signatureImport(t){const[e,r]=this._decodeDER(t,!1);return this._encodeCompact(e,r)}isLowS(t){let r;i(e.isBuffer(t));try{[,r]=this._decodeCompact(t)}catch(t){return!1}return r.cmp(this.curve.nh)<=0}isLowDER(t){let r;i(e.isBuffer(t));try{[,r]=this._decodeDER(t,!1)}catch(t){return!1}return r.cmp(this.curve.nh)<=0}sign(t,e){const[r,i]=this._sign(t,e);return this._encodeCompact(r,i)}signRecoverable(t,e){const[r,i,n]=this._sign(t,e);return[this._encodeCompact(r,i),n]}signDER(t,e){const[r,i]=this._sign(t,e);return this._encodeDER(r,i)}signRecoverableDER(t,e){const[r,i,n]=this._sign(t,e);return[this._encodeDER(r,i),n]}_sign(t,e){const{n:r,nh:i}=this.curve,n=this.curve.g,o=this.curve.decodeScalar(e);if(o.isZero()||o.cmp(r)>=0)throw new Error("Invalid private key.");const f=this._reduce(t),c=this.curve.encodeScalar(f),h=new a(this.hash,e,c);for(;;){const t=h.generate(this.curve.scalarSize),e=this._truncate(t);if(e.isZero()||e.cmp(r)>=0)continue;const a=n.mulBlind(e);if(a.isInfinity())continue;const c=a.getX(),u=c.mod(r);if(u.isZero())continue;const d=this.curve.randomScalar(s),l=e.mul(d).fermat(r),b=o.mul(d).imod(r),p=f.mul(d).imod(r),m=u.mul(b).iadd(p).imod(r).mul(l).imod(r);if(m.isZero())continue;let g=a.isOdd()|!c.eq(u)<<1;return m.cmp(i)>0&&(m.ineg().imod(r),g^=1),[u,m,g]}}verify(t,r,n){let s,o;i(e.isBuffer(t)),i(e.isBuffer(r)),i(e.isBuffer(n));try{[s,o]=this._decodeCompact(r)}catch(t){return!1}try{return this._verify(t,s,o,n)}catch(t){return!1}}verifyDER(t,r,n){let s,o;i(e.isBuffer(t)),i(e.isBuffer(r)),i(e.isBuffer(n));try{[s,o]=this._decodeDER(r,!1)}catch(t){return!1}try{return this._verify(t,s,o,n)}catch(t){return!1}}_verify(t,e,r,i){const{n:n}=this.curve,s=this.curve.g,o=this._reduce(t),f=this.curve.decodePoint(i);if(e.isZero()||e.cmp(n)>=0)return!1;if(r.isZero()||r.cmp(n)>=0)return!1;const a=r.invert(n),c=o.mul(a).imod(n),h=e.mul(a).imod(n);return s.jmulAdd(c,f,h).eqR(e)}recover(t,r,n,s){let o,f,a;i(e.isBuffer(t)),i(e.isBuffer(r)),i(n>>>0===n),i((3&n)===n,"The recovery param is more than two bits.");try{[o,f]=this._decodeCompact(r)}catch(t){return null}try{a=this._recover(t,o,f,n)}catch(t){return null}return a.encode(s)}recoverDER(t,r,n,s){let o,f,a;i(e.isBuffer(t)),i(e.isBuffer(r)),i(n>>>0===n),i((3&n)===n,"The recovery param is more than two bits.");try{[o,f]=this._decodeDER(r,!1)}catch(t){return null}try{a=this._recover(t,o,f,n)}catch(t){return null}return a.encode(s)}_recover(t,e,r,i){const{n:n,pmodn:s}=this.curve,o=this.curve.g,f=this._reduce(t);if(e.isZero()||e.cmp(n)>=0)throw new Error("Invalid R value.");if(r.isZero()||r.cmp(n)>=0)throw new Error("Invalid S value.");const a=0!=(1&i);let c=e;if(i>>>1){if(this.curve.highOrder)throw new Error("Invalid high bit.");if(c.cmp(s)>=0)throw new Error("Invalid R value.");c=c.add(n)}const h=this.curve.pointFromX(c,a),u=e.invert(n),d=f.mul(u).ineg().imod(n),l=r.mul(u).imod(n),b=o.mulAdd(d,h,l);if(b.isInfinity())throw new Error("Invalid point.");return b}derive(t,e,r){const i=this.curve.decodePoint(t),n=this.curve.decodeScalar(e);if(n.isZero()||n.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");if(this.curve.h.cmpn(1)>0&&i.isSmall())throw new Error("Invalid point.");return i.mulBlind(n,s).encode(r)}schnorrSign(t,e){return this.schnorr.sign(t,e)}schnorrVerify(t,e,r){return this.schnorr.verify(t,e,r)}schnorrVerifyBatch(t){return this.schnorr.verifyBatch(t)}_encodeCompact(t,r){return e.concat([this.curve.encodeScalar(t),this.curve.encodeScalar(r)])}_decodeCompact(t){i(e.isBuffer(t));const{n:r}=this.curve,n=this.curve.scalarSize;if(t.length!==2*n)throw new Error("Invalid signature size.");const s=t.slice(0,n),o=t.slice(n,2*n),f=this.curve.decodeScalar(s),a=this.curve.decodeScalar(o);if(f.cmp(r)>=0||a.cmp(r)>=0)throw new Error("Invalid signature.");return[f,a]}_encodeDER(t,r){const n=o.sizeInt(t)+o.sizeInt(r),s=e.alloc(o.sizeSeq(n));let f=0;return f=o.writeSeq(s,f,n),f=o.writeInt(s,f,t),f=o.writeInt(s,f,r),i(f===s.length),s}_decodeDER(t,r){i(e.isBuffer(t)),i("boolean"==typeof r);const{n:n}=this.curve;let s,f,a=0;if(a=o.readSeq(t,a,r),[s,a]=o.readInt(t,a,r),[f,a]=o.readInt(t,a,r),r&&a!==t.length)throw new Error("Trailing bytes.");if(s.cmp(n)>=0||f.cmp(n)>=0)throw new Error("Invalid signature.");return[s,f]}_truncate(t){i(e.isBuffer(t));const r=this.curve.n.bitLength(),s=r+7>>>3;t.length>s&&(t=t.slice(0,s));const o=n.decode(t,this.curve.endian),f=8*t.length-r;return f>0&&o.iushrn(f),o}_reduce(t){return this._truncate(t).imod(this.curve.n)}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";var i=r(10),n=r(16);function s(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}e.BlockHash=s,s.prototype.update=function(t,e){if(t=i.toArray(t,e),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){var r=(t=this.pending).length%this._delta8;this.pending=t.slice(t.length-r,t.length),0===this.pending.length&&(this.pending=null),t=i.join32(t,0,t.length-r,this.endian);for(var n=0;n<t.length;n+=this._delta32)this._update(t,n,n+this._delta32)}return this},s.prototype.digest=function(t){return this.update(this._pad()),n(null===this.pending),this._digest(t)},s.prototype._pad=function(){var t=this.pendingTotal,e=this._delta8,r=e-(t+this.padLength)%e,i=new Array(r+this.padLength);i[0]=128;for(var n=1;n<r;n++)i[n]=0;if(t<<=3,"big"===this.endian){for(var s=8;s<this.padLength;s++)i[n++]=0;i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=t>>>24&255,i[n++]=t>>>16&255,i[n++]=t>>>8&255,i[n++]=255&t}else for(i[n++]=255&t,i[n++]=t>>>8&255,i[n++]=t>>>16&255,i[n++]=t>>>24&255,i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=0,s=8;s<this.padLength;s++)i[n++]=0;return i}},function(t,e,r){"use strict";
/*!
 * sha512.js - sha512 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(72)},function(t,e,r){"use strict";
/*!
 * blake2b.js - blake2b for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(175)},function(t,e,r){"use strict";
/*!
 * blake2s.js - blake2s for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(180)},function(t,e,r){"use strict";
/*!
 * secretbox.js - secretbox for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(191)},function(t,e,r){"use strict";
/*!
 * error.js - encoding error for bcoin
 * Copyright (c) 2014-2015, Fedor Indutny (MIT License)
 * Copyright (c) 2014-2017, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */class i extends Error{constructor(t,e,r){super(),this.type="EncodingError",this.name="EncodingError",this.code="ERR_ENCODING",this.message=`${e} (offset=${t}).`,Error.captureStackTrace&&Error.captureStackTrace(this,r||i)}}t.exports=i},function(t,e,r){"use strict";
/*!
 * sha3.js - sha3 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(286)},function(t,e,r){(function(t){!function(t,e){"use strict";function i(t,e){if(!t)throw new Error(e||"Assertion failed")}function n(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}function s(t,e,r){if(s.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(r=e,e=10),this._init(t||0,e||10,r||"be"))}var o;"object"==typeof t?t.exports=s:e.BN=s,s.BN=s,s.wordSize=26;try{o="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:r(117).Buffer}catch(t){}function f(t,e){var r=t.charCodeAt(e);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void i(!1,"Invalid character in "+t)}function a(t,e,r){var i=f(t,r);return r-1>=e&&(i|=f(t,r-1)<<4),i}function c(t,e,r,n){for(var s=0,o=0,f=Math.min(t.length,r),a=e;a<f;a++){var c=t.charCodeAt(a)-48;s*=n,o=c>=49?c-49+10:c>=17?c-17+10:c,i(c>=0&&o<n,"Invalid character"),s+=o}return s}function h(t,e){t.words=e.words,t.length=e.length,t.negative=e.negative,t.red=e.red}if(s.isBN=function(t){return t instanceof s||null!==t&&"object"==typeof t&&t.constructor.wordSize===s.wordSize&&Array.isArray(t.words)},s.max=function(t,e){return t.cmp(e)>0?t:e},s.min=function(t,e){return t.cmp(e)<0?t:e},s.prototype._init=function(t,e,r){if("number"==typeof t)return this._initNumber(t,e,r);if("object"==typeof t)return this._initArray(t,e,r);"hex"===e&&(e=16),i(e===(0|e)&&e>=2&&e<=36);var n=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&(n++,this.negative=1),n<t.length&&(16===e?this._parseHex(t,n,r):(this._parseBase(t,e,n),"le"===r&&this._initArray(this.toArray(),e,r)))},s.prototype._initNumber=function(t,e,r){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(i(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),e,r)},s.prototype._initArray=function(t,e,r){if(i("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var s,o,f=0;if("be"===r)for(n=t.length-1,s=0;n>=0;n-=3)o=t[n]|t[n-1]<<8|t[n-2]<<16,this.words[s]|=o<<f&67108863,this.words[s+1]=o>>>26-f&67108863,(f+=24)>=26&&(f-=26,s++);else if("le"===r)for(n=0,s=0;n<t.length;n+=3)o=t[n]|t[n+1]<<8|t[n+2]<<16,this.words[s]|=o<<f&67108863,this.words[s+1]=o>>>26-f&67108863,(f+=24)>=26&&(f-=26,s++);return this._strip()},s.prototype._parseHex=function(t,e,r){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var n,s=0,o=0;if("be"===r)for(i=t.length-1;i>=e;i-=2)n=a(t,e,i)<<s,this.words[o]|=67108863&n,s>=18?(s-=18,o+=1,this.words[o]|=n>>>26):s+=8;else for(i=(t.length-e)%2==0?e+1:e;i<t.length;i+=2)n=a(t,e,i)<<s,this.words[o]|=67108863&n,s>=18?(s-=18,o+=1,this.words[o]|=n>>>26):s+=8;this._strip()},s.prototype._parseBase=function(t,e,r){this.words=[0],this.length=1;for(var i=0,n=1;n<=67108863;n*=e)i++;i--,n=n/e|0;for(var s=t.length-r,o=s%i,f=Math.min(s,s-o)+r,a=0,h=r;h<f;h+=i)a=c(t,h,h+i,e),this.imuln(n),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a);if(0!==o){var u=1;for(a=c(t,h,t.length,e),h=0;h<o;h++)u*=e;this.imuln(u),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a)}this._strip()},s.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},s.prototype._move=function(t){h(t,this)},s.prototype.clone=function(){var t=new s(null);return this.copy(t),t},s.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=u}catch(t){s.prototype.inspect=u}else s.prototype.inspect=u;function u(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],b=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(t,e){var r;if(e=0|e||1,16===(t=t||10)||"hex"===t){r="";for(var n=0,s=0,o=0;o<this.length;o++){var f=this.words[o],a=(16777215&(f<<n|s)).toString(16);r=0!==(s=f>>>24-n&16777215)||o!==this.length-1?d[6-a.length]+a+r:a+r,(n+=2)>=26&&(n-=26,o--)}for(0!==s&&(r=s.toString(16)+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(t===(0|t)&&t>=2&&t<=36){var c=l[t],h=b[t];r="";var u=this.clone();for(u.negative=0;!u.isZero();){var p=u.modrn(h).toString(t);r=(u=u.idivn(h)).isZero()?p+r:d[c-p.length]+p+r}for(this.isZero()&&(r="0"+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},s.prototype.toJSON=function(){return this.toString(16,2)},o&&(s.prototype.toBuffer=function(t,e){return this.toArrayLike(o,t,e)}),s.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)};function p(t,e,r){r.negative=e.negative^t.negative;var i=t.length+e.length|0;r.length=i,i=i-1|0;var n=0|t.words[0],s=0|e.words[0],o=n*s,f=67108863&o,a=o/67108864|0;r.words[0]=f;for(var c=1;c<i;c++){for(var h=a>>>26,u=67108863&a,d=Math.min(c,e.length-1),l=Math.max(0,c-t.length+1);l<=d;l++){var b=c-l|0;h+=(o=(n=0|t.words[b])*(s=0|e.words[l])+u)/67108864|0,u=67108863&o}r.words[c]=0|u,a=0|h}return 0!==a?r.words[c]=0|a:r.length--,r._strip()}s.prototype.toArrayLike=function(t,e,r){this._strip();var n=this.byteLength(),s=r||Math.max(1,n);i(n<=s,"byte array longer than desired length"),i(s>0,"Requested array length <= 0");var o=function(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)}(t,s);return this["_toArrayLike"+("le"===e?"LE":"BE")](o,n),o},s.prototype._toArrayLikeLE=function(t,e){for(var r=0,i=0,n=0,s=0;n<this.length;n++){var o=this.words[n]<<s|i;t[r++]=255&o,r<t.length&&(t[r++]=o>>8&255),r<t.length&&(t[r++]=o>>16&255),6===s?(r<t.length&&(t[r++]=o>>24&255),i=0,s=0):(i=o>>>24,s+=2)}if(r<t.length)for(t[r++]=i;r<t.length;)t[r++]=0},s.prototype._toArrayLikeBE=function(t,e){for(var r=t.length-1,i=0,n=0,s=0;n<this.length;n++){var o=this.words[n]<<s|i;t[r--]=255&o,r>=0&&(t[r--]=o>>8&255),r>=0&&(t[r--]=o>>16&255),6===s?(r>=0&&(t[r--]=o>>24&255),i=0,s=0):(i=o>>>24,s+=2)}if(r>=0)for(t[r--]=i;r>=0;)t[r--]=0},Math.clz32?s.prototype._countBits=function(t){return 32-Math.clz32(t)}:s.prototype._countBits=function(t){var e=t,r=0;return e>=4096&&(r+=13,e>>>=13),e>=64&&(r+=7,e>>>=7),e>=8&&(r+=4,e>>>=4),e>=2&&(r+=2,e>>>=2),r+e},s.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,r=0;return 0==(8191&e)&&(r+=13,e>>>=13),0==(127&e)&&(r+=7,e>>>=7),0==(15&e)&&(r+=4,e>>>=4),0==(3&e)&&(r+=2,e>>>=2),0==(1&e)&&r++,r},s.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var r=this._zeroBits(this.words[e]);if(t+=r,26!==r)break}return t},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},s.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this._strip()},s.prototype.ior=function(t){return i(0==(this.negative|t.negative)),this.iuor(t)},s.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},s.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},s.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var r=0;r<e.length;r++)this.words[r]=this.words[r]&t.words[r];return this.length=e.length,this._strip()},s.prototype.iand=function(t){return i(0==(this.negative|t.negative)),this.iuand(t)},s.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},s.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},s.prototype.iuxor=function(t){var e,r;this.length>t.length?(e=this,r=t):(e=t,r=this);for(var i=0;i<r.length;i++)this.words[i]=e.words[i]^r.words[i];if(this!==e)for(;i<e.length;i++)this.words[i]=e.words[i];return this.length=e.length,this._strip()},s.prototype.ixor=function(t){return i(0==(this.negative|t.negative)),this.iuxor(t)},s.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},s.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},s.prototype.inotn=function(t){i("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),r=t%26;this._expand(e),r>0&&e--;for(var n=0;n<e;n++)this.words[n]=67108863&~this.words[n];return r>0&&(this.words[n]=~this.words[n]&67108863>>26-r),this._strip()},s.prototype.notn=function(t){return this.clone().inotn(t)},s.prototype.setn=function(t,e){i("number"==typeof t&&t>=0);var r=t/26|0,n=t%26;return this._expand(r+1),this.words[r]=e?this.words[r]|1<<n:this.words[r]&~(1<<n),this._strip()},s.prototype.iadd=function(t){var e,r,i;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(r=this,i=t):(r=t,i=this);for(var n=0,s=0;s<i.length;s++)e=(0|r.words[s])+(0|i.words[s])+n,this.words[s]=67108863&e,n=e>>>26;for(;0!==n&&s<r.length;s++)e=(0|r.words[s])+n,this.words[s]=67108863&e,n=e>>>26;if(this.length=r.length,0!==n)this.words[this.length]=n,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},s.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},s.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var r,i,n=this.cmp(t);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(r=this,i=t):(r=t,i=this);for(var s=0,o=0;o<i.length;o++)s=(e=(0|r.words[o])-(0|i.words[o])+s)>>26,this.words[o]=67108863&e;for(;0!==s&&o<r.length;o++)s=(e=(0|r.words[o])+s)>>26,this.words[o]=67108863&e;if(0===s&&o<r.length&&r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=Math.max(this.length,o),r!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(t){return this.clone().isub(t)};var m=function(t,e,r){var i,n,s,o=t.words,f=e.words,a=r.words,c=0,h=0|o[0],u=8191&h,d=h>>>13,l=0|o[1],b=8191&l,p=l>>>13,m=0|o[2],g=8191&m,w=m>>>13,y=0|o[3],v=8191&y,S=y>>>13,E=0|o[4],M=8191&E,A=E>>>13,I=0|o[5],_=8191&I,x=I>>>13,B=0|o[6],k=8191&B,z=B>>>13,q=0|o[7],N=8191&q,P=q>>>13,R=0|o[8],O=8191&R,U=R>>>13,C=0|o[9],T=8191&C,D=C>>>13,L=0|f[0],K=8191&L,H=L>>>13,j=0|f[1],F=8191&j,Z=j>>>13,V=0|f[2],G=8191&V,J=V>>>13,Y=0|f[3],X=8191&Y,W=Y>>>13,$=0|f[4],Q=8191&$,tt=$>>>13,et=0|f[5],rt=8191&et,it=et>>>13,nt=0|f[6],st=8191&nt,ot=nt>>>13,ft=0|f[7],at=8191&ft,ct=ft>>>13,ht=0|f[8],ut=8191&ht,dt=ht>>>13,lt=0|f[9],bt=8191&lt,pt=lt>>>13;r.negative=t.negative^e.negative,r.length=19;var mt=(c+(i=Math.imul(u,K))|0)+((8191&(n=(n=Math.imul(u,H))+Math.imul(d,K)|0))<<13)|0;c=((s=Math.imul(d,H))+(n>>>13)|0)+(mt>>>26)|0,mt&=67108863,i=Math.imul(b,K),n=(n=Math.imul(b,H))+Math.imul(p,K)|0,s=Math.imul(p,H);var gt=(c+(i=i+Math.imul(u,F)|0)|0)+((8191&(n=(n=n+Math.imul(u,Z)|0)+Math.imul(d,F)|0))<<13)|0;c=((s=s+Math.imul(d,Z)|0)+(n>>>13)|0)+(gt>>>26)|0,gt&=67108863,i=Math.imul(g,K),n=(n=Math.imul(g,H))+Math.imul(w,K)|0,s=Math.imul(w,H),i=i+Math.imul(b,F)|0,n=(n=n+Math.imul(b,Z)|0)+Math.imul(p,F)|0,s=s+Math.imul(p,Z)|0;var wt=(c+(i=i+Math.imul(u,G)|0)|0)+((8191&(n=(n=n+Math.imul(u,J)|0)+Math.imul(d,G)|0))<<13)|0;c=((s=s+Math.imul(d,J)|0)+(n>>>13)|0)+(wt>>>26)|0,wt&=67108863,i=Math.imul(v,K),n=(n=Math.imul(v,H))+Math.imul(S,K)|0,s=Math.imul(S,H),i=i+Math.imul(g,F)|0,n=(n=n+Math.imul(g,Z)|0)+Math.imul(w,F)|0,s=s+Math.imul(w,Z)|0,i=i+Math.imul(b,G)|0,n=(n=n+Math.imul(b,J)|0)+Math.imul(p,G)|0,s=s+Math.imul(p,J)|0;var yt=(c+(i=i+Math.imul(u,X)|0)|0)+((8191&(n=(n=n+Math.imul(u,W)|0)+Math.imul(d,X)|0))<<13)|0;c=((s=s+Math.imul(d,W)|0)+(n>>>13)|0)+(yt>>>26)|0,yt&=67108863,i=Math.imul(M,K),n=(n=Math.imul(M,H))+Math.imul(A,K)|0,s=Math.imul(A,H),i=i+Math.imul(v,F)|0,n=(n=n+Math.imul(v,Z)|0)+Math.imul(S,F)|0,s=s+Math.imul(S,Z)|0,i=i+Math.imul(g,G)|0,n=(n=n+Math.imul(g,J)|0)+Math.imul(w,G)|0,s=s+Math.imul(w,J)|0,i=i+Math.imul(b,X)|0,n=(n=n+Math.imul(b,W)|0)+Math.imul(p,X)|0,s=s+Math.imul(p,W)|0;var vt=(c+(i=i+Math.imul(u,Q)|0)|0)+((8191&(n=(n=n+Math.imul(u,tt)|0)+Math.imul(d,Q)|0))<<13)|0;c=((s=s+Math.imul(d,tt)|0)+(n>>>13)|0)+(vt>>>26)|0,vt&=67108863,i=Math.imul(_,K),n=(n=Math.imul(_,H))+Math.imul(x,K)|0,s=Math.imul(x,H),i=i+Math.imul(M,F)|0,n=(n=n+Math.imul(M,Z)|0)+Math.imul(A,F)|0,s=s+Math.imul(A,Z)|0,i=i+Math.imul(v,G)|0,n=(n=n+Math.imul(v,J)|0)+Math.imul(S,G)|0,s=s+Math.imul(S,J)|0,i=i+Math.imul(g,X)|0,n=(n=n+Math.imul(g,W)|0)+Math.imul(w,X)|0,s=s+Math.imul(w,W)|0,i=i+Math.imul(b,Q)|0,n=(n=n+Math.imul(b,tt)|0)+Math.imul(p,Q)|0,s=s+Math.imul(p,tt)|0;var St=(c+(i=i+Math.imul(u,rt)|0)|0)+((8191&(n=(n=n+Math.imul(u,it)|0)+Math.imul(d,rt)|0))<<13)|0;c=((s=s+Math.imul(d,it)|0)+(n>>>13)|0)+(St>>>26)|0,St&=67108863,i=Math.imul(k,K),n=(n=Math.imul(k,H))+Math.imul(z,K)|0,s=Math.imul(z,H),i=i+Math.imul(_,F)|0,n=(n=n+Math.imul(_,Z)|0)+Math.imul(x,F)|0,s=s+Math.imul(x,Z)|0,i=i+Math.imul(M,G)|0,n=(n=n+Math.imul(M,J)|0)+Math.imul(A,G)|0,s=s+Math.imul(A,J)|0,i=i+Math.imul(v,X)|0,n=(n=n+Math.imul(v,W)|0)+Math.imul(S,X)|0,s=s+Math.imul(S,W)|0,i=i+Math.imul(g,Q)|0,n=(n=n+Math.imul(g,tt)|0)+Math.imul(w,Q)|0,s=s+Math.imul(w,tt)|0,i=i+Math.imul(b,rt)|0,n=(n=n+Math.imul(b,it)|0)+Math.imul(p,rt)|0,s=s+Math.imul(p,it)|0;var Et=(c+(i=i+Math.imul(u,st)|0)|0)+((8191&(n=(n=n+Math.imul(u,ot)|0)+Math.imul(d,st)|0))<<13)|0;c=((s=s+Math.imul(d,ot)|0)+(n>>>13)|0)+(Et>>>26)|0,Et&=67108863,i=Math.imul(N,K),n=(n=Math.imul(N,H))+Math.imul(P,K)|0,s=Math.imul(P,H),i=i+Math.imul(k,F)|0,n=(n=n+Math.imul(k,Z)|0)+Math.imul(z,F)|0,s=s+Math.imul(z,Z)|0,i=i+Math.imul(_,G)|0,n=(n=n+Math.imul(_,J)|0)+Math.imul(x,G)|0,s=s+Math.imul(x,J)|0,i=i+Math.imul(M,X)|0,n=(n=n+Math.imul(M,W)|0)+Math.imul(A,X)|0,s=s+Math.imul(A,W)|0,i=i+Math.imul(v,Q)|0,n=(n=n+Math.imul(v,tt)|0)+Math.imul(S,Q)|0,s=s+Math.imul(S,tt)|0,i=i+Math.imul(g,rt)|0,n=(n=n+Math.imul(g,it)|0)+Math.imul(w,rt)|0,s=s+Math.imul(w,it)|0,i=i+Math.imul(b,st)|0,n=(n=n+Math.imul(b,ot)|0)+Math.imul(p,st)|0,s=s+Math.imul(p,ot)|0;var Mt=(c+(i=i+Math.imul(u,at)|0)|0)+((8191&(n=(n=n+Math.imul(u,ct)|0)+Math.imul(d,at)|0))<<13)|0;c=((s=s+Math.imul(d,ct)|0)+(n>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,i=Math.imul(O,K),n=(n=Math.imul(O,H))+Math.imul(U,K)|0,s=Math.imul(U,H),i=i+Math.imul(N,F)|0,n=(n=n+Math.imul(N,Z)|0)+Math.imul(P,F)|0,s=s+Math.imul(P,Z)|0,i=i+Math.imul(k,G)|0,n=(n=n+Math.imul(k,J)|0)+Math.imul(z,G)|0,s=s+Math.imul(z,J)|0,i=i+Math.imul(_,X)|0,n=(n=n+Math.imul(_,W)|0)+Math.imul(x,X)|0,s=s+Math.imul(x,W)|0,i=i+Math.imul(M,Q)|0,n=(n=n+Math.imul(M,tt)|0)+Math.imul(A,Q)|0,s=s+Math.imul(A,tt)|0,i=i+Math.imul(v,rt)|0,n=(n=n+Math.imul(v,it)|0)+Math.imul(S,rt)|0,s=s+Math.imul(S,it)|0,i=i+Math.imul(g,st)|0,n=(n=n+Math.imul(g,ot)|0)+Math.imul(w,st)|0,s=s+Math.imul(w,ot)|0,i=i+Math.imul(b,at)|0,n=(n=n+Math.imul(b,ct)|0)+Math.imul(p,at)|0,s=s+Math.imul(p,ct)|0;var At=(c+(i=i+Math.imul(u,ut)|0)|0)+((8191&(n=(n=n+Math.imul(u,dt)|0)+Math.imul(d,ut)|0))<<13)|0;c=((s=s+Math.imul(d,dt)|0)+(n>>>13)|0)+(At>>>26)|0,At&=67108863,i=Math.imul(T,K),n=(n=Math.imul(T,H))+Math.imul(D,K)|0,s=Math.imul(D,H),i=i+Math.imul(O,F)|0,n=(n=n+Math.imul(O,Z)|0)+Math.imul(U,F)|0,s=s+Math.imul(U,Z)|0,i=i+Math.imul(N,G)|0,n=(n=n+Math.imul(N,J)|0)+Math.imul(P,G)|0,s=s+Math.imul(P,J)|0,i=i+Math.imul(k,X)|0,n=(n=n+Math.imul(k,W)|0)+Math.imul(z,X)|0,s=s+Math.imul(z,W)|0,i=i+Math.imul(_,Q)|0,n=(n=n+Math.imul(_,tt)|0)+Math.imul(x,Q)|0,s=s+Math.imul(x,tt)|0,i=i+Math.imul(M,rt)|0,n=(n=n+Math.imul(M,it)|0)+Math.imul(A,rt)|0,s=s+Math.imul(A,it)|0,i=i+Math.imul(v,st)|0,n=(n=n+Math.imul(v,ot)|0)+Math.imul(S,st)|0,s=s+Math.imul(S,ot)|0,i=i+Math.imul(g,at)|0,n=(n=n+Math.imul(g,ct)|0)+Math.imul(w,at)|0,s=s+Math.imul(w,ct)|0,i=i+Math.imul(b,ut)|0,n=(n=n+Math.imul(b,dt)|0)+Math.imul(p,ut)|0,s=s+Math.imul(p,dt)|0;var It=(c+(i=i+Math.imul(u,bt)|0)|0)+((8191&(n=(n=n+Math.imul(u,pt)|0)+Math.imul(d,bt)|0))<<13)|0;c=((s=s+Math.imul(d,pt)|0)+(n>>>13)|0)+(It>>>26)|0,It&=67108863,i=Math.imul(T,F),n=(n=Math.imul(T,Z))+Math.imul(D,F)|0,s=Math.imul(D,Z),i=i+Math.imul(O,G)|0,n=(n=n+Math.imul(O,J)|0)+Math.imul(U,G)|0,s=s+Math.imul(U,J)|0,i=i+Math.imul(N,X)|0,n=(n=n+Math.imul(N,W)|0)+Math.imul(P,X)|0,s=s+Math.imul(P,W)|0,i=i+Math.imul(k,Q)|0,n=(n=n+Math.imul(k,tt)|0)+Math.imul(z,Q)|0,s=s+Math.imul(z,tt)|0,i=i+Math.imul(_,rt)|0,n=(n=n+Math.imul(_,it)|0)+Math.imul(x,rt)|0,s=s+Math.imul(x,it)|0,i=i+Math.imul(M,st)|0,n=(n=n+Math.imul(M,ot)|0)+Math.imul(A,st)|0,s=s+Math.imul(A,ot)|0,i=i+Math.imul(v,at)|0,n=(n=n+Math.imul(v,ct)|0)+Math.imul(S,at)|0,s=s+Math.imul(S,ct)|0,i=i+Math.imul(g,ut)|0,n=(n=n+Math.imul(g,dt)|0)+Math.imul(w,ut)|0,s=s+Math.imul(w,dt)|0;var _t=(c+(i=i+Math.imul(b,bt)|0)|0)+((8191&(n=(n=n+Math.imul(b,pt)|0)+Math.imul(p,bt)|0))<<13)|0;c=((s=s+Math.imul(p,pt)|0)+(n>>>13)|0)+(_t>>>26)|0,_t&=67108863,i=Math.imul(T,G),n=(n=Math.imul(T,J))+Math.imul(D,G)|0,s=Math.imul(D,J),i=i+Math.imul(O,X)|0,n=(n=n+Math.imul(O,W)|0)+Math.imul(U,X)|0,s=s+Math.imul(U,W)|0,i=i+Math.imul(N,Q)|0,n=(n=n+Math.imul(N,tt)|0)+Math.imul(P,Q)|0,s=s+Math.imul(P,tt)|0,i=i+Math.imul(k,rt)|0,n=(n=n+Math.imul(k,it)|0)+Math.imul(z,rt)|0,s=s+Math.imul(z,it)|0,i=i+Math.imul(_,st)|0,n=(n=n+Math.imul(_,ot)|0)+Math.imul(x,st)|0,s=s+Math.imul(x,ot)|0,i=i+Math.imul(M,at)|0,n=(n=n+Math.imul(M,ct)|0)+Math.imul(A,at)|0,s=s+Math.imul(A,ct)|0,i=i+Math.imul(v,ut)|0,n=(n=n+Math.imul(v,dt)|0)+Math.imul(S,ut)|0,s=s+Math.imul(S,dt)|0;var xt=(c+(i=i+Math.imul(g,bt)|0)|0)+((8191&(n=(n=n+Math.imul(g,pt)|0)+Math.imul(w,bt)|0))<<13)|0;c=((s=s+Math.imul(w,pt)|0)+(n>>>13)|0)+(xt>>>26)|0,xt&=67108863,i=Math.imul(T,X),n=(n=Math.imul(T,W))+Math.imul(D,X)|0,s=Math.imul(D,W),i=i+Math.imul(O,Q)|0,n=(n=n+Math.imul(O,tt)|0)+Math.imul(U,Q)|0,s=s+Math.imul(U,tt)|0,i=i+Math.imul(N,rt)|0,n=(n=n+Math.imul(N,it)|0)+Math.imul(P,rt)|0,s=s+Math.imul(P,it)|0,i=i+Math.imul(k,st)|0,n=(n=n+Math.imul(k,ot)|0)+Math.imul(z,st)|0,s=s+Math.imul(z,ot)|0,i=i+Math.imul(_,at)|0,n=(n=n+Math.imul(_,ct)|0)+Math.imul(x,at)|0,s=s+Math.imul(x,ct)|0,i=i+Math.imul(M,ut)|0,n=(n=n+Math.imul(M,dt)|0)+Math.imul(A,ut)|0,s=s+Math.imul(A,dt)|0;var Bt=(c+(i=i+Math.imul(v,bt)|0)|0)+((8191&(n=(n=n+Math.imul(v,pt)|0)+Math.imul(S,bt)|0))<<13)|0;c=((s=s+Math.imul(S,pt)|0)+(n>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,i=Math.imul(T,Q),n=(n=Math.imul(T,tt))+Math.imul(D,Q)|0,s=Math.imul(D,tt),i=i+Math.imul(O,rt)|0,n=(n=n+Math.imul(O,it)|0)+Math.imul(U,rt)|0,s=s+Math.imul(U,it)|0,i=i+Math.imul(N,st)|0,n=(n=n+Math.imul(N,ot)|0)+Math.imul(P,st)|0,s=s+Math.imul(P,ot)|0,i=i+Math.imul(k,at)|0,n=(n=n+Math.imul(k,ct)|0)+Math.imul(z,at)|0,s=s+Math.imul(z,ct)|0,i=i+Math.imul(_,ut)|0,n=(n=n+Math.imul(_,dt)|0)+Math.imul(x,ut)|0,s=s+Math.imul(x,dt)|0;var kt=(c+(i=i+Math.imul(M,bt)|0)|0)+((8191&(n=(n=n+Math.imul(M,pt)|0)+Math.imul(A,bt)|0))<<13)|0;c=((s=s+Math.imul(A,pt)|0)+(n>>>13)|0)+(kt>>>26)|0,kt&=67108863,i=Math.imul(T,rt),n=(n=Math.imul(T,it))+Math.imul(D,rt)|0,s=Math.imul(D,it),i=i+Math.imul(O,st)|0,n=(n=n+Math.imul(O,ot)|0)+Math.imul(U,st)|0,s=s+Math.imul(U,ot)|0,i=i+Math.imul(N,at)|0,n=(n=n+Math.imul(N,ct)|0)+Math.imul(P,at)|0,s=s+Math.imul(P,ct)|0,i=i+Math.imul(k,ut)|0,n=(n=n+Math.imul(k,dt)|0)+Math.imul(z,ut)|0,s=s+Math.imul(z,dt)|0;var zt=(c+(i=i+Math.imul(_,bt)|0)|0)+((8191&(n=(n=n+Math.imul(_,pt)|0)+Math.imul(x,bt)|0))<<13)|0;c=((s=s+Math.imul(x,pt)|0)+(n>>>13)|0)+(zt>>>26)|0,zt&=67108863,i=Math.imul(T,st),n=(n=Math.imul(T,ot))+Math.imul(D,st)|0,s=Math.imul(D,ot),i=i+Math.imul(O,at)|0,n=(n=n+Math.imul(O,ct)|0)+Math.imul(U,at)|0,s=s+Math.imul(U,ct)|0,i=i+Math.imul(N,ut)|0,n=(n=n+Math.imul(N,dt)|0)+Math.imul(P,ut)|0,s=s+Math.imul(P,dt)|0;var qt=(c+(i=i+Math.imul(k,bt)|0)|0)+((8191&(n=(n=n+Math.imul(k,pt)|0)+Math.imul(z,bt)|0))<<13)|0;c=((s=s+Math.imul(z,pt)|0)+(n>>>13)|0)+(qt>>>26)|0,qt&=67108863,i=Math.imul(T,at),n=(n=Math.imul(T,ct))+Math.imul(D,at)|0,s=Math.imul(D,ct),i=i+Math.imul(O,ut)|0,n=(n=n+Math.imul(O,dt)|0)+Math.imul(U,ut)|0,s=s+Math.imul(U,dt)|0;var Nt=(c+(i=i+Math.imul(N,bt)|0)|0)+((8191&(n=(n=n+Math.imul(N,pt)|0)+Math.imul(P,bt)|0))<<13)|0;c=((s=s+Math.imul(P,pt)|0)+(n>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,i=Math.imul(T,ut),n=(n=Math.imul(T,dt))+Math.imul(D,ut)|0,s=Math.imul(D,dt);var Pt=(c+(i=i+Math.imul(O,bt)|0)|0)+((8191&(n=(n=n+Math.imul(O,pt)|0)+Math.imul(U,bt)|0))<<13)|0;c=((s=s+Math.imul(U,pt)|0)+(n>>>13)|0)+(Pt>>>26)|0,Pt&=67108863;var Rt=(c+(i=Math.imul(T,bt))|0)+((8191&(n=(n=Math.imul(T,pt))+Math.imul(D,bt)|0))<<13)|0;return c=((s=Math.imul(D,pt))+(n>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,a[0]=mt,a[1]=gt,a[2]=wt,a[3]=yt,a[4]=vt,a[5]=St,a[6]=Et,a[7]=Mt,a[8]=At,a[9]=It,a[10]=_t,a[11]=xt,a[12]=Bt,a[13]=kt,a[14]=zt,a[15]=qt,a[16]=Nt,a[17]=Pt,a[18]=Rt,0!==c&&(a[19]=c,r.length++),r};function g(t,e,r){r.negative=e.negative^t.negative,r.length=t.length+e.length;for(var i=0,n=0,s=0;s<r.length-1;s++){var o=n;n=0;for(var f=67108863&i,a=Math.min(s,e.length-1),c=Math.max(0,s-t.length+1);c<=a;c++){var h=s-c,u=(0|t.words[h])*(0|e.words[c]),d=67108863&u;f=67108863&(d=d+f|0),n+=(o=(o=o+(u/67108864|0)|0)+(d>>>26)|0)>>>26,o&=67108863}r.words[s]=f,i=o,o=n}return 0!==i?r.words[s]=i:r.length--,r._strip()}function w(t,e,r){return g(t,e,r)}function y(t,e){this.x=t,this.y=e}Math.imul||(m=p),s.prototype.mulTo=function(t,e){var r=this.length+t.length;return 10===this.length&&10===t.length?m(this,t,e):r<63?p(this,t,e):r<1024?g(this,t,e):w(this,t,e)},y.prototype.makeRBT=function(t){for(var e=new Array(t),r=s.prototype._countBits(t)-1,i=0;i<t;i++)e[i]=this.revBin(i,r,t);return e},y.prototype.revBin=function(t,e,r){if(0===t||t===r-1)return t;for(var i=0,n=0;n<e;n++)i|=(1&t)<<e-n-1,t>>=1;return i},y.prototype.permute=function(t,e,r,i,n,s){for(var o=0;o<s;o++)i[o]=e[t[o]],n[o]=r[t[o]]},y.prototype.transform=function(t,e,r,i,n,s){this.permute(s,t,e,r,i,n);for(var o=1;o<n;o<<=1)for(var f=o<<1,a=Math.cos(2*Math.PI/f),c=Math.sin(2*Math.PI/f),h=0;h<n;h+=f)for(var u=a,d=c,l=0;l<o;l++){var b=r[h+l],p=i[h+l],m=r[h+l+o],g=i[h+l+o],w=u*m-d*g;g=u*g+d*m,m=w,r[h+l]=b+m,i[h+l]=p+g,r[h+l+o]=b-m,i[h+l+o]=p-g,l!==f&&(w=a*u-c*d,d=a*d+c*u,u=w)}},y.prototype.guessLen13b=function(t,e){var r=1|Math.max(e,t),i=1&r,n=0;for(r=r/2|0;r;r>>>=1)n++;return 1<<n+1+i},y.prototype.conjugate=function(t,e,r){if(!(r<=1))for(var i=0;i<r/2;i++){var n=t[i];t[i]=t[r-i-1],t[r-i-1]=n,n=e[i],e[i]=-e[r-i-1],e[r-i-1]=-n}},y.prototype.normalize13b=function(t,e){for(var r=0,i=0;i<e/2;i++){var n=8192*Math.round(t[2*i+1]/e)+Math.round(t[2*i]/e)+r;t[i]=67108863&n,r=n<67108864?0:n/67108864|0}return t},y.prototype.convert13b=function(t,e,r,n){for(var s=0,o=0;o<e;o++)s+=0|t[o],r[2*o]=8191&s,s>>>=13,r[2*o+1]=8191&s,s>>>=13;for(o=2*e;o<n;++o)r[o]=0;i(0===s),i(0==(-8192&s))},y.prototype.stub=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=0;return e},y.prototype.mulp=function(t,e,r){var i=2*this.guessLen13b(t.length,e.length),n=this.makeRBT(i),s=this.stub(i),o=new Array(i),f=new Array(i),a=new Array(i),c=new Array(i),h=new Array(i),u=new Array(i),d=r.words;d.length=i,this.convert13b(t.words,t.length,o,i),this.convert13b(e.words,e.length,c,i),this.transform(o,s,f,a,i,n),this.transform(c,s,h,u,i,n);for(var l=0;l<i;l++){var b=f[l]*h[l]-a[l]*u[l];a[l]=f[l]*u[l]+a[l]*h[l],f[l]=b}return this.conjugate(f,a,i),this.transform(f,a,d,s,i,n),this.conjugate(d,s,i),this.normalize13b(d,i),r.negative=t.negative^e.negative,r.length=t.length+e.length,r._strip()},s.prototype.mul=function(t){var e=new s(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},s.prototype.mulf=function(t){var e=new s(null);return e.words=new Array(this.length+t.length),w(this,t,e)},s.prototype.imul=function(t){return this.clone().mulTo(t,this)},s.prototype.imuln=function(t){var e=t<0;e&&(t=-t),i("number"==typeof t),i(t<67108864);for(var r=0,n=0;n<this.length;n++){var s=(0|this.words[n])*t,o=(67108863&s)+(67108863&r);r>>=26,r+=s/67108864|0,r+=o>>>26,this.words[n]=67108863&o}return 0!==r&&(this.words[n]=r,this.length++),e?this.ineg():this},s.prototype.muln=function(t){return this.clone().imuln(t)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),r=0;r<e.length;r++){var i=r/26|0,n=r%26;e[r]=t.words[i]>>>n&1}return e}(t);if(0===e.length)return new s(1);for(var r=this,i=0;i<e.length&&0===e[i];i++,r=r.sqr());if(++i<e.length)for(var n=r.sqr();i<e.length;i++,n=n.sqr())0!==e[i]&&(r=r.mul(n));return r},s.prototype.iushln=function(t){i("number"==typeof t&&t>=0);var e,r=t%26,n=(t-r)/26,s=67108863>>>26-r<<26-r;if(0!==r){var o=0;for(e=0;e<this.length;e++){var f=this.words[e]&s,a=(0|this.words[e])-f<<r;this.words[e]=a|o,o=f>>>26-r}o&&(this.words[e]=o,this.length++)}if(0!==n){for(e=this.length-1;e>=0;e--)this.words[e+n]=this.words[e];for(e=0;e<n;e++)this.words[e]=0;this.length+=n}return this._strip()},s.prototype.ishln=function(t){return i(0===this.negative),this.iushln(t)},s.prototype.iushrn=function(t,e,r){var n;i("number"==typeof t&&t>=0),n=e?(e-e%26)/26:0;var s=t%26,o=Math.min((t-s)/26,this.length),f=67108863^67108863>>>s<<s,a=r;if(n-=o,n=Math.max(0,n),a){for(var c=0;c<o;c++)a.words[c]=this.words[c];a.length=o}if(0===o);else if(this.length>o)for(this.length-=o,c=0;c<this.length;c++)this.words[c]=this.words[c+o];else this.words[0]=0,this.length=1;var h=0;for(c=this.length-1;c>=0&&(0!==h||c>=n);c--){var u=0|this.words[c];this.words[c]=h<<26-s|u>>>s,h=u&f}return a&&0!==h&&(a.words[a.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(t,e,r){return i(0===this.negative),this.iushrn(t,e,r)},s.prototype.shln=function(t){return this.clone().ishln(t)},s.prototype.ushln=function(t){return this.clone().iushln(t)},s.prototype.shrn=function(t){return this.clone().ishrn(t)},s.prototype.ushrn=function(t){return this.clone().iushrn(t)},s.prototype.testn=function(t){i("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26,n=1<<e;return!(this.length<=r)&&!!(this.words[r]&n)},s.prototype.imaskn=function(t){i("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26;if(i(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==e&&r++,this.length=Math.min(r,this.length),0!==e){var n=67108863^67108863>>>e<<e;this.words[this.length-1]&=n}return this._strip()},s.prototype.maskn=function(t){return this.clone().imaskn(t)},s.prototype.iaddn=function(t){return i("number"==typeof t),i(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<=t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},s.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},s.prototype.isubn=function(t){if(i("number"==typeof t),i(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this._strip()},s.prototype.addn=function(t){return this.clone().iaddn(t)},s.prototype.subn=function(t){return this.clone().isubn(t)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(t,e,r){var n,s,o=t.length+r;this._expand(o);var f=0;for(n=0;n<t.length;n++){s=(0|this.words[n+r])+f;var a=(0|t.words[n])*e;f=((s-=67108863&a)>>26)-(a/67108864|0),this.words[n+r]=67108863&s}for(;n<this.length-r;n++)f=(s=(0|this.words[n+r])+f)>>26,this.words[n+r]=67108863&s;if(0===f)return this._strip();for(i(-1===f),f=0,n=0;n<this.length;n++)f=(s=-(0|this.words[n])+f)>>26,this.words[n]=67108863&s;return this.negative=1,this._strip()},s.prototype._wordDiv=function(t,e){var r=(this.length,t.length),i=this.clone(),n=t,o=0|n.words[n.length-1];0!==(r=26-this._countBits(o))&&(n=n.ushln(r),i.iushln(r),o=0|n.words[n.length-1]);var f,a=i.length-n.length;if("mod"!==e){(f=new s(null)).length=a+1,f.words=new Array(f.length);for(var c=0;c<f.length;c++)f.words[c]=0}var h=i.clone()._ishlnsubmul(n,1,a);0===h.negative&&(i=h,f&&(f.words[a]=1));for(var u=a-1;u>=0;u--){var d=67108864*(0|i.words[n.length+u])+(0|i.words[n.length+u-1]);for(d=Math.min(d/o|0,67108863),i._ishlnsubmul(n,d,u);0!==i.negative;)d--,i.negative=0,i._ishlnsubmul(n,1,u),i.isZero()||(i.negative^=1);f&&(f.words[u]=d)}return f&&f._strip(),i._strip(),"div"!==e&&0!==r&&i.iushrn(r),{div:f||null,mod:i}},s.prototype.divmod=function(t,e,r){return i(!t.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===t.negative?(f=this.neg().divmod(t,e),"mod"!==e&&(n=f.div.neg()),"div"!==e&&(o=f.mod.neg(),r&&0!==o.negative&&o.iadd(t)),{div:n,mod:o}):0===this.negative&&0!==t.negative?(f=this.divmod(t.neg(),e),"mod"!==e&&(n=f.div.neg()),{div:n,mod:f.mod}):0!=(this.negative&t.negative)?(f=this.neg().divmod(t.neg(),e),"div"!==e&&(o=f.mod.neg(),r&&0!==o.negative&&o.isub(t)),{div:f.div,mod:o}):t.length>this.length||this.cmp(t)<0?{div:new s(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new s(this.modrn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new s(this.modrn(t.words[0]))}:this._wordDiv(t,e);var n,o,f},s.prototype.div=function(t){return this.divmod(t,"div",!1).div},s.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},s.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},s.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var r=0!==e.div.negative?e.mod.isub(t):e.mod,i=t.ushrn(1),n=t.andln(1),s=r.cmp(i);return s<0||1===n&&0===s?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},s.prototype.modrn=function(t){var e=t<0;e&&(t=-t),i(t<=67108863);for(var r=(1<<26)%t,n=0,s=this.length-1;s>=0;s--)n=(r*n+(0|this.words[s]))%t;return e?-n:n},s.prototype.modn=function(t){return this.modrn(t)},s.prototype.idivn=function(t){var e=t<0;e&&(t=-t),i(t<=67108863);for(var r=0,n=this.length-1;n>=0;n--){var s=(0|this.words[n])+67108864*r;this.words[n]=s/t|0,r=s%t}return this._strip(),e?this.ineg():this},s.prototype.divn=function(t){return this.clone().idivn(t)},s.prototype.egcd=function(t){i(0===t.negative),i(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var n=new s(1),o=new s(0),f=new s(0),a=new s(1),c=0;e.isEven()&&r.isEven();)e.iushrn(1),r.iushrn(1),++c;for(var h=r.clone(),u=e.clone();!e.isZero();){for(var d=0,l=1;0==(e.words[0]&l)&&d<26;++d,l<<=1);if(d>0)for(e.iushrn(d);d-- >0;)(n.isOdd()||o.isOdd())&&(n.iadd(h),o.isub(u)),n.iushrn(1),o.iushrn(1);for(var b=0,p=1;0==(r.words[0]&p)&&b<26;++b,p<<=1);if(b>0)for(r.iushrn(b);b-- >0;)(f.isOdd()||a.isOdd())&&(f.iadd(h),a.isub(u)),f.iushrn(1),a.iushrn(1);e.cmp(r)>=0?(e.isub(r),n.isub(f),o.isub(a)):(r.isub(e),f.isub(n),a.isub(o))}return{a:f,b:a,gcd:r.iushln(c)}},s.prototype._invmp=function(t){i(0===t.negative),i(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var n,o=new s(1),f=new s(0),a=r.clone();e.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,h=1;0==(e.words[0]&h)&&c<26;++c,h<<=1);if(c>0)for(e.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(a),o.iushrn(1);for(var u=0,d=1;0==(r.words[0]&d)&&u<26;++u,d<<=1);if(u>0)for(r.iushrn(u);u-- >0;)f.isOdd()&&f.iadd(a),f.iushrn(1);e.cmp(r)>=0?(e.isub(r),o.isub(f)):(r.isub(e),f.isub(o))}return(n=0===e.cmpn(1)?o:f).cmpn(0)<0&&n.iadd(t),n},s.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),r=t.clone();e.negative=0,r.negative=0;for(var i=0;e.isEven()&&r.isEven();i++)e.iushrn(1),r.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;r.isEven();)r.iushrn(1);var n=e.cmp(r);if(n<0){var s=e;e=r,r=s}else if(0===n||0===r.cmpn(1))break;e.isub(r)}return r.iushln(i)},s.prototype.invm=function(t){return this.egcd(t).a.umod(t)},s.prototype.isEven=function(){return 0==(1&this.words[0])},s.prototype.isOdd=function(){return 1==(1&this.words[0])},s.prototype.andln=function(t){return this.words[0]&t},s.prototype.bincn=function(t){i("number"==typeof t);var e=t%26,r=(t-e)/26,n=1<<e;if(this.length<=r)return this._expand(r+1),this.words[r]|=n,this;for(var s=n,o=r;0!==s&&o<this.length;o++){var f=0|this.words[o];s=(f+=s)>>>26,f&=67108863,this.words[o]=f}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(t){var e,r=t<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)e=1;else{r&&(t=-t),i(t<=67108863,"Number is too big");var n=0|this.words[0];e=n===t?0:n<t?-1:1}return 0!==this.negative?0|-e:e},s.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},s.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,r=this.length-1;r>=0;r--){var i=0|this.words[r],n=0|t.words[r];if(i!==n){i<n?e=-1:i>n&&(e=1);break}}return e},s.prototype.gtn=function(t){return 1===this.cmpn(t)},s.prototype.gt=function(t){return 1===this.cmp(t)},s.prototype.gten=function(t){return this.cmpn(t)>=0},s.prototype.gte=function(t){return this.cmp(t)>=0},s.prototype.ltn=function(t){return-1===this.cmpn(t)},s.prototype.lt=function(t){return-1===this.cmp(t)},s.prototype.lten=function(t){return this.cmpn(t)<=0},s.prototype.lte=function(t){return this.cmp(t)<=0},s.prototype.eqn=function(t){return 0===this.cmpn(t)},s.prototype.eq=function(t){return 0===this.cmp(t)},s.red=function(t){return new _(t)},s.prototype.toRed=function(t){return i(!this.red,"Already a number in reduction context"),i(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(t){return this.red=t,this},s.prototype.forceRed=function(t){return i(!this.red,"Already a number in reduction context"),this._forceRed(t)},s.prototype.redAdd=function(t){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},s.prototype.redIAdd=function(t){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},s.prototype.redSub=function(t){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},s.prototype.redISub=function(t){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},s.prototype.redShl=function(t){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},s.prototype.redMul=function(t){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},s.prototype.redIMul=function(t){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(t){return i(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var v={k256:null,p224:null,p192:null,p25519:null};function S(t,e){this.name=t,this.p=new s(e,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){S.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function M(){S.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function A(){S.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function I(){S.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function _(t){if("string"==typeof t){var e=s._prime(t);this.m=e.p,this.prime=e}else i(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function x(t){_.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}S.prototype._tmp=function(){var t=new s(null);return t.words=new Array(Math.ceil(this.n/13)),t},S.prototype.ireduce=function(t){var e,r=t;do{this.split(r,this.tmp),e=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(e>this.n);var i=e<this.n?-1:r.ucmp(this.p);return 0===i?(r.words[0]=0,r.length=1):i>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},S.prototype.split=function(t,e){t.iushrn(this.n,0,e)},S.prototype.imulK=function(t){return t.imul(this.k)},n(E,S),E.prototype.split=function(t,e){for(var r=Math.min(t.length,9),i=0;i<r;i++)e.words[i]=t.words[i];if(e.length=r,t.length<=9)return t.words[0]=0,void(t.length=1);var n=t.words[9];for(e.words[e.length++]=4194303&n,i=10;i<t.length;i++){var s=0|t.words[i];t.words[i-10]=(4194303&s)<<4|n>>>22,n=s}n>>>=22,t.words[i-10]=n,0===n&&t.length>10?t.length-=10:t.length-=9},E.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,r=0;r<t.length;r++){var i=0|t.words[r];e+=977*i,t.words[r]=67108863&e,e=64*i+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},n(M,S),n(A,S),n(I,S),I.prototype.imulK=function(t){for(var e=0,r=0;r<t.length;r++){var i=19*(0|t.words[r])+e,n=67108863&i;i>>>=26,t.words[r]=n,e=i}return 0!==e&&(t.words[t.length++]=e),t},s._prime=function(t){if(v[t])return v[t];var e;if("k256"===t)e=new E;else if("p224"===t)e=new M;else if("p192"===t)e=new A;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new I}return v[t]=e,e},_.prototype._verify1=function(t){i(0===t.negative,"red works only with positives"),i(t.red,"red works only with red numbers")},_.prototype._verify2=function(t,e){i(0==(t.negative|e.negative),"red works only with positives"),i(t.red&&t.red===e.red,"red works only with red numbers")},_.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):(h(t,t.umod(this.m)._forceRed(this)),t)},_.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},_.prototype.add=function(t,e){this._verify2(t,e);var r=t.add(e);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},_.prototype.iadd=function(t,e){this._verify2(t,e);var r=t.iadd(e);return r.cmp(this.m)>=0&&r.isub(this.m),r},_.prototype.sub=function(t,e){this._verify2(t,e);var r=t.sub(e);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},_.prototype.isub=function(t,e){this._verify2(t,e);var r=t.isub(e);return r.cmpn(0)<0&&r.iadd(this.m),r},_.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},_.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},_.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},_.prototype.isqr=function(t){return this.imul(t,t.clone())},_.prototype.sqr=function(t){return this.mul(t,t)},_.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(i(e%2==1),3===e){var r=this.m.add(new s(1)).iushrn(2);return this.pow(t,r)}for(var n=this.m.subn(1),o=0;!n.isZero()&&0===n.andln(1);)o++,n.iushrn(1);i(!n.isZero());var f=new s(1).toRed(this),a=f.redNeg(),c=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new s(2*h*h).toRed(this);0!==this.pow(h,c).cmp(a);)h.redIAdd(a);for(var u=this.pow(h,n),d=this.pow(t,n.addn(1).iushrn(1)),l=this.pow(t,n),b=o;0!==l.cmp(f);){for(var p=l,m=0;0!==p.cmp(f);m++)p=p.redSqr();i(m<b);var g=this.pow(u,new s(1).iushln(b-m-1));d=d.redMul(g),u=g.redSqr(),l=l.redMul(u),b=m}return d},_.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},_.prototype.pow=function(t,e){if(e.isZero())return new s(1).toRed(this);if(0===e.cmpn(1))return t.clone();var r=new Array(16);r[0]=new s(1).toRed(this),r[1]=t;for(var i=2;i<r.length;i++)r[i]=this.mul(r[i-1],t);var n=r[0],o=0,f=0,a=e.bitLength()%26;for(0===a&&(a=26),i=e.length-1;i>=0;i--){for(var c=e.words[i],h=a-1;h>=0;h--){var u=c>>h&1;n!==r[0]&&(n=this.sqr(n)),0!==u||0!==o?(o<<=1,o|=u,(4===++f||0===i&&0===h)&&(n=this.mul(n,r[o]),f=0,o=0)):f=0}a=26}return n},_.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},_.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},s.mont=function(t){return new x(t)},n(x,_),x.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},x.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},x.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var r=t.imul(e),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(i).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},x.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new s(0)._forceRed(this);var r=t.mul(e),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(i).iushrn(this.shift),o=n;return n.cmp(this.m)>=0?o=n.isub(this.m):n.cmpn(0)<0&&(o=n.iadd(this.m)),o._forceRed(this)},x.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(t,this)}).call(this,r(56)(t))},function(t,e,r){var i,n,s,o,f,a;t.exports=(a=r(2),n=(i=a).lib,s=n.Base,o=n.WordArray,(f=i.x64={}).Word=s.extend({init:function(t,e){this.high=t,this.low=e}}),f.WordArray=s.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,r=[],i=0;i<e;i++){var n=t[i];r.push(n.high),r.push(n.low)}return o.create(r,this.sigBytes)},clone:function(){for(var t=s.clone.call(this),e=t.words=this.words.slice(0),r=e.length,i=0;i<r;i++)e[i]=e[i].clone();return t}}),a)},function(t,e,r){"use strict";var i=r(12),n=r(7),s=n.getNAF,o=n.getJSF,f=n.assert;function a(t,e){this.type=t,this.p=new i(e.p,16),this.red=e.prime?i.red(e.prime):i.mont(this.p),this.zero=new i(0).toRed(this.red),this.one=new i(1).toRed(this.red),this.two=new i(2).toRed(this.red),this.n=e.n&&new i(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function c(t,e){this.curve=t,this.type=e,this.precomputed=null}t.exports=a,a.prototype.point=function(){throw new Error("Not implemented")},a.prototype.validate=function(){throw new Error("Not implemented")},a.prototype._fixedNafMul=function(t,e){f(t.precomputed);var r=t._getDoubles(),i=s(e,1,this._bitLength),n=(1<<r.step+1)-(r.step%2==0?2:1);n/=3;var o,a,c=[];for(o=0;o<i.length;o+=r.step){a=0;for(var h=o+r.step-1;h>=o;h--)a=(a<<1)+i[h];c.push(a)}for(var u=this.jpoint(null,null,null),d=this.jpoint(null,null,null),l=n;l>0;l--){for(o=0;o<c.length;o++)(a=c[o])===l?d=d.mixedAdd(r.points[o]):a===-l&&(d=d.mixedAdd(r.points[o].neg()));u=u.add(d)}return u.toP()},a.prototype._wnafMul=function(t,e){var r=4,i=t._getNAFPoints(r);r=i.wnd;for(var n=i.points,o=s(e,r,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var h=0;c>=0&&0===o[c];c--)h++;if(c>=0&&h++,a=a.dblp(h),c<0)break;var u=o[c];f(0!==u),a="affine"===t.type?u>0?a.mixedAdd(n[u-1>>1]):a.mixedAdd(n[-u-1>>1].neg()):u>0?a.add(n[u-1>>1]):a.add(n[-u-1>>1].neg())}return"affine"===t.type?a.toP():a},a.prototype._wnafMulAdd=function(t,e,r,i,n){var f,a,c,h=this._wnafT1,u=this._wnafT2,d=this._wnafT3,l=0;for(f=0;f<i;f++){var b=(c=e[f])._getNAFPoints(t);h[f]=b.wnd,u[f]=b.points}for(f=i-1;f>=1;f-=2){var p=f-1,m=f;if(1===h[p]&&1===h[m]){var g=[e[p],null,null,e[m]];0===e[p].y.cmp(e[m].y)?(g[1]=e[p].add(e[m]),g[2]=e[p].toJ().mixedAdd(e[m].neg())):0===e[p].y.cmp(e[m].y.redNeg())?(g[1]=e[p].toJ().mixedAdd(e[m]),g[2]=e[p].add(e[m].neg())):(g[1]=e[p].toJ().mixedAdd(e[m]),g[2]=e[p].toJ().mixedAdd(e[m].neg()));var w=[-3,-1,-5,-7,0,7,5,1,3],y=o(r[p],r[m]);for(l=Math.max(y[0].length,l),d[p]=new Array(l),d[m]=new Array(l),a=0;a<l;a++){var v=0|y[0][a],S=0|y[1][a];d[p][a]=w[3*(v+1)+(S+1)],d[m][a]=0,u[p]=g}}else d[p]=s(r[p],h[p],this._bitLength),d[m]=s(r[m],h[m],this._bitLength),l=Math.max(d[p].length,l),l=Math.max(d[m].length,l)}var E=this.jpoint(null,null,null),M=this._wnafT4;for(f=l;f>=0;f--){for(var A=0;f>=0;){var I=!0;for(a=0;a<i;a++)M[a]=0|d[a][f],0!==M[a]&&(I=!1);if(!I)break;A++,f--}if(f>=0&&A++,E=E.dblp(A),f<0)break;for(a=0;a<i;a++){var _=M[a];0!==_&&(_>0?c=u[a][_-1>>1]:_<0&&(c=u[a][-_-1>>1].neg()),E="affine"===c.type?E.mixedAdd(c):E.add(c))}}for(f=0;f<i;f++)u[f]=null;return n?E:E.toP()},a.BasePoint=c,c.prototype.eq=function(){throw new Error("Not implemented")},c.prototype.validate=function(){return this.curve.validate(this)},a.prototype.decodePoint=function(t,e){t=n.toArray(t,e);var r=this.p.byteLength();if((4===t[0]||6===t[0]||7===t[0])&&t.length-1==2*r)return 6===t[0]?f(t[t.length-1]%2==0):7===t[0]&&f(t[t.length-1]%2==1),this.point(t.slice(1,1+r),t.slice(1+r,1+2*r));if((2===t[0]||3===t[0])&&t.length-1===r)return this.pointFromX(t.slice(1,1+r),3===t[0]);throw new Error("Unknown point format")},c.prototype.encodeCompressed=function(t){return this.encode(t,!0)},c.prototype._encode=function(t){var e=this.curve.p.byteLength(),r=this.getX().toArray("be",e);return t?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",e))},c.prototype.encode=function(t,e){return n.encode(this._encode(e),t)},c.prototype.precompute=function(t){if(this.precomputed)return this;var e={doubles:null,naf:null,beta:null};return e.naf=this._getNAFPoints(8),e.doubles=this._getDoubles(4,t),e.beta=this._getBeta(),this.precomputed=e,this},c.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var e=this.precomputed.doubles;return!!e&&e.points.length>=Math.ceil((t.bitLength()+1)/e.step)},c.prototype._getDoubles=function(t,e){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],i=this,n=0;n<e;n+=t){for(var s=0;s<t;s++)i=i.dbl();r.push(i)}return{step:t,points:r}},c.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var e=[this],r=(1<<t)-1,i=1===r?null:this.dbl(),n=1;n<r;n++)e[n]=e[n-1].add(i);return{wnd:t,points:e}},c.prototype._getBeta=function(){return null},c.prototype.dblp=function(t){for(var e=this,r=0;r<t;r++)e=e.dbl();return e}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}},function(t,e,r){"use strict";(function(t){
/*!
 * elliptic.js - elliptic curves for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/elliptic:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/elliptic
 *
 * Formulas from DJB and Tanja Lange [EFD].
 *
 * References:
 *
 *   [GECC] Guide to Elliptic Curve Cryptography
 *     D. Hankerson, A. Menezes, and S. Vanstone
 *     https://tinyurl.com/guide-to-ecc
 *
 *   [GLV] Faster Point Multiplication on Elliptic Curves
 *     R. Gallant, R. Lambert, and S. Vanstone
 *     https://link.springer.com/content/pdf/10.1007/3-540-44647-8_11.pdf
 *
 *   [MONT1] Montgomery curves and the Montgomery ladder
 *     Daniel J. Bernstein, Tanja Lange
 *     https://eprint.iacr.org/2017/293.pdf
 *
 *   [SQUARED] Elligator Squared
 *     Mehdi Tibouchi
 *     https://eprint.iacr.org/2014/043.pdf
 *
 *   [SEC1] SEC 1 - Standards for Efficient Cryptography Group
 *     Certicom Research
 *     https://www.secg.org/sec1-v2.pdf
 *
 *   [SEC2] SEC 2: Recommended Elliptic Curve Domain Parameters
 *     Certicom Research
 *     https://www.secg.org/sec2-v2.pdf
 *
 *   [SIDE1] Elliptic Curves and Side-Channel Attacks
 *     Marc Joye
 *     https://pdfs.semanticscholar.org/8d69/9645033e25d74fcfd4cbf07a770d2e943e14.pdf
 *
 *   [BLIND] Side-Channel Analysis on Blinding Regular Scalar Multiplications
 *     B. Feix, M. Roussellet, A. Venelli
 *     https://eprint.iacr.org/2014/191.pdf
 *
 *   [ALT] Alternative Elliptic Curve Representations
 *     R. Struik
 *     https://tools.ietf.org/id/draft-ietf-lwig-curve-representations-02.html
 *
 *   [ARITH1] Arithmetic of Elliptic Curves
 *     Christophe Doche, Tanja Lange
 *     Handbook of Elliptic and Hyperelliptic Curve Cryptography
 *     Page 267, Section 13 (978-1-58488-518-4)
 *     https://hyperelliptic.org/HEHCC/index.html
 *
 *   [ARITH2] The Arithmetic of Elliptic Curves, 2nd Edition
 *     Joseph H. Silverman
 *     http://www.pdmi.ras.ru/~lowdimma/BSD/Silverman-Arithmetic_of_EC.pdf
 *
 *   [EFD] Explicit-Formulas Database
 *     Daniel J. Bernstein, Tanja Lange
 *     https://hyperelliptic.org/EFD/index.html
 *
 *   [SAFE] SafeCurves: choosing safe curves for elliptic-curve cryptography
 *     Daniel J. Bernstein
 *     https://safecurves.cr.yp.to/
 *
 *   [4GLV] Refinement of the Four-Dimensional GLV Method on Elliptic Curves
 *     Hairong Yi, Yuqing Zhu, and Dongdai Lin
 *     http://www.site.uottawa.ca/~cadams/papers/prepro/paper_19_slides.pdf
 *
 *   [SSWU1] Efficient Indifferentiable Hashing into Ordinary Elliptic Curves
 *     E. Brier, J. Coron, T. Icart, D. Madore, H. Randriam, M. Tibouchi
 *     https://eprint.iacr.org/2009/340.pdf
 *
 *   [SSWU2] Rational points on certain hyperelliptic curves over finite fields
 *     Maciej Ulas
 *     https://arxiv.org/abs/0706.1448
 *
 *   [H2EC] Hashing to Elliptic Curves
 *     A. Faz-Hernandez, S. Scott, N. Sullivan, R. S. Wahby, C. A. Wood
 *     https://git.io/JeWz6
 *     https://github.com/cfrg/draft-irtf-cfrg-hash-to-curve
 *
 *   [SVDW1] Construction of Rational Points on Elliptic Curves
 *     A. Shallue, C. E. van de Woestijne
 *     https://works.bepress.com/andrew_shallue/1/download/
 *
 *   [SVDW2] Indifferentiable Hashing to Barreto-Naehrig Curves
 *     Pierre-Alain Fouque, Mehdi Tibouchi
 *     https://www.di.ens.fr/~fouque/pub/latincrypt12.pdf
 *
 *   [SVDW3] Covert ECDH over secp256k1
 *     Pieter Wuille
 *     https://gist.github.com/sipa/29118d3fcfac69f9930d57433316c039
 *
 *   [MONT2] Montgomery Curve (wikipedia)
 *     https://en.wikipedia.org/wiki/Montgomery_curve
 *
 *   [MONT3] Montgomery Curves and their arithmetic
 *     C. Costello, B. Smith
 *     https://eprint.iacr.org/2017/212.pdf
 *
 *   [ELL2] Elliptic-curve points indistinguishable from uniform random strings
 *     D. Bernstein, M. Hamburg, A. Krasnova, T. Lange
 *     https://elligator.cr.yp.to/elligator-20130828.pdf
 *
 *   [RFC7748] Elliptic Curves for Security
 *     A. Langley, M. Hamburg, S. Turner
 *     https://tools.ietf.org/html/rfc7748
 *
 *   [TWISTED] Twisted Edwards Curves
 *     D. Bernstein, P. Birkner, M. Joye, T. Lange, C. Peters
 *     https://eprint.iacr.org/2008/013.pdf
 *
 *   [ELL1] Injective Encodings to Elliptic Curves
 *     P. Fouque, A. Joux, M. Tibouchi
 *     https://eprint.iacr.org/2013/373.pdf
 *
 *   [ISOGENY] Twisting Edwards curves with isogenies
 *     Mike Hamburg
 *     https://www.shiftleft.org/papers/isogeny/isogeny.pdf
 *
 *   [RFC8032] Edwards-Curve Digital Signature Algorithm (EdDSA)
 *     S. Josefsson, SJD AB, I. Liusvaara
 *     https://tools.ietf.org/html/rfc8032
 *
 *   [SCHNORR] Schnorr Signatures for secp256k1
 *     Pieter Wuille
 *     https://github.com/sipa/bips/blob/d194620/bip-schnorr.mediawiki
 *
 *   [BIP340] Schnorr Signatures for secp256k1
 *     Pieter Wuille, Jonas Nick, Tim Ruffing
 *     https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki
 *
 *   [JCEN12] Efficient Software Implementation of Public-Key Cryptography
 *            on Sensor Networks Using the MSP430X Microcontroller
 *     C. P. L. Gouvea, L. B. Oliveira, J. Lopez
 *     http://conradoplg.cryptoland.net/files/2010/12/jcen12.pdf
 *
 *   [FIPS186] Federal Information Processing Standards Publication
 *     National Institute of Standards and Technology
 *     https://tinyurl.com/fips-186-3
 *
 *   [RFC5639] Elliptic Curve Cryptography (ECC) Brainpool
 *             Standard Curves and Curve Generation
 *     M. Lochter, BSI, J. Merkle
 *     https://tools.ietf.org/html/rfc5639
 *
 *   [TWISTEQ] Twisted Edwards & Short Weierstrass Equivalence
 *     Christopher Jeffrey
 *     https://gist.github.com/chjj/16ba7fa08d64e8dda269a9fe5b2a8bbc
 *
 *   [ECPM] Elliptic Curve Point Multiplication (wikipedia)
 *     https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication
 */
const{custom:i}=r(74),n=r(6),s=0,o=1,f=2,a=3,c=[-3,-1,-5,-7,0,7,5,1,3];let h=0;class u{constructor(t,e,r){this.Point=null,this.id=null,this.uid=h++,this.ossl=null,this.type="base",this.endian="be",this.hash=null,this.prefix=null,this.context=!1,this.prime=null,this.p=null,this.red=null,this.fieldSize=0,this.fieldBits=0,this.adjustedSize=0,this.signBit=0,this.mask=0,this.n=null,this.h=null,this.q=null,this.z=null,this.g=null,this.nh=null,this.scalarSize=0,this.scalarBits=0,this.zero=null,this.one=null,this.two=null,this.three=null,this.four=null,this.i2=null,this.i3=null,this.i4=null,this.i6=null,this.torsion=null,this.endo=null,this.hi=null,this._init(t,e,r)}_init(e,r,i){N("function"==typeof e),N("string"==typeof r),N(i&&"object"==typeof i),N(null==i.red||i.red instanceof n.Red),N(null!=i.p,"Must pass a prime."),N(null==i.id||"string"==typeof i.id),N(null==i.ossl||"string"==typeof i.ossl),N(null==i.endian||"string"==typeof i.endian),N(null==i.hash||"string"==typeof i.hash),N(null==i.prefix||"string"==typeof i.prefix),N(null==i.context||"boolean"==typeof i.context),N(null==i.prime||"string"==typeof i.prime),N(null==i.torsion||Array.isArray(i.torsion)),this.Point=e,this.id=i.id||null,this.ossl=i.ossl||null,this.type=r,this.endian=i.endian||("short"===r?"be":"le"),this.hash=i.hash||null,this.prefix=i.prefix?t.from(i.prefix,"binary"):null,this.context=i.context||!1,this.prime=i.prime||null,this.p=n.fromJSON(i.p),i.red?this.red=i.red:(this.red=i.prime?n.red(i.prime):n.mont(this.p),this.red.precompute()),this.fieldSize=this.p.byteLength(),this.fieldBits=this.p.bitLength(),this.adjustedSize=this.fieldSize+(0==(7&this.fieldBits)),this.signBit=8*this.adjustedSize-1,this.mask=255,0!=(7&this.fieldBits)&&(this.mask=(1<<(7&this.fieldBits))-1),this.n=n.fromJSON(i.n||"0"),this.h=n.fromJSON(i.h||"1"),this.q=this.n.mul(this.h),this.z=n.fromJSON(i.z||"0").toRed(this.red),this.g=null,this.nh=this.n.ushrn(1),this.scalarSize=this.n.byteLength(),this.scalarBits=this.n.bitLength(),this.zero=new n(0).toRed(this.red),this.one=new n(1).toRed(this.red),this.two=new n(2).toRed(this.red),this.three=new n(3).toRed(this.red),this.four=new n(4).toRed(this.red),this.i2=this.two.redInvert(),this.i3=this.three.redInvert(),this.i4=this.i2.redSqr(),this.i6=this.i2.redMul(this.i3),this.torsion=new Array(this.h.word(0));for(let t=0;t<this.torsion.length;t++)this.torsion[t]=this.point();return this.endo=null,this.hi=null,this._scale=C(this._scale,this),this.isIsomorphic=C(this.isIsomorphic,this),this.isIsogenous=C(this.isIsogenous,this),N(this.p.sign()>0&&this.p.isOdd()),N(this.n.sign()>=0),N(this.h.sign()>0&&this.h.cmpn(255)<=0),N("be"===this.endian||"le"===this.endian),this}_finalize(t){if(N(t&&"object"==typeof t),this.g=t.g?this.pointFromJSON(t.g):this.point(),t.torsion){N(t.torsion.length===this.torsion.length);for(let e=0;e<this.torsion.length;e++)this.torsion[e]=this.pointFromJSON(t.torsion[e])}return this}_findTorsion(){N(!this.n.isZero());const t=this.h.word(0),e=this.one.redNeg(),r=[this.point()],i=new Set;let n=t;for(;r.length<n;){let t;e.redIAdd(this.one);try{t=this.pointFromX(e.clone())}catch(t){continue}try{t=t.mul(this.n)}catch(t){n=2;continue}if(!t.isInfinity()){t.normalize();for(const e of[t,t.neg()]){const t=e.key();i.has(t)||(r.push(e),i.add(t))}}}for(r.sort((t,e)=>t.cmp(e));r.length<t;)r.push(this.point());return r}_fixedMul(t,e){N(t instanceof d),N(e instanceof n),N(t.pre&&t.pre.windows);const{width:r,points:i}=t._getWindows(0,0),s=1<<r,o=(e.bitLength()+r-1)/r>>>0;let f=this.jpoint();for(let t=0;t<o;t++){const n=e.bits(t*r,r);f=f.add(i[t*s+n])}return e.isNeg()&&(f=f.neg()),f}_fixedNafMul(t,e){N(t instanceof d),N(e instanceof n),N(t.pre&&t.pre.doubles);const{step:r,points:i}=t._getDoubles(0,0),s=function(t,e,r,i){N(i>>>0===i);const n=z(t,e,r),s=Math.ceil(n.length/i),o=new Array(s);let f=0;for(let t=0;t<n.length;t+=i){let e=0;for(let r=t+i-1;r>=t;r--)e=(e<<1)+n[r];o[f++]=e}return N(f===s),o}(e,2,e.bitLength()+1,r),o=((1<<r+1)-(r%2==0?2:1))/3;let f=this.jpoint(),a=this.jpoint();for(let t=o;t>0;t--){for(let e=0;e<s.length;e++){const r=s[e];r===t?a=a.add(i[e]):r===-t&&(a=a.sub(i[e]))}f=f.add(a)}return f}_wnafMul(t,e,r){N(e instanceof d),N(r instanceof n);const{width:i,points:s}=e._safeNAF(t),o=z(r,i,r.bitLength()+1);let f=this.jpoint();for(let t=o.length-1;t>=0;t--){const e=o[t];t!==o.length-1&&(f=f.dbl()),e>0?f=f.add(s[e-1>>1]):e<0&&(f=f.sub(s[-e-1>>1]))}return f}_wnafMulAdd(t,e,r){N(t>>>0===t),N(Array.isArray(e)),N(Array.isArray(r)),N(e.length===r.length);const i=e.length,s=new Array(i),o=new Array(i);let f=0;for(let t=0;t<i;t++){const i=e[t],a=r[t];if(N(i instanceof d),N(a instanceof n),t>0&&i.type!==e[t-1].type)throw new Error("Cannot mix points.");s[t]=null,o[t]=null,f=Math.max(f,a.bitLength()+1)}let a=null,c=null,h=0;for(let t=0;t<i;t++){const i=e[t],n=r[t],u=i._getNAF(0);u?(s[h]=u.points,o[h]=z(n,u.width,f),h+=1):a?(s[h]=a._getJNAF(i),o[h]=q(c,n,f),a=null,c=null,h+=1):(a=i,c=n)}if(a){const e=a._safeNAF(t);s[h]=e.points,o[h]=z(c,e.width,f),h+=1}let u=this.jpoint();for(let t=f-1;t>=0;t--){t!==f-1&&(u=u.dbl());for(let e=0;e<h;e++){const r=o[e][t];r>0?u=u.add(s[e][r-1>>1]):r<0&&(u=u.sub(s[e][-r-1>>1]))}}return u}_endoWnafMulAdd(t,e){throw new Error("Not implemented.")}_scale(t,e){switch(N(t instanceof u),N(t.p.eq(this.p)),t.type){case"short":return this._scaleShort(t,e);case"mont":return this._scaleMont(t,e);case"edwards":return this._scaleEdwards(t,e);default:throw new Error("Not implemented.")}}_scaleShort(t,e){throw new Error("Not implemented.")}_scaleMont(t,e){throw new Error("Not implemented.")}_scaleEdwards(t,e){throw new Error("Not implemented.")}isElliptic(){throw new Error("Not implemented.")}jinv(){throw new Error("Not implemented.")}isComplete(){return!1}precompute(t){return N(!this.g.isInfinity(),"Must have base point."),N(!this.n.isZero(),"Must have order."),this.g.precompute(this.n.bitLength(),t),this}scalar(t,e,r){const i=new n(t,e,r);return N(!i.red),this.n.isZero()?i:i.imod(this.n)}field(t,e,r){const i=n.cast(t,e,r);return i.red?i.forceRed(this.red):i.toRed(this.red)}point(t,e){throw new Error("Not implemented.")}jpoint(t,e,r){throw new Error("Not implemented.")}xpoint(t,e){throw new Error("Not implemented.")}cpoint(t,e,r,i){if(N(t instanceof n),N(e instanceof n),N(r instanceof n),N(i instanceof n),e.isZero()||i.isZero())return this.point();const s=e.redMul(i).redInvert(),o=t.redMul(i).redMul(s),f=r.redMul(e).redMul(s);return this.point(o,f)}solveX2(t){throw new Error("Not implemented.")}solveX(t){return this.solveX2(t).redSqrt()}solveY2(t){throw new Error("Not implemented.")}solveY(t){return this.solveY2(t).redSqrt()}validate(t){throw new Error("Not implemented.")}pointFromX(t,e){throw new Error("Not implemented.")}pointFromY(t,e){throw new Error("Not implemented.")}isIsomorphic(t){throw new Error("Not implemented.")}isIsogenous(t){throw new Error("Not implemented.")}pointFromShort(t){throw new Error("Not implemented.")}pointFromMont(t,e){throw new Error("Not implemented.")}pointFromEdwards(t){throw new Error("Not implemented.")}pointFromUniform(t){throw new Error("Not implemented.")}pointToUniform(t){throw new Error("Not implemented.")}pointFromHash(e,r=!1){if(N(t.isBuffer(e)),N("boolean"==typeof r),e.length!==2*this.fieldSize)throw new Error("Invalid hash size.");const i=e.slice(0,this.fieldSize),n=e.slice(this.fieldSize),s=this.decodeUniform(i),o=this.decodeUniform(n),f=this.pointFromUniform(s),a=this.pointFromUniform(o),c=f.add(a);return r?c.mulH():c}pointToHash(e,r,i){N(e instanceof this.Point),N(r>>>0===r);const n=r%this.torsion.length,s=e.add(this.torsion[n]);for(;;){const e=this.randomField(i),r=this.pointFromUniform(e);if(r.neg().eq(r))continue;const n=s.sub(r),o=U(i);let f;try{f=this.pointToUniform(n,15&o)}catch(t){if("Invalid point."===t.message)continue;throw t}const a=this.encodeUniform(e,o>>>8),c=this.encodeUniform(f,o>>>16);return t.concat([a,c])}}randomScalar(t){const e=this.n.isZero()?this.p:this.n;return n.random(t,1,e)}randomField(t){return n.random(t,1,this.p).toRed(this.red)}randomPoint(t){let e;for(;;){const r=this.randomField(t),i=0!=(1&U(t));try{e=this.pointFromX(r,i)}catch(t){continue}return N(e.validate()),e.mulH()}}mulAll(t,e){return this.jmulAll(t,e)}jmulAll(t,e){return N(Array.isArray(t)),N(0===t.length||t[0]instanceof d),this.endo&&t.length>0&&t[0].type===s?this._endoWnafMulAdd(t,e):this._wnafMulAdd(5,t,e)}mulH(t){return N(t instanceof n),this.imulH(t.clone())}imulH(t){N(t instanceof n),N(!t.red);const e=this.h.word(0);if(0==(e&e-1)){const e=this.h.bitLength();return t.iushln(e-1).imod(this.n)}return t.imuln(e).imod(this.n)}normalizeAll(t){N(Array.isArray(t));const e=t.length,r=new Array(e);for(let i=0;i<e;i++){const e=t[i];N(e instanceof d),N(e.curve===this),e.type!==s?r[i]=e.z:r[i]=this.one}const i=this.red.invertAll(r),n=new Array(e);for(let r=0;r<e;r++)n[r]=t[r].scale(i[r]);return n}affinizeAll(t){return this.normalizeAll(t)}clamp(e){N(t.isBuffer(e)),N(e.length===this.scalarSize),N(this.scalarSize<=this.fieldSize);let r=7&this.fieldBits||8,i=0,n=this.scalarSize-1;return"be"===this.endian&&([i,n]=[n,i]),this.scalarSize<this.fieldSize&&(r=8),e[i]&=255&-this.h.word(0),e[n]&=(1<<r)-1,e[n]|=1<<r-1,e}splitHash(e){N(t.isBuffer(e)),N(e.length===2*this.adjustedSize),N(this.scalarSize<=this.adjustedSize);let r=0;"be"===this.endian&&(r=this.adjustedSize-this.scalarSize);const i=e.slice(r,r+this.scalarSize),n=e.slice(this.adjustedSize);return this.clamp(i),[i,n]}encodeField(t){return N(t instanceof n),N(!t.red),t.encode(this.endian,this.fieldSize)}decodeField(e){if(N(t.isBuffer(e)),e.length!==this.fieldSize)throw new Error("Invalid field element size.");return n.decode(e,this.endian)}encodeAdjusted(t){return N(t instanceof n),N(!t.red),t.encode(this.endian,this.adjustedSize)}decodeAdjusted(e){if(N(t.isBuffer(e)),e.length!==this.adjustedSize)throw new Error("Invalid field element size.");return n.decode(e,this.endian)}encodeScalar(t){return N(t instanceof n),N(!t.red),t.encode(this.endian,this.scalarSize)}decodeScalar(e){if(N(t.isBuffer(e)),e.length!==this.scalarSize)throw new Error("Invalid scalar size.");return n.decode(e,this.endian)}encodeClamped(t){return this.clamp(this.encodeScalar(t))}decodeClamped(e){if(N(t.isBuffer(e)),e.length!==this.scalarSize)throw new Error("Invalid scalar size.");const r=this.clamp(t.from(e));return n.decode(r,this.endian)}encodeUniform(t,e){N(t instanceof n),N(e>>>0===e);const r="le"===this.endian?this.fieldSize-1:0,i=t.fromRed().encode(this.endian,this.fieldSize);return i[r]|=e&~this.mask&255,i}decodeUniform(e){if(N(t.isBuffer(e)),e.length!==this.fieldSize)throw new Error("Invalid field size.");const r=n.decode(e,this.endian);return r.iumaskn(this.fieldBits),r.toRed(this.red)}encodePoint(t,e){return N(t instanceof d),t.encode(e)}decodePoint(t){throw new Error("Not implemented.")}encodeX(t){throw new Error("Not implemented.")}decodeX(t){throw new Error("Not implemented.")}decodeEven(t){throw new Error("Not implemented.")}decodeSquare(t){throw new Error("Not implemented.")}toShort(){throw new Error("Not implemented.")}toMont(t){throw new Error("Not implemented.")}toEdwards(t){throw new Error("Not implemented.")}pointToJSON(t,e){return N(t instanceof d),t.toJSON(e)}pointFromJSON(t){throw new Error("Not implemented.")}toJSON(t){let e,r,i,n,s;return"edwards"===this.type&&(e=this.prefix?this.prefix.toString():null,r=this.context),this.n.isZero()||(i=this.n.toJSON()),this.z.isZero()||(n=this.z.fromRed(),this.z.redIsHigh()&&n.isub(this.p),n=n.toString(16)),this.endo&&(s=this.endo.toJSON()),{id:this.id,ossl:this.ossl,type:this.type,endian:this.endian,hash:this.hash,prefix:e,context:r,prime:this.prime,p:this.p.toJSON(),a:void 0,b:void 0,d:void 0,n:i,h:this.h.toString(16),s:void 0,z:n,c:void 0,g:this.g.toJSON(t),endo:s}}static fromJSON(t){return new this(t)}}class d{constructor(t,e){N(t instanceof u),N(e>>>0===e),this.curve=t,this.type=e,this.pre=null}_init(){throw new Error("Not implemented.")}_safeNAF(t){if(N(t>>>0===t),this.pre&&this.pre.naf)return this.pre.naf;if(0===t)return null;const e=1<<t-2,r=new Array(e),i=this.toJ(),n=1===e?null:i.dbl();r[0]=i;for(let t=1;t<e;t++)r[t]=r[t-1].add(n);return new E(t,r)}_getNAF(t){if(N(t>>>0===t),this.pre&&this.pre.naf)return this.pre.naf;if(0===t)return null;const e=this._safeNAF(t).points,r=this.curve.affinizeAll(e);return new E(t,r)}_getWindows(t,e){if(N(t>>>0===t),N(e>>>0===e),this.pre&&this.pre.windows)return this.pre.windows;if(0===t)return null;const r=1<<t,i=(e+t-1)/t>>>0,n=new Array(i*r);let s=this.toJ();for(let e=0;e<i;e++){n[e*r]=this.curve.jpoint();for(let t=1;t<r;t++)n[e*r+t]=n[e*r+t-1].add(s);s=s.dblp(t)}const o=this.curve.affinizeAll(n);return new M(t,e,o)}_getDoubles(t,e){if(N(t>>>0===t),N(e>>>0===e),this.pre&&this.pre.doubles)return this.pre.doubles;if(0===t)return null;const r=Math.ceil(e/t)+1,i=new Array(r);let n=this.toJ(),s=0;i[s++]=n;for(let r=0;r<e;r+=t){for(let e=0;e<t;e++)n=n.dbl();i[s++]=n}N(s===r);const o=this.curve.affinizeAll(i);return new A(t,o)}_getBeta(){return null}_getBlinding(t){if(this.pre&&this.pre.blinding)return this.pre.blinding;if(!t)return null;if(this.curve.n.isZero())return null;const e=this.curve.randomScalar(t),r=this.mul(e);return new I(e,r)}_hasWindows(t){if(N(t instanceof n),!this.pre||!this.pre.windows)return!1;const{width:e,bits:r}=this.pre.windows,i=(r+e-1)/e>>>0;return t.bitLength()<=i*e}_hasDoubles(t){if(N(t instanceof n),!this.pre||!this.pre.doubles)return!1;const{step:e,points:r}=this.pre.doubles,i=t.bitLength()+1;return r.length>=Math.ceil(i/e)+1}_getJNAF(t){return N(t instanceof d),N(t.type===this.type),[this,this.add(t),this.sub(t),t]}_blind(t,e){if(N(t instanceof n),N(!t.red),this.pre&&this.pre.blinding){const{blind:e,unblind:r}=this.pre.blinding;return[this,t.sub(e),r]}if(!e)return[this,t,null];if(this.pre){if(this.curve.n.isZero())return[this,t,null];return[this,this.curve.randomScalar(e).mul(this.curve.n).iadd(t),null]}return[this.randomize(e),t,null]}clone(){throw new Error("Not implemented.")}precompute(t,e){return N(t>>>0===t),this.pre||(this.pre=new S),this.pre.naf||(this.pre.naf=this._getNAF(9)),this.pre.doubles||(this.pre.doubles=this._getDoubles(4,t+1)),this.pre.beta||(this.pre.beta=this._getBeta()),this.pre.blinding||(this.pre.blinding=this._getBlinding(e)),this}validate(){return this.curve.validate(this)}normalize(){return this}scale(t){throw new Error("Not implemented.")}randomize(t){const e=this.curve.randomField(t);return this.scale(e)}neg(){throw new Error("Not implemented.")}add(t){throw new Error("Not implemented.")}sub(t){return N(t instanceof d),this.add(t.neg())}dbl(){throw new Error("Not implemented.")}dblp(t){N(t>>>0===t);let e=this;for(let r=0;r<t;r++)e=e.dbl();return e}diffAddDbl(t,e){throw new Error("Not implemented.")}getX(){throw new Error("Not implemented.")}getY(){throw new Error("Not implemented.")}eq(t){throw new Error("Not implemented.")}cmp(t){throw new Error("Not implemented.")}isInfinity(){throw new Error("Not implemented.")}isOrder2(){throw new Error("Not implemented.")}isOdd(){throw new Error("Not implemented.")}isEven(){throw new Error("Not implemented.")}isSquare(){throw new Error("Not implemented.")}eqX(t){throw new Error("Not implemented.")}eqR(t){throw new Error("Not implemented.")}isSmall(){return!this.isInfinity()&&this.jmulH().isInfinity()}hasTorsion(){return!this.isInfinity()&&!this.jmul(this.curve.n).isInfinity()}order(){const{h:t,n:e}=this.curve;let r=this.toJ(),i=new n(1);for(;!r.isInfinity();){if(i.iaddn(1),i.cmp(t)>0){i=e.clone();break}r=r.add(this)}return i}mul(t){return this.jmul(t)}muln(t){return this.jmuln(t)}mulBlind(t,e){return this.jmulBlind(t,e)}mulAdd(t,e,r){return this.jmulAdd(t,e,r)}mulH(){return this.jmulH()}div(t){return this.jdiv(t)}divn(t){return this.jdivn(t)}divH(){return this.jdivH()}jmul(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo&&this.type===s?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(5,this,t)}jmuln(t){return N((0|t)===t),this.jmul(new n(t))}jmulBlind(t,e=null){const[r,i,n]=this._blind(t,e),s=r.jmul(i);return n?s.add(n):s}jmulAdd(t,e,r){return this.curve.endo&&this.type===s?this.curve._endoWnafMulAdd([this,e],[t,r]):this.curve._wnafMulAdd(5,[this,e],[t,r])}jmulH(){const t=this.curve.h.word(0);if(0==(t&t-1)){const t=this.curve.h.bitLength();return this.toJ().dblp(t-1)}return this.jmul(this.curve.h)}jdiv(t){return N(t instanceof n),N(!t.red),this.jmul(t.invert(this.curve.n))}jdivn(t){return N(!this.curve.n.isZero()),0===this.curve.h.cmpn(t)?this.jdivH():this.jdiv(new n(t))}jdivH(){return this.curve.n.isZero()||0===this.curve.h.cmpn(1)?this.toJ():(null===this.curve.hi&&(this.curve.hi=this.curve.h.invert(this.curve.n)),this.jmul(this.curve.hi))}toP(){return this.normalize()}toJ(){return this}toX(){return this}key(){if(this.isInfinity())return this.curve.uid+":oo";this.normalize();const t=this.getX().toString(16),e=this.getY().toString(16);return`${this.curve.uid}:${t},${e}`}encode(t){throw new Error("Not implemented.")}static decode(t,e){throw new Error("Not implemented.")}encodeX(){throw new Error("Not implemented.")}static decodeX(t,e){throw new Error("Not implemented.")}static decodeEven(t,e){throw new Error("Not implemented.")}static decodeSquare(t,e){throw new Error("Not implemented.")}toJSON(t){throw new Error("Not implemented.")}static fromJSON(t,e){throw new Error("Not implemented.")}[i](){return"<Point>"}}class l extends u{constructor(t){super(b,"short",t),this.a=n.fromJSON(t.a).toRed(this.red),this.b=n.fromJSON(t.b).toRed(this.red),this.c=n.fromJSON(t.c||"0").toRed(this.red),this.ai=this.a.isZero()?this.zero:this.a.redInvert(),this.zi=this.z.isZero()?this.zero:this.z.redInvert(),this.zeroA=this.a.isZero(),this.threeA=this.a.eq(this.three.redNeg()),this.redN=this.n.toRed(this.red),this.pmodn=this.p.clone(),this.highOrder=this.n.cmp(this.p)>=0,this.smallGap=!1,this._finalize(t)}_finalize(t){return super._finalize(t),null!=t.endo?this.endo=_.fromJSON(this,t.endo):this.endo=this._getEndomorphism(),this.n.isZero()||(this.pmodn=this.p.mod(this.n),this.smallGap=this.p.div(this.n).cmpn(1)<=0),this}static _isomorphism(t,e,r,i){if(N(t instanceof n),N(e instanceof n),N(r instanceof n),N(null==i||"boolean"==typeof i),N(!t.isZero()||!e.isZero()),r.isZero())throw new Error("Invalid coefficient.");if(t.isZero()){const i=r;return N(1===O(i.redDiv(e)).redJacobi()),[t.clone(),i.clone()]}if(e.isZero()){const i=r,n=i.redDiv(t).redSqrt();if(1!==n.redJacobi()&&n.redINeg(),1!==n.redJacobi())throw new Error("Invalid `a` coefficient.");return[i.clone(),e.clone()]}const s=r,o=s.redDiv(t),f=o.redSqrt();if(null!=i?f.redIsOdd()!==i&&f.redINeg():1!==f.redJacobi()&&f.redINeg(),1!==f.redJacobi())throw new Error("Invalid `a` coefficient.");const a=o.redMul(f),c=t.redMul(o),h=e.redMul(a);return N(c.eq(s)),[c,h]}_short(t,e){return l._isomorphism(this.a,this.b,t,e)}_mont(t,e){const[r,i]=this._findRS(e),n=i.redInvert(),s=r.redMuln(3).redMul(n);return null!=t?m._isomorphism(s,n,t):[s,n]}_edwards(t,e){const[r,i]=this._findRS(e),n=r.redMuln(3),s=i.redMuln(2),o=n.redAdd(s),f=n.redSub(s);return null!=t?y._isomorphism(o,f,t):[o,f]}_findRS(t){N(null==t||"boolean"==typeof t),N(this.h.word(0)>=4),N(!this.n.isZero());const e=this.one.redNeg();let r;for(;;){e.redIAdd(this.one);try{r=this.pointFromX(e.clone())}catch(t){continue}if(r=r.mul(this.n),!r.isInfinity()&&r.y.isZero())break}const i=r.x,n=i.redSqr().redMuln(3).redIAdd(this.a).redSqrt();return null!=t&&n.redIsOdd()!==t&&n.redINeg(),[i,n]}_scale0(t,e){if(N(this.a.isZero()===t.isZero()),N(this.b.isZero()===e.isZero()),this.a.isZero()){const t=this.b.redDiv(this.field(e)),r=O(t),i=r.redSqrt(),n=r.redMul(i);return N(n.redSqr().eq(t)),N(!i.isZero()),[r,n]}if(this.b.isZero()){const e=this.a.redDiv(this.field(t)),r=e.redSqrt();1!==r.redJacobi()&&r.redINeg();const i=r.redSqrt(),n=r.redMul(i);return N(n.redMul(i).eq(e)),N(!i.isZero()),[r,n]}const r=this.a.redDiv(this.field(t)),i=this.b.redDiv(this.field(e)),n=r.redSqrt();r.redMul(n).eq(i)||n.redINeg(),N(r.redMul(n).eq(i));const s=n.redSqrt(),o=n.redMul(s);return N(!s.isZero()),[n,o]}_scale1(t,e){const r=this.g.x.redDiv(this.field(t)),i=this.g.y.redDiv(this.field(e)),n=r.redSqrt();return r.redMul(n).eq(i)||n.redINeg(),N(r.redMul(n).eq(i)),N(!n.isZero()),[r,i]}_scaleShort(t){return N(t instanceof l),this.g.isInfinity()||t.g.isInfinity()?this._scale0(t.a,t.b):this._scale1(t.g.x,t.g.y)}_scaleMont(t){if(N(t instanceof m),this.g.isInfinity()||t.g.isInfinity()){const[e,r]=t._short();return this._scale0(e,r)}const{x:e,y:r}=t.g,i=e.redAdd(t.a3).redMul(t.bi),n=r.redMul(t.bi);return this._scale1(i,n)}_scaleEdwards(t){if(N(t instanceof y),this.g.isInfinity()||t.g.isInfinity()){const[e,r]=t._short();return this._scale0(e,r)}const{x:e,y:r,z:i}=t.g,n=t.a.redMuln(5),s=t.d.redMuln(5),o=t.d.redSub(t.a),f=s.redSub(t.a),a=t.d.redSub(n),c=r.redAdd(i),h=r.redSub(i),u=f.redMul(r).redIAdd(a.redMul(i)),d=h.redMuln(12),l=o.redMul(c).redMul(i),b=h.redMul(e).redIMuln(4),p=d.redMul(b).redInvert(),m=u.redMul(b).redMul(p),g=l.redMul(d).redMul(p);return this._scale1(m,g)}_getEndomorphism(t=0){if(this.n.isZero()||this.g.isInfinity())return null;if(!this.zeroA||1!==this.p.modrn(3)||1!==this.n.modrn(3))return null;const[e,r]=this._getEndoRoots(this.p),i=[e,r][1&t].toRed(this.red),[n,s]=this._getEndoRoots(this.n),o=this.point(this.g.x.redMul(i),this.g.y);let f;this.g.mul(n).eq(o)?f=n:(N(this.g.mul(s).eq(o)),f=s);const a=this._getEndoBasis(f),c=this._getEndoPrecomp(a);return new _(i,f,a,c)}_getEndoRoots(t){const e=t===this.p?this.red:n.mont(t),r=new n(2).toRed(e),i=new n(3).toRed(e),s=r.redInvert(),o=i.redNeg().redSqrt().redMul(s),f=o.redNeg();return[o.redSub(s).fromRed(),f.redSub(s).fromRed()].sort(n.cmp)}_getEndoBasis(t){const[e,r,i,n,s,o]=this._egcdSqrt(t),f=i,a=n.neg(),c=e.sqr().iadd(r.sqr()),h=s.sqr().iadd(o.sqr());let u,d;return c.cmp(h)<=0?(u=e,d=r.neg()):(u=s,d=o.neg()),[new x(f,a),new x(u,d)]}_egcdSqrt(t){N(t instanceof n),N(!t.red),N(t.sign()>0),N(this.n.sign()>0);const e=this.n.ushrn(this.n.bitLength()>>>1);let r,i,s,o,f,a=t,c=this.n.clone(),h=new n(1),u=new n(0),d=new n(0),l=new n(1),b=0,p=0;for(;!a.isZero()&&b<2;){const t=c.quo(a),n=c.sub(t.mul(a)),m=d.sub(t.mul(h)),g=l.sub(t.mul(u));0===p&&n.cmp(e)<0&&(r=f,i=h,s=n,o=m,p=1),f=n,c=a,a=n,d=h,h=m,l=u,u=g,b+=p}N(0!==p,"Could not find r < sqrt(n).");return[r,i,s,o,d,h]}_getEndoPrecomp(t){N(Array.isArray(t)),N(2===t.length),N(t[0]instanceof x),N(t[1]instanceof x);const[e,r]=t,i=e.a.mul(r.b).isub(e.b.mul(r.a)),n=i.bitLength(),s=n>=160;N(i.eq(this.n));let o,f,a=n+Math.ceil(n/2)+1;for(s&&(a-=63&a);a>n&&(o=r.b.ushln(a).divRound(i),f=e.b.ushln(a).divRound(i),!(o.ucmp(i)<0&&f.ucmp(i)<0));)a-=s?64:1;if(a<=n)throw new Error("Could not calculate g1 and g2.");return[a,o,f]}_endoSplit(t){N(t instanceof n),N(!t.red),N(!this.n.isZero());const[e,r]=this.endo.basis,i=r.b.mul(t).divRound(this.n),s=e.b.neg().mul(t).divRound(this.n),o=i.mul(e.a),f=s.mul(r.a),a=i.ineg().mul(e.b),c=s.mul(r.b);return[t.sub(o).isub(f),a.isub(c)]}_endoBeta(t){return N(t instanceof b),[t,t._getBeta()]}_endoWnafMulAdd(t,e){N(Array.isArray(t)),N(Array.isArray(e)),N(t.length===e.length),N(null!=this.endo);const r=t.length,i=new Array(2*r),n=new Array(2*r);for(let s=0;s<r;s++){const[r,o]=this._endoBeta(t[s]),[f,a]=this._endoSplit(e[s]);i[2*s+0]=r,n[2*s+0]=f,i[2*s+1]=o,n[2*s+1]=a}return this._wnafMulAdd(5,i,n)}_sswu(t){const{b:e,z:r,ai:i,zi:n,one:s}=this,o=r.redSqr(),f=e.redNeg().redMul(i),a=e.redMul(n).redMul(i),c=t.redSqr(),h=c.redSqr(),u=o.redMul(h).redIAdd(r.redMul(c)),d=u.isZero()?u:u.redInvert(),l=d.isZero()?a:f.redMul(s.redAdd(d)),b=r.redMul(c).redMul(l),p=this.solveY2(l),m=this.solveY2(b),g=0|p.redIsSquare(),w=[l,b][1^g],y=[p,m][1^g].redSqrt();return y.redIsOdd()!==t.redIsOdd()&&y.redINeg(),this.point(w,y)}_sswui(t,e){const{a:r,b:i,z:n}=this,{x:s,y:o}=t,f=3&e,a=r.redSqr().redMul(s.redSqr()),c=r.redMul(i).redMul(s).redIMuln(2),h=i.redSqr().redMuln(3),u=r.redMul(s).redIAdd(i),d=a.redISub(c).redISub(h).redSqrt(),l=u.redSub(d).redINeg(),b=u.redAdd(d).redINeg(),p=[u.redMul(n).redIMuln(2),i.redMul(n).redIMuln(2)][f>>>1],m=[l,b][1&f].redDivSqrt(p);return m.redIsOdd()!==o.redIsOdd()&&m.redINeg(),m}_svdwf(t){const{c:e,z:r,zi:i,i2:n,i3:s}=this,o=this.solveY2(r),f=s.redMul(i.redSqr()),a=t.redSqr(),c=a.redSqr(),h=a.redAdd(o),u=a.redMul(h),d=u.isZero()?u:u.redInvert(),l=c.redMul(d).redMul(e),b=h.redSqr().redMul(h),p=e.redSub(r).redMul(n).redISub(l),m=l.redSub(e.redAdd(r).redMul(n)),g=r.redSub(b.redMul(d).redMul(f)),w=this.solveY2(p),y=this.solveY2(m),v=this.solveY2(g),S=function(t,e){let r=t%e;r<0&&(e<0?r-=e:r+=e);return r}(((1|w.redJacobi())-1)*(1|y.redJacobi()),3);return[[p,m,g][S],[w,y,v][S]]}_svdw(t){const[e,r]=this._svdwf(t),i=r.redSqrt();return i.redIsOdd()!==t.redIsOdd()&&i.redINeg(),this.point(e,i)}_svdwi(t,e){const{b:r,c:i,z:n,zero:s,two:o}=this,{x:f,y:a}=t,c=3&e,h=n.redSqr(),u=h.redMul(n),d=h.redSqr(),l=u.redAdd(r),b=l.redMuln(2),p=f.redSqr(),m=f.redMuln(2).redIAdd(n),g=f.redMul(h),w=i.redSub(m),y=i.redAdd(m),v=p.redMul(h).redIAdd(d).redIMuln(9),S=f.redMul(u).redIMuln(18),E=l.redMul(f.redSub(n)).redIMuln(12),M=(c>=2?v.redISub(S).redIAdd(E).redSqrt():s).redMul(n),A=u.redISub(g).redIMuln(3).redISub(b),I=l.redMul(w),_=l.redMul(y),x=A.redAdd(M),B=A.redSub(M),k=[y,w,o,o][c],z=[I,_,x,B][c].redDivSqrt(k),[q]=this._svdwf(z);if(!q.eq(f))throw new Error("Invalid point.");return z.redIsOdd()!==a.redIsOdd()&&z.redINeg(),z}isElliptic(){const{a:t,b:e}=this,r=t.redSqr().redMul(t);return!e.redSqr().redMuln(27).redIAdd(r.redMuln(4)).isZero()}jinv(){const{a:t,b:e}=this,r=t.redSqr().redMul(t),i=e.redSqr(),n=r.redMuln(4),s=n.redMuln(1728),o=i.redMuln(27).redIAdd(n);if(o.isZero())throw new Error("Curve is not elliptic.");return s.redDiv(o).fromRed()}point(t,e){return new b(this,t,e)}jpoint(t,e,r){return new p(this,t,e,r)}solveX(t){if(N(t instanceof n),!this.a.isZero())throw new Error("Not implemented.");return R(t.redSqr().redSub(this.b))}solveY2(t){N(t instanceof n);const e=t.redSqr().redMul(t).redIAdd(this.b);return this.zeroA||(this.threeA?e.redIAdd(t.redMuln(-3)):e.redIAdd(this.a.redMul(t))),e}validate(t){if(N(t instanceof b),t.inf)return!0;const{x:e,y:r}=t,i=this.solveY2(e);return r.redSqr().eq(i)}pointFromX(t,e=null){N(t instanceof n),N(null==e||"boolean"==typeof e),t.red||(t=t.toRed(this.red));const r=this.solveY(t);if(null!=e){if(this.h.cmpn(1)>0&&r.isZero()&&e)throw new Error("Invalid point.");r.redIsOdd()!==e&&r.redINeg()}return this.point(t,r)}pointFromY(t,e=0){N(t instanceof n),N(e>>>0===e),t.red||(t=t.toRed(this.red));const r=this.solveX(t);if(e>=r.length)throw new Error("Invalid X coordinate index.");const i=r[e];return this.point(i,t)}isIsomorphic(t){if(N(t instanceof u),!t.p.eq(this.p))return!1;let e,r;try{[e,r]=this._scale(t)}catch(t){return!1}if("short"===t.type){const i=this.field(t.a).redMul(e.redSqr()),n=this.field(t.b).redMul(r.redSqr());return this.a.eq(i)&&this.b.eq(n)}if("mont"===t.type){const{a3:r,bi:i}=t,n=this.field(r.redMul(i)).redMul(e);return this.solveY2(n).isZero()}if("edwards"===t.type){const r=this.field(t.ad6).redMul(e);return this.solveY2(r).isZero()}return!1}isIsogenous(t){return N(t instanceof u),!1}pointFromShort(t){if(N(t instanceof b),this.isIsomorphic(t.curve)){if(t.isInfinity())return this.point();const[e,r]=this._scale(t.curve),i=this.field(t.x),n=this.field(t.y),s=i.redMul(e),o=n.redMul(r);return this.point(s,o)}throw new Error("Not implemented.")}pointFromMont(t){if(N(t instanceof g),this.isIsomorphic(t.curve)){if(t.isInfinity())return this.point();const{a3:e,bi:r}=t.curve,[i,n]=this._scale(t.curve),s=t.x.redAdd(e).redMul(r),o=t.y.redMul(r);return this.point(this.field(s).redMul(i),this.field(o).redMul(n))}throw new Error("Not implemented.")}pointFromEdwards(t){if(N(t instanceof v),this.isIsomorphic(t.curve)){const{a:e,d:r,ad6:i}=t.curve,[n,s]=this._scale(t.curve);if(t.isInfinity())return this.point();if(t.x.isZero()){const t=this.field(i).redMul(n);return this.point(t,this.zero)}const{x:o,y:f,z:a}=t,c=e.redMuln(5),h=r.redMuln(5),u=r.redSub(e),d=h.redSub(e),l=r.redSub(c),b=f.redAdd(a),p=f.redSub(a),m=d.redMul(f).redIAdd(l.redMul(a)),g=p.redMuln(12),w=u.redMul(b).redMul(a),y=p.redMul(o).redIMuln(4);return this.cpoint(this.field(m).redMul(n),this.field(g),this.field(w).redMul(s),this.field(y))}throw new Error("Not implemented.")}pointFromUniform(t){if(N(t instanceof n),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(!this.a.isZero())return this._sswu(t);if(!this.c.isZero())return this._svdw(t);throw new Error("Not implemented.")}pointToUniform(t,e){if(N(t instanceof b),N(e>>>0===e),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(t.isInfinity())throw new Error("Invalid point.");const r=(e>>>4&15)%this.torsion.length,i=t.add(this.torsion[r]);return P(()=>{if(!this.a.isZero())return this._sswui(i,e);if(!this.c.isZero())return this._svdwi(i,e);throw new Error("Not implemented.")})}mulAll(t,e){return super.mulAll(t,e).toP()}affinizeAll(t){const e=this.normalizeAll(t);for(let t=0;t<e.length;t++)e[t]=e[t].toP();return e}decodePoint(t){return b.decode(this,t)}encodeX(t){return N(t instanceof d),t.encodeX()}decodeEven(t){return b.decodeEven(this,t)}decodeSquare(t){return b.decodeSquare(this,t)}toShort(t,e,r=null){const[i,n]=this._short(t,e),s=new l({red:this.red,prime:this.prime,p:this.p,a:i,b:n,n:this.n,h:this.h});if(null!=r){const[,t]=s._scale(this);t.redIsOdd()!==r&&t.redINeg()}this.g.isInfinity()||(s.g=s.pointFromShort(this.g));for(let t=0;t<this.h.word(0);t++)s.torsion[t]=s.pointFromShort(this.torsion[t]);return s}toMont(t,e,r=null){const[i,n]=this._mont(t,e),s=new m({red:this.red,prime:this.prime,p:this.p,a:i,b:n,n:this.n,h:this.h});if(null!=r){const[,t]=this._scale(s);t.redIsOdd()!==r&&t.redINeg()}this.g.isInfinity()||(s.g=s.pointFromShort(this.g));for(let t=0;t<this.h.word(0);t++)s.torsion[t]=s.pointFromShort(this.torsion[t]);return s}toEdwards(t,e,r=null){const[i,n]=this._edwards(t,e),s=new y({red:this.red,prime:this.prime,p:this.p,a:i,d:n,n:this.n,h:this.h});if(null!=r){const[,t]=this._scale(s);t.redIsOdd()!==r&&t.redINeg()}if(this.g.isInfinity()||(s.g=s.pointFromShort(this.g),s.g.normalize()),s.isComplete())for(let t=0;t<this.h.word(0);t++)s.torsion[t]=s.pointFromShort(this.torsion[t]),s.torsion[t].normalize();return s}pointFromJSON(t){return b.fromJSON(this,t)}toJSON(t){const e=super.toJSON(t);return e.a=this.a.fromRed().toJSON(),e.b=this.b.fromRed().toJSON(),this.c.isZero()||(e.c=this.c.fromRed().toJSON()),e}}class b extends d{constructor(t,e,r){N(t instanceof l),super(t,s),this.x=this.curve.zero,this.y=this.curve.zero,this.inf=!0,null!=e&&this._init(e,r)}_init(t,e){N(t instanceof n),N(e instanceof n),this.x=t,this.y=e,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1}_getBeta(){if(!this.curve.endo)return null;if(this.pre&&this.pre.beta)return this.pre.beta;const t=this.x.redMul(this.curve.endo.beta),e=this.curve.point(t,this.y);return this.pre&&(e.pre=this.pre.map(t=>{const e=t.x.redMul(this.curve.endo.beta);return this.curve.point(e,t.y)}),this.pre.beta=e),e}_getJNAF(t){if(N(t instanceof b),this.inf||t.inf)return super._getJNAF(t);const e=[this,null,null,t];return this.y.eq(t.y)?(e[1]=this.add(t),e[2]=this.toJ().sub(t)):this.y.eq(t.y.redNeg())?(e[1]=this.toJ().add(t),e[2]=this.sub(t)):(e[1]=this.toJ().add(t),e[2]=this.toJ().sub(t)),e}clone(){return this.inf?this.curve.point():this.curve.point(this.x,this.y)}scale(t){return this.toJ().scale(t)}neg(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}add(t){if(N(t instanceof b),this.inf)return t;if(t.inf)return this;if(this.x.eq(t.x))return this.y.eq(t.y)?this.dbl():this.curve.point();if(this.y.eq(t.y)){const e=this.x.redNeg().redISub(t.x),r=this.y.redNeg();return this.curve.point(e,r)}const e=this.x.redSub(t.x),r=this.y.redSub(t.y).redDiv(e),i=r.redSqr().redISub(this.x).redISub(t.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)}dbl(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();const t=this.x.redSqr().redIMuln(3).redIAdd(this.curve.a),e=this.y.redMuln(2),r=t.redDiv(e),i=r.redSqr().redISub(this.x).redISub(this.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)}dblp(t){return this.toJ().dblp(t).toP()}getX(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}getY(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}eq(t){return N(t instanceof b),this===t||(this.inf?t.inf:!t.inf&&(this.x.eq(t.x)&&this.y.eq(t.y)))}cmp(t){return N(t instanceof b),this.inf&&!t.inf?-1:!this.inf&&t.inf?1:this.inf&&t.inf?0:this.order().cmp(t.order())||this.getX().cmp(t.getX())||this.getY().cmp(t.getY())}isInfinity(){return this.inf}isOrder2(){return!this.inf&&this.y.isZero()}isOdd(){return!this.inf&&this.y.redIsOdd()}isEven(){return!this.inf&&this.y.redIsEven()}isSquare(){return!this.inf&&-1!==this.y.redJacobi()}eqX(t){return N(t instanceof n),N(!t.red),!this.inf&&this.getX().eq(t)}eqR(t){return N(t instanceof n),N(!t.red),N(!this.curve.n.isZero()),!this.inf&&this.getX().imod(this.curve.n).eq(t)}mul(t){return super.mul(t).toP()}muln(t){return super.muln(t).toP()}mulBlind(t,e){return super.mulBlind(t,e).toP()}mulAdd(t,e,r){return super.mulAdd(t,e,r).toP()}mulH(){return super.mulH().toP()}div(t){return super.div(t).toP()}divn(t){return super.divn(t).toP()}divH(){return super.divH().toP()}toP(){return this}toJ(){return this.inf?this.curve.jpoint():this.curve.jpoint(this.x,this.y,this.curve.one)}encode(e){null==e&&(e=!0),N("boolean"==typeof e);const{fieldSize:r}=this.curve;if(this.inf)throw new Error("Invalid point.");if(e){const e=t.alloc(1+r),i=this.curve.encodeField(this.getX());return e[0]=2|this.y.redIsOdd(),i.copy(e,1),e}const i=t.alloc(1+2*r),n=this.curve.encodeField(this.getX()),s=this.curve.encodeField(this.getY());return i[0]=4,n.copy(i,1),s.copy(i,1+r),i}static decode(e,r){N(e instanceof l),N(t.isBuffer(r));const i=e.fieldSize;if(r.length<1+i)throw new Error("Not a point.");const n=r[0];switch(n){case 2:case 3:{if(r.length!==1+i)throw new Error("Invalid point size for compressed.");const t=e.decodeField(r.slice(1,1+i));if(t.cmp(e.p)>=0)throw new Error("Invalid point.");const s=e.pointFromX(t,3===n);return N(!s.isInfinity()),s}case 4:case 6:case 7:{if(r.length!==1+2*i)throw new Error("Invalid point size for uncompressed.");const t=e.decodeField(r.slice(1,1+i)),s=e.decodeField(r.slice(1+i,1+2*i));if(t.cmp(e.p)>=0||s.cmp(e.p)>=0)throw new Error("Invalid point.");if(4!==n&&n!==(6|s.isOdd()))throw new Error("Invalid hybrid encoding.");const o=e.point(t,s);if(!o.validate())throw new Error("Invalid point.");return N(!o.isInfinity()),o}default:throw new Error("Unknown point format.")}}encodeX(){return this.curve.encodeField(this.getX())}static decodeEven(t,e){N(t instanceof l);const r=t.decodeField(e);if(r.cmp(t.p)>=0)throw new Error("Invalid point.");return t.pointFromX(r,!1)}static decodeSquare(t,e){N(t instanceof l);const r=t.decodeField(e);if(r.cmp(t.p)>=0)throw new Error("Invalid point.");return t.pointFromX(r)}toJSON(t){if(this.inf)return[];const e=this.getX().toJSON(),r=this.getY().toJSON();return!0===t&&this.pre?[e,r,this.pre.toJSON()]:[e,r]}toPretty(){if(this.inf)return[];const t=2*this.curve.fieldSize;return[T(this.getX(),t),T(this.getY(),t)]}static fromJSON(t,e){if(N(t instanceof l),N(Array.isArray(e)),N(0===e.length||2===e.length||3===e.length),0===e.length)return t.point();const r=n.fromJSON(e[0]),i=n.fromJSON(e[1]),s=t.point(r,i);return e.length>2&&null!=e[2]&&(s.pre=S.fromJSON(s,e[2])),s}[i](){return this.inf?"<ShortPoint: Infinity>":"<ShortPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}}class p extends d{constructor(t,e,r,i){N(t instanceof l),super(t,o),this.x=this.curve.one,this.y=this.curve.one,this.z=this.curve.zero,this.zOne=!1,null!=e&&this._init(e,r,i)}_init(t,e,r){N(t instanceof n),N(e instanceof n),N(null==r||r instanceof n),this.x=t,this.y=e,this.z=r||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z.eq(this.curve.one)}clone(){return this.curve.jpoint(this.x,this.y,this.z)}validate(){const{a:t,b:e}=this.curve;if(this.isInfinity())return!0;if(this.zOne)return this.curve.validate(this.toP());const r=this.y.redSqr(),i=this.x.redSqr().redMul(this.x),n=this.z.redSqr(),s=n.redSqr(),o=s.redMul(n),f=i.redIAdd(e.redMul(o));return this.curve.zeroA||(this.curve.threeA?f.redIAdd(s.redIMuln(-3).redMul(this.x)):f.redIAdd(t.redMul(s).redMul(this.x))),r.eq(f)}normalize(){if(this.zOne)return this;if(this.isInfinity())return this;const t=this.z.redInvert(),e=t.redSqr();return this.x=this.x.redMul(e),this.y=this.y.redMul(e).redMul(t),this.z=this.curve.one,this.zOne=!0,this}scale(t){if(N(t instanceof n),this.isInfinity())return this.curve.jpoint();const e=t.redSqr(),r=this.x.redMul(e),i=this.y.redMul(e).redMul(t),s=this.z.redMul(t);return this.curve.jpoint(r,i,s)}neg(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)}add(t){return N(t instanceof d),t.type===s?this._mixedAdd(t):this._add(t)}_add(t){return N(t instanceof p),this.isInfinity()?t:t.isInfinity()?this:this.zOne?t._addJA(this):t.zOne?this._addJA(t):this._addJJ(t)}_mixedAdd(t){return N(t instanceof b),this.isInfinity()?t.toJ():t.isInfinity()?this:this._addJA(t)}_addJJ(t){const e=this.z.redSqr(),r=t.z.redSqr(),i=this.x.redMul(r),n=t.x.redMul(e),s=this.y.redMul(t.z).redMul(r),o=t.y.redMul(this.z).redMul(e),f=n.redISub(i),a=o.redISub(s);if(f.isZero())return a.isZero()?this.dbl():this.curve.jpoint();const c=f.redSqr(),h=f.redMul(c),u=i.redMul(c),d=a.redSqr().redISub(h).redISub(u).redISub(u),l=a.redMul(u.redISub(d)).redISub(s.redMul(h)),b=this.z.redMul(t.z).redMul(f);return this.curve.jpoint(d,l,b)}_addJA(t){const e=this.z.redSqr(),r=t.x.redMul(e),i=t.y.redMul(this.z).redMul(e),n=r.redISub(this.x),s=i.redISub(this.y).redIMuln(2);if(n.isZero())return s.isZero()?this.dbl():this.curve.jpoint();const o=n.redMuln(2).redSqr(),f=n.redMul(o),a=this.x.redMul(o),c=s.redSqr().redISub(f).redISub(a).redISub(a),h=s.redMul(a.redISub(c)).redISub(this.y.redMul(f).redIMuln(2)),u=this.z.redMul(n).redIMuln(2);return this.curve.jpoint(c,h,u)}dbl(){return this.isInfinity()?this:this.y.isZero()?this.curve.jpoint():this.curve.zeroA?this._dbl0():this.curve.threeA?this._dbl3():this._dblJ()}_dblJ(){const t=this.x.redSqr(),e=this.y.redSqr(),r=this.z.redSqr(),i=this.x.redMul(e).redIMuln(4),n=t.redIMuln(3).redIAdd(this.curve.a.redMul(r.redSqr())),s=n.redSqr().redISub(i).redISub(i),o=s,f=n.redMul(i.redISub(s)).redISub(e.redSqr().redIMuln(8)),a=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(o,f,a)}_dbl0(){const t=this.x.redSqr(),e=this.y.redSqr(),r=e.redSqr(),i=e.redIAdd(this.x).redSqr().redISub(t).redISub(r).redIMuln(2),n=t.redIMuln(3),s=n.redSqr().redISub(i).redISub(i),o=n.redMul(i.redISub(s)).redISub(r.redIMuln(8)),f=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(s,o,f)}_dbl3(){const t=this.z.redSqr(),e=this.y.redSqr(),r=this.x.redMul(e),i=this.x.redSub(t),n=this.x.redAdd(t),s=i.redMul(n).redIMuln(3),o=r.redIMuln(4),f=o.redMuln(2),a=e.redSqr().redIMuln(8),c=s.redSqr().redISub(f),h=this.y.redAdd(this.z).redSqr().redISub(e).redISub(t),u=s.redMul(o.redISub(c)).redISub(a);return this.curve.jpoint(c,u,h)}getX(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}getY(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.y.fromRed()}eq(t){if(N(t instanceof p),this===t)return!0;if(this.isInfinity())return t.isInfinity();if(t.isInfinity())return!1;if(this.z.eq(t.z))return this.x.eq(t.x)&&this.y.eq(t.y);const e=this.z.redSqr(),r=t.z.redSqr(),i=this.x.redMul(r),n=t.x.redMul(e);if(!i.eq(n))return!1;const s=e.redMul(this.z),o=r.redMul(t.z),f=this.y.redMul(o),a=t.y.redMul(s);return f.eq(a)}cmp(t){N(t instanceof p);const e=this.isInfinity(),r=t.isInfinity();return e&&!r?-1:!e&&r?1:e&&r?0:this.order().cmp(t.order())||this.getX().cmp(t.getX())||this.getY().cmp(t.getY())}isInfinity(){return this.z.isZero()}isOrder2(){return!this.isInfinity()&&this.y.isZero()}isOdd(){return!this.isInfinity()&&(this.normalize(),this.y.redIsOdd())}isEven(){return!this.isInfinity()&&(this.normalize(),this.y.redIsEven())}isSquare(){return!this.isInfinity()&&-1!==this.y.redMul(this.z).redJacobi()}eqX(t){if(N(t instanceof n),N(!t.red),this.isInfinity())return!1;const e=this.z.redSqr(),r=t.toRed(this.curve.red).redMul(e);return this.x.eq(r)}eqR(t){if(N(t instanceof n),N(!t.red),!this.curve.smallGap)return this.toP().eqR(t);if(this.isInfinity())return!1;if(t.cmp(this.curve.p)>=0)return!1;const e=this.z.redSqr(),r=t.toRed(this.curve.red).redMul(e);if(this.x.eq(r))return!0;if(this.curve.highOrder)return!1;if(t.cmp(this.curve.pmodn)>=0)return!1;const i=this.curve.redN.redMul(e);return r.redIAdd(i),this.x.eq(r)}toP(){return this.isInfinity()?this.curve.point():(this.normalize(),this.curve.point(this.x,this.y))}toJ(){return this}encode(t){return this.toP().encode(t)}static decode(t,e){return b.decode(t,e).toJ()}encodeX(){return this.toP().encodeX()}static decodeEven(t,e){return b.decodeEven(t,e).toJ()}static decodeSquare(t,e){return b.decodeSquare(t,e).toJ()}toJSON(t){return this.toP().toJSON(t)}toPretty(){return this.toP().toPretty()}static fromJSON(t,e){return b.fromJSON(t,e).toJ()}[i](){return this.isInfinity()?"<JPoint: Infinity>":"<JPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class m extends u{constructor(t){super(g,"mont",t),this.a=n.fromJSON(t.a).toRed(this.red),this.b=n.fromJSON(t.b).toRed(this.red),this.bi=this.b.redInvert(),this.a2=this.a.redAdd(this.two),this.a24=this.a2.redMul(this.i4),this.a3=this.a.redMul(this.i3),this.a0=this.a.redMul(this.bi),this.b0=this.bi.redSqr(),this._finalize(t)}static _isomorphism(t,e,r){N(t instanceof n),N(e instanceof n),N(r instanceof n);const i=t.clone(),s=r.clone();if(1!==e.redDiv(r).redJacobi())throw new Error("Invalid `b` coefficient.");return[i,s]}_short(t,e){const{a:r,b:i,three:n}=this,s=r.redSqr(),o=s.redMul(r),f=i.redSqr(),a=f.redMul(i),c=n.redSub(s),h=f.redMuln(3),u=o.redMuln(2).redISub(r.redMuln(9)),d=a.redMuln(27),b=c.redDiv(h),p=u.redDiv(d);return null!=t?l._isomorphism(b,p,t,e):[b,p]}_mont(t){return m._isomorphism(this.a,this.b,t)}_edwards(t,e=!1){N("boolean"==typeof e);const{two:r,bi:i}=this,n=this.a.redAdd(r).redMul(i),s=this.a.redSub(r).redMul(i);return e&&n.swap(s),null!=t?y._isomorphism(n,s,t):[n,s]}_scaleShort(t){N(t instanceof l);const[e,r]=t._scale(this);return[this.field(e.redInvert()),this.field(r.redInvert())]}_scaleMont(t){return N(t instanceof m),this.g.isInfinity()||t.g.isInfinity()?this.field(t.b).redDivSqrt(this.b):this.g.y.redDiv(this.field(t.g.y))}_scaleEdwards(t,e){N(t instanceof y);const r=t._scale(this,e);return this.field(r)}_solveY0(t){N(t instanceof n);const e=this.a0,r=this.b0,i=t.redSqr();return i.redMul(t).redIAdd(e.redMul(i)).redIAdd(r.redMul(t))}_elligator2(t){const e=this.a0.redNeg(),r=this.one.redAdd(this.z.redMul(t.redSqr()));r.isZero()&&r.inject(this.one);const i=e.redMul(r.redInvert()),n=i.redNeg().redISub(this.a0),s=this._solveY0(i),o=this._solveY0(n),f=0|s.redIsSquare(),a=[i,n][1^f],c=[s,o][1^f].redSqrt();c.redIsOdd()!==t.redIsOdd()&&c.redINeg();const h=this.b.redMul(a),u=this.b.redMul(c);return this.point(h,u)}_invert2(t,e){const{x:r,y:i}=t,n=1&e,s=r.redMul(this.bi),o=i.redMul(this.bi),f=s.redAdd(this.a0),a=s,c=[f,a][n].redINeg(),h=[a,f][n].redMul(this.z),u=c.redDivSqrt(h);return u.redIsOdd()!==o.redIsOdd()&&u.redINeg(),u}isElliptic(){const t=this.a.redSqr();return!this.b.redMul(t.redSub(this.four)).isZero()}jinv(){const{a:t,three:e,four:r}=this,i=t.redSqr(),n=i.redSub(e).redPown(3).redIMuln(256),s=i.redSub(r);if(s.isZero())throw new Error("Curve is not elliptic.");return n.redDiv(s).fromRed()}point(t,e){return new g(this,t,e)}jpoint(t,e,r){return N(null==t&&null==e&&null==r),this.point()}xpoint(t,e){return new w(this,t,e)}solveY2(t){N(t instanceof n);const e=t.redSqr();return e.redMul(t).redIAdd(this.a.redMul(e)).redIAdd(t).redMul(this.bi)}validate(t){if(N(t instanceof g),t.isInfinity())return!0;const{x:e,y:r}=t,i=this.solveY2(e);return r.redSqr().eq(i)}pointFromX(t,e=null){N(t instanceof n),N(null==e||"boolean"==typeof e),t.red||(t=t.toRed(this.red));const r=this.solveY(t);if(null!=e){if(r.isZero()&&e)throw new Error("Invalid point.");r.redIsOdd()!==e&&r.redINeg()}return this.point(t,r)}isIsomorphic(t,e){if(N(t instanceof u),!t.p.eq(this.p))return!1;if("mont"===t.type){const e=this.field(t.a),r=this.field(t.b);if(!this.a.eq(e))return!1;if(this.b.isZero())return!1;return 1===r.redDiv(this.b).redJacobi()}return t.isIsomorphic(this,e)}isIsogenous(t){return N(t instanceof u),"mont"!==t.type&&t.isIsogenous(this)}pointFromShort(t){if(N(t instanceof b),this.isIsomorphic(t.curve)){if(t.isInfinity())return this.point();const{a3:e,b:r}=this,[i,n]=this._scale(t.curve),s=this.field(t.x).redMul(i),o=this.field(t.y).redMul(n),f=r.redMul(s).redISub(e),a=r.redMul(o);return this.point(f,a)}throw new Error("Not implemented.")}pointFromMont(t){if(N(t instanceof g),this.isIsomorphic(t.curve)){if(t.isInfinity())return this.point();const e=this._scale(t.curve),r=this.field(t.x),i=this.field(t.y),n=r,s=e.redMul(i);return this.point(n,s)}throw new Error("Not implemented.")}pointFromEdwards(t){N(t instanceof v),N(t.curve.p.eq(this.p));const e=this.field(t.x),r=this.field(t.y),i=this.field(t.z);if(this.isIsogenous(t.curve)){if(t.isInfinity())return this.point();if(t.x.isZero())return this.point(this.zero,this.zero);const n=i.redSqr().redIMuln(2),s=r.redSqr(),o=e.redSqr(),f=n.redISub(o).redISub(s).redMul(r),a=o.redMul(e);return this.cpoint(s,o,f,a)}if(this.isIsomorphic(t.curve,!0)){if(t.isInfinity())return this.point();if(t.x.isZero())return this.point(this.zero,this.zero);const n=this._scale(t.curve,!0),s=r.redAdd(i),o=r.redSub(i),f=n.redMul(i).redMul(s),a=e.redMul(o);return this.cpoint(s,o,f,a)}if(this.isIsomorphic(t.curve,!1)){if(t.isInfinity())return this.point();if(t.x.isZero())return this.point(this.zero,this.zero);const n=this._scale(t.curve,!1),s=i.redAdd(r),o=i.redSub(r),f=n.redMul(i).redMul(s),a=e.redMul(o);return this.cpoint(s,o,f,a)}throw new Error("Not implemented.")}pointFromUniform(t){if(N(t instanceof n),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");return this._elligator2(t)}pointToUniform(t,e){if(N(t instanceof g),N(e>>>0===e),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");if(t.isInfinity())throw new Error("Invalid point.");const r=(e>>>4&15)%this.torsion.length,i=t.add(this.torsion[r]);return P(()=>this._invert2(i,e))}decodePoint(t,e){return g.decode(this,t,e)}encodeX(t){return N(t instanceof w),t.encode()}decodeX(t){return w.decode(this,t)}toShort(t,e,r=null){const[i,n]=this._short(t,e),s=new l({red:this.red,prime:this.prime,p:this.p,a:i,b:n,n:this.n,h:this.h});if(null!=r){const[,t]=s._scale(this);t.redIsOdd()!==r&&t.redINeg()}this.g.isInfinity()||(s.g=s.pointFromMont(this.g));for(let t=0;t<this.h.word(0);t++)s.torsion[t]=s.pointFromMont(this.torsion[t]);return s}toMont(t,e=null){const[r,i]=this._mont(t),n=new m({red:this.red,prime:this.prime,p:this.p,a:r,b:i,n:this.n,h:this.h,z:this.z});if(null!=e){const t=n._scale(this);t.redIsOdd()!==e&&t.redINeg()}this.g.isInfinity()||(n.g=n.pointFromMont(this.g));for(let t=0;t<this.h.word(0);t++)n.torsion[t]=n.pointFromMont(this.torsion[t]);return n}toEdwards(t,e,r=null){const[i,n]=this._edwards(t,e),s=new y({red:this.red,prime:this.prime,p:this.p,a:i,d:n,n:this.n,h:this.h,z:this.z});if(null!=r){const t=s._scale(this,e);t.redIsOdd()!==r&&t.redINeg()}if(this.g.isInfinity()||(s.g=s.pointFromMont(this.g),s.g.normalize()),s.isComplete())for(let t=0;t<this.h.word(0);t++)s.torsion[t]=s.pointFromMont(this.torsion[t]),s.torsion[t].normalize();return s}pointFromJSON(t){return g.fromJSON(this,t)}toJSON(t){const e=super.toJSON(t);return e.a=this.a.fromRed().toJSON(),e.b=this.b.fromRed().toJSON(),e}}class g extends d{constructor(t,e,r){N(t instanceof m),super(t,s),this.x=this.curve.zero,this.y=this.curve.zero,this.inf=!0,null!=e&&this._init(e,r)}_init(t,e){N(t instanceof n),N(e instanceof n),this.x=t,this.y=e,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1}clone(){return this.inf?this.curve.point():this.curve.point(this.x,this.y)}scale(t){return this.clone()}randomize(t){return this.clone()}neg(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}add(t){if(N(t instanceof g),this.inf)return t;if(t.inf)return this;if(this.x.eq(t.x))return this.y.eq(t.y)?this.dbl():this.curve.point();const e=t.x.redSub(this.x),r=t.y.redSub(this.y).redDiv(e),i=this.curve.b.redMul(r.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(t.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)}dbl(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();const t=this.x.redSqr().redIMuln(3),e=this.curve.a.redMul(this.x).redIMuln(2),r=t.redIAdd(e).redIAdd(this.curve.one),i=this.curve.b.redMul(this.y).redIMuln(2),n=r.redDiv(i),s=this.curve.b.redMul(n.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(this.x),o=n.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,o)}getX(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}getY(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}eq(t){return N(t instanceof g),this===t||(this.inf?t.inf:!t.inf&&(this.x.eq(t.x)&&this.y.eq(t.y)))}cmp(t){return N(t instanceof g),this.inf&&!t.inf?-1:!this.inf&&t.inf?1:this.inf&&t.inf?0:this.order().cmp(t.order())||this.getX().cmp(t.getX())||this.getY().cmp(t.getY())}isInfinity(){return this.inf}isOrder2(){return!this.inf&&this.y.isZero()}isOdd(){return!this.inf&&this.y.redIsOdd()}isEven(){return!this.inf&&this.y.redIsEven()}toP(){return this}toJ(){return this}toX(){return this.inf?this.curve.xpoint():this.curve.xpoint(this.x,this.curve.one)}encode(){return this.toX().encode()}static decode(t,e,r){return N(t instanceof m),t.decodeX(e).toP(r)}toJSON(t){if(this.inf)return[];return[this.getX().toJSON(),this.getY().toJSON()]}toPretty(){if(this.inf)return[];const t=2*this.curve.fieldSize;return[T(this.getX(),t),T(this.getY(),t)]}static fromJSON(t,e){if(N(t instanceof m),N(Array.isArray(e)),N(0===e.length||2===e.length||3===e.length),0===e.length)return t.point();const r=n.fromJSON(e[0]),i=n.fromJSON(e[1]);return t.point(r,i)}[i](){return this.inf?"<MontPoint: Infinity>":"<MontPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}}class w extends d{constructor(t,e,r){N(t instanceof m),super(t,f),this.x=this.curve.one,this.z=this.curve.zero,null!=e&&this._init(e,r)}_init(t,e){N(t instanceof n),N(null==e||e instanceof n),this.x=t,this.z=e||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red))}clone(){return this.curve.xpoint(this.x,this.z)}precompute(t,e){return this}validate(){if(this.isInfinity())return!0;const{x:t,z:e}=this,r=t.redSqr(),i=r.redMul(t),n=e.redSqr(),s=this.curve.a.redMul(r).redMul(e);return-1!==i.redIAdd(s).redIAdd(t.redMul(n)).redMul(this.curve.bi).redMul(e).redJacobi()}normalize(){return this.isInfinity()||this.z.eq(this.curve.one)||(this.x=this.x.redDiv(this.z),this.z=this.curve.one),this}scale(t){if(N(t instanceof n),this.isInfinity())return this.curve.xpoint();const e=this.x.redMul(t),r=this.z.redMul(t);return this.curve.xpoint(e,r)}neg(){return this}dbl(){const t=this.x.redAdd(this.z).redSqr(),e=this.x.redSub(this.z).redSqr(),r=t.redSub(e),i=t.redMul(e),n=r.redMul(e.redIAdd(this.curve.a24.redMul(r)));return this.curve.xpoint(i,n)}diffAddDbl(t,e){N(t instanceof w),N(e instanceof w);const r=t.x.redAdd(t.z),i=r.redSqr(),n=t.x.redSub(t.z),s=n.redSqr(),o=i.redSub(s),f=e.x.redAdd(e.z),a=e.x.redSub(e.z).redMul(r),c=f.redMul(n),h=this.z.redMul(a.redAdd(c).redSqr()),u=this.x.redMul(a.redISub(c).redSqr()),d=i.redMul(s),l=o.redMul(s.redIAdd(this.curve.a24.redMul(o)));return[this.curve.xpoint(d,l),this.curve.xpoint(h,u)]}getX(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}getY(t){return this.toP(t).getY()}eq(t){if(N(t instanceof w),this===t)return!0;if(this.isInfinity())return t.isInfinity();if(t.isInfinity())return!1;if(this.z.eq(t.z))return this.x.eq(t.x);const e=this.x.redMul(t.z),r=t.x.redMul(this.z);return e.eq(r)}cmp(t){N(t instanceof w);const e=this.isInfinity(),r=t.isInfinity();return e&&!r?-1:!e&&r?1:e&&r?0:this.order().cmp(t.order())||this.getX().cmp(t.getX())}isInfinity(){return this.z.isZero()}isOrder2(){return!this.isInfinity()&&this.x.isZero()}isOdd(){return!1}isEven(){return!1}hasTorsion(){return!this.isInfinity()&&(!!this.x.isZero()||super.hasTorsion())}order(){try{return this.toP().order()}catch(t){return new n(1)}}jmul(t){N(t instanceof n),N(!t.red);const e=t.bitLength();let r=this.curve.xpoint(),i=this;for(let n=e-1;n>=0;n--){0===t.bit(n)?[r,i]=this.diffAddDbl(r,i):[i,r]=this.diffAddDbl(i,r)}return r}jmulBlind(t,e){return e?this.randomize(e).jmul(t):this.jmul(t)}jmulAdd(t,e,r){throw new Error("Not implemented.")}toP(t=null){return N(null==t||"boolean"==typeof t),this.isInfinity()?this.curve.point():(this.normalize(),this.curve.pointFromX(this.x,t))}toJ(){return this}toX(){return this}key(){if(this.isInfinity())return this.curve.uid+":oo";this.normalize();const t=this.getX().toString(16);return`${this.curve.uid}:${t}`}encode(){return this.curve.encodeField(this.getX())}static decode(t,e){N(t instanceof m);const r=t.decodeField(e);r.iumaskn(t.fieldBits);const i=t.xpoint(r,t.one);return N(!i.isInfinity()),i}toJSON(t){return this.toP().toJSON(t)}toPretty(){return this.toP().toPretty()}static fromJSON(t,e){return g.fromJSON(t,e).toX()}[i](){return this.isInfinity()?"<XPoint: Infinity>":"<XPoint: x="+this.x.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class y extends u{constructor(t){super(v,"edwards",t),this.a=n.fromJSON(t.a).toRed(this.red),this.d=n.fromJSON(t.d).toRed(this.red),this.s=n.fromJSON(t.s||"0").toRed(this.red),this.si=this.s.isZero()?this.zero:this.s.redInvert(),this.k=this.d.redMuln(2),this.smi=-this.d.redNeg().word(0),this.ad6=this.a.redAdd(this.d).redMul(this.i6),this.twisted=!this.a.eq(this.one),this.oneA=this.a.eq(this.one),this.mOneA=this.a.eq(this.one.redNeg()),this.smallD=null!=this.prime&&1===this.d.redNeg().length,this.alt=null,this._finalize(t)}static _isomorphism(t,e,r){N(t instanceof n),N(e instanceof n),N(r instanceof n);const i=r.clone(),s=r.redMul(e).redDiv(t);if(1!==t.redDiv(r).redJacobi())throw new Error("Invalid `a` coefficient.");return[i,s]}_short(t,e){const{a:r,d:i}=this,n=r.redSqr(),s=n.redMul(r),o=i.redSqr(),f=o.redMul(i),a=r.redMul(i).redIMuln(14),c=n.redMul(i),h=r.redMul(o),u=c.redIAdd(h).redIMuln(33),d=n.redAdd(a).redIAdd(o).redDivn(-48),b=u.redISub(s).redISub(f).redDivn(864);return null!=t?l._isomorphism(d,b,t,e):[d,b]}_mont(t,e=!1){let r,i;N("boolean"==typeof e),e?(r=this.d.redAdd(this.a),i=this.d.redSub(this.a)):(r=this.a.redAdd(this.d),i=this.a.redSub(this.d));const n=i.redInvert(),s=r.redMuln(2).redMul(n),o=n.redMuln(4);return null!=t?m._isomorphism(s,o,t):[s,o]}_edwards(t){return y._isomorphism(this.a,this.d,t)}_scaleShort(t){N(t instanceof l);const[e,r]=t._scale(this);return[this.field(e.redInvert()),this.field(r.redInvert())]}_scaleMont(t,e=!1){if(N(t instanceof m),N("boolean"==typeof e),this.g.isInfinity()||t.g.isInfinity()){const[r]=t._edwards(null,e);return this.field(r).redDivSqrt(this.a)}const r=t.g.x.redDiv(t.g.y);return this.g.x.redDiv(this.field(r))}_scaleEdwards(t){return N(t instanceof y),this.g.isInfinity()||t.g.isInfinity()?this.field(t.a).redDivSqrt(this.a):this.g.x.redDiv(this.field(t.g.x))}_mulA(t){return N(t instanceof n),this.oneA?t.clone():this.mOneA?t.redNeg():this.a.redMul(t)}_mulD(t){return N(t instanceof n),this.smallD?t.redMuln(this.smi):this.d.redMul(t)}_elligator1(t){const{s:e,si:r,i2:i,one:n,two:s}=this,o=r.redSqr().redIMuln(2),f=e.redSqr().redMul(i),a=f.redSqr(),c=o.redAdd(f),h=c.redSqr().redISub(s),u=o.redSub(n),d=n.redSub(t),l=n.redAdd(t),b=l.isZero()?l:d.redDiv(l),p=b.redSqr(),m=p.redMul(b),g=m.redMul(p).redAdd(h.redMul(m)).redIAdd(b),w=this.field(g.redJacobi()),y=this.field(p.redAdd(a).redJacobi()),v=w.redMul(y),S=w.redMul(b),E=w.redMul(g).redSqrt().redMul(v),M=n.redAdd(S),A=c.redMul(S),I=M.redSqr(),_=u.redMul(e).redMul(S).redMul(M),x=b.isZero()?this.one:E,B=A.redSub(I),k=A.redAdd(I);return this.cpoint(_,x,B,k)}_invert1(t,e){const{s:r,si:i,i2:n,one:s}=this,{x:o,y:f,z:a}=t,c=1&e,h=i.redSqr().redIMuln(2),u=r.redSqr().redMul(n),d=u.redSqr(),l=h.redAdd(u),b=h.redSub(s),p=f.redSub(a),m=f.redAdd(a).redIMuln(2),g=m.isZero()?m:p.redDiv(m),w=s.redAdd(g.redMul(l)),y=w.redSqr().redISub(s).redSqrt().redSub(w),v=s.redAdd(y),S=b.redMul(r).redMul(y).redMul(v).redMul(o.redMul(a)),E=y.redSqr().redIAdd(d),M=this.field(S.redMul(E).redJacobi()).redMul(y),A=s.redSub(M),I=s.redAdd(M),_=I.isZero()?I:A.redDiv(I);return _.redIsOdd()!==Boolean(c)&&_.redINeg(),_}_alt(){return this.alt||(this.alt=this.toMont()),this.alt}isElliptic(){const t=this.a.redMul(this.d),e=this.a.redSub(this.d);return!t.redMul(e).isZero()}jinv(){const{a:t,d:e}=this,r=t.redMul(e),i=t.redSub(e).redPown(4),n=t.redSqr(),s=e.redSqr(),o=n.redAdd(r.redMuln(14)).redIAdd(s).redPown(3).redIMuln(16),f=r.redMul(i);if(f.isZero())throw new Error("Curve is not elliptic.");return o.redDiv(f).fromRed()}isComplete(){return 1===this.a.redJacobi()&&-1===this.d.redJacobi()}point(t,e,r,i){return new v(this,t,e,r,i)}jpoint(t,e,r){return N(null==t&&null==e&&null==r),this.point()}cpoint(t,e,r,i){N(t instanceof n),N(e instanceof n),N(r instanceof n),N(i instanceof n);const s=t.redMul(i),o=r.redMul(e),f=e.redMul(i),a=t.redMul(r);return this.point(s,o,f,a)}solveX2(t){N(t instanceof n);const e=t.redSqr(),r=this._mulD(e).redISub(this.a);return e.redISub(this.one).redDiv(r)}solveX(t){const e=t.redSqr(),r=this._mulD(e).redISub(this.a);return e.redISub(this.one).redDivSqrt(r)}solveY2(t){N(t instanceof n);const e=t.redSqr(),r=this._mulA(e).redISub(this.one),i=this._mulD(e).redISub(this.one);return r.redDiv(i)}solveY(t){const e=t.redSqr(),r=this._mulA(e).redISub(this.one),i=this._mulD(e).redISub(this.one);return r.redDivSqrt(i)}validate(t){if(N(t instanceof v),t.zOne){const e=t.x.redSqr(),r=t.y.redSqr(),i=this._mulD(e).redMul(r),n=this._mulA(e).redIAdd(r),s=this.one.redAdd(i),o=t.t,f=t.x.redMul(t.y);return n.eq(s)&&o.eq(f)}const e=t.x.redSqr(),r=t.y.redSqr(),i=t.z.redSqr(),n=i.redSqr(),s=this._mulD(e).redMul(r),o=this._mulA(e).redIAdd(r).redMul(i),f=n.redIAdd(s),a=t.t.redMul(t.z),c=t.x.redMul(t.y);return o.eq(f)&&a.eq(c)}pointFromX(t,e=null){N(t instanceof n),N(null==e||"boolean"==typeof e),t.red||(t=t.toRed(this.red));const r=this.solveY(t);if(null!=e){if(r.isZero()&&e)throw new Error("Invalid point.");r.redIsOdd()!==e&&r.redINeg()}return this.point(t,r)}pointFromY(t,e=null){N(t instanceof n),N(null==e||"boolean"==typeof e),t.red||(t=t.toRed(this.red));const r=this.solveX(t);if(null!=e){if(r.isZero()&&e)throw new Error("Invalid point.");r.redIsOdd()!==e&&r.redINeg()}return this.point(r,t)}isIsomorphic(t,e=!1){if(N(t instanceof u),N("boolean"==typeof e),!t.p.eq(this.p))return!1;if("short"===t.type)return t.isIsomorphic(this);if("mont"===t.type){const r=this.field(t.a);let i,n;return e?(i=this.d.redAdd(this.a),n=this.d.redSub(this.a)):(i=this.a.redAdd(this.d),n=this.a.redSub(this.d)),r.redMul(n).eq(i.redIMuln(2))}if("edwards"===t.type){const e=this.field(t.a),r=this.field(t.d);return this.a.redMul(r).eq(e.redMul(this.d))}return!1}isIsogenous(t){if(N(t instanceof u),!t.p.eq(this.p))return!1;if("mont"===t.type){if(!this.a.eq(this.one))return!1;const e=this.field(t.a),r=this.field(t.b),i=this.two.redSub(this.d.redMuln(4));return e.eq(i)&&r.eq(this.one)}if("edwards"===t.type){const e=this.field(t.a),r=this.field(t.d);return e.eq(this.a.redNeg())&&r.eq(this.d.redSub(this.a))}return!1}pointFromShort(t){if(N(t instanceof b),this.isIsomorphic(t.curve)){if(t.isInfinity())return this.point();if(t.y.isZero())return this.point(this.zero,this.one.redNeg());const{a:e,d:r}=this,[i,n]=this._scale(t.curve),s=e.redMuln(5),o=r.redMuln(5),f=this.field(t.x).redMul(i),a=this.field(t.y).redMul(n),c=f.redMuln(6),h=f.redMuln(12),u=c.redSub(e).redISub(r),d=a.redMuln(6),l=h.redSub(s).redIAdd(r),b=h.redAdd(e).redISub(o);return this.cpoint(u,d,l,b)}throw new Error("Not implemented.")}pointFromMont(t){N(t instanceof g),N(t.curve.p.eq(this.p));const e=this.field(t.x),r=this.field(t.y);if(this.isIsogenous(t.curve)){if(t.isInfinity())return this.point();if(t.x.isZero())return this.point();const i=e.redSqr(),n=i.redMul(e),s=n.redMul(e),o=s.redMul(e),f=r.redSqr(),a=r.redMuln(4),c=i.redSub(this.one),h=i.redMuln(2),u=f.redMuln(4),d=n.redIMuln(2),l=e.redMul(f).redIMuln(4),b=i.redMul(f).redIMuln(2),p=f.redIMuln(2),m=a.redMul(c),g=s.redISub(h).redIAdd(u).redIAdd(this.one),w=o.redSub(d).redISub(l).redIAdd(e).redINeg(),y=o.redISub(b).redISub(d).redISub(p).redIAdd(e);return this.cpoint(m,g,w,y).divn(4)}if(this.isIsomorphic(t.curve,!0)){if(t.isInfinity())return this.point();if(t.x.isZero())return this.point(this.zero,this.one.redNeg());const i=this._scale(t.curve,!0).redMul(e),n=r,s=e.redAdd(this.one),o=e.redSub(this.one);return this.cpoint(i,n,s,o)}if(this.isIsomorphic(t.curve,!1)){if(t.isInfinity())return this.point();if(t.x.isZero())return this.point(this.zero,this.one.redNeg());const i=this._scale(t.curve,!1).redMul(e),n=r,s=e.redSub(this.one),o=e.redAdd(this.one);return this.cpoint(i,n,s,o)}throw new Error("Not implemented.")}pointFromEdwards(t){N(t instanceof v),N(t.curve.p.eq(this.p));const e=this.field(t.curve.a),r=this.field(t.x),i=this.field(t.y),n=this.field(t.z),s=this.field(t.t);if(this.isIsogenous(t.curve)){const t=r.redMul(i),s=r.redSqr(),o=i.redSqr(),f=n.redSqr(),a=e.redMul(s),c=t.redIMuln(2),h=o.redSub(a),u=o.redAdd(a),d=f.redIMuln(2).redISub(u),l=this.cpoint(c,h,u,d);return this.twisted?l:l.divn(4)}if(this.isIsomorphic(t.curve)){const e=this._scale(t.curve),o=e.redMul(r),f=i,a=n,c=e.redMul(s);return this.point(o,f,a,c)}throw new Error("Not implemented.")}pointFromUniform(t,e=null){N(t instanceof n),N(t.red===this.red),N(null==e||e instanceof m),e||(e=this._alt());const r=e.field(t),i=e.pointFromUniform(r);return this.pointFromMont(i)}pointToUniform(t,e,r=null){N(t instanceof v),N(e>>>0===e),N(null==r||r instanceof m),r||(r=this._alt());const i=(e>>4&15)%this.torsion.length,n=t.add(this.torsion[i]),s=r.pointFromEdwards(n),o=r.pointToUniform(s,15&e);return this.field(o)}pointFromHash(t,e,r=null){N(null==r||r instanceof m),r||(r=this._alt());const i=r.pointFromHash(t,e);return this.pointFromMont(i)}pointToHash(t,e,r,i=null){N(t instanceof v),N(e>>>0===e),N(null==i||i instanceof m),i||(i=this._alt());const n=e%this.torsion.length,s=t.add(this.torsion[n]),o=i.pointFromEdwards(s);return i.pointToHash(o,0,r)}decodePoint(t){return v.decode(this,t)}toShort(t,e,r=null){const[i,n]=this._short(t,e),s=new l({red:this.red,prime:this.prime,p:this.p,a:i,b:n,n:this.n,h:this.h});if(null!=r){const[,t]=s._scale(this);t.redIsOdd()!==r&&t.redINeg()}this.g.isInfinity()||(s.g=s.pointFromEdwards(this.g));for(let t=0;t<this.h.word(0);t++)s.torsion[t]=s.pointFromEdwards(this.torsion[t]);return s}toMont(t,e,r=null){const[i,n]=this._mont(t,e),s=new m({red:this.red,prime:this.prime,p:this.p,a:i,b:n,n:this.n,h:this.h,z:this.z});if(null!=r){const t=this._scale(s,e);t.redIsOdd()!==r&&t.redINeg()}this.g.isInfinity()||(s.g=s.pointFromEdwards(this.g));for(let t=0;t<this.h.word(0);t++)s.torsion[t]=s.pointFromEdwards(this.torsion[t]);return s}toEdwards(t,e=null){const[r,i]=this._edwards(t),n=new y({red:this.red,prime:this.prime,p:this.p,a:r,d:i,n:this.n,h:this.h,z:this.z});if(null!=e){const t=n._scale(this);t.redIsOdd()!==e&&t.redINeg()}if(this.g.isInfinity()||(n.g=n.pointFromEdwards(this.g),n.g.normalize()),n.isComplete())for(let t=0;t<this.h.word(0);t++)n.torsion[t]=n.pointFromEdwards(this.torsion[t]),n.torsion[t].normalize();return n}pointFromJSON(t){return v.fromJSON(this,t)}toJSON(t){const e=super.toJSON(t);return e.a=this.a.fromRed().toJSON(),e.d=this.d.fromRed().toJSON(),this.s.isZero()||(e.s=this.s.fromRed().toJSON()),e}}class v extends d{constructor(t,e,r,i,n){N(t instanceof y),super(t,a),this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0,null!=e&&this._init(e,r,i,n)}_init(t,e,r,i){N(t instanceof n),N(e instanceof n),N(null==r||r instanceof n),N(null==i||i instanceof n),this.x=t,this.y=e,this.z=r||this.curve.one,this.t=i||null,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z.eq(this.curve.one),this._check(),this.t||(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redDiv(this.z)))}_check(){if(this.z.isZero())throw new Error("Invalid point.")}clone(){return this.curve.point(this.x,this.y,this.z,this.t)}normalize(){if(this.zOne)return this;const t=this.z.redInvert();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t=this.t.redMul(t),this.z=this.curve.one,this.zOne=!0,this}scale(t){N(t instanceof n);const e=this.x.redMul(t),r=this.y.redMul(t),i=this.z.redMul(t),s=this.t.redMul(t);return this.curve.point(e,r,i,s)}neg(){const t=this.x.redNeg(),e=this.y,r=this.z,i=this.t.redNeg();return this.curve.point(t,e,r,i)}add(t){return N(t instanceof v),this.isInfinity()?t:t.isInfinity()?this:this.zOne?t._add(this):this._add(t)}_add(t){return this.curve.mOneA?this._addM1(t):this._addA(t)}_addM1(t){const e=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),r=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.k).redMul(t.t),n=t.zOne?this.z.redAdd(this.z):this.z.redMul(t.z).redIMuln(2),s=r.redSub(e),o=n.redSub(i),f=n.redIAdd(i),a=r.redIAdd(e),c=s.redMul(o),h=f.redMul(a),u=s.redMul(a),d=o.redMul(f);return this.curve.point(c,h,d,u)}_addA(t){const e=this.x.redMul(t.x),r=this.y.redMul(t.y),i=this.curve._mulD(this.t).redMul(t.t),n=t.zOne?this.z.clone():this.z.redMul(t.z),s=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(e).redISub(r),o=n.redSub(i),f=n.redIAdd(i),a=r.redISub(this.curve._mulA(e)),c=s.redMul(o),h=f.redMul(a),u=s.redMul(a),d=o.redMul(f);return this.curve.point(c,h,d,u)}dbl(){return this.isInfinity()?this:this._dbl()}_dbl(){const t=this.x.redSqr(),e=this.y.redSqr(),r=this.zOne?this.curve.two:this.z.redSqr().redIMuln(2),i=this.curve._mulA(t),n=this.x.redAdd(this.y).redSqr().redISub(t).redISub(e),s=i.redAdd(e),o=s.redSub(r),f=i.redISub(e),a=n.redMul(o),c=s.redMul(f),h=n.redMul(f),u=o.redMul(s);return this.curve.point(a,c,u,h)}getX(){return this.normalize(),this.x.fromRed()}getY(){return this.normalize(),this.y.fromRed()}eq(t){if(N(t instanceof v),N(!this.z.isZero()),N(!t.z.isZero()),this===t)return!0;if(this.z.eq(t.z))return this.x.eq(t.x)&&this.y.eq(t.y);const e=this.x.redMul(t.z),r=t.x.redMul(this.z);if(!e.eq(r))return!1;const i=this.y.redMul(t.z),n=t.y.redMul(this.z);return i.eq(n)}cmp(t){return N(t instanceof v),this.order().cmp(t.order())||this.getY().cmp(t.getY())||this.getX().cmp(t.getX())}isInfinity(){return N(!this.z.isZero()),!!this.x.isZero()&&this.y.eq(this.z)}isOrder2(){return!this.isInfinity()&&this.x.isZero()}isOdd(){return this.normalize(),this.x.redIsOdd()}isEven(){return this.normalize(),this.x.redIsEven()}toP(){return this.normalize()}toJ(){return this}encode(){const t=this.getY();return t.setn(this.curve.signBit,this.x.redIsOdd()),this.curve.encodeAdjusted(t)}static decode(t,e){N(t instanceof y);const r=t.decodeAdjusted(e),i=0!==r.testn(t.signBit);if(r.setn(t.signBit,0),r.cmp(t.p)>=0)throw new Error("Invalid point.");return t.pointFromY(r,i)}toJSON(t){if(this.isInfinity())return[];const e=this.getX().toJSON(),r=this.getY().toJSON();return!0===t&&this.pre?[e,r,this.pre.toJSON()]:[e,r]}toPretty(){const t=2*this.curve.fieldSize;return[T(this.getX(),t),T(this.getY(),t)]}static fromJSON(t,e){if(N(t instanceof y),N(Array.isArray(e)),N(0===e.length||2===e.length||3===e.length),0===e.length)return t.point();const r=n.fromJSON(e[0]),i=n.fromJSON(e[1]),s=t.point(r,i);return e.length>2&&null!=e[2]&&(s.pre=S.fromJSON(s,e[2])),s}[i](){return this.isInfinity()?"<EdwardsPoint: Infinity>":"<EdwardsPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class S{constructor(){this.naf=null,this.windows=null,this.doubles=null,this.blinding=null,this.beta=null}map(t){N("function"==typeof t);const e=new this.constructor;return this.naf&&(e.naf=this.naf.map(t)),this.doubles&&(e.doubles=this.doubles.map(t)),e}toJSON(){return{naf:this.naf?this.naf.toJSON():null,windows:this.windows?this.windows.toJSON():null,doubles:this.doubles?this.doubles.toJSON():null,blinding:this.blinding?this.blinding.toJSON():void 0}}fromJSON(t,e){return N(t instanceof d),N(e&&"object"==typeof e),null!=e.naf&&(this.naf=E.fromJSON(t,e.naf)),null!=e.windows&&(this.windows=M.fromJSON(t,e.windows)),null!=e.doubles&&(this.doubles=A.fromJSON(t,e.doubles)),null!=e.blinding&&(this.blinding=I.fromJSON(t,e.blinding)),this}static fromJSON(t,e){return(new this).fromJSON(t,e)}}class E{constructor(t,e){this.width=t,this.points=e}map(t){N("function"==typeof t);const{width:e}=this,r=[];for(const e of this.points)r.push(t(e));return new this.constructor(e,r)}toJSON(){return{width:this.width,points:this.points.slice(1).map(t=>t.toJSON())}}static fromJSON(t,e){N(t instanceof d),N(e&&"object"==typeof e),N(e.width>>>0===e.width),N(Array.isArray(e.points));const{curve:r}=t,{width:i}=e,n=[t];for(const t of e.points)n.push(r.pointFromJSON(t));return new this(i,n)}}class M{constructor(t,e,r){this.width=t,this.bits=e,this.points=r}toJSON(){return{width:this.width,bits:this.bits,points:this.points.slice(1).map(t=>t.toJSON())}}static fromJSON(t,e){N(t instanceof d),N(e&&"object"==typeof e),N(e.width>>>0===e.width),N(e.bits>>>0===e.bits),N(Array.isArray(e.points));const{curve:r}=t,{width:i,bits:n}=e,s=[t];for(const t of e.points)s.push(r.pointFromJSON(t));return new this(i,n,s)}}class A{constructor(t,e){this.step=t,this.points=e}map(t){N("function"==typeof t);const{step:e}=this,r=[];for(const e of this.points)r.push(t(e));return new this.constructor(e,r)}toJSON(){return{step:this.step,points:this.points.slice(1).map(t=>t.toJSON())}}static fromJSON(t,e){N(t instanceof d),N(e&&"object"==typeof e),N(e.step>>>0===e.step),N(Array.isArray(e.points));const{curve:r}=t,{step:i}=e,n=[t];for(const t of e.points)n.push(r.pointFromJSON(t));return new this(i,n)}}class I{constructor(t,e){this.blind=t,this.unblind=e}toJSON(){return{blind:this.blind.toJSON(),unblind:this.unblind.toJSON()}}static fromJSON(t,e){N(t instanceof d),N(e&&"object"==typeof e);const{curve:r}=t;return new this(n.fromJSON(e.blind),r.pointFromJSON(e.unblind))}}class _{constructor(t,e,r,i){this.beta=t,this.lambda=e,this.basis=r,this.pre=i}toJSON(){return{beta:this.beta.fromRed().toJSON(),lambda:this.lambda.toJSON(),basis:[this.basis[0].toJSON(),this.basis[1].toJSON()],pre:[this.pre[0],this.pre[1].toJSON(),this.pre[2].toJSON()]}}static fromJSON(t,e){N(t instanceof u),N(e&&"object"==typeof e),N(Array.isArray(e.basis)),N(Array.isArray(e.pre)),N(2===e.basis.length),N(3===e.pre.length),N(e.pre[0]>>>0===e.pre[0]);return new this(n.fromJSON(e.beta).toRed(t.red),n.fromJSON(e.lambda),[x.fromJSON(e.basis[0]),x.fromJSON(e.basis[1])],[e.pre[0],n.fromJSON(e.pre[1]),n.fromJSON(e.pre[2])])}}class x{constructor(t,e){this.a=t,this.b=e}toJSON(){return{a:this.a.toJSON(),b:this.b.toJSON()}}static fromJSON(t){N(t&&"object"==typeof t);return new this(n.fromJSON(t.a),n.fromJSON(t.b))}}const B={__proto__:null,P192:class extends l{constructor(t){super({id:"P192",ossl:"prime192v1",type:"short",endian:"be",hash:"SHA256",prime:"p192",p:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff fffffffc"],b:["64210519 e59c80e7 0fa7e9ab 72243049","feb8deec c146b9b1"],n:["ffffffff ffffffff ffffffff 99def836","146bc9b1 b4d22831"],h:"1",z:"-5",g:[["188da80e b03090f6 7cbf20eb 43a18800","f4ff0afd 82ff1012"],["07192b95 ffc8da78 631011ed 6b24cdd5","73f977a1 1e794811"],t]})}},P224:class extends l{constructor(t){super({id:"P224",ossl:"secp224r1",type:"short",endian:"be",hash:"SHA256",prime:"p224",p:["ffffffff ffffffff ffffffff ffffffff","00000000 00000000 00000001"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff fffffffe"],b:["b4050a85 0c04b3ab f5413256 5044b0b7","d7bfd8ba 270b3943 2355ffb4"],n:["ffffffff ffffffff ffffffff ffff16a2","e0b8f03e 13dd2945 5c5c2a3d"],h:"1",z:"1f",g:[["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3","56c21122 343280d6 115c1d21"],["bd376388 b5f723fb 4c22dfe6 cd4375a0","5a074764 44d58199 85007e34"],t]})}},P256:class extends l{constructor(t){super({id:"P256",ossl:"prime256v1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff ffffffff"],a:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff fffffffc"],b:["5ac635d8 aa3a93e7 b3ebbd55 769886bc","651d06b0 cc53b0f6 3bce3c3e 27d2604b"],n:["ffffffff 00000000 ffffffff ffffffff","bce6faad a7179e84 f3b9cac2 fc632551"],h:"1",z:"-a",g:[["6b17d1f2 e12c4247 f8bce6e5 63a440f2","77037d81 2deb33a0 f4a13945 d898c296"],["4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16","2bce3357 6b315ece cbb64068 37bf51f5"],t]})}},P384:class extends l{constructor(t){super({id:"P384",ossl:"secp384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 ffffffff"],a:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 fffffffc"],b:["b3312fa7 e23ee7e4 988e056b e3f82d19","181d9c6e fe814112 0314088f 5013875a","c656398d 8a2ed19d 2a85c8ed d3ec2aef"],n:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff c7634d81 f4372ddf","581a0db2 48b0a77a ecec196a ccc52973"],h:"1",z:"-c",g:[["aa87ca22 be8b0537 8eb1c71e f320ad74","6e1d3b62 8ba79b98 59f741e0 82542a38","5502f25d bf55296c 3a545e38 72760ab7"],["3617de4a 96262c6f 5d9e98bf 9292dc29","f8f41dbd 289a147c e9da3113 b5f0b8c0","0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"],t]})}},P521:class extends l{constructor(t){super({id:"P521",ossl:"secp521r1",type:"short",endian:"be",hash:"SHA512",prime:"p521",p:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff"],a:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffc"],b:["00000051 953eb961 8e1c9a1f 929a21a0","b68540ee a2da725b 99b315f3 b8b48991","8ef109e1 56193951 ec7e937b 1652c0bd","3bb1bf07 3573df88 3d2c34f1 ef451fd4","6b503f00"],n:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffa 51868783 bf2f966b 7fcc0148","f709a5d0 3bb5c9b8 899c47ae bb6fb71e","91386409"],h:"1",z:"-4",g:[["000000c6 858e06b7 0404e9cd 9e3ecb66","2395b442 9c648139 053fb521 f828af60","6b4d3dba a14b5e77 efe75928 fe1dc127","a2ffa8de 3348b3c1 856a429b f97e7e31","c2e5bd66"],["00000118 39296a78 9a3bc004 5c8a5fb4","2c7d1bd9 98f54449 579b4468 17afbd17","273e662c 97ee7299 5ef42640 c550b901","3fad0761 353c7086 a272c240 88be9476","9fd16650"],t]})}},SECP256K1:class extends l{constructor(t){super({id:"SECP256K1",ossl:"secp256k1",type:"short",endian:"be",hash:"SHA256",prime:"k256",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe fffffc2f"],a:"0",b:"7",n:["ffffffff ffffffff ffffffff fffffffe","baaedce6 af48a03b bfd25e8c d0364141"],h:"1",z:"1",c:["0a2d2ba9 3507f1df 233770c2 a797962c","c61f6d15 da14ecd4 7d8d27ae 1cd5f852"],g:[["79be667e f9dcbbac 55a06295 ce870b07","029bfcdb 2dce28d9 59f2815b 16f81798"],["483ada77 26a3c465 5da4fbfc 0e1108a8","fd17b448 a6855419 9c47d08f fb10d4b8"],t],endo:{beta:["7ae96a2b 657c0710 6e64479e ac3434e9","9cf04975 12f58995 c1396c28 719501ee"],lambda:["5363ad4c c05c30e0 a5261c02 8812645a","122e22ea 20816678 df02967c 1b23bd72"],basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],pre:[384,["3086d221 a7d46bcd e86c90e4 9284eb15","3daa8a14 71e8ca7f e893209a 45dbb031"],["-","e4437ed6 010e8828 6f547fa9 0abfe4c4","221208ac 9df506c6 1571b4ae 8ac47f71"]]}})}},BRAINPOOLP256:class extends l{constructor(t){super({id:"BRAINPOOLP256",ossl:"brainpoolP256r1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["a9fb57db a1eea9bc 3e660a90 9d838d72","6e3bf623 d5262028 2013481d 1f6e5377"],a:["7d5a0975 fc2c3057 eef67530 417affe7","fb8055c1 26dc5c6c e94a4b44 f330b5d9"],b:["26dc5c6c e94a4b44 f330b5d9 bbd77cbf","95841629 5cf7e1ce 6bccdc18 ff8c07b6"],n:["a9fb57db a1eea9bc 3e660a90 9d838d71","8c397aa3 b561a6f7 901e0e82 974856a7"],h:"1",z:"-2",g:[["8bd2aeb9 cb7e57cb 2c4b482f fc81b7af","b9de27e1 e3bd23c2 3a4453bd 9ace3262"],["547ef835 c3dac4fd 97f8461a 14611dc9","c2774513 2ded8e54 5c1d54c7 2f046997"],t]})}},BRAINPOOLP384:class extends l{constructor(t){super({id:"BRAINPOOLP384",ossl:"brainpoolP384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b4 12b1da19 7fb71123","acd3a729 901d1a71 87470013 3107ec53"],a:["7bc382c6 3d8c150c 3c72080a ce05afa0","c2bea28e 4fb22787 139165ef ba91f90f","8aa5814a 503ad4eb 04a8c7dd 22ce2826"],b:["04a8c7dd 22ce2826 8b39b554 16f0447c","2fb77de1 07dcd2a6 2e880ea5 3eeb62d5","7cb43902 95dbc994 3ab78696 fa504c11"],n:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b3 1f166e6c ac0425a7","cf3ab6af 6b7fc310 3b883202 e9046565"],h:"1",z:"-5",g:[["1d1c64f0 68cf45ff a2a63a81 b7c13f6b","8847a3e7 7ef14fe3 db7fcafe 0cbd10e8","e826e034 36d646aa ef87b2e2 47d4af1e"],["8abe1d75 20f9c2a4 5cb1eb8e 95cfd552","62b70b29 feec5864 e19c054f f9912928","0e464621 77918111 42820341 263c5315"],t]})}},BRAINPOOLP512:class extends l{constructor(t){super({id:"BRAINPOOLP512",ossl:"brainpoolP512r1",type:"short",endian:"be",hash:"SHA512",prime:null,p:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330871","7d4d9b00 9bc66842 aecda12a e6a380e6","2881ff2f 2d82c685 28aa6056 583a48f3"],a:["7830a331 8b603b89 e2327145 ac234cc5","94cbdd8d 3df91610 a83441ca ea9863bc","2ded5d5a a8253aa1 0a2ef1c9 8b9ac8b5","7f1117a7 2bf2c7b9 e7c1ac4d 77fc94ca"],b:["3df91610 a83441ca ea9863bc 2ded5d5a","a8253aa1 0a2ef1c9 8b9ac8b5 7f1117a7","2bf2c7b9 e7c1ac4d 77fc94ca dc083e67","984050b7 5ebae5dd 2809bd63 8016f723"],n:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330870","553e5c41 4ca92619 41866119 7fac1047","1db1d381 085ddadd b5879682 9ca90069"],h:"1",z:"7",g:[["81aee4bd d82ed964 5a21322e 9c4c6a93","85ed9f70 b5d916c1 b43b62ee f4d0098e","ff3b1f78 e2d0d48d 50d1687b 93b97d5f","7c6d5047 406a5e68 8b352209 bcb9f822"],["7dde385d 566332ec c0eabfa9 cf7822fd","f209f700 24a57b1a a000c55b 881f8111","b2dcde49 4a5f485e 5bca4bd8 8a2763ae","d1ca2b2f a8f05406 78cd1e0f 3ad80892"],t]})}},X25519:class extends m{constructor(){super({id:"X25519",ossl:"X25519",type:"mont",endian:"le",hash:"SHA512",prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"76d06",b:"1",n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000009"],["5f51e65e 475f794b 1fe122d3 88b72eb3","6dc2b281 92839e4d d6163a5d 81312c14"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"],["6be4f497 f9a9c2af c21fa77a d7f4a6ef","635a11c7 284a9363 e9a248ef 9c884415"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"],["141b0b68 06563d50 3de05885 280b5910","9ca5ee38 d7b56c9c 165db710 6377bbd8"]],[["57119fd0 dd4e22d8 868e1c58 c45c4404","5bef839c 55b1d0b1 248c50a3 bc959c5f"],["68c59389 3d458e64 31c6ca00 45fb5015","20a44346 8eaa68dd 0f103842 048065b7"]],[["57119fd0 dd4e22d8 868e1c58 c45c4404","5bef839c 55b1d0b1 248c50a3 bc959c5f"],["173a6c76 c2ba719b ce3935ff ba04afea","df5bbcb9 71559722 f0efc7bd fb7f9a36"]],[["00b8495f 16056286 fdb1329c eb8d09da","6ac49ff1 fae35616 aeb8413b 7c7aebe0"],["3931c129 569e83a5 29482c14 e628b457","933bfc29 ed801b4d 68871483 92507b1a"]],[["00b8495f 16056286 fdb1329c eb8d09da","6ac49ff1 fae35616 aeb8413b 7c7aebe0"],["46ce3ed6 a9617c5a d6b7d3eb 19d74ba8","6cc403d6 127fe4b2 9778eb7c 6daf84d3"]]]})}},X448:class extends m{constructor(){super({id:"X448",ossl:"X448",type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"262a6",b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000005"],["7d235d12 95f5b1f6 6c98ab6e 58326fce","cbae5d34 f55545d0 60f75dc2 8df3f6ed","b8027e23 46430d21 1312c4b1 50677af7","6fd7223d 457b5b1a"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["ba4d3a08 29b6112f 8812e51b a0bb2abe","bc1cb08e b48e5569 36ba50fd d2e7d68a","f8cb3216 0522425b 3f990812 abbe635a","d37a21e1 7551b193"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["45b2c5f7 d649eed0 77ed1ae4 5f44d541","43e34f71 4b71aa96 c945af01 2d182975","0734cde9 faddbda4 c066f7ed 54419ca5","2c85de1e 8aae4e6c"]]]})}},MONT448:class extends m{constructor(){super({id:"MONT448",ossl:null,type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:["b2cf97d2 d43459a9 31ed36b1 fc4e3cb5","5d93f8d2 22746997 60ccffc6 49961ed6","c5b05fca c24864ed 6fb59697 931b78da","84ddecd8 ca2b5cfb"],b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["ac0d24cc c6c75cb0 eb71f81e 7a6edf51","48e88aee 009a2a24 e795687e c28e125a","3e6730a6 0d46367b aa7fe99d 152128dc","41321bc7 7817f059"],["5a4437f6 80c0d0db 9b061276 d5d0ffcc","e786ff33 b6a53d30 98746425 82e66f09","4433dae7 7244a6e2 6b11e905 7228f483","556c41a5 913f55fe"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["bec92fd0 6da2acf2 b4e261e8 7cef0d34","22e75c18 3c589857 b71924e5 73c2f9ce","e18da5f2 466e2f39 3c2eedf0 f105a60a","b40c717d 4f1e1fd7"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["4136d02f 925d530d 4b1d9e17 8310f2cb","dd18a3e7 c3a767a8 48e6db19 8c3d0631","1e725a0d b991d0c6 c3d1120f 0efa59f5","4bf38e82 b0e1e028"]]]})}},ED25519:class extends y{constructor(t){super({id:"ED25519",ossl:"ED25519",type:"edwards",endian:"le",hash:"SHA512",prefix:"SigEd25519 no Ed25519 collisions",context:!1,prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"-1",d:["52036cee 2b6ffe73 8cc74079 7779e898","00700a4d 4141d8ab 75eb4dca 135978a3"],n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["216936d3 cd6e53fe c0a4e231 fdd6dc5c","692cc760 9525a7b2 c9562d60 8f25d51a"],["66666666 66666666 66666666 66666666","66666666 66666666 66666666 66666658"],t],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffec"]],[["2b832480 4fc1df0b 2b4d0099 3dfbd7a7","2f431806 ad2fe478 c4ee1b27 4a0ea0b0"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["547cdb7f b03e20f4 d4b2ff66 c2042858","d0bce7f9 52d01b87 3b11e4d8 b5f15f3d"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["1fd5b9a0 06394a28 e9339932 38de4abb","5c193c70 13e5e238 dea14646 c545d14a"],["05fc536d 880238b1 3933c6d3 05acdfd5","f098eff2 89f4c345 b027b2c2 8f95e826"]],[["602a465f f9c6b5d7 16cc66cd c721b544","a3e6c38f ec1a1dc7 215eb9b9 3aba2ea3"],["05fc536d 880238b1 3933c6d3 05acdfd5","f098eff2 89f4c345 b027b2c2 8f95e826"]],[["1fd5b9a0 06394a28 e9339932 38de4abb","5c193c70 13e5e238 dea14646 c545d14a"],["7a03ac92 77fdc74e c6cc392c fa53202a","0f67100d 760b3cba 4fd84d3d 706a17c7"]],[["602a465f f9c6b5d7 16cc66cd c721b544","a3e6c38f ec1a1dc7 215eb9b9 3aba2ea3"],["7a03ac92 77fdc74e c6cc392c fa53202a","0f67100d 760b3cba 4fd84d3d 706a17c7"]]]})}},ISO448:class extends y{constructor(t){super({id:"ISO448",ossl:null,type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["d78b4bdc 7f0daf19 f24f38c2 9373a2cc","ad461572 42a50f37 809b1da3 412a12e7","9ccc9c81 264cfe9a d0809970 58fb61c4","243cc32d baa156b9"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["79a70b2b 70400553 ae7c9df4 16c792c6","1128751a c9296924 0c25a07d 728bdc93","e21f7787 ed697224 9de732f3 8496cd11","69871309 3e9c04fc"],["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 80000000","00000000 00000000 00000000 00000000","00000000 00000001"],t],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]]]})}},ED448:class extends y{constructor(t){super({id:"ED448",ossl:"ED448",type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffff6756"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["4f1970c6 6bed0ded 221d15a6 22bf36da","9e146570 470f1767 ea6de324 a3d3a464","12ae1af7 2ab66511 433b80e1 8b00938e","2626a82b c70cc05e"],["693f4671 6eb6bc24 88762037 56c9c762","4bea7373 6ca39840 87789c1e 05a0c2d7","3ad3ff1c e67c39c4 fdbd132c 4ed7c8ad","9808795b f230fa14"],t],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]]]})}}},k={__proto__:null,P192:null,P224:null,P256:null,P384:null,P521:null,SECP256K1:null,BRAINPOOLP256:null,BRAINPOOLP384:null,BRAINPOOLP512:null,X25519:null,X448:null,MONT448:null,ED25519:null,ISO448:null,ED448:null};function z(t,e,r){N(t instanceof n),N(!t.red),N(e>>>0===e),N(r>>>0===r);const i=new Array(r),s=t.bitLength()+1,o=1|t.sign();N(s<=r);for(let t=0;t<r;t++)i[t]=0;let f,a=0,c=0;for(;a<s;)t.bit(a)!==c?(f=t.bits(a,e)+c,c=f>>e-1&1,f-=c<<e,i[a]=o*f,a+=e):a+=1;return N(0===c),i}function q(t,e,r){const i=function(t,e,r){N(t instanceof n),N(e instanceof n),N(!t.red),N(!e.red),N(r>>>0===r);const i=[new Array(r),new Array(r)],s=Math.max(t.bitLength(),e.bitLength())+1,o=1|t.sign(),f=1|e.sign();N(s<=r);let a=0,c=0;for(let r=0;r<s;r++){const n=t.bits(r,3),s=e.bits(r,3);let h=(3&n)+a&3,u=(3&s)+c&3,d=0,l=0;if(3===h&&(h=-1),3===u&&(u=-1),1&h){const t=(7&n)+a&7;d=3!==t&&5!==t||2!==u?h:-h}if(1&u){const t=(7&s)+c&7;l=3!==t&&5!==t||2!==h?u:-u}i[0][r]=d*o,i[1][r]=l*f,2*a===1+d&&(a=1-a),2*c===1+l&&(c=1-c)}for(let t=s;t<r;t++)i[0][t]=0,i[1][t]=0;return i}(t,e,r),s=new Array(r);for(let t=0;t<r;t++){const e=i[0][t],r=i[1][t];s[t]=c[3*(e+1)+(r+1)]}return s}function N(t,e){if(!t){const t=new Error(e||"Assertion failed");throw Error.captureStackTrace&&Error.captureStackTrace(t,N),t}}function P(t){N("function"==typeof t);try{return t()}catch(t){if("X is not a square mod P."===t.message||"Not invertible."===t.message)throw new Error("Invalid point.");throw t}}function R(t){const e=function(t){N(t instanceof n),N(t.red);const e=t.red.m;if(e.cmpn(3)<=0)return t.clone();if(2===e.modrn(3)){const r=e.ushln(1).isubn(1).idivn(3);return t.redPow(r)}const r=e.modrn(9);if(4===r){const r=e.ushln(1).iaddn(1).idivn(9),i=t.redPow(r);if(!i.redSqr().redMul(i).eq(t))throw new Error("X is not a cube mod P.");return i}if(7===r){const r=e.addn(2).idivn(9),i=t.redPow(r);if(!i.redSqr().redMul(i).eq(t))throw new Error("X is not a cube mod P.");return i}throw new Error("Not implemented.")}(t);if(1===t.red.m.modrn(3)){const r=new n(2).toRed(t.red),i=new n(3).toRed(t.red),s=r.redInvert(),o=i.redNeg().redSqrt().redMul(s),f=o.redNeg(),a=o.redSub(s),c=f.redSub(s),h=e.redMul(a),u=e.redMul(c);return[e,h,u]}return[e]}function O(t){for(const e of R(t))if(e.redJacobi()>=0)return e;throw new Error("X^(1/3) is not a square mod P.")}function U(t){return n.randomBits(t,32).toNumber()}function C(t,e){const r=new WeakMap;return function(i,n){const s=1&n,o=r.get(i);if(o&&null!==o[s])return o[s];const f=t.call(e,i,n);return r.has(i)||r.set(i,[null,null]),r.get(i)[s]=f,f}}function T(t,e){N(t instanceof n),N(e>>>0===e),7&e&&(e+=8-(7&e));const r=t.toString(16,e),i=[],s=[];N(0==(7&r.length));for(let t=0;t<r.length;t+=8)i.push(r.slice(t,t+8));for(let t=0;t<i.length;t+=4)s.push(i.slice(t,t+4).join(" "));return s}e.Curve=u,e.Point=d,e.ShortCurve=l,e.ShortPoint=b,e.JPoint=p,e.MontCurve=m,e.MontPoint=g,e.XPoint=w,e.EdwardsCurve=y,e.EdwardsPoint=v,e.curves=B,e.curve=function(t,...e){N("string"==typeof t);const r=t.toUpperCase();let i=k[r];if(!i){const n=B[r];if(!n)throw new Error(`Curve not found: "${t}".`);i=new n(...e),k[r]=i}return i},e.register=function(t,e){N("string"==typeof t),N("function"==typeof e);const r=t.toUpperCase();if(B[r])throw new Error(`Curve already registered: "${t}".`);B[r]=e,k[r]=null}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * cipher.js - cipher for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(195)},function(t,e,r){"use strict";(function(e){
/*!
 * cshake.js - cSHAKE implementation for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://keccak.team/specifications.html
 *   https://www.nist.gov/node/1131611
 *   https://doi.org/10.6028/NIST.SP.800-185
 *   https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf
 *   https://github.com/XKCP/XKCP/blob/8f447eb/lib/high/Keccak/SP800-185/SP800-185.inc
 *   https://github.com/XKCP/XKCP/blob/8f447eb/lib/high/Keccak/SP800-185/SP800-185.c
 *   https://github.com/XKCP/XKCP/blob/8f447eb/tests/UnitTests/testSP800-185.c
 *   https://github.com/emn178/js-sha3/blob/master/src/sha3.js
 */
const i=r(1),n=r(17),s=r(3),o=e.alloc(0),f=e.alloc(200,0);class a extends n{constructor(){super(),this.pad=4,this.rate=1088}init(t,r,n){if(null==t&&(t=256),null==r&&(r=o),null==n&&(n=o),i(t>>>0===t),i(128===t||256===t),i(e.isBuffer(r)),i(e.isBuffer(n)),super.init(t),0===r.length&&0===n.length)this.pad=31;else{const e=1600-2*t,i=e/8;this.bytePad([r,n],i),this.rate=e,this.pad=4}return this}final(t){return super.final(this.pad,t)}bytePad(t,e){i(Array.isArray(t)),i(e>>>0===e),i(e>0);let r=this.leftEncode(e);for(const e of t)r+=this.encodeString(e);const n=e-r%e;return n===e||(r+=this.zeroPad(n)),r}encodeString(t){i(e.isBuffer(t));const r=this.leftEncode(8*t.length);return this.update(t),r+t.length}zeroPad(t){i(t>>>0===t),i(t<=200);const e=f.slice(0,t);return this.update(e),e.length}leftEncode(t){i(t>>>0===t),i(t>=0&&t<22040);let r=t,n=0;for(;r&&n<4;)n+=1,r>>>=8;0===n&&(n=1);const s=e.alloc(n+1);for(let e=1;e<=n;e++)s[e]=t>>>8*(n-e);return s[0]=n,this.update(s),s.length}rightEncode(t){i(t>>>0===t),i(t>=0&&t<22040);let r=t,n=0;for(;r&&n<4;)n+=1,r>>>=8;0===n&&(n=1);const s=e.alloc(n+1);for(let e=1;e<=n;e++)s[e-1]=t>>>8*(n-e);return s[n]=n,this.update(s),s.length}static hash(){return new a}static hmac(t,e,r,n){null==t&&(t=256),i(t>>>0===t),i(128===t||256===t);return new s(a,(1600-2*t)/8,[t,e,r],[n])}static digest(t,e,r,i,n){return a.ctx.init(e,r,i).update(t).final(n)}static root(t,r,n,s,o,f){null==n&&(n=256),null==f&&(f=0),0===f&&(i(n>>>0===n),f=n>>>3),i(f>>>0===f),i(e.isBuffer(t)&&t.length===f),i(e.isBuffer(r)&&r.length===f);const{ctx:c}=a;return c.init(n,s,o),c.update(t),c.update(r),c.final(f)}static multi(t,e,r,i,n,s,o){const{ctx:f}=a;return f.init(i,n,s),f.update(t),f.update(e),r&&f.update(r),f.final(o)}static mac(t,e,r,i,n,s){return a.hmac(r,i,n,s).init(e).update(t).final()}}a.native=n.native,a.id="CSHAKE256",a.size=32,a.bits=256,a.blockSize=136,a.zero=e.alloc(32,0),a.ctx=new a,t.exports=a}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * sha256.js - SHA256 implementation for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/hash.js:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/hash.js
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/SHA-2
 *   https://tools.ietf.org/html/rfc4634
 *   https://github.com/indutny/hash.js/blob/master/lib/hash/sha/256.js
 */
const i=r(1),n=r(3),s=e.alloc(8,0),o=e.alloc(64,0);o[0]=128;const f=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);class a{constructor(){this.state=new Uint32Array(8),this.msg=new Uint32Array(64),this.block=e.alloc(64),this.size=-1}init(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.size=0,this}update(t){return i(e.isBuffer(t)),this._update(t,t.length),this}final(){return this._final(e.alloc(32))}_update(t,e){i(-1!==this.size,"Context is not initialized.");let r=63&this.size,n=0;if(this.size+=e,r>0){let i=64-r;if(i>e&&(i=e),t.copy(this.block,r,n,n+i),r+=i,e-=i,n+=i,r<64)return;this._transform(this.block,0)}for(;e>=64;)this._transform(t,n),n+=64,e-=64;e>0&&t.copy(this.block,0,n,n+e)}_final(t){i(-1!==this.size,"Context is not initialized.");const e=63&this.size,r=8*this.size;b(s,r*(1/4294967296)>>>0,0),b(s,r>>>0,4),this._update(o,1+(119-e&63)),this._update(s,8);for(let e=0;e<8;e++)b(t,this.state[e],4*e),this.state[e]=0;for(let t=0;t<64;t++)this.msg[t]=0;for(let t=0;t<64;t++)this.block[t]=0;return this.size=-1,t}_transform(t,e){const r=this.msg;let i=this.state[0],n=this.state[1],s=this.state[2],o=this.state[3],a=this.state[4],b=this.state[5],p=this.state[6],m=this.state[7],g=0;for(;g<16;g++)r[g]=(y=e+4*g,16777216*(w=t)[y++]+65536*w[y++]+256*w[y++]+w[y]);for(var w,y,v;g<64;g++)r[g]=(((v=r[g-2])>>>17|v<<15)^(v>>>19|v<<13)^v>>>10)+r[g-7]+u(r[g-15])+r[g-16];for(g=0;g<64;g++){const t=m+h(a)+d(a,b,p)+f[g]+r[g],e=c(i)+l(i,n,s);m=p,p=b,b=a,a=o+t>>>0,o=s,s=n,n=i,i=t+e>>>0}this.state[0]+=i,this.state[1]+=n,this.state[2]+=s,this.state[3]+=o,this.state[4]+=a,this.state[5]+=b,this.state[6]+=p,this.state[7]+=m}static hash(){return new a}static hmac(){return new n(a,64)}static digest(t){return a.ctx.init().update(t).final()}static root(t,r){return i(e.isBuffer(t)&&32===t.length),i(e.isBuffer(r)&&32===r.length),a.ctx.init().update(t).update(r).final()}static multi(t,e,r){const{ctx:i}=a;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return a.hmac().init(e).update(t).final()}}function c(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function h(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function u(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}function d(t,e,r){return r^t&(e^r)}function l(t,e,r){return t&e|r&(t|e)}function b(t,e,r){return t[r++]=e>>>24,t[r++]=e>>>16,t[r++]=e>>>8,t[r++]=e,r}a.native=0,a.id="SHA256",a.size=32,a.bits=256,a.blockSize=64,a.zero=e.alloc(32,0),a.ctx=new a,t.exports=a}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * util.js - encoding utils for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(1);function n(e){i(t.isBuffer(e));let r=0;for(;r<e.length&&0===e[r];)r+=1;return e.slice(r)}function s(e){i(t.isBuffer(e));let r=e.length;for(;r>0&&0===e[r-1];)r-=1;return e.slice(0,r)}e.countLeft=function(e){i(t.isBuffer(e));let r=0;for(;r<e.length&&0===e[r];)r+=1;let n=8*(e.length-r);if(0===n)return 0;n-=8;let s=e[r];for(;s;)n+=1,s>>>=1;return n},e.countRight=function(e){i(t.isBuffer(e));let r=e.length;for(;r>0&&0===e[r-1];)r-=1;let n=8*r;if(0===n)return 0;n-=8;let s=e[r-1];for(;s;)n+=1,s>>>=1;return n},e.compareLeft=function(e,r){i(t.isBuffer(e)),i(t.isBuffer(r));let n=0,s=e.length,o=0,f=r.length;for(;s>0&&0===e[n];)n+=1,s-=1;for(;f>0&&0===r[o];)o+=1,f-=1;if(s<f)return-1;if(s>f)return 1;for(let t=0;t<s;t++){if(e[n+t]<r[o+t])return-1;if(e[n+t]>r[o+t])return 1}return 0},e.compareRight=function(e,r){i(t.isBuffer(e)),i(t.isBuffer(r));let n=e.length,s=r.length;for(;n>0&&0===e[n-1];)n-=1;for(;s>0&&0===r[s-1];)s-=1;if(n<s)return-1;if(n>s)return 1;for(let t=n-1;t>=0;t--){if(e[t]<r[t])return-1;if(e[t]>r[t])return 1}return 0},e.trimLeft=n,e.trimRight=s,e.padLeft=function(e,r){if(i(t.isBuffer(e)),i(r>>>0===r),e.length>r&&(e=n(e)),e.length>r)throw new RangeError(`Buffer expected to be ${r} bytes in size.`);const s=t.alloc(r,0);return e.copy(s,r-e.length),s},e.padRight=function(e,r){if(i(t.isBuffer(e)),i(r>>>0===r),e.length>r&&(e=s(e)),e.length>r)throw new RangeError(`Buffer expected to be ${r} bytes in size.`);const n=t.alloc(r,0);return e.copy(n,0),n}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * shake256.js - SHAKE256 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(51);class n extends i{constructor(){super()}init(){return super.init(256)}static hash(){return new n}static hmac(t){return super.hmac(256,t)}static digest(t,e){return super.digest(t,256,e)}static root(t,e,r){return super.root(t,e,256,r)}static multi(t,e,r,i){return super.multi(t,e,r,256,i)}static mac(t,e,r){return super.mac(t,e,256,r)}}n.native=i.native,n.id="SHAKE256",n.size=32,n.bits=256,n.blockSize=136,n.zero=e.alloc(32,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * encoding.js - encoding utils for bcoin
 * Copyright (c) 2014-2015, Fedor Indutny (MIT License)
 * Copyright (c) 2014-2017, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */
const i=r(20),n=r(27),s=1/4294967296,{MAX_SAFE_INTEGER:o}=Number,f=new Float32Array(1),a=new Uint8Array(f.buffer),c=new Float64Array(1),h=new Uint8Array(c.buffer);f[0]=-1;const u=0===a[3];function d(t,e){const r=m(t,e+4),i=m(t,e);return qt(0==(4292870144&r),e,"Number exceeds 2^53-1"),4294967296*r+i}function l(t,e){const r=g(t,e+4),i=m(t,e);return qt(0==(4292870144&r),e,"Number exceeds 2^53-1"),4294967296*r+i}function b(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e++]+4294967296*t[e++]+1099511627776*t[e]}function p(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e++]+4294967296*t[e]}function m(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]}function g(t,e){return t[e++]+256*t[e++]+65536*t[e]}function w(t,e){return t[e++]+256*t[e]}function y(t,e){return t[e]}function v(t,e){const r=A(t,e),i=A(t,e+4);return qt(0==(4292870144&r),e,"Number exceeds 2^53-1"),4294967296*r+i}function S(t,e){const r=I(t,e),i=A(t,e+3);return qt(0==(4292870144&r),e,"Number exceeds 2^53-1"),4294967296*r+i}function E(t,e){return 1099511627776*t[e++]+4294967296*t[e++]+16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function M(t,e){return 4294967296*t[e++]+16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function A(t,e){return 16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function I(t,e){return 65536*t[e++]+256*t[e++]+t[e]}function _(t,e){return 256*t[e++]+t[e]}function x(t,e){const r=q(t,e+4),i=m(t,e);return qt(It(r,i),"Number exceeds 2^53-1"),4294967296*r+i}function B(t,e){const r=N(t,e+4),i=m(t,e);return qt(It(r,i),"Number exceeds 2^53-1"),4294967296*r+i}function k(t,e){const r=t[e+4]+256*t[e+5];return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]+4294967296*(r|131070*(32768&r))}function z(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e++]+4294967296*(t[e]|33554430*(128&t[e]))}function q(t,e){return t[e++]+256*t[e++]+65536*t[e++]+(t[e]<<24)}function N(t,e){const r=t[e++]+256*t[e++]+65536*t[e];return r|510*(8388608&r)}function P(t,e){const r=t[e++]+256*t[e];return r|131070*(32768&r)}function R(t,e){const r=t[e];return r|33554430*(128&r)}function O(t,e){const r=D(t,e),i=A(t,e+4);return qt(It(r,i),"Number exceeds 2^53-1"),4294967296*r+i}function U(t,e){const r=L(t,e),i=A(t,e+3);return qt(It(r,i),"Number exceeds 2^53-1"),4294967296*r+i}function C(t,e){const r=256*t[e++]+t[e++];return 4294967296*(r|131070*(32768&r))+16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function T(t,e){const r=t[e++];return 4294967296*(r|33554430*(128&r))+16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function D(t,e){return(t[e++]<<24)+65536*t[e++]+256*t[e++]+t[e]}function L(t,e){const r=65536*t[e++]+256*t[e++]+t[e];return r|510*(8388608&r)}function K(t,e){const r=256*t[e++]+t[e];return r|131070*(32768&r)}function H(t,e){return a[3]=t[e++],a[2]=t[e++],a[1]=t[e++],a[0]=t[e],f[0]}function j(t,e){return a[0]=t[e++],a[1]=t[e++],a[2]=t[e++],a[3]=t[e],f[0]}function F(t,e){return h[7]=t[e++],h[6]=t[e++],h[5]=t[e++],h[4]=t[e++],h[3]=t[e++],h[2]=t[e++],h[1]=t[e++],h[0]=t[e],c[0]}function Z(t,e){return h[0]=t[e++],h[1]=t[e++],h[2]=t[e++],h[3]=t[e++],h[4]=t[e++],h[5]=t[e++],h[6]=t[e++],h[7]=t[e],c[0]}const V=u?H:j,G=u?j:H,J=u?F:Z,Y=u?Z:F;function X(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),_t(t,e,r,!1)}function W(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),xt(t,e,r,!1)}function $(t,e,r){i(Number.isSafeInteger(e),"num","integer");const n=e*s|0;return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,t[r++]=n,t[r++]=n>>>8,r}function Q(t,e,r){i(Number.isSafeInteger(e),"num","integer");const n=e*s|0;return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,t[r++]=n,r}function tt(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}function et(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}function rt(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r++]=e,t[r++]=e>>>8,r}function it(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r]=e,r+1}function nt(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),_t(t,e,r,!0)}function st(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),xt(t,e,r,!0)}function ot(t,e,r){i(Number.isSafeInteger(e),"num","integer");const n=e*s|0;return t[r++]=n>>>8,t[r++]=n,t[r+3]=e,e>>>=8,t[r+2]=e,e>>>=8,t[r+1]=e,e>>>=8,t[r]=e,r+4}function ft(t,e,r){i(Number.isSafeInteger(e),"num","integer");const n=e*s|0;return t[r++]=n,t[r+3]=e,e>>>=8,t[r+2]=e,e>>>=8,t[r+1]=e,e>>>=8,t[r]=e,r+4}function at(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r+3]=e,e>>>=8,t[r+2]=e,e>>>=8,t[r+1]=e,e>>>=8,t[r]=e,r+4}function ct(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r+2]=e,e>>>=8,t[r+1]=e,e>>>=8,t[r]=e,r+3}function ht(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r++]=e>>>8,t[r++]=e,r}function ut(t,e,r){return tt(t,e,r)}function dt(t,e,r){return et(t,e,r)}function lt(t,e,r){return at(t,e,r)}function bt(t,e,r){return ct(t,e,r)}function pt(t,e,r){return i(kt(e),"num","number"),c[0]=e,t[r++]=h[0],t[r++]=h[1],t[r++]=h[2],t[r++]=h[3],t[r++]=h[4],t[r++]=h[5],t[r++]=h[6],t[r++]=h[7],r}function mt(t,e,r){return i(kt(e),"num","number"),c[0]=e,t[r++]=h[7],t[r++]=h[6],t[r++]=h[5],t[r++]=h[4],t[r++]=h[3],t[r++]=h[2],t[r++]=h[1],t[r++]=h[0],r}function gt(t,e,r){return i(kt(e),"num","number"),f[0]=e,t[r++]=a[0],t[r++]=a[1],t[r++]=a[2],t[r++]=a[3],r}function wt(t,e,r){return i(kt(e),"num","number"),f[0]=e,t[r++]=a[3],t[r++]=a[2],t[r++]=a[1],t[r++]=a[0],r}const yt=u?wt:gt,vt=u?gt:wt,St=u?mt:pt,Et=u?pt:mt;function Mt(t){return i(Number.isSafeInteger(t),"num","integer"),t<253?1:t<=65535?3:t<=4294967295?5:9}function At(e,r){i(t.isBuffer(e),"data","buffer");const n=t.allocUnsafeSlow(r);return e.copy(n,0),n}function It(t,e){return t<0&&(t=~t,0===e&&(t+=1)),0==(4292870144&t)}function _t(t,e,r,i){let n=!1;e<0&&(e=-e,n=!0);let o=e*s|0,f=0|e;return n&&(0===f?o=1+~o|0:(o=~o,f=1+~f)),i?(r=lt(t,o,r),r=lt(t,f,r)):(r=ut(t,f,r),r=ut(t,o,r)),r}function xt(t,e,r,i){let n=!1;e<0&&(e=-e,n=!0);let o=e*s|0,f=0|e;return n&&(0===f?o=1+~o|0:(o=~o,f=1+~f)),r=i?lt(t,f,r=bt(t,o,r)):dt(t,o,r=ut(t,f,r))}class Bt{constructor(t,e){this.size=t,this.value=e}}function kt(t){return"number"==typeof t&&isFinite(t)}function zt(t,e){if(!t)throw new n(e,"Out of bounds read",zt)}function qt(t,e,r){if(!t)throw new n(e,r,qt)}e.readU=function(t,e,r){switch(r){case 8:return d(t,e);case 7:return l(t,e);case 6:return b(t,e);case 5:return p(t,e);case 4:return m(t,e);case 3:return g(t,e);case 2:return w(t,e);case 1:return y(t,e);default:throw new n(e,"Invalid read length")}},e.readU64=d,e.readU56=l,e.readU48=b,e.readU40=p,e.readU32=m,e.readU24=g,e.readU16=w,e.readU8=y,e.readUBE=function(t,e,r){switch(r){case 8:return v(t,e);case 7:return S(t,e);case 6:return E(t,e);case 5:return M(t,e);case 4:return A(t,e);case 3:return I(t,e);case 2:return _(t,e);case 1:return y(t,e);default:throw new n(e,"Invalid read length")}},e.readU64BE=v,e.readU56BE=S,e.readU48BE=E,e.readU40BE=M,e.readU32BE=A,e.readU24BE=I,e.readU16BE=_,e.readI=function(t,e,r){switch(r){case 8:return x(t,e);case 7:return B(t,e);case 6:return k(t,e);case 5:return z(t,e);case 4:return q(t,e);case 3:return N(t,e);case 2:return P(t,e);case 1:return R(t,e);default:throw new n(e,"Invalid read length")}},e.readI64=x,e.readI56=B,e.readI48=k,e.readI40=z,e.readI32=q,e.readI24=N,e.readI16=P,e.readI8=R,e.readIBE=function(t,e,r){switch(r){case 8:return O(t,e);case 7:return U(t,e);case 6:return C(t,e);case 5:return T(t,e);case 4:return D(t,e);case 3:return L(t,e);case 2:return K(t,e);case 1:return R(t,e);default:throw new n(e,"Invalid read length")}},e.readI64BE=O,e.readI56BE=U,e.readI48BE=C,e.readI40BE=T,e.readI32BE=D,e.readI24BE=L,e.readI16BE=K,e.readFloat=V,e.readFloatBE=G,e.readDouble=J,e.readDoubleBE=Y,e.writeU=function(t,e,r,i){switch(i){case 8:return X(t,e,r);case 7:return W(t,e,r);case 6:return $(t,e,r);case 5:return Q(t,e,r);case 4:return tt(t,e,r);case 3:return et(t,e,r);case 2:return rt(t,e,r);case 1:return it(t,e,r);default:throw new n(r,"Invalid write length")}},e.writeU64=X,e.writeU56=W,e.writeU48=$,e.writeU40=Q,e.writeU32=tt,e.writeU24=et,e.writeU16=rt,e.writeU8=it,e.writeUBE=function(t,e,r,i){switch(i){case 8:return nt(t,e,r);case 7:return st(t,e,r);case 6:return ot(t,e,r);case 5:return ft(t,e,r);case 4:return at(t,e,r);case 3:return ct(t,e,r);case 2:return ht(t,e,r);case 1:return it(t,e,r);default:throw new n(r,"Invalid write length")}},e.writeU64BE=nt,e.writeU56BE=st,e.writeU48BE=ot,e.writeU40BE=ft,e.writeU32BE=at,e.writeU24BE=ct,e.writeU16BE=ht,e.writeI=function(t,e,r,i){switch(i){case 8:return X(t,e,r);case 7:return W(t,e,r);case 6:return $(t,e,r);case 5:return Q(t,e,r);case 4:return et(t,e,r);case 3:return tt(t,e,r);case 2:return rt(t,e,r);case 1:return it(t,e,r);default:throw new n(r,"Invalid write length")}},e.writeI64=function(t,e,r){return X(t,e,r)},e.writeI56=function(t,e,r){return W(t,e,r)},e.writeI48=function(t,e,r){return $(t,e,r)},e.writeI40=function(t,e,r){return Q(t,e,r)},e.writeI32=ut,e.writeI24=dt,e.writeI16=function(t,e,r){return rt(t,e,r)},e.writeI8=function(t,e,r){return it(t,e,r)},e.writeIBE=function(t,e,r,i){switch(i){case 8:return nt(t,e,r);case 7:return st(t,e,r);case 6:return ot(t,e,r);case 5:return ft(t,e,r);case 4:return at(t,e,r);case 3:return ct(t,e,r);case 2:return ht(t,e,r);case 1:return it(t,e,r);default:throw new n(r,"Invalid write length")}},e.writeI64BE=function(t,e,r){return nt(t,e,r)},e.writeI56BE=function(t,e,r){return st(t,e,r)},e.writeI48BE=function(t,e,r){return ot(t,e,r)},e.writeI40BE=function(t,e,r){return ft(t,e,r)},e.writeI32BE=lt,e.writeI24BE=bt,e.writeI16BE=function(t,e,r){return ht(t,e,r)},e.writeFloat=yt,e.writeFloatBE=vt,e.writeDouble=St,e.writeDoubleBE=Et,e.readVarint=function(t,e){let r,i;switch(zt(e<t.length,e),t[e]){case 255:i=9,zt(e+i<=t.length,e),r=d(t,e+1),qt(r>4294967295,e,"Non-canonical varint");break;case 254:i=5,zt(e+i<=t.length,e),r=m(t,e+1),qt(r>65535,e,"Non-canonical varint");break;case 253:i=3,zt(e+i<=t.length,e),r=w(t,e+1),qt(r>=253,e,"Non-canonical varint");break;default:i=1,r=t[e]}return new Bt(i,r)},e.writeVarint=function(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),e<253?(t[r++]=e,r):e<=65535?(t[r++]=253,rt(t,e,r)):e<=4294967295?(t[r++]=254,tt(t,e,r)):(t[r++]=255,X(t,e,r))},e.sizeVarint=Mt,e.readVarint2=function(t,e){let r=0,i=0;for(;;){zt(e<t.length,e);const n=t[e++];if(i+=1,qt(r<=70368744177663-(127&n),e,"Number exceeds 2^53-1"),r=128*r+(127&n),0==(128&n))break;qt(r!==o,e,"Number exceeds 2^53-1"),r+=1}return new Bt(i,r)},e.writeVarint2=function(t,e,r){i(Number.isSafeInteger(e),"num","integer");const n=[];let s=0;for(;n[s]=127&e|(s?128:0),!(e<=127);)e=(e-e%128)/128-1,s+=1;zt(r+s+1<=t.length,r);do{t[r++]=n[s]}while(s--);return r},e.sizeVarint2=function(t){i(Number.isSafeInteger(t),"num","integer");let e=0;for(;e+=1,!(t<=127);)t=(t-t%128)/128-1;return e},e.sliceBytes=function(e,r,s){if(i(t.isBuffer(e),"data","buffer"),i(r>>>0===r,"off","integer"),i(s>>>0===s,"size","integer"),r+s>e.length)throw new n(r,"Out of bounds read");return e.slice(r,r+s)},e.readBytes=function(e,r,s){if(i(t.isBuffer(e),"data","buffer"),i(r>>>0===r,"off","integer"),i(s>>>0===s,"size","integer"),r+s>e.length)throw new n(r,"Out of bounds read");const o=t.allocUnsafeSlow(s);return e.copy(o,0,r,r+s),o},e.writeBytes=function(e,r,s){if(i(t.isBuffer(e),"data","buffer"),i(t.isBuffer(r),"value","buffer"),i(s>>>0===s,"off","integer"),s+r.length>e.length)throw new n(s,"Out of bounds write");return r.copy(e,s,0,r.length)},e.readString=function(e,r,s,o){if(null==o&&(o="binary"),i(t.isBuffer(e),"data","buffer"),i(r>>>0===r,"off","integer"),i(s>>>0===s,"size","integer"),i("string"==typeof o,"enc","string"),r+s>e.length)throw new n(r,"Out of bounds read");return e.toString(o,r,r+s)},e.writeString=function(e,r,s,o){if(null==o&&(o="binary"),i(t.isBuffer(e),"data","buffer"),i("string"==typeof r,"str","string"),i(s>>>0===s,"off","integer"),i("string"==typeof o,"enc","string"),0===r.length)return 0;if(s+t.byteLength(r,o)>e.length)throw new n(s,"Out of bounds write");return e.write(r,s,o)},e.realloc=At,e.copy=function(e){return i(t.isBuffer(e),"data","buffer"),At(e,e.length)},e.concat=function(e,r){i(t.isBuffer(e),"a","buffer"),i(t.isBuffer(r),"b","buffer");const n=e.length+r.length,s=t.allocUnsafeSlow(n);return e.copy(s,0),r.copy(s,e.length),s},e.sizeVarBytes=function(e){return i(t.isBuffer(e),"data","buffer"),Mt(e.length)+e.length},e.sizeVarlen=function(t){return Mt(t)+t},e.sizeVarString=function(e,r){if(null==r&&(r="binary"),i("string"==typeof e,"str","string"),i("string"==typeof r,"enc","string"),0===e.length)return 1;const n=t.byteLength(e,r);return Mt(n)+n}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * base64.js - base64 for bcrypto
 * Copyright (c) 2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(226)},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.toHexString=e.flipbits=e.NEGATIVE_1_64=e.MIN_INTEGER_64=e.MAX_INTEGER_64=e.ZERO_64=void 0;var n=i(r(8)),s=i(r(29)),o=r(57);e.ZERO_64=new s.default((0,o.convert64)(n.default.fromHex("00")).bin,2),e.MAX_INTEGER_64=new s.default("1111111111111111111111111111111111111111111111111111111101111111",2),e.MIN_INTEGER_64=new s.default("0000000000000000000000000000000000000000000000000000000010000000",2),e.NEGATIVE_1_64=new s.default("0000000000000000000000000000000000000000000000000000000010000001",2);e.flipbits=function(t){return t.split("").map((function(t){return(1-t).toString()})).join("")};e.toHexString=function(t){return Array.from(t,(function(t){return("0"+(255&t).toString(16)).slice(-2)})).join("")}},function(t,e,r){"use strict";(function(t){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.schnorrCreatePublicKey=e.secp256k1CreatePublicKey=e.secp256k1Verify=e.schnorrSign=e.secp256k1Sign=e.schnorrKeyGenerator=e.secp256k1KeyGenerator=e.shnorrSigVerify=e.tweakVerify=e.checkSig=e.ecdsaVerify=e.hash256=e.hash160v2=e.sha256v2=e.hash160=e.sha256=e.sha1=e.ripemd160=void 0;var n=i(r(122)),s=i(r(147)),o=i(r(29)),f=i(r(8)),a=i(r(67)),c=r(112);e.ripemd160=function(t){return n.default.RIPEMD160(n.default.enc.Hex.parse(t.hex))};e.sha1=function(t){return n.default.SHA1(n.default.enc.Hex.parse(t.hex))};e.sha256=function(t){return n.default.SHA256(n.default.enc.Hex.parse(t.hex))};e.hash160=function(t){var e=n.default.SHA256(n.default.enc.Hex.parse(t.hex));return n.default.RIPEMD160(e)};e.sha256v2=function(t){return n.default.SHA256(n.default.enc.Hex.parse(t.hex)).toString()};e.hash160v2=function(t){var e=n.default.SHA256(n.default.enc.Hex.parse(t.hex));return n.default.RIPEMD160(e).toString()};e.hash256=function(t){var e=n.default.SHA256(n.default.enc.Hex.parse(t.hex));return n.default.SHA256(e)};e.ecdsaVerify=function(t,r,i){var n=new s.default.ec("secp256k1"),a=(0,e.sha256)(r).toString(),c=i.hex,h=t.hex;if(66!==c.length)throw"ECDSA Verify error : invalid public key length";if(!h.startsWith("30"))throw"ECDSA Verify error : signature must start with 0x30";var u=2*Number("0x"+h.substr(2,2))+4;if(h.length!==u)throw"ECDSA Verify error : signature length invalid";var d=Number("0x"+h.substr(6,2)),l=h.substr(8,2*d),b=Number("0x"+h.substr(10+2*d,2)),p=h.substr(10+2*d+2,2*b),m=new o.default(l,"hex"),g=new o.default(p,"hex");try{return f.default.fromNumber(n.verify(a,{r:m,s:g},n.keyFromPublic(c,"hex"))?1:0)}catch(t){throw"ECDSA Verify error : something went wrong"}};e.checkSig=function(t,e){var r=t.hex;if(68!==e.hex.length)return f.default.fromNumber(0);if(!r.startsWith("0x30"))return f.default.fromNumber(0);var i=2*Number("0x"+r.substr(4,2))+6;return r.length!==i?f.default.fromNumber(0):f.default.fromNumber(1)};e.tweakVerify=function(t,e,r){var i=r,n=e,s=t;if(32!=n.bytes.length)throw"Tweak key length must be eqaul 32 byte";if(32!=i.bytes.length)throw"Internal key length must be eqaul 32 byte";if(2!==s.bytes[0]&&3!==s.bytes[0])throw"Tweaked key must start with 0x02 or 0x03";var o=(0,c.publicKeyTweakCheckWithPrefix)(i,n,s);return f.default.fromNumber(o?1:0)};e.shnorrSigVerify=function(e,r,i){if(32!==i.bytes.length)throw"Schnorr Verify error : invalid public key length";if(64!==e.bytes.length)throw"Schnorr Verify error : signature length must be equal 64 byte";var n=t.from(i.hex,"hex"),s=t.from(e.hex,"hex"),o=t.from(r.hex,"hex");try{return f.default.fromNumber(a.default.schnorr.verify(o,s,n)?1:0)}catch(t){throw"ECDSA Verify error : something went wrong"}};e.secp256k1KeyGenerator=function(){var t=a.default.secp256k1.privateKeyGenerate(),e=a.default.secp256k1.publicKeyCreate(t),r=t.toString("hex"),i=e.toString("hex"),n=a.default.secp256k1.publicKeyExport(e),s="04"+n.x.toString("hex")+n.y.toString("hex");return{privateKey:f.default.fromHex(r),publicKey:f.default.fromHex(i),uncompressedPubKey:f.default.fromHex(s)}};e.schnorrKeyGenerator=function(){var t=a.default.schnorr.privateKeyGenerate(),e=a.default.schnorr.publicKeyCreate(t),r=t.toString("hex"),i=e.toString("hex"),n=a.default.schnorr.publicKeyExport(e),s="04"+n.x.toString("hex")+n.y.toString("hex");return{privateKey:f.default.fromHex(r),publicKey:f.default.fromHex(i),uncompressedPubKey:f.default.fromHex(s)}};e.secp256k1Sign=function(e,r){if(32!==r.bytes.length)throw"Private key byte length must be 32.";var i,n=t.from(e.hex,"hex"),s=t.from(r.hex,"hex");try{i=a.default.secp256k1.sign(n,s)}catch(t){throw"invalid message"}var o=i.toString("hex"),c=a.default.secp256k1.signatureExport(i).toString("hex");return{sign:f.default.fromHex(o),derEncodedSign:f.default.fromHex(c)}};e.schnorrSign=function(e,r){if(32!==r.bytes.length)throw"Private key byte length must be 32.";var i,n=t.from(e.hex,"hex"),s=t.from(r.hex,"hex");try{i=a.default.schnorr.sign(n,s)}catch(t){throw"invalid message"}var o=i.toString("hex"),c=a.default.secp256k1.signatureExport(i).toString("hex");return{sign:f.default.fromHex(o),derEncodedSign:f.default.fromHex(c)}};e.secp256k1Verify=function(e,r,i){var n=t.from(e.hex,"hex"),s=t.from(r.hex,"hex"),o=t.from(i.hex,"hex"),c=a.default.secp256k1.verify(n,s,o);return f.default.fromNumber(c?1:0)};e.secp256k1CreatePublicKey=function(e){if(32!==e.bytes.length)throw"Private key byte length must be 32.";var r;try{var i=t.from(e.hex,"hex");r=a.default.secp256k1.publicKeyCreate(i)}catch(t){throw"invalid private key"}var n=r.toString("hex"),s=a.default.secp256k1.publicKeyExport(r),o="04"+s.x.toString("hex")+s.y.toString("hex");return{privateKey:e,publicKey:f.default.fromHex(n),uncompressedPubKey:f.default.fromHex(o)}};e.schnorrCreatePublicKey=function(e){if(32!==e.bytes.length)throw"Private key byte length must be 32.";var r;try{var i=t.from(e.hex,"hex");r=a.default.schnorr.publicKeyCreate(i)}catch(t){throw"invalid private key"}var n=r.toString("hex"),s=a.default.schnorr.publicKeyExport(r),o="04"+s.x.toString("hex")+s.y.toString("hex");return{privateKey:e,publicKey:f.default.fromHex(n),uncompressedPubKey:f.default.fromHex(o)}}}).call(this,r(0).Buffer)},function(t,e,r){var i,n,s,o,f,a,c,h;t.exports=(h=r(2),n=(i=h).lib,s=n.WordArray,o=n.Hasher,f=i.algo,a=[],c=f.SHA1=o.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var r=this._hash.words,i=r[0],n=r[1],s=r[2],o=r[3],f=r[4],c=0;c<80;c++){if(c<16)a[c]=0|t[e+c];else{var h=a[c-3]^a[c-8]^a[c-14]^a[c-16];a[c]=h<<1|h>>>31}var u=(i<<5|i>>>27)+f+a[c];u+=c<20?1518500249+(n&s|~n&o):c<40?1859775393+(n^s^o):c<60?(n&s|n&o|s&o)-1894007588:(n^s^o)-899497514,f=o,o=s,s=n<<30|n>>>2,n=i,i=u}r[0]=r[0]+i|0,r[1]=r[1]+n|0,r[2]=r[2]+s|0,r[3]=r[3]+o|0,r[4]=r[4]+f|0},_doFinalize:function(){var t=this._data,e=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=Math.floor(r/4294967296),e[15+(i+64>>>9<<4)]=r,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}}),i.SHA1=o._createHelper(c),i.HmacSHA1=o._createHmacHelper(c),h.SHA1)},function(t,e,r){var i,n,s,o;t.exports=(i=r(2),s=(n=i).lib.Base,o=n.enc.Utf8,void(n.algo.HMAC=s.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=o.parse(e));var r=t.blockSize,i=4*r;e.sigBytes>i&&(e=t.finalize(e)),e.clamp();for(var n=this._oKey=e.clone(),s=this._iKey=e.clone(),f=n.words,a=s.words,c=0;c<r;c++)f[c]^=1549556828,a[c]^=909522486;n.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,r=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(r))}})))},function(t,e,r){"use strict";var i,n=e,s=r(46),o=r(63),f=r(7).assert;function a(t){"short"===t.type?this.curve=new o.short(t):"edwards"===t.type?this.curve=new o.edwards(t):this.curve=new o.mont(t),this.g=this.curve.g,this.n=this.curve.n,this.hash=t.hash,f(this.g.validate(),"Invalid curve"),f(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function c(t,e){Object.defineProperty(n,t,{configurable:!0,enumerable:!0,get:function(){var r=new a(e);return Object.defineProperty(n,t,{configurable:!0,enumerable:!0,value:r}),r}})}n.PresetCurve=a,c("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:s.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),c("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:s.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),c("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:s.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),c("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:s.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),c("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:s.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),c("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["9"]}),c("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{i=r(159)}catch(t){i=void 0}c("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:s.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",i]})},function(t,e,r){var i=e;i.utils=r(10),i.common=r(22),i.sha=r(153),i.ripemd=r(157),i.hmac=r(158),i.sha1=i.sha.sha1,i.sha256=i.sha.sha256,i.sha224=i.sha.sha224,i.sha384=i.sha.sha384,i.sha512=i.sha.sha512,i.ripemd160=i.ripemd.ripemd160},function(t,e,r){"use strict";(function(e){
/*!
 * aes.js - aes128/192/256 for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on openssl/openssl:
 *   Based on code entered into the public domain by Vincent Rijmen.
 *   https://github.com/openssl/openssl/blob/master/crypto/aes/aes_core.c
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Advanced_Encryption_Standard
 *   http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.197.pdf
 *   https://github.com/openssl/openssl/blob/master/crypto/aes/aes_core.c
 */
const i=r(1),n=new Uint32Array([3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986]),s=new Uint32Array([2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766]),o=new Uint32Array([1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126]),f=new Uint32Array([1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436]),a=new Uint32Array([1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890]),c=new Uint32Array([1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935]),h=new Uint32Array([2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600]),u=new Uint32Array([4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480]),d=new Uint8Array([82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125]),l=new Uint32Array([16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,452984832,905969664]);function b(t,e){return 16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function p(t,e,r){return t[r++]=e>>>24,t[r++]=e>>>16,t[r++]=e>>>8,t[r++]=e,r}t.exports=class{constructor(t=256){i(t>>>0===t),this.bits=t,this.rounds=function(t){switch(t){case 128:return 10;case 192:return 12;case 256:return 14;default:throw new Error("Bad key size.")}}(t),this.key=null,this.encKey=null,this.decKey=null}get blockSize(){return 16}init(t){if(i(e.isBuffer(t)),t.length!==this.bits>>>3)throw new Error("Invalid key size.");return this.destroy(),this.key=e.from(t),this.encKey=null,this.decKey=null,this}createEncryptKey(){if(!this.key)throw new Error("Cipher is not initialized.");const t=this.key;if(t.length!==this.bits>>>3)throw new Error("Invalid key size.");const e=new Uint32Array(60);e[0]=b(t,0),e[1]=b(t,4),e[2]=b(t,8),e[3]=b(t,12);let r=0,i=0;if(128===this.bits){for(;;){const t=e[r+3];if(e[r+4]=e[r]^4278190080&o[t>>>16&255]^16711680&f[t>>>8&255]^65280&n[t>>>0&255]^255&s[t>>>24&255]^l[i],e[r+5]=e[r+1]^e[r+4],e[r+6]=e[r+2]^e[r+5],e[r+7]=e[r+3]^e[r+6],i+=1,10===i)break;r+=4}return e}if(e[r+4]=b(t,16),e[r+5]=b(t,20),192===this.bits){for(;;){const t=e[r+5];if(e[r+6]=e[r]^4278190080&o[t>>>16&255]^16711680&f[t>>>8&255]^65280&n[t>>>0&255]^255&s[t>>>24&255]^l[i],e[r+7]=e[r+1]^e[r+6],e[r+8]=e[r+2]^e[r+7],e[r+9]=e[r+3]^e[r+8],i+=1,8===i)break;e[r+10]=e[r+4]^e[r+9],e[r+11]=e[r+5]^e[r+10],r+=6}return e}if(e[r+6]=b(t,24),e[r+7]=b(t,28),256===this.bits){for(;;){let t=e[r+7];if(e[r+8]=e[r]^4278190080&o[t>>>16&255]^16711680&f[t>>>8&255]^65280&n[t>>>0&255]^255&s[t>>>24&255]^l[i],e[r+9]=e[r+1]^e[r+8],e[r+10]=e[r+2]^e[r+9],e[r+11]=e[r+3]^e[r+10],i+=1,7===i)break;t=e[r+11],e[r+12]=e[r+4]^4278190080&o[t>>>24&255]^16711680&f[t>>>16&255]^65280&n[t>>>8&255]^255&s[t>>>0&255],e[r+13]=e[r+5]^e[r+12],e[r+14]=e[r+6]^e[r+13],e[r+15]=e[r+7]^e[r+14],r+=8}return e}throw new Error("Bad key size.")}createDecryptKey(){const t=this.createEncryptKey();let e=0;for(let r=0,i=4*this.rounds;r<i;r+=4,i-=4){let n=t[e+r+0];t[e+r+0]=t[e+i+0],t[e+i+0]=n,n=t[e+r+1],t[e+r+1]=t[e+i+1],t[e+i+1]=n,n=t[e+r+2],t[e+r+2]=t[e+i+2],t[e+i+2]=n,n=t[e+r+3],t[e+r+3]=t[e+i+3],t[e+i+3]=n}for(let r=1;r<this.rounds;r++)e+=4,t[e+0]=a[255&s[t[e+0]>>>24&255]]^c[255&s[t[e+0]>>>16&255]]^h[255&s[t[e+0]>>>8&255]]^u[255&s[t[e+0]>>>0&255]],t[e+1]=a[255&s[t[e+1]>>>24&255]]^c[255&s[t[e+1]>>>16&255]]^h[255&s[t[e+1]>>>8&255]]^u[255&s[t[e+1]>>>0&255]],t[e+2]=a[255&s[t[e+2]>>>24&255]]^c[255&s[t[e+2]>>>16&255]]^h[255&s[t[e+2]>>>8&255]]^u[255&s[t[e+2]>>>0&255]],t[e+3]=a[255&s[t[e+3]>>>24&255]]^c[255&s[t[e+3]>>>16&255]]^h[255&s[t[e+3]>>>8&255]]^u[255&s[t[e+3]>>>0&255]];return t}getEncryptKey(){return this.encKey||(this.encKey=this.createEncryptKey()),this.encKey}getDecryptKey(){return this.decKey||(this.decKey=this.createDecryptKey()),this.decKey}encrypt(t,e,r,i){const a=this.getEncryptKey();let c,h,u,d,l=b(r,i+0)^a[0],m=b(r,i+4)^a[1],g=b(r,i+8)^a[2],w=b(r,i+12)^a[3],y=this.rounds>>>1,v=0;for(;c=n[l>>>24&255]^s[m>>>16&255]^o[g>>>8&255]^f[w>>>0&255]^a[v+4],h=n[m>>>24&255]^s[g>>>16&255]^o[w>>>8&255]^f[l>>>0&255]^a[v+5],u=n[g>>>24&255]^s[w>>>16&255]^o[l>>>8&255]^f[m>>>0&255]^a[v+6],d=n[w>>>24&255]^s[l>>>16&255]^o[m>>>8&255]^f[g>>>0&255]^a[v+7],v+=8,y-=1,0!==y;)l=n[c>>>24&255]^s[h>>>16&255]^o[u>>>8&255]^f[d>>>0&255]^a[v+0],m=n[h>>>24&255]^s[u>>>16&255]^o[d>>>8&255]^f[c>>>0&255]^a[v+1],g=n[u>>>24&255]^s[d>>>16&255]^o[c>>>8&255]^f[h>>>0&255]^a[v+2],w=n[d>>>24&255]^s[c>>>16&255]^o[h>>>8&255]^f[u>>>0&255]^a[v+3];return l=4278190080&o[c>>>24&255]^16711680&f[h>>>16&255]^65280&n[u>>>8&255]^255&s[d>>>0&255]^a[v+0],m=4278190080&o[h>>>24&255]^16711680&f[u>>>16&255]^65280&n[d>>>8&255]^255&s[c>>>0&255]^a[v+1],g=4278190080&o[u>>>24&255]^16711680&f[d>>>16&255]^65280&n[c>>>8&255]^255&s[h>>>0&255]^a[v+2],w=4278190080&o[d>>>24&255]^16711680&f[c>>>16&255]^65280&n[h>>>8&255]^255&s[u>>>0&255]^a[v+3],p(t,l,e+0),p(t,m,e+4),p(t,g,e+8),p(t,w,e+12),this}decrypt(t,e,r,i){const n=this.getDecryptKey();let s,o,f,l,m=b(r,i+0)^n[0],g=b(r,i+4)^n[1],w=b(r,i+8)^n[2],y=b(r,i+12)^n[3],v=this.rounds>>>1,S=0;for(;s=a[m>>>24&255]^c[y>>>16&255]^h[w>>>8&255]^u[g>>>0&255]^n[S+4],o=a[g>>>24&255]^c[m>>>16&255]^h[y>>>8&255]^u[w>>>0&255]^n[S+5],f=a[w>>>24&255]^c[g>>>16&255]^h[m>>>8&255]^u[y>>>0&255]^n[S+6],l=a[y>>>24&255]^c[w>>>16&255]^h[g>>>8&255]^u[m>>>0&255]^n[S+7],S+=8,v-=1,0!==v;)m=a[s>>>24&255]^c[l>>>16&255]^h[f>>>8&255]^u[o>>>0&255]^n[S+0],g=a[o>>>24&255]^c[s>>>16&255]^h[l>>>8&255]^u[f>>>0&255]^n[S+1],w=a[f>>>24&255]^c[o>>>16&255]^h[s>>>8&255]^u[l>>>0&255]^n[S+2],y=a[l>>>24&255]^c[f>>>16&255]^h[o>>>8&255]^u[s>>>0&255]^n[S+3];return m=d[s>>>24&255]<<24^d[l>>>16&255]<<16^d[f>>>8&255]<<8^d[o>>>0&255]<<0^n[S+0],g=d[o>>>24&255]<<24^d[s>>>16&255]<<16^d[l>>>8&255]<<8^d[f>>>0&255]<<0^n[S+1],w=d[f>>>24&255]<<24^d[o>>>16&255]<<16^d[s>>>8&255]<<8^d[l>>>0&255]<<0^n[S+2],y=d[l>>>24&255]<<24^d[f>>>16&255]<<16^d[o>>>8&255]<<8^d[s>>>0&255]<<0^n[S+3],p(t,m,e+0),p(t,g,e+4),p(t,w,e+8),p(t,y,e+12),this}destroy(){if(this.key)for(let t=0;t<this.key.length;t++)this.key[t]=0;if(this.encKey)for(let t=0;t<60;t++)this.encKey[t]=0;if(this.decKey)for(let t=0;t<60;t++)this.decKey[t]=0;return this.key=null,this.encKey=null,this.decKey=null,this}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * hmac-drbg.js - hmac-drbg for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(210)},function(t,e,r){"use strict";(function(t){
/*!
 * asn1.js - asn1 parsing for bcrypto
 * Copyright (c) 2020, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(75),n=r(6);function s(e,r,n){if(i(t.isBuffer(e)),i(r>>>0===r),i("boolean"==typeof n),r>=e.length)throw new Error("Invalid size.");const s=e[r],o=127&s;if(r+=1,0==(128&s))return[o,r];if(n&&0===o)throw new Error("Indefinite length.");let f=0;for(let t=0;t<o;t++){i(r<e.length);const t=e[r];if(r+=1,f>=1<<24)throw new Error("Length too large.");if(f*=256,f+=t,n&&0===f)throw new Error("Unexpected leading zeroes.")}if(n&&f<128)throw new Error("Non-minimal length.");return[f,r]}function o(e,r,o=!0){if(i(t.isBuffer(e)),i(r>>>0===r),i("boolean"==typeof o),r>=e.length||2!==e[r])throw new Error("Invalid integer tag.");let f;if(r+=1,[f,r]=s(e,r,o),r+f>e.length)throw new Error("Integer body out of bounds.");if(o){if(0===f)throw new Error("Zero length integer.");if(128&e[r])throw new Error("Integers must be positive.");if(f>1&&0===e[r]&&0==(128&e[r+1]))throw new Error("Unexpected leading zeroes.")}for(;f>0&&0===e[r];)r+=1,f-=1;if(f>2048)throw new Error("Invalid integer size.");return[n.decode(e.slice(r,r+f)),r+=f]}function f(t){return i(t>>>0===t),t<=127?1:t<=255?2:(i(t<=65535),3)}function a(e,r,n){return i(t.isBuffer(e)),i(r>>>0===r),i(n>>>0===n),n<=127?e[r++]=n:n<=255?(e[r++]=129,e[r++]=n):(i(n<=65535),e[r++]=130,e[r++]=n>>8,e[r++]=255&n),i(r<=e.length),r}e.readSize=s,e.readSeq=function(e,r,n=!0){if(i(t.isBuffer(e)),i(r>>>0===r),i("boolean"==typeof n),r>=e.length||48!==e[r])throw new Error("Invalid sequence tag.");let o;if(r+=1,[o,r]=s(e,r,n),n&&r+o!==e.length)throw new Error("Trailing bytes.");return r},e.readInt=o,e.readVersion=function(e,r,n,s=!0){let f;if(i(t.isBuffer(e)),i(r>>>0===r),i((255&n)===n),i("boolean"==typeof s),[f,r]=o(e,r,s),0!==f.cmpn(n))throw new Error("Invalid version.");return r},e.sizeSize=f,e.sizeSeq=function(t){return 1+f(t)+t},e.sizeInt=function(t){i(t instanceof n);const e=t.bitLength();let r=e+7>>>3;return e>0&&0==(7&e)&&(r+=t.testn(e-1)),0===e&&(r=1),1+f(r)+r},e.sizeVersion=function(t){return i((255&t)===t),3},e.writeSize=a,e.writeSeq=function(e,r,n){return i(t.isBuffer(e)),i(r>>>0===r),e[r++]=48,a(e,r,n)},e.writeInt=function(e,r,s){i(t.isBuffer(e)),i(r>>>0===r),i(s instanceof n);const o=s.bitLength();let f=o+7>>>3,c=0;return o>0&&0==(7&o)&&(c=s.testn(o-1)),0===o&&(f=1),e[r++]=2,r=a(e,r,c+f),c&&(e[r++]=0),0!==o?s.encode().copy(e,r):e[r]=0,i((r+=f)<=e.length),r},e.writeVersion=function(e,r,n){return i(t.isBuffer(e)),i(r>>>0===r),i((255&n)===n),i(r+3<=e.length),e[r++]=2,e[r++]=1,e[r++]=n,r}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * batch-rng.js - batch rng for bcrypto
 * Copyright (c) 2019-2020, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on ElementsProject/secp256k1-zkp:
 *   Copyright (c) 2013, Pieter Wuille.
 *   https://github.com/ElementsProject/secp256k1-zkp
 *
 * Resources:
 *   https://github.com/ElementsProject/secp256k1-zkp/blob/11af701/src/modules/schnorrsig/main_impl.h#L166
 *   https://github.com/ElementsProject/secp256k1-zkp/blob/11af701/src/scalar_4x64_impl.h#L972
 *   https://github.com/ElementsProject/secp256k1-zkp/blob/11af701/src/scalar_8x32_impl.h#L747
 */
const i=r(1),n=r(6),s=r(82),o=r(11);t.exports=class{constructor(t,r=(t=>t)){this.curve=t,this.encode=r,this.hash=new o,this.chacha=new s,this.key=e.alloc(32,0),this.iv=e.alloc(8,0),this.cache=[new n(1),new n(1)]}init(t){i(Array.isArray(t)),this.hash.init();for(const[e,r,i]of t)this.hash.update(o.digest(e)),this.hash.update(r),this.hash.update(this.encode(i));return this.key=this.hash.final(),this.cache[0]=new n(1),this.cache[1]=new n(1),this}encrypt(t){const r=2*this.curve.scalarSize,i=e.alloc(r,0),n=i.slice(0,this.curve.scalarSize),s=i.slice(this.curve.scalarSize);return this.chacha.init(this.key,this.iv,t),this.chacha.encrypt(i),[this.curve.decodeScalar(n),this.curve.decodeScalar(s)]}refresh(t){let e=0;for(;;){this.iv[4]=e,this.iv[5]=e>>>8,this.iv[6]=e>>>16,this.iv[7]=e>>>24,e+=1;const[r,i]=this.encrypt(t);if(!(r.isZero()||r.cmp(this.curve.n)>=0)&&!(i.isZero()||i.cmp(this.curve.n)>=0)){this.cache[0]=r,this.cache[1]=i;break}}}generate(t){return i(t>>>0===t),1&t&&this.refresh(t>>>1),this.cache[1&t]}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * shake.js - SHAKE implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/SHA-3
 *   https://keccak.team/specifications.html
 *   https://csrc.nist.gov/projects/hash-functions/sha-3-project/sha-3-standardization
 *   http://dx.doi.org/10.6028/NIST.FIPS.202
 */
const i=r(17);class n extends i{constructor(){super()}final(t){return super.final(31,t)}static hash(){return new n}static hmac(t,e){return super.hmac(t,31,e)}static digest(t,e,r){return super.digest(t,e,31,r)}static root(t,e,r,i){return super.root(t,e,r,31,i)}static multi(t,e,r,i,n){return super.multi(t,e,r,i,31,n)}static mac(t,e,r,i){return super.mac(t,e,r,31,i)}}n.native=i.native,n.id="SHAKE256",n.size=32,n.bits=256,n.blockSize=136,n.zero=e.alloc(32,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * bufio.js - buffer utilities for javascript
 * Copyright (c) 2014-2017, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */
const i=r(89),n=r(39),s=r(20),o=r(27),f=r(90),a=r(91),c=r(92),h=r(218);function u(e,r){return function(i,n){if(s(t.isBuffer(i),"data","buffer"),s(n>>>0===n,"off","integer"),n+r>i.length)throw new o(n,"Out of bounds read");return e(i,n)}}function d(e){return function(r,i,n){if(s(t.isBuffer(r),"data","buffer"),s(i>>>0===i,"off","integer"),s(n>>>0===n,"len","integer"),i+n>r.length)throw new o(i,"Out of bounds read");return e(r,i,n)}}function l(e){return function(r,i){return s(t.isBuffer(r),"data","buffer"),s(i>>>0===i,"off","integer"),e(r,i)}}function b(e,r){return function(i,n,f){if(s(t.isBuffer(i),"data","buffer"),s(f>>>0===f,"off","integer"),f+r>i.length)throw new o(f,"Out of bounds write");return e(i,n,f)}}function p(e){return function(r,i,n,f){if(s(t.isBuffer(r),"data","buffer"),s(n>>>0===n,"off","integer"),s(f>>>0===f,"len","integer"),n+f>r.length)throw new o(n,"Out of bounds write");return e(r,i,n,f)}}function m(e,r){return function(i,n,f){if(s(t.isBuffer(i),"data","buffer"),s(f>>>0===f,"off","integer"),f+r(n)>i.length)throw new o(f,"Out of bounds write");return e(i,n,f)}}e.custom=i,e.encoding=n,e.EncodingError=o,e.BufferReader=f,e.BufferWriter=a,e.StaticWriter=c,e.Struct=h,e.read=function(t,e){return new f(t,e)},e.write=function(t){return null!=t?new c(t):new a},e.pool=function(t){return c.pool(t)},e.readU=d(n.readU),e.readU64=u(n.readU64,8),e.readU56=u(n.readU56,7),e.readU48=u(n.readU48,6),e.readU40=u(n.readU40,5),e.readU32=u(n.readU32,4),e.readU24=u(n.readU24,3),e.readU16=u(n.readU16,2),e.readU8=u(n.readU8,1),e.readUBE=d(n.readUBE),e.readU64BE=u(n.readU64BE,8),e.readU56BE=u(n.readU56BE,7),e.readU48BE=u(n.readU48BE,6),e.readU40BE=u(n.readU40BE,5),e.readU32BE=u(n.readU32BE,4),e.readU24BE=u(n.readU24BE,3),e.readU16BE=u(n.readU16BE,2),e.readI=d(n.readI),e.readI64=u(n.readI64,8),e.readI56=u(n.readI56,7),e.readI48=u(n.readI48,6),e.readI40=u(n.readI40,5),e.readI32=u(n.readI32,4),e.readI24=u(n.readI24,3),e.readI16=u(n.readI16,2),e.readI8=u(n.readI8,1),e.readIBE=d(n.readIBE),e.readI64BE=u(n.readI64BE,8),e.readI56BE=u(n.readI56BE,7),e.readI48BE=u(n.readI48BE,6),e.readI40BE=u(n.readI40BE,5),e.readI32BE=u(n.readI32BE,4),e.readI24BE=u(n.readI24BE,3),e.readI16BE=u(n.readI16BE,2),e.readFloat=u(n.readFloat,4),e.readFloatBE=u(n.readFloatBE,4),e.readDouble=u(n.readDouble,8),e.readDoubleBE=u(n.readDoubleBE,8),e.writeU=p(n.writeU),e.writeU64=b(n.writeU64,8),e.writeU56=b(n.writeU56,7),e.writeU48=b(n.writeU48,6),e.writeU40=b(n.writeU40,5),e.writeU32=b(n.writeU32,4),e.writeU24=b(n.writeU24,3),e.writeU16=b(n.writeU16,2),e.writeU8=b(n.writeU8,1),e.writeUBE=p(n.writeUBE),e.writeU64BE=b(n.writeU64BE,8),e.writeU56BE=b(n.writeU56BE,7),e.writeU48BE=b(n.writeU48BE,6),e.writeU40BE=b(n.writeU40BE,5),e.writeU32BE=b(n.writeU32BE,4),e.writeU24BE=b(n.writeU24BE,3),e.writeU16BE=b(n.writeU16BE,2),e.writeI=p(n.writeI),e.writeI64=b(n.writeI64,8),e.writeI56=b(n.writeI56,7),e.writeI48=b(n.writeI48,6),e.writeI40=b(n.writeI40,5),e.writeI32=b(n.writeI32,4),e.writeI24=b(n.writeI24,3),e.writeI16=b(n.writeI16,2),e.writeI8=b(n.writeI8,1),e.writeIBE=p(n.writeIBE),e.writeI64BE=b(n.writeI64BE,8),e.writeI56BE=b(n.writeI56BE,7),e.writeI48BE=b(n.writeI48BE,6),e.writeI40BE=b(n.writeI40BE,5),e.writeI32BE=b(n.writeI32BE,4),e.writeI24BE=b(n.writeI24BE,3),e.writeI16BE=b(n.writeI16BE,2),e.writeFloat=b(n.writeFloat,4),e.writeFloatBE=b(n.writeFloatBE,4),e.writeDouble=b(n.writeDouble,8),e.writeDoubleBE=b(n.writeDoubleBE,8),e.readVarint=l(n.readVarint),e.writeVarint=m(n.writeVarint,n.sizeVarint),e.sizeVarint=n.sizeVarint,e.readVarint2=l(n.readVarint2),e.writeVarint2=m(n.writeVarint2,n.sizeVarint2),e.sizeVarint2=n.sizeVarint2,e.sliceBytes=n.sliceBytes,e.readBytes=n.readBytes,e.writeBytes=n.writeBytes,e.readString=n.readString,e.writeString=n.writeString,e.realloc=n.realloc,e.copy=n.copy,e.concat=n.concat,e.sizeVarBytes=n.sizeVarBytes,e.sizeVarlen=n.sizeVarlen,e.sizeVarString=n.sizeVarString}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * md5.js - MD5 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(96)},function(t,e,r){"use strict";(function(e){
/*!
 * kmac.js - KMAC implementation for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf
 *   https://github.com/XKCP/XKCP/blob/8f447eb/lib/high/Keccak/SP800-185/SP800-185.inc
 *   https://github.com/XKCP/XKCP/blob/8f447eb/lib/high/Keccak/SP800-185/SP800-185.c
 *   https://github.com/XKCP/XKCP/blob/8f447eb/tests/UnitTests/testSP800-185.c
 *   https://github.com/emn178/js-sha3/blob/master/src/sha3.js
 */
const i=r(1),n=r(35),s=r(3),o=e.from("KMAC","binary"),f=e.alloc(0);class a extends n{constructor(){super()}init(t,r,n){return null==r&&(r=f),i(e.isBuffer(r)),super.init(t,o,n),super.bytePad([r],this.rate/8),this}final(t){if(null==t){t=100-this.rate/8/2}return super.rightEncode(8*t),super.final(t)}static hash(){return new a}static hmac(t,e,r,n){null==t&&(t=256),i(t>>>0===t),i(128===t||256===t);return new s(a,(1600-2*t)/8,[t,e,r],[n])}static digest(t,e,r,i,n){return a.ctx.init(e,r,i).update(t).final(n)}static root(t,r,n,s,o,f){null==n&&(n=256),null==f&&(f=0),0===f&&(i(n>>>0===n),f=n>>>3),i(f>>>0===f),i(e.isBuffer(t)&&t.length===f),i(e.isBuffer(r)&&r.length===f);const{ctx:c}=a;return c.init(n,s,o),c.update(t),c.update(r),c.final(f)}static multi(t,e,r,i,n,s,o){const{ctx:f}=a;return f.init(i,n,s),f.update(t),f.update(e),r&&f.update(r),f.final(o)}static mac(t,e,r,i,n,s){return a.hmac(r,i,n,s).init(e).update(t).final()}}a.native=n.native,a.id="KMAC256",a.size=32,a.bits=256,a.blockSize=136,a.zero=e.alloc(32,0),a.ctx=new a,t.exports=a}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * sha384.js - SHA384 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(268)},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.LE32toLE64=e.LE64ToNum=e.numToLE64=e.convert64=void 0;var n=i(r(8)),s=i(r(29));e.convert64=function(t){var e="1"===t.bin.charAt(0),r=new s.default(t.bin,2);if(e){t.number&&(r=new s.default(t.number||0));var i=r.abs().neg().toTwos(64).toString(2,64);return n.default.fromBin(i)}var o=r.toString(2,64);return n.default.fromBin(o)};e.numToLE64=function(t){if(t.bytes.length>8)throw"Input byte length must be maximum 8 byte";return(0,e.convert64)(t)};e.LE64ToNum=function(t){if(8!==t.bytes.length)throw"Input byte length must be equal 8 byte";var e=new s.default(t.bin,2),r=e.byteLength();if("1"===t.bin.charAt(0)){var i=e.fromTwos(64).abs(),o=n.default.fromBin(i.toString(2,8*i.byteLength()));return o.number?n.default.fromNumber(-1*o.number):o}return n.default.fromBin(e.toString(2,8*r))};e.LE32toLE64=function(t){if(4!==t.bytes.length)throw"Input byte length must be equal 4 byte";return(0,e.numToLE64)(t)}},function(t,e){t.exports=require("crypto")},function(t,e,r){var i;t.exports=(i=r(2),function(t){var e=i,r=e.lib,n=r.WordArray,s=r.Hasher,o=e.algo,f=[],a=[];!function(){function e(e){for(var r=t.sqrt(e),i=2;i<=r;i++)if(!(e%i))return!1;return!0}function r(t){return 4294967296*(t-(0|t))|0}for(var i=2,n=0;n<64;)e(i)&&(n<8&&(f[n]=r(t.pow(i,.5))),a[n]=r(t.pow(i,1/3)),n++),i++}();var c=[],h=o.SHA256=s.extend({_doReset:function(){this._hash=new n.init(f.slice(0))},_doProcessBlock:function(t,e){for(var r=this._hash.words,i=r[0],n=r[1],s=r[2],o=r[3],f=r[4],h=r[5],u=r[6],d=r[7],l=0;l<64;l++){if(l<16)c[l]=0|t[e+l];else{var b=c[l-15],p=(b<<25|b>>>7)^(b<<14|b>>>18)^b>>>3,m=c[l-2],g=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;c[l]=p+c[l-7]+g+c[l-16]}var w=i&n^i&s^n&s,y=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),v=d+((f<<26|f>>>6)^(f<<21|f>>>11)^(f<<7|f>>>25))+(f&h^~f&u)+a[l]+c[l];d=u,u=h,h=f,f=o+v|0,o=s,s=n,n=i,i=v+(y+w)|0}r[0]=r[0]+i|0,r[1]=r[1]+n|0,r[2]=r[2]+s|0,r[3]=r[3]+o|0,r[4]=r[4]+f|0,r[5]=r[5]+h|0,r[6]=r[6]+u|0,r[7]=r[7]+d|0},_doFinalize:function(){var e=this._data,r=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;return r[n>>>5]|=128<<24-n%32,r[14+(n+64>>>9<<4)]=t.floor(i/4294967296),r[15+(n+64>>>9<<4)]=i,e.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var t=s.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=s._createHelper(h),e.HmacSHA256=s._createHmacHelper(h)}(Math),i.SHA256)},function(t,e,r){var i;t.exports=(i=r(2),r(30),function(){var t=i,e=t.lib.Hasher,r=t.x64,n=r.Word,s=r.WordArray,o=t.algo;function f(){return n.create.apply(n,arguments)}var a=[f(1116352408,3609767458),f(1899447441,602891725),f(3049323471,3964484399),f(3921009573,2173295548),f(961987163,4081628472),f(1508970993,3053834265),f(2453635748,2937671579),f(2870763221,3664609560),f(3624381080,2734883394),f(310598401,1164996542),f(607225278,1323610764),f(1426881987,3590304994),f(1925078388,4068182383),f(2162078206,991336113),f(2614888103,633803317),f(3248222580,3479774868),f(3835390401,2666613458),f(4022224774,944711139),f(264347078,2341262773),f(604807628,2007800933),f(770255983,1495990901),f(1249150122,1856431235),f(1555081692,3175218132),f(1996064986,2198950837),f(2554220882,3999719339),f(2821834349,766784016),f(2952996808,2566594879),f(3210313671,3203337956),f(3336571891,1034457026),f(3584528711,2466948901),f(113926993,3758326383),f(338241895,168717936),f(666307205,1188179964),f(773529912,1546045734),f(1294757372,1522805485),f(1396182291,2643833823),f(1695183700,2343527390),f(1986661051,1014477480),f(2177026350,1206759142),f(2456956037,344077627),f(2730485921,1290863460),f(2820302411,3158454273),f(3259730800,3505952657),f(3345764771,106217008),f(3516065817,3606008344),f(3600352804,1432725776),f(4094571909,1467031594),f(275423344,851169720),f(430227734,3100823752),f(506948616,1363258195),f(659060556,3750685593),f(883997877,3785050280),f(958139571,3318307427),f(1322822218,3812723403),f(1537002063,2003034995),f(1747873779,3602036899),f(1955562222,1575990012),f(2024104815,1125592928),f(2227730452,2716904306),f(2361852424,442776044),f(2428436474,593698344),f(2756734187,3733110249),f(3204031479,2999351573),f(3329325298,3815920427),f(3391569614,3928383900),f(3515267271,566280711),f(3940187606,3454069534),f(4118630271,4000239992),f(116418474,1914138554),f(174292421,2731055270),f(289380356,3203993006),f(460393269,320620315),f(685471733,587496836),f(852142971,1086792851),f(1017036298,365543100),f(1126000580,2618297676),f(1288033470,3409855158),f(1501505948,4234509866),f(1607167915,987167468),f(1816402316,1246189591)],c=[];!function(){for(var t=0;t<80;t++)c[t]=f()}();var h=o.SHA512=e.extend({_doReset:function(){this._hash=new s.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var r=this._hash.words,i=r[0],n=r[1],s=r[2],o=r[3],f=r[4],h=r[5],u=r[6],d=r[7],l=i.high,b=i.low,p=n.high,m=n.low,g=s.high,w=s.low,y=o.high,v=o.low,S=f.high,E=f.low,M=h.high,A=h.low,I=u.high,_=u.low,x=d.high,B=d.low,k=l,z=b,q=p,N=m,P=g,R=w,O=y,U=v,C=S,T=E,D=M,L=A,K=I,H=_,j=x,F=B,Z=0;Z<80;Z++){var V,G,J=c[Z];if(Z<16)G=J.high=0|t[e+2*Z],V=J.low=0|t[e+2*Z+1];else{var Y=c[Z-15],X=Y.high,W=Y.low,$=(X>>>1|W<<31)^(X>>>8|W<<24)^X>>>7,Q=(W>>>1|X<<31)^(W>>>8|X<<24)^(W>>>7|X<<25),tt=c[Z-2],et=tt.high,rt=tt.low,it=(et>>>19|rt<<13)^(et<<3|rt>>>29)^et>>>6,nt=(rt>>>19|et<<13)^(rt<<3|et>>>29)^(rt>>>6|et<<26),st=c[Z-7],ot=st.high,ft=st.low,at=c[Z-16],ct=at.high,ht=at.low;G=(G=(G=$+ot+((V=Q+ft)>>>0<Q>>>0?1:0))+it+((V+=nt)>>>0<nt>>>0?1:0))+ct+((V+=ht)>>>0<ht>>>0?1:0),J.high=G,J.low=V}var ut,dt=C&D^~C&K,lt=T&L^~T&H,bt=k&q^k&P^q&P,pt=z&N^z&R^N&R,mt=(k>>>28|z<<4)^(k<<30|z>>>2)^(k<<25|z>>>7),gt=(z>>>28|k<<4)^(z<<30|k>>>2)^(z<<25|k>>>7),wt=(C>>>14|T<<18)^(C>>>18|T<<14)^(C<<23|T>>>9),yt=(T>>>14|C<<18)^(T>>>18|C<<14)^(T<<23|C>>>9),vt=a[Z],St=vt.high,Et=vt.low,Mt=j+wt+((ut=F+yt)>>>0<F>>>0?1:0),At=gt+pt;j=K,F=H,K=D,H=L,D=C,L=T,C=O+(Mt=(Mt=(Mt=Mt+dt+((ut+=lt)>>>0<lt>>>0?1:0))+St+((ut+=Et)>>>0<Et>>>0?1:0))+G+((ut+=V)>>>0<V>>>0?1:0))+((T=U+ut|0)>>>0<U>>>0?1:0)|0,O=P,U=R,P=q,R=N,q=k,N=z,k=Mt+(mt+bt+(At>>>0<gt>>>0?1:0))+((z=ut+At|0)>>>0<ut>>>0?1:0)|0}b=i.low=b+z,i.high=l+k+(b>>>0<z>>>0?1:0),m=n.low=m+N,n.high=p+q+(m>>>0<N>>>0?1:0),w=s.low=w+R,s.high=g+P+(w>>>0<R>>>0?1:0),v=o.low=v+U,o.high=y+O+(v>>>0<U>>>0?1:0),E=f.low=E+T,f.high=S+C+(E>>>0<T>>>0?1:0),A=h.low=A+L,h.high=M+D+(A>>>0<L>>>0?1:0),_=u.low=_+H,u.high=I+K+(_>>>0<H>>>0?1:0),B=d.low=B+F,d.high=x+j+(B>>>0<F>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[30+(i+128>>>10<<5)]=Math.floor(r/4294967296),e[31+(i+128>>>10<<5)]=r,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=e.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32});t.SHA512=e._createHelper(h),t.HmacSHA512=e._createHmacHelper(h)}(),i.SHA512)},function(t,e,r){"use strict";var i=e;function n(t){return 1===t.length?"0"+t:t}function s(t){for(var e="",r=0;r<t.length;r++)e+=n(t[r].toString(16));return e}i.toArray=function(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if("string"!=typeof t){for(var i=0;i<t.length;i++)r[i]=0|t[i];return r}if("hex"===e){(t=t.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(t="0"+t);for(i=0;i<t.length;i+=2)r.push(parseInt(t[i]+t[i+1],16))}else for(i=0;i<t.length;i++){var n=t.charCodeAt(i),s=n>>8,o=255&n;s?r.push(s,o):r.push(o)}return r},i.zero2=n,i.toHex=s,i.encode=function(t,e){return"hex"===e?s(t):t}},function(t,e,r){var i;function n(t){this.rand=t}if(t.exports=function(t){return i||(i=new n(null)),i.generate(t)},t.exports.Rand=n,n.prototype.generate=function(t){return this._rand(t)},n.prototype._rand=function(t){if(this.rand.getBytes)return this.rand.getBytes(t);for(var e=new Uint8Array(t),r=0;r<e.length;r++)e[r]=this.rand.getByte();return e},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?n.prototype._rand=function(t){var e=new Uint8Array(t);return self.crypto.getRandomValues(e),e}:self.msCrypto&&self.msCrypto.getRandomValues?n.prototype._rand=function(t){var e=new Uint8Array(t);return self.msCrypto.getRandomValues(e),e}:"object"==typeof window&&(n.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var s=r(58);if("function"!=typeof s.randomBytes)throw new Error("Not supported");n.prototype._rand=function(t){return s.randomBytes(t)}}catch(t){}},function(t,e,r){"use strict";var i=e;i.base=r(31),i.short=r(150),i.mont=r(151),i.edwards=r(152)},function(t,e,r){"use strict";var i=r(10).rotr32;function n(t,e,r){return t&e^~t&r}function s(t,e,r){return t&e^t&r^e&r}function o(t,e,r){return t^e^r}e.ft_1=function(t,e,r,i){return 0===t?n(e,r,i):1===t||3===t?o(e,r,i):2===t?s(e,r,i):void 0},e.ch32=n,e.maj32=s,e.p32=o,e.s0_256=function(t){return i(t,2)^i(t,13)^i(t,22)},e.s1_256=function(t){return i(t,6)^i(t,11)^i(t,25)},e.g0_256=function(t){return i(t,7)^i(t,18)^t>>>3},e.g1_256=function(t){return i(t,17)^i(t,19)^t>>>10}},function(t,e,r){"use strict";var i=r(10),n=r(22),s=r(64),o=r(16),f=i.sum32,a=i.sum32_4,c=i.sum32_5,h=s.ch32,u=s.maj32,d=s.s0_256,l=s.s1_256,b=s.g0_256,p=s.g1_256,m=n.BlockHash,g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function w(){if(!(this instanceof w))return new w;m.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=g,this.W=new Array(64)}i.inherits(w,m),t.exports=w,w.blockSize=512,w.outSize=256,w.hmacStrength=192,w.padLength=64,w.prototype._update=function(t,e){for(var r=this.W,i=0;i<16;i++)r[i]=t[e+i];for(;i<r.length;i++)r[i]=a(p(r[i-2]),r[i-7],b(r[i-15]),r[i-16]);var n=this.h[0],s=this.h[1],m=this.h[2],g=this.h[3],w=this.h[4],y=this.h[5],v=this.h[6],S=this.h[7];for(o(this.k.length===r.length),i=0;i<r.length;i++){var E=c(S,l(w),h(w,y,v),this.k[i],r[i]),M=f(d(n),u(n,s,m));S=v,v=y,y=w,w=f(g,E),g=m,m=s,s=n,n=f(E,M)}this.h[0]=f(this.h[0],n),this.h[1]=f(this.h[1],s),this.h[2]=f(this.h[2],m),this.h[3]=f(this.h[3],g),this.h[4]=f(this.h[4],w),this.h[5]=f(this.h[5],y),this.h[6]=f(this.h[6],v),this.h[7]=f(this.h[7],S)},w.prototype._digest=function(t){return"hex"===t?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},function(t,e,r){"use strict";var i=r(10),n=r(22),s=r(16),o=i.rotr64_hi,f=i.rotr64_lo,a=i.shr64_hi,c=i.shr64_lo,h=i.sum64,u=i.sum64_hi,d=i.sum64_lo,l=i.sum64_4_hi,b=i.sum64_4_lo,p=i.sum64_5_hi,m=i.sum64_5_lo,g=n.BlockHash,w=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function y(){if(!(this instanceof y))return new y;g.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=w,this.W=new Array(160)}function v(t,e,r,i,n){var s=t&r^~t&n;return s<0&&(s+=4294967296),s}function S(t,e,r,i,n,s){var o=e&i^~e&s;return o<0&&(o+=4294967296),o}function E(t,e,r,i,n){var s=t&r^t&n^r&n;return s<0&&(s+=4294967296),s}function M(t,e,r,i,n,s){var o=e&i^e&s^i&s;return o<0&&(o+=4294967296),o}function A(t,e){var r=o(t,e,28)^o(e,t,2)^o(e,t,7);return r<0&&(r+=4294967296),r}function I(t,e){var r=f(t,e,28)^f(e,t,2)^f(e,t,7);return r<0&&(r+=4294967296),r}function _(t,e){var r=o(t,e,14)^o(t,e,18)^o(e,t,9);return r<0&&(r+=4294967296),r}function x(t,e){var r=f(t,e,14)^f(t,e,18)^f(e,t,9);return r<0&&(r+=4294967296),r}function B(t,e){var r=o(t,e,1)^o(t,e,8)^a(t,e,7);return r<0&&(r+=4294967296),r}function k(t,e){var r=f(t,e,1)^f(t,e,8)^c(t,e,7);return r<0&&(r+=4294967296),r}function z(t,e){var r=o(t,e,19)^o(e,t,29)^a(t,e,6);return r<0&&(r+=4294967296),r}function q(t,e){var r=f(t,e,19)^f(e,t,29)^c(t,e,6);return r<0&&(r+=4294967296),r}i.inherits(y,g),t.exports=y,y.blockSize=1024,y.outSize=512,y.hmacStrength=192,y.padLength=128,y.prototype._prepareBlock=function(t,e){for(var r=this.W,i=0;i<32;i++)r[i]=t[e+i];for(;i<r.length;i+=2){var n=z(r[i-4],r[i-3]),s=q(r[i-4],r[i-3]),o=r[i-14],f=r[i-13],a=B(r[i-30],r[i-29]),c=k(r[i-30],r[i-29]),h=r[i-32],u=r[i-31];r[i]=l(n,s,o,f,a,c,h,u),r[i+1]=b(n,s,o,f,a,c,h,u)}},y.prototype._update=function(t,e){this._prepareBlock(t,e);var r=this.W,i=this.h[0],n=this.h[1],o=this.h[2],f=this.h[3],a=this.h[4],c=this.h[5],l=this.h[6],b=this.h[7],g=this.h[8],w=this.h[9],y=this.h[10],B=this.h[11],k=this.h[12],z=this.h[13],q=this.h[14],N=this.h[15];s(this.k.length===r.length);for(var P=0;P<r.length;P+=2){var R=q,O=N,U=_(g,w),C=x(g,w),T=v(g,w,y,B,k),D=S(g,w,y,B,k,z),L=this.k[P],K=this.k[P+1],H=r[P],j=r[P+1],F=p(R,O,U,C,T,D,L,K,H,j),Z=m(R,O,U,C,T,D,L,K,H,j);R=A(i,n),O=I(i,n),U=E(i,n,o,f,a),C=M(i,n,o,f,a,c);var V=u(R,O,U,C),G=d(R,O,U,C);q=k,N=z,k=y,z=B,y=g,B=w,g=u(l,b,F,Z),w=d(b,b,F,Z),l=a,b=c,a=o,c=f,o=i,f=n,i=u(F,Z,V,G),n=d(F,Z,V,G)}h(this.h,0,i,n),h(this.h,2,o,f),h(this.h,4,a,c),h(this.h,6,l,b),h(this.h,8,g,w),h(this.h,10,y,B),h(this.h,12,k,z),h(this.h,14,q,N)},y.prototype._digest=function(t){return"hex"===t?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},function(t,e,r){"use strict";
/*!
 * bcrypto.js - crypto for bcrypto
 * Copyright (c) 2014-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */e.AEAD=r(167),e.aes=r(169),e.ARC4=r(172),e.bcrypt=r(71),e.BLAKE2b=r(24),e.BLAKE2b160=r(176),e.BLAKE2b256=r(177),e.BLAKE2b384=r(178),e.BLAKE2b512=r(179),e.BLAKE2s=r(25),e.BLAKE2s128=r(181),e.BLAKE2s160=r(182),e.BLAKE2s224=r(183),e.BLAKE2s256=r(184),e.BN=r(6),e.box=r(186),e.ChaCha20=r(82),e.cipher=r(34),e.cleanse=r(203),e.CSHAKE=r(35),e.CSHAKE128=r(205),e.CSHAKE256=r(206),e.CtrDRBG=r(207),e.dsa=r(84),e.dsaies=r(211),e.eb2k=r(86),e.ecies=r(213),e.ed25519=r(87),e.ed448=r(215),e.encoding=r(217),e.GOST94=r(235),e.Hash160=r(237),e.Hash256=r(239),e.HashDRBG=r(241),e.hkdf=r(243),e.HmacDRBG=r(48),e.Keccak=r(17),e.Keccak224=r(245),e.Keccak256=r(246),e.Keccak384=r(247),e.Keccak512=r(248),e.KMAC=r(54),e.KMAC128=r(249),e.KMAC256=r(250),e.MD2=r(251),e.MD4=r(253),e.MD5=r(53),e.MD5SHA1=r(255),e.merkle=r(257),e.mrkl=r(258),e.murmur3=r(259),e.p192=r(261),e.p224=r(264),e.p256=r(102),e.p384=r(103),e.p521=r(104),e.pbkdf2=r(105),e.pgp=r(271),e.Poly1305=r(78),e.random=r(5),e.RIPEMD160=r(107),e.rsa=r(109),e.rsaies=r(276),e.safe=r(110),e.Salsa20=r(77),e.schnorr=r(277),e.scrypt=r(279),e.secp256k1=r(283),e.secretbox=r(26),e.ssh=r(285),e.SHA1=r(106),e.SHA224=r(108),e.SHA256=r(11),e.SHA384=r(55),e.SHA512=r(23),e.SHA3=r(28),e.SHA3_224=r(287),e.SHA3_256=r(288),e.SHA3_384=r(289),e.SHA3_512=r(290),e.SHAKE=r(51),e.SHAKE128=r(291),e.SHAKE256=r(38),e.siphash=r(292),e.Whirlpool=r(294),e.x25519=r(79),e.x448=r(296),e.version="5.4.0",e.native=e.SHA256.native},function(t,e,r){"use strict";(function(e){
/*!
 * chacha20.js - chacha20 for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources
 *   https://en.wikipedia.org/wiki/Chacha20
 *   https://tools.ietf.org/html/rfc7539#section-2
 *   https://cr.yp.to/chacha.html
 */
const i=r(1),n=0===new Int8Array(new Int16Array([1]).buffer)[0];class s{constructor(){this.state=new Uint32Array(16),this.stream=new Uint32Array(16),this.bytes=new Uint8Array(this.stream.buffer),this.pos=-1,n&&(this.bytes=e.alloc(64))}init(t,r,n){if(null==n&&(n=0),i(e.isBuffer(t)),i(e.isBuffer(r)),i(Number.isSafeInteger(n)),16!==t.length&&32!==t.length)throw new RangeError("Invalid key size.");if(r.length>=24&&(t=s.derive(t,r.slice(0,16)),r=r.slice(16)),this.state[0]=1634760805,this.state[1]=t.length<32?824206446:857760878,this.state[2]=t.length<32?2036477238:2036477234,this.state[3]=1797285236,this.state[4]=a(t,0),this.state[5]=a(t,4),this.state[6]=a(t,8),this.state[7]=a(t,12),this.state[8]=a(t,16%t.length),this.state[9]=a(t,20%t.length),this.state[10]=a(t,24%t.length),this.state[11]=a(t,28%t.length),this.state[12]=n>>>0,8===r.length)this.state[13]=n/4294967296>>>0,this.state[14]=a(r,0),this.state[15]=a(r,4);else if(12===r.length)this.state[13]=a(r,0),this.state[14]=a(r,4),this.state[15]=a(r,8);else{if(16!==r.length)throw new RangeError("Invalid nonce size.");this.state[12]=a(r,0),this.state[13]=a(r,4),this.state[14]=a(r,8),this.state[15]=a(r,12)}return this.pos=0,this}encrypt(t){if(i(e.isBuffer(t)),-1===this.pos)throw new Error("Context is not initialized.");for(let e=0;e<t.length;e++)0==(63&this.pos)&&(this._block(),this.pos=0),t[e]^=this.bytes[this.pos++];return t}_block(){for(let t=0;t<16;t++)this.stream[t]=this.state[t];for(let t=0;t<10;t++)o(this.stream,0,4,8,12),o(this.stream,1,5,9,13),o(this.stream,2,6,10,14),o(this.stream,3,7,11,15),o(this.stream,0,5,10,15),o(this.stream,1,6,11,12),o(this.stream,2,7,8,13),o(this.stream,3,4,9,14);for(let t=0;t<16;t++)this.stream[t]+=this.state[t];if(n)for(let t=0;t<16;t++)c(this.bytes,this.stream[t],4*t);this.state[12]+=1,0===this.state[12]&&(this.state[13]+=1)}destroy(){for(let t=0;t<16;t++)this.state[t]=0,this.stream[t]=0;if(n)for(let t=0;t<64;t++)this.bytes[t]=0;return this.pos=-1,this}static derive(t,r){if(i(e.isBuffer(t)),i(e.isBuffer(r)),16!==t.length&&32!==t.length)throw new RangeError("Invalid key size.");if(16!==r.length)throw new RangeError("Invalid nonce size.");const n=new Uint32Array(16);n[0]=1634760805,n[1]=t.length<32?824206446:857760878,n[2]=t.length<32?2036477238:2036477234,n[3]=1797285236,n[4]=a(t,0),n[5]=a(t,4),n[6]=a(t,8),n[7]=a(t,12),n[8]=a(t,16%t.length),n[9]=a(t,20%t.length),n[10]=a(t,24%t.length),n[11]=a(t,28%t.length),n[12]=a(r,0),n[13]=a(r,4),n[14]=a(r,8),n[15]=a(r,12);for(let t=0;t<10;t++)o(n,0,4,8,12),o(n,1,5,9,13),o(n,2,6,10,14),o(n,3,7,11,15),o(n,0,5,10,15),o(n,1,6,11,12),o(n,2,7,8,13),o(n,3,4,9,14);const s=e.alloc(32);return c(s,n[0],0),c(s,n[1],4),c(s,n[2],8),c(s,n[3],12),c(s,n[12],16),c(s,n[13],20),c(s,n[14],24),c(s,n[15],28),s}}function o(t,e,r,i,n){t[e]+=t[r],t[n]=f(t[n]^t[e],16),t[i]+=t[n],t[r]=f(t[r]^t[i],12),t[e]+=t[r],t[n]=f(t[n]^t[e],8),t[i]+=t[n],t[r]=f(t[r]^t[i],7)}function f(t,e){return t<<e|t>>>32-e}function a(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]}function c(t,e,r){return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}s.native=0,t.exports=s}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * poly1305.js - poly1305 for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on floodyberry/poly1305-donna:
 *   Placed into the public domain by Andrew Moon.
 *   https://github.com/floodyberry/poly1305-donna
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Poly1305
 *   https://cr.yp.to/mac.html
 *   https://tools.ietf.org/html/rfc7539#section-2.5
 *   https://github.com/floodyberry/poly1305-donna/blob/master/poly1305-donna-16.h
 */
const i=r(1);class n{constructor(){this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.buffer=e.alloc(16),this.fin=-1,this.leftover=0}init(t){i(e.isBuffer(t)&&t.length>=32);const r=s(t,0),n=s(t,2),o=s(t,4),f=s(t,6),a=s(t,8),c=s(t,10),h=s(t,12),u=s(t,14);this.r[0]=8191&r,this.r[1]=8191&(r>>>13|n<<3),this.r[2]=7939&(n>>>10|o<<6),this.r[3]=8191&(o>>>7|f<<9),this.r[4]=255&(f>>>4|a<<12),this.r[5]=a>>>1&8190,this.r[6]=8191&(a>>>14|c<<2),this.r[7]=8065&(c>>>11|h<<5),this.r[8]=8191&(h>>>8|u<<8),this.r[9]=u>>>5&127;for(let t=0;t<10;t++)this.h[t]=0;for(let e=0;e<8;e++)this.pad[e]=s(t,16+2*e);return this.fin=0,this.leftover=0,this}_blocks(t,e,r){const i=this.fin?0:2048,n=new Uint32Array(10);for(;e>=16;){const o=s(t,r+0),f=s(t,r+2),a=s(t,r+4),c=s(t,r+6),h=s(t,r+8),u=s(t,r+10),d=s(t,r+12),l=s(t,r+14);this.h[0]+=8191&o,this.h[1]+=8191&(o>>>13|f<<3),this.h[2]+=8191&(f>>>10|a<<6),this.h[3]+=8191&(a>>>7|c<<9),this.h[4]+=8191&(c>>>4|h<<12),this.h[5]+=h>>>1&8191,this.h[6]+=8191&(h>>>14|u<<2),this.h[7]+=8191&(u>>>11|d<<5),this.h[8]+=8191&(d>>>8|l<<8),this.h[9]+=l>>>5|i;let b=0;for(let t=0;t<10;t++){n[t]=b;for(let e=0;e<10;e++){let r=this.h[e];r*=e<=t?this.r[t-e]:5*this.r[t+10-e],n[t]+=r,4===e&&(b=n[t]>>>13,n[t]&=8191)}b+=n[t]>>>13,n[t]&=8191}b=(b<<2)+b,b+=n[0],n[0]=8191&b,b>>>=13,n[1]+=b;for(let t=0;t<10;t++)this.h[t]=n[t];r+=16,e-=16}}update(t){if(i(e.isBuffer(t)),-1===this.fin)throw new Error("Context is not initialized.");let r=t.length,n=0;if(this.leftover){let e=16-this.leftover;e>r&&(e=r);for(let r=0;r<e;r++)this.buffer[this.leftover+r]=t[n+r];if(r-=e,n+=e,this.leftover+=e,this.leftover<16)return this;this._blocks(this.buffer,16,0),this.leftover=0}if(r>=16){const e=-16&r;this._blocks(t,e,n),n+=e,r-=e}if(r){for(let e=0;e<r;e++)this.buffer[this.leftover+e]=t[n+e];this.leftover+=r}return this}final(){if(-1===this.fin)throw new Error("Context is not initialized.");const t=e.alloc(16),r=new Uint16Array(10);if(this.leftover){let t=this.leftover;for(this.buffer[t++]=1;t<16;t++)this.buffer[t]=0;this.fin=1,this._blocks(this.buffer,16,0)}let i=this.h[1]>>>13;this.h[1]&=8191;for(let t=2;t<10;t++)this.h[t]+=i,i=this.h[t]>>>13,this.h[t]&=8191;this.h[0]+=5*i,i=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=i,i=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=i,r[0]=this.h[0]+5,i=r[0]>>>13,r[0]&=8191;for(let t=1;t<10;t++)r[t]=this.h[t]+i,i=r[t]>>>13,r[t]&=8191;let n=(1^i)-1;for(let t=0;t<10;t++)r[t]&=n;n=~n;for(let t=0;t<10;t++)this.h[t]=this.h[t]&n|r[t];this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5);let s=this.h[0]+this.pad[0];this.h[0]=s;for(let t=1;t<8;t++)s=this.h[t]+this.pad[t]+(s>>>16),this.h[t]=s;for(let e=0;e<8;e++)o(t,this.h[e],2*e);return this.destroy(),t}destroy(){for(let t=0;t<10;t++)this.r[t]=0,this.h[t]=0;for(let t=0;t<8;t++)this.pad[t]=0;for(let t=0;t<16;t++)this.buffer[t]=0;this.fin=-1,this.leftover=0}verify(t){i(e.isBuffer(t)),i(16===t.length);const r=this.final();let n=0;for(let e=0;e<16;e++)n|=r[e]^t[e];return n-1>>>31!=0}}function s(t,e){return t[e++]+256*t[e]}function o(t,e,r){return t[r++]=e,t[r++]=e>>>8,r}n.native=0,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * modes.js - cipher modes for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation
 */
const i=r(1),n=r(171),s=t.alloc(0),o=new Uint32Array([27,135,1061,0,293,0,0,0,524355]);class f{constructor(t){i(t&&"function"==typeof t.encrypt),i("number"==typeof t.blockSize),this.ctx=t}get blockSize(){return this.ctx.blockSize}init(t,e){throw new Error("Not implemented.")}update(t){throw new Error("Not implemented.")}crypt(t,e){throw new Error("Not implemented.")}final(){throw new Error("Not implemented.")}destroy(){throw new Error("Not implemented.")}setAutoPadding(t){return i("boolean"==typeof t),this._setAutoPadding(t),this}setAAD(e){return i(t.isBuffer(e)),this._setAAD(e),this}setCCM(e,r,n){return i(e>>>0===e),i(r>>>0===r),i(null==n||t.isBuffer(n)),this._setCCM(e,r,n),this}getAuthTag(){return this._getAuthTag()}setAuthTag(e){return i(t.isBuffer(e)),this._setAuthTag(e),this}_setAutoPadding(t){throw new Error("Not available.")}_setAAD(t){throw new Error("Cipher is not authenticated.")}_setCCM(t,e,r){throw new Error("Not available.")}_getAuthTag(){throw new Error("Cipher is not authenticated.")}_setAuthTag(t){throw new Error("Cipher is not authenticated.")}}class a extends f{constructor(e,r){super(e),this.padding=!0,this.unpad=r,this.block=t.alloc(this.blockSize),this.blockPos=-1,this.last=null,this.lastSize=0,r&&(this.last=t.alloc(this.blockSize))}init(e,r){return null==r&&(r=s),i(t.isBuffer(e)),i(t.isBuffer(r)),this.ctx.init(e),this.blockPos=0,this.lastSize=0,this._init(e,r),this}_updateSize(t){if(this.blockPos+t<this.blockSize)return 0;let e=0;return this.unpad&&(e+=this.lastSize),this.blockPos>0&&(t-=this.blockSize-this.blockPos,e+=this.blockSize),t>=this.blockSize&&(e+=t-t%this.blockSize),i(e>=this.blockSize),e}update(e){if(i(t.isBuffer(e)),-1===this.blockPos)throw new Error("Cipher is not initialized.");const r=this._updateSize(e.length),n=t.alloc(r);if(this.blockPos+e.length<this.blockSize)return this.blockPos+=e.copy(this.block,this.blockPos,0,e.length),n;let s=e.length,o=0,f=0;if(this.unpad&&(f+=this.last.copy(n,f,0,this.lastSize)),this.blockPos>0){const t=this.blockSize-this.blockPos;o+=e.copy(this.block,this.blockPos,o,o+t),s-=t,this._update(n,f,this.block,0),f+=this.blockSize,this.blockPos=0}for(;s>=this.blockSize;)this._update(n,f,e,o),o+=this.blockSize,s-=this.blockSize,f+=this.blockSize;return s>0&&(this.blockPos=e.copy(this.block,0,o,o+s)),i(f===r),this.unpad?(this.lastSize=n.copy(this.last,0,r-this.blockSize,r),n.slice(0,r-this.blockSize)):n}crypt(e,r){if(i(t.isBuffer(e)),i(t.isBuffer(r)),i(e.length===r.length),-1===this.blockPos)throw new Error("Cipher is not initialized.");if(this.unpad||0!==this.blockPos)throw new Error("Cannot crypt while buffering.");if(r.length%this.blockSize!=0)throw new Error("Input must be a multiple of the block size.");const n=this.blockSize;let s=r.length,o=0;for(;s>0;)this._update(e,o,r,o),o+=n,s-=n;return e}final(){if(-1===this.blockPos)throw new Error("Cipher is not initialized.");try{return this._final()}finally{this.destroy()}}destroy(){this.ctx.destroy(),this.blockPos=-1,this.lastSize=0;for(let t=0;t<this.blockSize;t++)this.block[t]=0;if(this.unpad)for(let t=0;t<this.blockSize;t++)this.last[t]=0;return this._destroy(),this}_init(t,e){throw new Error("Not implemented.")}_update(t,e,r,i){throw new Error("Not implemented.")}_final(){throw new Error("Not implemented.")}_destroy(){throw new Error("Not implemented.")}}class c extends f{constructor(t){super(t),this.pos=-1}init(e,r){return null==r&&(r=s),i(t.isBuffer(e)),i(t.isBuffer(r)),this.ctx.init(e),this.pos=0,this._init(e,r),this}update(e){if(i(t.isBuffer(e)),-1===this.pos)throw new Error("Cipher is not initialized.");const r=t.alloc(e.length);return this._crypt(r,e),r}crypt(e,r){if(i(t.isBuffer(e)),i(t.isBuffer(r)),i(e.length===r.length),-1===this.pos)throw new Error("Cipher is not initialized.");return this._crypt(e,r),e}final(){if(-1===this.pos)throw new Error("Cipher is not initialized.");try{return this._final()}finally{this.destroy()}}destroy(){return this.ctx.destroy(),this.pos=-1,this._destroy(),this}_init(t,e){throw new Error("Not implemented.")}_crypt(t,e){throw new Error("Not implemented.")}_final(){throw new Error("Not implemented.")}_destroy(){throw new Error("Not implemented.")}}class h extends a{constructor(t){super(t,!1)}_init(t,e){i(0===e.length)}_update(t,e,r,i){this.ctx.encrypt(t,e,r,i)}_final(){if(0!==this.blockPos)throw new Error("Bad encrypt (trailing bytes).");return t.alloc(0)}_destroy(){}}class u extends a{constructor(t){super(t,!1)}_init(t,e){i(0===e.length)}_update(t,e,r,i){this.ctx.decrypt(t,e,r,i)}_final(){if(0!==this.blockPos)throw new Error("Bad decrypt (trailing bytes).");return t.alloc(0)}_destroy(){}}class d extends a{constructor(t){super(t,!1)}_final(){if(!this.padding){if(0!==this.blockPos)throw new Error("Bad encrypt (trailing bytes).");return t.alloc(0)}const e=this.blockSize-this.blockPos,r=t.from(this.block);for(let t=this.blockPos;t<this.blockSize;t++)r[t]=e;return this._update(r,0,r,0),r}_setAutoPadding(t){this.padding=t}}class l extends a{constructor(t){super(t,!0)}_final(){if(0!==this.blockPos)throw new Error("Bad decrypt (trailing bytes).");if(!this.padding)return t.alloc(0);if(0===this.lastSize)throw new Error("Bad decrypt (no data).");i(this.lastSize===this.last.length),i(this.lastSize===this.blockSize);const e=t.from(this.last);let r=e[e.length-1],n=1;n&=r-1>>>31^1,n&=r-this.blockSize-1>>>31,r&=-n;const s=this.blockSize-r;for(let t=0;t<this.blockSize;t++){n&=t-s>>>31|(e[t]^r)-1>>>31}if(!n)throw new Error("Bad decrypt (padding).");return e.slice(0,s)}_setAutoPadding(t){if(0!==this.lastSize||0!==this.blockPos)throw new Error("Cannot set auto padding.");this.padding=t,this.unpad=t}}class b extends d{constructor(t){super(t)}_init(t,e){i(0===e.length)}_update(t,e,r,i){this.ctx.encrypt(t,e,r,i)}_destroy(){}}class p extends l{constructor(t){super(t)}_init(t,e){i(0===e.length)}_update(t,e,r,i){this.ctx.decrypt(t,e,r,i)}_destroy(){}}class m extends d{constructor(e){super(e),this.prev=t.alloc(this.blockSize)}_init(t,e){i(e.length===this.blockSize),e.copy(this.prev,0)}_update(t,e,r,i){for(let t=0;t<this.blockSize;t++)this.prev[t]^=r[i+t];this.ctx.encrypt(t,e,this.prev,0),t.copy(this.prev,0,e,e+this.blockSize)}_destroy(){for(let t=0;t<this.blockSize;t++)this.prev[t]=0}}class g extends l{constructor(e){super(e),this.prev=t.alloc(this.blockSize),this.tmp=t.alloc(this.blockSize)}_init(t,e){i(e.length===this.blockSize),e.copy(this.prev,0)}_update(t,e,r,i){if(j(t,e,r,i)){this.prev.copy(this.tmp,0),r.copy(this.prev,0,i,i+this.blockSize),this.ctx.decrypt(t,e,r,i);for(let r=0;r<this.blockSize;r++)t[e+r]^=this.tmp[r]}else{this.ctx.decrypt(t,e,r,i);for(let r=0;r<this.blockSize;r++)t[e+r]^=this.prev[r];r.copy(this.prev,0,i,i+this.blockSize)}}_destroy(){for(let t=0;t<this.blockSize;t++)this.prev[t]=0,this.tmp[t]=0}}class w extends a{constructor(e){super(e,!0),this.prev=t.alloc(this.blockSize)}_init(t,e){i(e.length===this.blockSize),e.copy(this.prev,0)}_update(t,e,r,i){for(let t=0;t<this.blockSize;t++)this.prev[t]^=r[i+t];this.ctx.encrypt(t,e,this.prev,0),t.copy(this.prev,0,e,e+this.blockSize)}_final(){if(!this.padding){if(0!==this.blockPos)throw new Error("Bad encrypt (trailing bytes).");return t.alloc(0)}if(0===this.lastSize)throw new Error("Bad encrypt (no data).");for(let t=0;t<this.blockPos;t++)this.prev[t]^=this.block[t];this.ctx.encrypt(this.prev,0,this.prev,0);const e=this.last.slice(0,this.blockPos);return t.concat([this.prev,e])}_destroy(){for(let t=0;t<this.blockSize;t++)this.prev[t]=0}_setAutoPadding(t){if(0!==this.lastSize||0!==this.blockPos)throw new Error("Cannot set auto padding.");this.padding=t,this.unpad=t}}class y extends a{constructor(e){super(e,!0),this.prev=t.alloc(this.blockSize),this.tmp=t.alloc(this.blockSize)}_init(t,e){i(e.length===this.blockSize),e.copy(this.prev,0)}_update(t,e,r,i){if(j(t,e,r,i)){this.prev.copy(this.tmp,0),r.copy(this.prev,0,i,i+this.blockSize),this.ctx.decrypt(t,e,r,i);for(let r=0;r<this.blockSize;r++)t[e+r]^=this.tmp[r]}else{this.ctx.decrypt(t,e,r,i);for(let r=0;r<this.blockSize;r++)t[e+r]^=this.prev[r];r.copy(this.prev,0,i,i+this.blockSize)}}_final(){if(!this.padding){if(0!==this.blockPos)throw new Error("Bad decrypt (trailing bytes).");return t.alloc(0)}if(0===this.lastSize)throw new Error("Bad decrypt (no data).");const e=t.alloc(this.blockSize);this.ctx.decrypt(this.prev,0,this.prev,0);for(let t=0;t<this.blockSize;t++)e[t]=this.last[t]^this.prev[t];for(let t=0;t<this.blockPos;t++)this.last[t]=this.block[t],this.block[t]^=this.prev[t];for(let t=this.blockPos;t<this.blockSize;t++)this.last[t]=this.prev[t];this.ctx.decrypt(this.last,0,this.last,0);for(let t=0;t<this.blockSize;t++)this.last[t]^=e[t];const r=this.block.slice(0,this.blockPos);return t.concat([this.last,r])}_destroy(){for(let t=0;t<this.blockSize;t++)this.prev[t]=0,this.tmp[t]=0}_setAutoPadding(t){if(0!==this.lastSize||0!==this.blockPos)throw new Error("Cannot set auto padding.");this.padding=t,this.unpad=t}}class v extends a{constructor(e,r){super(e,!0),this.encrypt=r,this.poly=o[this.blockSize>>>4],this.tweak=t.alloc(this.blockSize),this.prev=t.alloc(this.blockSize)}init(e,r){i(t.isBuffer(e)),i(t.isBuffer(r)),i(e.length>0&&0==(1&e.length)),i(r.length===this.blockSize);const n=e.length>>>1,s=e.slice(0,n),o=e.slice(n);if(F(s,o,n))throw new Error("XTS keys are equal.");return this.ctx.init(o),this.ctx.encrypt(this.tweak,0,r,0),this.ctx.init(s),this.blockPos=0,this.lastSize=0,this}_shift(){let t=0;this.encrypt||this.tweak.copy(this.prev,0);for(let e=0;e<this.blockSize;e++){const r=this.tweak[e]>>7;this.tweak[e]<<=1,this.tweak[e]|=t,t=r}t=255&-t,this.tweak[2]^=this.poly>>16&t,this.tweak[1]^=this.poly>>8&t,this.tweak[0]^=this.poly>>0&t}_update(t,e,r,i){for(let n=0;n<this.blockSize;n++)t[e+n]=r[i+n]^this.tweak[n];this.encrypt?this.ctx.encrypt(t,e,t,e):this.ctx.decrypt(t,e,t,e);for(let r=0;r<this.blockSize;r++)t[e+r]^=this.tweak[r];this._shift()}_destroy(){for(let t=0;t<this.blockSize;t++)this.tweak[t]=0,this.prev[t]=0}_setAutoPadding(t){if(0!==this.lastSize||0!==this.blockPos)throw new Error("Cannot set auto padding.");this.padding=t,this.unpad=t}}class S extends v{constructor(t){super(t,!0)}_final(){if(!this.padding){if(0!==this.blockPos)throw new Error("Bad encrypt (trailing bytes).");return t.alloc(0)}if(0===this.lastSize)throw new Error("Bad encrypt (no data).");if(0===this.blockPos)return t.from(this.last);const e=t.alloc(this.blockPos);for(let t=0;t<this.blockPos;t++)e[t]=this.last[t],this.last[t]=this.block[t];for(let t=0;t<this.blockSize;t++)this.last[t]^=this.tweak[t];this.ctx.encrypt(this.last,0,this.last,0);for(let t=0;t<this.blockSize;t++)this.last[t]^=this.tweak[t];return t.concat([this.last,e])}}class E extends v{constructor(t){super(t,!1)}_final(){if(!this.padding){if(0!==this.blockPos)throw new Error("Bad decrypt (trailing bytes).");return t.alloc(0)}if(0===this.lastSize)throw new Error("Bad decrypt (no data).");if(0===this.blockPos)return t.from(this.last);for(let t=0;t<this.blockSize;t++)this.last[t]^=this.prev[t];this.ctx.encrypt(this.last,0,this.last,0);for(let t=0;t<this.blockSize;t++)this.last[t]^=this.prev[t];for(let t=0;t<this.blockSize;t++)this.last[t]^=this.tweak[t];this.ctx.decrypt(this.last,0,this.last,0);for(let t=0;t<this.blockSize;t++)this.last[t]^=this.tweak[t];const e=t.alloc(this.blockPos);for(let t=0;t<this.blockPos;t++)e[t]=this.last[t],this.last[t]=this.block[t];for(let t=0;t<this.blockSize;t++)this.last[t]^=this.prev[t];this.ctx.decrypt(this.last,0,this.last,0);for(let t=0;t<this.blockSize;t++)this.last[t]^=this.prev[t];return t.concat([this.last,e])}}class M extends c{constructor(e){super(e),this.state=t.alloc(this.blockSize),this.ctr=t.alloc(this.blockSize)}_init(t,e){i(e.length===this.blockSize),e.copy(this.ctr,0)}_increment(){for(let t=this.ctr.length-1;t>=0&&(this.ctr[t]+=1,0===this.ctr[t]);t--);}_crypt(t,e){const r=this.blockSize-1;for(let i=0;i<e.length;i++)0==(this.pos&r)&&(this.ctx.encrypt(this.state,0,this.ctr,0),this._increment(),this.pos=0),t[i]=e[i]^this.state[this.pos++]}_final(){return t.alloc(0)}_destroy(){for(let t=0;t<this.blockSize;t++)this.state[t]=0,this.ctr[t]=0}}class A extends M{constructor(t){super(t)}}class I extends M{constructor(t){super(t)}}class _ extends c{constructor(e){super(e),this.state=t.alloc(this.blockSize),this.prev=t.alloc(this.blockSize)}_init(t,e){i(e.length===this.blockSize),e.copy(this.prev,0)}_final(){return t.alloc(0)}_destroy(){for(let t=0;t<this.blockSize;t++)this.state[t]=0,this.prev[t]=0}}class x extends _{constructor(t){super(t)}_crypt(t,e){const r=this.blockSize-1;for(let i=0;i<e.length;i++)0==(this.pos&r)&&(this.ctx.encrypt(this.state,0,this.prev,0),this.pos=0),t[i]=e[i]^this.state[this.pos],this.prev[this.pos]=t[i],this.pos+=1}}class B extends _{constructor(t){super(t)}_crypt(t,e){const r=this.blockSize-1;for(let i=0;i<e.length;i++)0==(this.pos&r)&&(this.ctx.encrypt(this.state,0,this.prev,0),this.pos=0),this.prev[this.pos]=e[i],t[i]=e[i]^this.state[this.pos],this.pos+=1}}class k extends c{constructor(e){super(e),this.state=t.alloc(this.blockSize)}_init(e,r){i(t.isBuffer(r)),i(r.length===this.blockSize),r.copy(this.state,0)}_crypt(t,e){const r=this.blockSize-1;for(let i=0;i<e.length;i++)0==(this.pos&r)&&(this.ctx.encrypt(this.state,0,this.state,0),this.pos=0),t[i]=e[i]^this.state[this.pos++]}_final(){return t.alloc(0)}_destroy(){for(let t=0;t<this.blockSize;t++)this.state[t]=0}}class z extends k{constructor(t){super(t)}}class q extends k{constructor(t){super(t)}}class N extends c{constructor(e,r){i(16===e.blockSize),super(e),this.encrypt=r,this.hash=new n,this.ctr=t.alloc(16),this.state=t.alloc(16),this.key=t.alloc(16),this.mask=t.alloc(16),this.tag=null,this.mac=null}_init(t,e){for(let t=0;t<16;t++)this.ctr[t]=0,this.key[t]=0,this.mask[t]=0;return this._encipher(this.key,this.key),this.hash.init(this.key),12!==e.length&&(this.hash.update(e),e=this.hash.final(),this.hash.init(this.key)),e.copy(this.ctr,0),12===e.length&&(this.ctr[12]=0,this.ctr[13]=0,this.ctr[14]=0,this.ctr[15]=1),this._encipher(this.mask,this.mask),this.tag=null,this.mac=null,this}_increment(){let t=1,e=4;for(;e--;)t+=this.ctr[12+e],this.ctr[12+e]=t,t>>=8}_encipher(t,e){for(let r=0;r<e.length;r++)0==(15&this.pos)&&(this.ctx.encrypt(this.state,0,this.ctr,0),this._increment(),this.pos=0),t[r]=e[r]^this.state[this.pos++]}_crypt(t,e){this.encrypt?(this._encipher(t,e),this.hash.update(t)):(this.hash.update(e),this._encipher(t,e))}_final(){const e=this.hash.final();for(let t=0;t<16;t++)e[t]^=this.mask[t];if(this.encrypt)return this.mac=e,t.alloc(0);if(!this.tag)throw new Error("No tag provided.");if(!F(e,this.tag,this.tag.length))throw new Error("Invalid tag.");return t.alloc(0)}_destroy(){this.hash.destroy();for(let t=0;t<16;t++)this.ctr[t]=0,this.state[t]=0,this.key[t]=0,this.mask[t]=0;if(this.tag){for(let t=0;t<this.tag.length;t++)this.tag[t]=0;this.tag=null}}_setAAD(t){if(-1===this.pos)throw new Error("Cipher is not initialized.");return this.hash.aad(t),this}_getAuthTag(){if(!this.encrypt)throw new Error("Must be a cipher context.");if(!this.mac)throw new Error("Cipher is not finalized.");return t.from(this.mac)}_setAuthTag(e){if(this.encrypt)throw new Error("Must be a decipher context.");if(-1===this.pos)throw new Error("Cipher is not initialized.");if(4!==e.length&&8!==e.length&&(e.length<12||e.length>16))throw new RangeError("Invalid tag size.");return this.tag=t.from(e),this}}class P extends N{constructor(t){super(t,!0)}}class R extends N{constructor(t){super(t,!1)}}class O{constructor(e){this.ctx=e,this.size=e.blockSize,this.mac=t.alloc(this.size),this.pos=-1}init(){return this.mac.fill(0),this.pos=0,this}update(e){if(i(t.isBuffer(e)),-1===this.pos)throw new Error("Context is not initialized.");for(let t=0;t<e.length;t++)this.mac[this.pos++]^=e[t],this.pos===this.size&&(this.ctx.encrypt(this.mac,0,this.mac,0),this.pos=0)}pad(){this.pos>0&&(this.ctx.encrypt(this.mac,0,this.mac,0),this.pos=0)}final(){if(-1===this.pos)throw new Error("Context is not initialized.");return this.pad(),this.pos=-1,t.from(this.mac)}}class U extends c{constructor(e,r){i(16===e.blockSize),super(e),this.encrypt=r,this.hash=new O(e),this.state=t.alloc(16),this.ctr=t.alloc(16),this.tagLen=0,this.iv=null,this.mac=null,this.tag=null}_increment(){for(let t=15;t>=1&&(this.ctr[t]+=1,0===this.ctr[t]);t--);}_encipher(t,e){for(let r=0;r<e.length;r++)0==(15&this.pos)&&(this.ctx.encrypt(this.state,0,this.ctr,0),this._increment(),this.pos=0),t[r]=e[r]^this.state[this.pos++]}_init(e,r){if(r.length<7)throw new RangeError("Invalid nonce length.");r.length>13&&(r=r.slice(0,13)),this.iv=t.from(r),this.pos=-1,this.tagLen=0,this.mac=null,this.tag=null}_setCCM(e,r,n){if(!this.iv)throw new Error("Cipher is not initialized.");let s=e,o=Math.ceil((32-Math.clz32(s))/8);o<2&&(o=2);const f=r,a=15-o,c=0|(n&&n.length>0),h=t.alloc(16);if(f<4||f>16||0!=(1&f))throw new RangeError("Invalid tag length.");h[0]=64*c+(f-2)/2*8+(o-1),this.iv.copy(h,1,0,Math.min(a,this.iv.length));for(let t=15;t>=1+a;t--)h[t]=255&s,s>>>=8;if(i(0===s),this.hash.init(),this.hash.update(h),c){if(n.length<65280){const e=t.alloc(2);e[0]=n.length>>>8,e[1]=n.length>>>0,this.hash.update(e)}else{if(!(n.length<4294967295))throw new RangeError("Invalid AAD length.");{const e=t.alloc(6);e[0]=255,e[1]=254,e[2]=n.length>>>24,e[3]=n.length>>>16,e[4]=n.length>>>8,e[5]=n.length>>>0,this.hash.update(e)}}this.hash.update(n),this.hash.pad()}h[0]&=7,h[15]=1;for(let t=14;t>=1+a;t--)h[t]=0;h.copy(this.ctr,0),this.pos=0,this.tagLen=f,this.iv=null}_crypt(t,e){this.encrypt?(this.hash.update(e),this._encipher(t,e)):(this._encipher(t,e),this.hash.update(t))}_final(){const e=this.hash.final();let r=16-(1+(7&this.ctr[0]));for(;r<16;)this.ctr[r++]=0;if(this.pos=0,this._encipher(e,e),this.encrypt)return this.mac=e.slice(0,this.tagLen),t.alloc(0);if(!this.tag)throw new Error("No tag provided.");if(!F(e,this.tag,this.tagLen))throw new Error("Invalid tag.");return t.alloc(0)}_destroy(){for(let t=0;t<16;t++)this.state[t]=0,this.ctr[t]=0;this.tagLen=0,this.iv=null,this.tag=null}_getAuthTag(){if(!this.encrypt)throw new Error("Must be a cipher context.");if(!this.mac)throw new Error("Cipher is not finalized.");return t.from(this.mac)}_setAuthTag(e){if(this.encrypt)throw new Error("Must be a decipher context.");if(-1===this.pos)throw new Error("Cipher is not initialized.");if(0===this.tagLen||e.length!==this.tagLen)throw new RangeError("Invalid tag size.");return this.tag=t.from(e),this}}class C extends U{constructor(t){super(t,!0)}}class T extends U{constructor(t){super(t,!1)}}class D{constructor(e){this.ctx=e,this.poly=o[e.blockSize>>>4],this.size=e.blockSize,this.mac=t.alloc(this.size),this.pos=-1}init(t){return this.mac.fill(0),this.pos=0,null!=t&&(this.mac[this.size-1]^=t,this.pos=this.size),this}shift(t,e){let r=0;for(let i=this.size-1;i>=0;i--){const n=e[i]>>7;t[i]=e[i]<<1|r,r=n}r=255&-r,t[this.size-3]^=this.poly>>16&r,t[this.size-2]^=this.poly>>8&r,t[this.size-1]^=this.poly>>0&r}update(e){if(i(t.isBuffer(e)),-1===this.pos)throw new Error("Context is not initialized.");for(let t=0;t<e.length;t++)this.pos===this.size&&(this.ctx.encrypt(this.mac,0,this.mac,0),this.pos=0),this.mac[this.pos++]^=e[t]}final(){if(-1===this.pos)throw new Error("Context is not initialized.");const e=t.alloc(this.size);this.ctx.encrypt(e,0,e,0),this.shift(e,e),this.pos<this.size&&(this.mac[this.pos]^=128,this.shift(e,e));for(let t=0;t<this.size;t++)this.mac[t]^=e[t];return this.ctx.encrypt(this.mac,0,this.mac,0),this.pos=-1,t.from(this.mac)}}class L extends c{constructor(e,r){super(e),this.encrypt=r,this.hash1=new D(e),this.hash2=new D(e),this.state=t.alloc(this.blockSize),this.ctr=t.alloc(this.blockSize),this.mask=t.alloc(this.blockSize),this.mac=null,this.tag=null}_increment(){let t=this.blockSize,e=1;for(;t--;)e+=this.ctr[t],this.ctr[t]=e,e>>=8}_encipher(t,e){const r=this.blockSize-1;for(let i=0;i<e.length;i++)0==(this.pos&r)&&(this.ctx.encrypt(this.state,0,this.ctr,0),this._increment(),this.pos=0),t[i]=e[i]^this.state[this.pos++]}_init(t,e){i(e.length>0),this.hash1.init(0),this.hash1.update(e),this.mask=this.hash1.final(),this.mask.copy(this.ctr,0),this.hash1.init(1),this.hash2.init(2),this.mac=null,this.tag=null}_crypt(t,e){this.encrypt?(this._encipher(t,e),this.hash2.update(t)):(this.hash2.update(e),this._encipher(t,e))}_final(){const e=t.alloc(this.blockSize),r=this.hash1.final(),i=this.hash2.final();for(let t=0;t<this.blockSize;t++)e[t]=r[t]^i[t]^this.mask[t];if(this.encrypt)return this.mac=e,t.alloc(0);if(!this.tag)throw new Error("No tag provided.");if(!F(e,this.tag,this.tag.length))throw new Error("Invalid tag.");return t.alloc(0)}_destroy(){for(let t=0;t<this.blockSize;t++)this.state[t]=0,this.ctr[t]=0,this.mask[t]=0;this.tag=null}_setAAD(t){if(-1===this.pos)throw new Error("Cipher is not initialized.");return this.hash1.update(t),this}_getAuthTag(){if(!this.encrypt)throw new Error("Must be a cipher context.");if(!this.mac)throw new Error("Cipher is not finalized.");return t.from(this.mac)}_setAuthTag(e){if(this.encrypt)throw new Error("Must be a decipher context.");if(-1===this.pos)throw new Error("Cipher is not initialized.");if(0===e.length||e.length>this.blockSize)throw new RangeError("Invalid tag size.");return this.tag=t.from(e),this}}class K extends L{constructor(t){super(t,!0)}}class H extends L{constructor(t){super(t,!1)}}function j(t,e,r,i){return t.buffer===r.buffer&&t.byteOffset===r.byteOffset&&e===i}function F(t,e,r){let i=0;for(let n=0;n<r;n++)i|=t[n]^e[n];return i-1>>>31}e.Mode=f,e.Block=a,e.Stream=c,e.RawCipher=h,e.RawDecipher=u,e.PKCS7Cipher=d,e.PKCS7Decipher=l,e.ECBCipher=b,e.ECBDecipher=p,e.CBCCipher=m,e.CBCDecipher=g,e.CTSCipher=w,e.CTSDecipher=y,e.XTS=v,e.XTSCipher=S,e.XTSDecipher=E,e.CTR=M,e.CTRCipher=A,e.CTRDecipher=I,e.CFB=_,e.CFBCipher=x,e.CFBDecipher=B,e.OFB=k,e.OFBCipher=z,e.OFBDecipher=q,e.GCM=N,e.GCMCipher=P,e.GCMDecipher=R,e.CBCMAC=O,e.CCM=U,e.CCMCipher=C,e.CCMDecipher=T,e.CMAC=D,e.EAX=L,e.EAXCipher=K,e.EAXDecipher=H,e.get=function(t,e=!0){switch(i("string"==typeof t),i("boolean"==typeof e),t){case"RAW":return e?h:u;case"ECB":return e?b:p;case"CBC":return e?m:g;case"CTS":return e?w:y;case"XTS":return e?S:E;case"CTR":return e?A:I;case"CFB":return e?x:B;case"OFB":return e?z:q;case"GCM":return e?P:R;case"CCM":return e?C:T;case"EAX":return e?K:H;default:throw new Error(`Unknown mode: ${t}.`)}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * bcrypt.js - bcrypt for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(174)},function(t,e,r){"use strict";(function(e){
/*!
 * sha512.js - SHA512 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/hash.js:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/hash.js
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/SHA-2
 *   https://tools.ietf.org/html/rfc4634
 *   https://github.com/indutny/hash.js/blob/master/lib/hash/sha/512.js
 */
const i=r(1),n=r(3),s=e.alloc(16,0),o=e.alloc(128,0);o[0]=128;const f=new Uint32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);class a{constructor(){this.state=new Uint32Array(16),this.msg=new Uint32Array(160),this.block=e.alloc(128),this.size=-1}init(){return this.state[0]=1779033703,this.state[1]=4089235720,this.state[2]=3144134277,this.state[3]=2227873595,this.state[4]=1013904242,this.state[5]=4271175723,this.state[6]=2773480762,this.state[7]=1595750129,this.state[8]=1359893119,this.state[9]=2917565137,this.state[10]=2600822924,this.state[11]=725511199,this.state[12]=528734635,this.state[13]=4215389547,this.state[14]=1541459225,this.state[15]=327033209,this.size=0,this}update(t){return i(e.isBuffer(t)),this._update(t,t.length),this}final(){return this._final(e.alloc(64))}_update(t,e){i(-1!==this.size,"Context is not initialized.");let r=127&this.size,n=0;if(this.size+=e,r>0){let i=128-r;if(i>e&&(i=e),t.copy(this.block,r,n,n+i),r+=i,e-=i,n+=i,r<128)return;this._transform(this.block,0)}for(;e>=128;)this._transform(t,n),n+=128,e-=128;e>0&&t.copy(this.block,0,n,n+e)}_final(t){i(-1!==this.size,"Context is not initialized.");const e=127&this.size,r=8*this.size;N(s,r*(1/4294967296)>>>0,8),N(s,r>>>0,12),this._update(o,1+(239-e&127)),this._update(s,16);for(let e=0;e<16;e++)N(t,this.state[e],4*e),this.state[e]=0;for(let t=0;t<160;t++)this.msg[t]=0;for(let t=0;t<128;t++)this.block[t]=0;return this.size=-1,t}_prepare(t,e){const r=this.msg;let i=0;for(;i<32;i++)r[i]=(s=e+4*i,16777216*(n=t)[s++]+65536*n[s++]+256*n[s++]+n[s]);for(var n,s;i<160;i+=2){const t=z(r[i-4],r[i-3]),e=q(r[i-4],r[i-3]),n=r[i-14],s=r[i-13],o=B(r[i-30],r[i-29]),f=k(r[i-30],r[i-29]),a=r[i-32],c=r[i-31];r[i+0]=d(t,e,n,s,o,f,a,c),r[i+1]=l(t,e,n,s,o,f,a,c)}}_transform(t,e){const r=this.msg;this._prepare(t,e);let i=this.state[0],n=this.state[1],s=this.state[2],o=this.state[3],a=this.state[4],d=this.state[5],l=this.state[6],m=this.state[7],g=this.state[8],w=this.state[9],y=this.state[10],B=this.state[11],k=this.state[12],z=this.state[13],q=this.state[14],N=this.state[15];for(let t=0;t<r.length;t+=2){let e=q,c=N,P=_(g,w),R=x(g,w);const O=v(g,w,y,B,k,z),U=S(g,w,y,B,k,z),C=f[t+0],T=f[t+1],D=r[t+0],L=r[t+1],K=b(e,c,P,R,O,U,C,T,D,L),H=p(e,c,P,R,O,U,C,T,D,L);e=A(i,n),c=I(i,n),P=E(i,n,s,o,a,d),R=M(i,n,s,o,a,d);const j=h(e,c,P,R),F=u(e,c,P,R);q=k,N=z,k=y,z=B,y=g,B=w,g=h(l,m,K,H),w=u(m,m,K,H),l=a,m=d,a=s,d=o,s=i,o=n,i=h(K,H,j,F),n=u(K,H,j,F)}c(this.state,0,i,n),c(this.state,2,s,o),c(this.state,4,a,d),c(this.state,6,l,m),c(this.state,8,g,w),c(this.state,10,y,B),c(this.state,12,k,z),c(this.state,14,q,N)}static hash(){return new a}static hmac(){return new n(a,128)}static digest(t){return a.ctx.init().update(t).final()}static root(t,r){return i(e.isBuffer(t)&&64===t.length),i(e.isBuffer(r)&&64===r.length),a.ctx.init().update(t).update(r).final()}static multi(t,e,r){const{ctx:i}=a;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return a.hmac().init(e).update(t).final()}}function c(t,e,r,i){const n=t[e+0],s=i+t[e+1]>>>0,o=(s<i)+r+n;t[e+0]=o>>>0,t[e+1]=s}function h(t,e,r,i){return(e+i>>>0<e)+t+r>>>0}function u(t,e,r,i){return e+i>>>0}function d(t,e,r,i,n,s,o,f){let a=0,c=e;c=c+i>>>0,a+=c<e,c=c+s>>>0,a+=c<s,c=c+f>>>0,a+=c<f;return t+r+n+o+a>>>0}function l(t,e,r,i,n,s,o,f){return e+i+s+f>>>0}function b(t,e,r,i,n,s,o,f,a,c){let h=0,u=e;u=u+i>>>0,h+=u<e,u=u+s>>>0,h+=u<s,u=u+f>>>0,h+=u<f,u=u+c>>>0,h+=u<c;return t+r+n+o+a+h>>>0}function p(t,e,r,i,n,s,o,f,a,c){return e+i+s+f+c>>>0}function m(t,e,r){return(e<<32-r|t>>>r)>>>0}function g(t,e,r){return(t<<32-r|e>>>r)>>>0}function w(t,e,r){return t>>>r}function y(t,e,r){return(t<<32-r|e>>>r)>>>0}function v(t,e,r,i,n,s){return(t&r^~t&n)>>>0}function S(t,e,r,i,n,s){return(e&i^~e&s)>>>0}function E(t,e,r,i,n,s){return(t&r^t&n^r&n)>>>0}function M(t,e,r,i,n,s){return(e&i^e&s^i&s)>>>0}function A(t,e){return(m(t,e,28)^m(e,t,2)^m(e,t,7))>>>0}function I(t,e){return(g(t,e,28)^g(e,t,2)^g(e,t,7))>>>0}function _(t,e){return(m(t,e,14)^m(t,e,18)^m(e,t,9))>>>0}function x(t,e){return(g(t,e,14)^g(t,e,18)^g(e,t,9))>>>0}function B(t,e){return(m(t,e,1)^m(t,e,8)^w(t,0,7))>>>0}function k(t,e){return(g(t,e,1)^g(t,e,8)^y(t,e,7))>>>0}function z(t,e){return(m(t,e,19)^m(e,t,29)^w(t,0,6))>>>0}function q(t,e){return(g(t,e,19)^g(e,t,29)^y(t,e,6))>>>0}function N(t,e,r){return t[r++]=e>>>24,t[r++]=e>>>16,t[r++]=e>>>8,t[r++]=e,r}a.native=0,a.id="SHA512",a.size=64,a.bits=512,a.blockSize=128,a.zero=e.alloc(64,0),a.ctx=new a,t.exports=a}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * blowfish.js - blowfish for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on joyent/node-bcrypt-pbkdf:
 *   Copyright (c) 2016, Joyent Inc
 *   https://github.com/joyent/node-bcrypt-pbkdf
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Blowfish_(cipher)
 *   https://www.schneier.com/blowfish.html
 *   https://github.com/joyent/node-bcrypt-pbkdf/blob/master/index.js
 */
const i=r(1),n=new Uint32Array([3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946]),s=new Uint32Array([1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055]),o=new Uint32Array([3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504]),f=new Uint32Array([976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]),a=new Uint32Array([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731]);function c(t,e){return(t[0][e>>>24&255]+t[1][e>>>16&255]^t[2][e>>>8&255])+t[3][e>>>0&255]}function h(t,e){for(let r=0;r<e.length;r++)t[r]=e[r]}function u(t){for(let e=0;e<t.length;e++)t[e]=0}function d(t,e){return 16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function l(t,e,r){return t[r++]=e>>>24,t[r++]=e>>>16,t[r++]=e>>>8,t[r++]=e,r}t.exports=class{constructor(){this.S=[new Uint32Array(n.length),new Uint32Array(s.length),new Uint32Array(o.length),new Uint32Array(f.length)],this.P=new Uint32Array(a.length),this.block=new Uint32Array(2),this.off=0}get blockSize(){return 8}init(t,r){return i(e.isBuffer(t)),i(t.length>=1&&t.length<=72),null!=r&&(i(e.isBuffer(r)),i(r.length<=1096)),h(this.S[0],n),h(this.S[1],s),h(this.S[2],o),h(this.S[3],f),h(this.P,a),this.off=0,r&&r.length>0?this.expandstate(t,r):this.expand0state(t),this}encrypt(t,e,r,i){const n=this.block;return n[0]=d(r,i+0),n[1]=d(r,i+4),this.encipher(n,0),l(t,n[0],e+0),l(t,n[1],e+4),this}decrypt(t,e,r,i){const n=this.block;return n[0]=d(r,i+0),n[1]=d(r,i+4),this.decipher(n,0),l(t,n[0],e+0),l(t,n[1],e+4),this}destroy(){return u(this.S[0]),u(this.S[1]),u(this.S[2]),u(this.S[3]),u(this.P),u(this.block),this.off=0,this}encipher(t,e){const r=this.S,i=this.P;let n=t[e+0]^i[0],s=t[e+1];s^=c(r,n)^i[1],n^=c(r,s)^i[2],s^=c(r,n)^i[3],n^=c(r,s)^i[4],s^=c(r,n)^i[5],n^=c(r,s)^i[6],s^=c(r,n)^i[7],n^=c(r,s)^i[8],s^=c(r,n)^i[9],n^=c(r,s)^i[10],s^=c(r,n)^i[11],n^=c(r,s)^i[12],s^=c(r,n)^i[13],n^=c(r,s)^i[14],s^=c(r,n)^i[15],n^=c(r,s)^i[16],t[e+0]=s^i[17],t[e+1]=n}decipher(t,e){const r=this.S,i=this.P;let n=t[e+0]^i[17],s=t[e+1];s^=c(r,n)^i[16],n^=c(r,s)^i[15],s^=c(r,n)^i[14],n^=c(r,s)^i[13],s^=c(r,n)^i[12],n^=c(r,s)^i[11],s^=c(r,n)^i[10],n^=c(r,s)^i[9],s^=c(r,n)^i[8],n^=c(r,s)^i[7],s^=c(r,n)^i[6],n^=c(r,s)^i[5],s^=c(r,n)^i[4],n^=c(r,s)^i[3],s^=c(r,n)^i[2],n^=c(r,s)^i[1],t[e+0]=s^i[0],t[e+1]=n}stream2word(t){if(0===t.length)return this.off=0,0;const e=16777216*t[(this.off+0)%t.length]+65536*t[(this.off+1)%t.length]+256*t[(this.off+2)%t.length]+1*t[(this.off+3)%t.length];return this.off=(this.off+4)%t.length,e}expand0state(t){const e=new Uint32Array(2);this.off=0;for(let e=0;e<18;e++)this.P[e]^=this.stream2word(t);this.off=0;for(let t=0;t<18;t+=2)this.encipher(e,0),this.P[t+0]=e[0],this.P[t+1]=e[1];for(let t=0;t<4;t++)for(let r=0;r<256;r+=2)this.encipher(e,0),this.S[t][r+0]=e[0],this.S[t][r+1]=e[1]}expandstate(t,e){const r=new Uint32Array(2);this.off=0;for(let e=0;e<18;e++)this.P[e]^=this.stream2word(t);this.off=0;for(let t=0;t<18;t+=2)r[0]^=this.stream2word(e),r[1]^=this.stream2word(e),this.encipher(r,0),this.P[t+0]=r[0],this.P[t+1]=r[1];for(let t=0;t<4;t++)for(let i=0;i<256;i+=2)r[0]^=this.stream2word(e),r[1]^=this.stream2word(e),this.encipher(r,0),this.S[t][i+0]=r[0],this.S[t][i+1]=r[1];this.off=0}enc(t){const e=t.length>>>1;for(let r=0;r<e;r++)this.encipher(t,2*r)}dec(t){const e=t.length>>>1;for(let r=0;r<e;r++)this.decipher(t,2*r)}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * custom.js - custom inspect symbol for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */e.custom="inspect"},function(t,e,r){"use strict";(function(e){var i=r(187);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function n(t,e){if(t===e)return 0;for(var r=t.length,i=e.length,n=0,s=Math.min(r,i);n<s;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:i<r?1:0}function s(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var o=r(188),f=Object.prototype.hasOwnProperty,a=Array.prototype.slice,c="foo"===function(){}.name;function h(t){return Object.prototype.toString.call(t)}function u(t){return!s(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var d=t.exports=w,l=/\s*function\s+([^\(\s]*)\s*/;function b(t){if(o.isFunction(t)){if(c)return t.name;var e=t.toString().match(l);return e&&e[1]}}function p(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function m(t){if(c||!o.isFunction(t))return o.inspect(t);var e=b(t);return"[Function"+(e?": "+e:"")+"]"}function g(t,e,r,i,n){throw new d.AssertionError({message:r,actual:t,expected:e,operator:i,stackStartFunction:n})}function w(t,e){t||g(t,!0,e,"==",d.ok)}function y(t,e,r,i){if(t===e)return!0;if(s(t)&&s(e))return 0===n(t,e);if(o.isDate(t)&&o.isDate(e))return t.getTime()===e.getTime();if(o.isRegExp(t)&&o.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(u(t)&&u(e)&&h(t)===h(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===n(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(s(t)!==s(e))return!1;var f=(i=i||{actual:[],expected:[]}).actual.indexOf(t);return-1!==f&&f===i.expected.indexOf(e)||(i.actual.push(t),i.expected.push(e),function(t,e,r,i){if(null==t||null==e)return!1;if(o.isPrimitive(t)||o.isPrimitive(e))return t===e;if(r&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var n=v(t),s=v(e);if(n&&!s||!n&&s)return!1;if(n)return t=a.call(t),e=a.call(e),y(t,e,r);var f,c,h=M(t),u=M(e);if(h.length!==u.length)return!1;for(h.sort(),u.sort(),c=h.length-1;c>=0;c--)if(h[c]!==u[c])return!1;for(c=h.length-1;c>=0;c--)if(f=h[c],!y(t[f],e[f],r,i))return!1;return!0}(t,e,r,i))}return r?t===e:t==e}function v(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function S(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function E(t,e,r,i){var n;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(i=r,r=null),n=function(t){var e;try{t()}catch(t){e=t}return e}(e),i=(r&&r.name?" ("+r.name+").":".")+(i?" "+i:"."),t&&!n&&g(n,r,"Missing expected exception"+i);var s="string"==typeof i,f=!t&&n&&!r;if((!t&&o.isError(n)&&s&&S(n,r)||f)&&g(n,r,"Got unwanted exception"+i),t&&n&&r&&!S(n,r)||!t&&n)throw n}d.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return p(m(t.actual),128)+" "+t.operator+" "+p(m(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var r=new Error;if(r.stack){var i=r.stack,n=b(e),s=i.indexOf("\n"+n);if(s>=0){var o=i.indexOf("\n",s+1);i=i.substring(o+1)}this.stack=i}}},o.inherits(d.AssertionError,Error),d.fail=g,d.ok=w,d.equal=function(t,e,r){t!=e&&g(t,e,r,"==",d.equal)},d.notEqual=function(t,e,r){t==e&&g(t,e,r,"!=",d.notEqual)},d.deepEqual=function(t,e,r){y(t,e,!1)||g(t,e,r,"deepEqual",d.deepEqual)},d.deepStrictEqual=function(t,e,r){y(t,e,!0)||g(t,e,r,"deepStrictEqual",d.deepStrictEqual)},d.notDeepEqual=function(t,e,r){y(t,e,!1)&&g(t,e,r,"notDeepEqual",d.notDeepEqual)},d.notDeepStrictEqual=function t(e,r,i){y(e,r,!0)&&g(e,r,i,"notDeepStrictEqual",t)},d.strictEqual=function(t,e,r){t!==e&&g(t,e,r,"===",d.strictEqual)},d.notStrictEqual=function(t,e,r){t===e&&g(t,e,r,"!==",d.notStrictEqual)},d.throws=function(t,e,r){E(!0,t,e,r)},d.doesNotThrow=function(t,e,r){E(!1,t,e,r)},d.ifError=function(t){if(t)throw t},d.strict=i((function t(e,r){e||g(e,!0,r,"==",t)}),d,{equal:d.strictEqual,deepEqual:d.deepStrictEqual,notEqual:d.notStrictEqual,notDeepEqual:d.notDeepStrictEqual}),d.strict.strict=d.strict;var M=Object.keys||function(t){var e=[];for(var r in t)f.call(t,r)&&e.push(r);return e}}).call(this,r(13))},function(t,e){var r,i,n=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function f(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(t){r=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var a,c=[],h=!1,u=-1;function d(){h&&a&&(h=!1,a.length?c=a.concat(c):u=-1,c.length&&l())}function l(){if(!h){var t=f(d);h=!0;for(var e=c.length;e;){for(a=c,c=[];++u<e;)a&&a[u].run();u=-1,e=c.length}a=null,h=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function b(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new b(t,e)),1!==c.length||h||f(l)},b.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(t,e,r){"use strict";
/*!
 * salsa20.js - salsa20 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(192)},function(t,e,r){"use strict";
/*!
 * poly1305.js - poly1305 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(69)},function(t,e,r){"use strict";
/*!
 * x25519.js - x25519 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(194)},function(t,e,r){"use strict";(function(e){
/*!
 * ecdh.js - ECDH for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://cr.yp.to/ecdh.html
 *   https://cr.yp.to/ecdh/curve25519-20060209.pdf
 *   https://tools.ietf.org/html/rfc7748
 */
const i=r(1),n=r(6),s=r(33),o=r(5);t.exports=class{constructor(t,e,r){i("string"==typeof t),i(!e||"string"==typeof e),this.id=t,this.type="ecdh",this.eid=e||null,this._pre=r||null,this._curve=null,this._edwards=null,this.native=0}get curve(){return this._curve||(this._curve=s.curve(this.id)),this._curve}get edwards(){return this.eid&&!this._edwards&&(this._edwards=s.curve(this.eid,this._pre),this._edwards.precompute(o),this._pre=null),this._edwards}get size(){return this.curve.fieldSize}get bits(){return this.curve.fieldBits}privateKeyGenerate(){const t=o.randomBytes(this.curve.scalarSize);return this.curve.clamp(t)}privateKeyVerify(t){return i(e.isBuffer(t)),t.length===this.curve.scalarSize}privateKeyExport(t,r){const i=this.publicKeyCreate(t),{x:n,y:s}=this.publicKeyExport(i,r);return{d:e.from(t),x:n,y:s}}privateKeyImport(t){i(t&&"object"==typeof t);const e=n.decode(t.d,this.curve.endian);if(e.byteLength()>this.curve.scalarSize)throw new Error("Invalid private key.");return this.curve.encodeScalar(e)}publicKeyCreate(t){const e=this.curve.decodeClamped(t);if(this.edwards&&this.edwards.g.pre){const t=this.edwards.g.mulBlind(e);return this.curve.pointFromEdwards(t).encode()}return this.curve.g.toX().mulBlind(e,o).encode()}publicKeyConvert(t,e){if(i(null==e||"boolean"==typeof e),!this.edwards)throw new Error("No equivalent edwards curve.");const r=this.curve.decodePoint(t),n=this.edwards.pointFromMont(r);return null!=e&&n.isOdd()!==e?n.neg().encode():n.encode()}publicKeyFromUniform(t){const e=this.curve.decodeUniform(t);return this.curve.pointFromUniform(e).encode()}publicKeyToUniform(t,e=o.randomInt()){const r=this.curve.decodePoint(t),i=this.curve.pointToUniform(r,e);return this.curve.encodeUniform(i,e>>>8)}publicKeyFromHash(t,e=!1){return this.curve.pointFromHash(t,e).encode()}publicKeyToHash(t,e=o.randomInt()){const r=this.curve.decodePoint(t);return this.curve.pointToHash(r,e,o)}publicKeyVerify(t){let r;i(e.isBuffer(t));try{r=this.curve.decodeX(t)}catch(t){return!1}return r.validate()}publicKeyIsSmall(t){let r;i(e.isBuffer(t));try{r=this.curve.decodeX(t)}catch(t){return!1}return!!r.validate()&&r.isSmall()}publicKeyHasTorsion(t){let r;i(e.isBuffer(t));try{r=this.curve.decodeX(t)}catch(t){return!1}return!!r.validate()&&r.hasTorsion()}publicKeyExport(t,e){const{x:r,y:i}=this.curve.decodePoint(t,e);return{x:this.curve.encodeField(r.fromRed()),y:this.curve.encodeField(i.fromRed())}}publicKeyImport(t){i(t&&"object"==typeof t);const e=n.decode(t.x,this.curve.endian);if(e.cmp(this.curve.p)>=0)throw new Error("Invalid point.");if(null!=t.y){const r=n.decode(t.y,this.curve.endian);if(r.cmp(this.curve.p)>=0)throw new Error("Invalid point.");const i=this.curve.point(e,r);if(!i.validate())throw new Error("Invalid point.");return i.encode()}return this.curve.pointFromX(e).encode()}derive(t,e){const r=this.curve.decodeX(t),i=this.curve.decodeClamped(e);return r.mulBlind(i,o).encode()}}}).call(this,r(0).Buffer)},function(t){t.exports=JSON.parse('{"naf":{"width":9,"points":[["67ae9c4a22928f491ff4ae743edac83a6343981981624886ac62485fd3f8e25c","1267b1d177ee69aba126a18e60269ef79f16ec176724030402c3684878f5b4d4"],["49fda73eade3587bfcef7cf7d12da5de5c2819f93e1be1a591409cc0322ef233","5f4825b298feae6fe02c6e148992466631282eca89430b5d10d21f83d676c8ed"],["14568685fcf4bd4ee9e3ee194b1d810783e809f3bbf1ce955855981af50e4107","31c563e32b47d52f87ce6468dd36ad41f0882b46f7abf23d12c4c4b59f4062b8"],["357cc970c80071651bf336e06f9422b886d80e5c2e4e0294d3e023065185715c","7f3d23c2c2dd0df4b2befce956f2d2fd1f789013236e4430c74e44845522f1c0"],["14e528b1154be417b6cf078dd6712438d381a5b2c593d552ff2fd2c1207cf3cb","2d9082313f21ab975a6f7ce340ff0fce1258591c3c9c58d4308f2dc36a033713"],["107427e0d5f366ccdb33adf0282d304f8843e3e88d22b7b83780e073b7c05fed","12dbb00ded538b7478466022d2da89b83740cfb2289a272387efe1aeea401f80"],["4f162deaec2ec435dc5ac6f95d20419ed9631374770189cb90617f3e66a18dc1","12cbfb2d04ff22f55162f70164d29331ace5af18a19a9aa1946d4cc4ad2e5cdf"],["7dc52d5a7db816e9b850741ea2fd72918d94985b85a20b4dc5597853a876df6a","6f6d2bca60003ef9f24ac245cc919fb717b188723b34f901cd6cfe9bec97be04"],["1d81f74a5ba45c7022e8c140d763b9c1b0e281a5304696e74f791a3a04a94472","3f185a93d95a4347227c5bb6ddd65cf42e1830823f435f3083fe6102691d55b9"],["6f0ac78e5eb90e87958588f9d47541edf252cb1dde3d073cc45e3e7ef9365716","6628d116b7975ae5f323e5ddf4f8cc35ae06d5c5c7d8a56effc66051336d289e"],["2188ac423c67db5625915e05222a391bcaf91f05d9b7cc2cab5798b2d2e14d95","23240c559c57b79a4df69a23fc46e50504277b1fa49369ab663d79782b33c0ee"],["794241471ed9ceb009384b370cb8790fca98552ecb822dc06b19362c36353455","71e918c03cdfca7207772e8d18ee8f9d92d79a0a83f378912362bc68d311dcd0"],["163bc180c22dfc5da23c5c052107bba93a88b4360aa1d4e729611d8f5a7f8079","631107a6ba83f7458194b9766a0a54f638ca20daf800384dbae1498677501939"],["39a32a30f3eb1da0eb7e3903b8ace3da3890b24b61a3a9e79db663b5db0f7a5d","4d4c54675dc1f1c9a1af9ca0010045dc803c16af345823136dd203715d67c491"],["38085391a0e2831f59c33fcce7591515784d359925f11ff958e0e4658efac0e9","42918001a829f49b5634e34ab7fac21b30e24660669ed91955cc31944a19e62a"],["5e3573b049d6135ffbbbbd9a480617434f2455b4a591f719e91153eeb75a32a1","54bc665420c789da1105d53983c1a0fc33bcc2690cd9b37d6566e21a85892871"],["7ed068b25b82c05fdc0e46bd80a357f3acd2f5c3b9330bc8d474e5b28270f6eb","01da83a187da8ccca704d46557a462551d70df7f943a681c3b97b1db6a21b7d3"],["05ca3370e7516f6686111b72650aab4c5484407f14b515ade03951c6a14a0aa3","6f407fc537b95277966e7f0f5e64b86904bf7baee091cee6011a3611834c6903"],["624cb312b698bbd6dbca79b8d2b53cb5d8b3ab33c19306e87c18211f095ab9c3","5b3336b2751e97c793731ac9b9a2243b6229f6d0bbea6b619395d0e5200bd8a3"],["1ddf6ece608fe2901b34b7e4f47cfcb75e947e293c704d8121b11a31a051b5f9","5e2dc58e9a48a749ce5296d229cfb34f96a147a8246d2e9844d52b52112ea94e"],["396b384f3d61cfc060308fbb1c941ebc9418e2d9abd81316e08d625f48c0e101","7223e5f7b66d1ca24962bac273a7aa6618cc60cb8a64a8837e0261107e7ad644"],["53cc3dca3410277fb38d75e4ac0dde8e77a99c817170dbc9696cffe7890fbd50","2592a3aafce64d7c69f4de468d5d5aa19845f5ca08f64a0a40e37d23ececbbe1"],["34705fe600f5aed77b29d3eacdffcd45d886904156d43dc550bb7fc889cc1368","299153c141a8950ffbcc8e9352993e642fa39a476200dd4acf42e158dbe3b01e"],["5969255bd089181b991fce96b1792ba330a14f8a0b061f8118c9c336b8504618","680a805fa0ae93c2a12b193517fb1147d355547e4ab18a9d6ca21575bbb4d7a4"],["27d1d57fa8808d3d452df14bda4248b37902752163b1fd499a92456c59918ecb","0a42f1c0f4c5d7de9e82904f0b4ff63988d31fedb8aad9d8ae009c7a1dff09c3"],["0811d14bfdfdcf2144edd9cf55bce584a9ba17aec3eac8aaa82987ad703d9b8a","42bea70d46f3ee0df0ec77d24c5495ea56ada2e0415920470c4746b68306376e"],["4de090761b863cb0f0650297f154a8e66d00c5119c38e5dd05303d905d527a4a","5eef0efd105361ce198a30e09e7e7edffbe3d70189e63ca68cf6057b9772baa8"],["1d45517858ce45556aaee056ebab7e0ef3dc9ae3740aed570f3e76bfb4fc4817","0b5a9d8fe8b7ccb04c0a5ef77798a3ec6e1bc1138604eb05e83844f0d4c5c699"],["4285edbe9117f30aae1ef5ee419eb1d472106c6b3d7f3ce3701e39324b0eeafc","503aa6104a682bcf2c0a60c84f4c22b50b0caa0fed8db87dedc7173eae04bdbd"],["3ef830cbeff9b79039b1b6bd9bb52bbcfa56d008d91b9703ea1c80351f8687d6","62349ff5d8dbd216a874769eec152ef9734bea9240eed623992c7553dc8ee4c8"],["649a996e6d4d3b60ccb526939ed8929134107e03e2fd4648eaa2fa9830822c1a","1648311b942fe95d492a1ace5e5235c1aea860d036d2475cc8964cd1acedee9c"],["3a95596d97770d050d1ecc075d58a74f5fe6b4b8222740534ba22c8be73f9d56","15a80cdcc03317a830fa4a7461de6bac136993e0a797f83b405c161a34c98fd7"],["2d265d3fe1c88903ca93685209418deec5af886bf0d9fdb3f499d831cbb76ce1","08376fb0663d3aa220948612b519af4a6a1f956622b15a305fb2e60a84210b3c"],["642cb15498d8c6b25803f3e56b98e2ea185ac808cbeab5eb0a610ed5babb9385","21b5ca5020a9e5a2334c0bee15193ea16c909963ffa6e1d93df4b239abeaeb3e"],["38e576301ff6cdd0822a19c6d610d445d3967e2bada903abb6220f68c6e79bef","458fe689e31a24952d2817dda4349109c1b26ef31699fa36c4f8389eeb60eac0"],["372bec78d75011a0ef2233cd08790a7f15c1ec1e3a78cac8d6652678641780db","32e9e47cf2f48612ed3e2c2006ea0c0c8476d3562aa88cefb67ec97abdb538e8"],["1aa3756aabcc3eb65afee34e0a15dd67bfb9fb199eb131f4cc6a3ca9ec4d1c77","42333e27831add6eb49af80e17347c63c26dd684758096ee3dbdbe03a49159ae"],["38db16447d79d3590c4a36e20286beadfbae91a4eed2e5e7dd4f975ac0537dc5","1c48ccaed60ec12ce862ea71165bba7df1739845df2a857f4ef0a0f714f96daa"],["176b78984cddfddef90bae619c6a98e951d9a7ac7d6af218ae7e76b273212fb7","7b5b93eda77443f366e2a127abe12212aad8536767ec1c5861143f777db85852"],["042d154bf7b4a7bd73897ae528c6bc552ea58d74f8109e8e4052d3e9d38bb0f6","42d1831323e279f9f7ee9e3470ba20ca7edc3245eca5d8ffa182de120a71fc90"],["1f8d28dd4f286a8d0687b626b01204434bf5874a9550d6e375116490c154e108","1ce82e2360367e06f41757fd45239f9bc2c61609139446b09b55a9c43da98bb8"],["613eb914c015076e9ae8356bf508c289e50b1c87d9e2546f6e406362e248e5e5","3edbaafcd8c41ef4aa18b254137d201a2ef0ca4ca28807156bc949e920b97353"],["27bf43826bf0310b4b3e3a405eff790a1d77a8d48b04891246cff8e193cb03a9","16a24d749cc1d234fbe8af9cfd782c3aaa5869d6db0afa7b4d4c67037514f2ea"],["769a6a59746d7bead417bdd9c3b5f5ae1dbd924083ffd9e88df7714f57a675c2","22dc1267cfb2b41c590abb7dc3df45619af688d0421f2bdfb50748335ec5da25"],["795734ee4fcc24194219d25d41a2889cdb942f765848e9df63bff0b158c7224d","756420ab5c71127d39d2e79907634a177af0e483e08484ea4d7b76f7100669b5"],["644d12fc5e7fcac5aeb5911d8240971a99fc59fdd2903f46958e6896aefbcf46","173450789fcd40172e8124fea56f7aedad2ee13fa8fc5209cc8cb572175216dc"],["5deca767ef17b9e8d4f351f5c8ad1fcc50e97a2ed687516bf5210679fd6c1110","4ddf2207da12f700708089989da016f3307ce5721c9e27c952599d67898aa396"],["296dcb24cb3185d037a94bef93c97cacd09fc7050ba8472da59d4a689d9d2848","0b17dc85a4acf73833fab728f15abccac97cd09e57975bd996d3e1dd8b060f7b"],["408a3f1af2e77dfe94f8e225b40dfc146abb1002db7bcf15fde61c1a6cf1b93f","4f01ec38854c15a879e7c7924f048e2ec951dcdf04a614088b68fbcc0954e1c8"],["07d2d9234970cdc9483e0a7c5ec52c49077c440e0a993a1e624f90b8fafbbf07","6ac2190030c210ae3e07b9239f6ee7affba263866ee7831a564c511f703f2295"],["2982d553002082320aa899b9b6887e40dedf11868fa931689795d93d58452873","215e16ca447978624cad0ea6bf45aada4eca914425ee275db2a26e980dc349b6"],["1d8649515cb49e136d2895b6276569e5c711fe1a343eeb5a3daaa8d0e7b42d1a","5b21e2f2978f343a3e9ec3316cdc111af3b55f34afa5fc3fcbf6c26c1bb7fb6c"],["5460df4d607147939cdbc04dbdcbdffd37c5eafdd501b50a67213a23ee724a97","69dfc7004263ccb52487d34ab134b80bb3030273999739cb9cdc16d71b9abcd8"],["24623476f0af9f42ca15a0697ad23abeaf5ed9dc4d2b44f7e8175486598125bb","6aebe4a1a22d9e31194dcde6d33ff3af77dda15c22b2ecba9329849b8c042687"],["64e507a02bfd8a8413117bac253b17f94b2911681ebc07c92da0de6a651dd538","513ac992d72b463da110afb612fbae36590248a0507d845ee95fab2d1caa03a4"],["47f3bd11324f6bee230a22a5bb06a3ccddbc0473b810689efaeef894a654bf0e","7e05db9b3ff886bf32608dfc8d14eaa91e2e2ef230e7c75618060e4285c492be"],["4a6d22703a7045d02d656015ea2d168385d42963a739a895e4fd87b3e55c5e0f","4c58d7a8c6ded0451798e51f16ffa5b637a87aa5defb119ba868d8cccf61776d"],["3e22af70a548097244d7798964598172a90391f84c59b04cea7af283ba368eb5","689d8b7cda23b8dea197c5119fbbbd81dd4b59a36cc283dbe292b5b6519a2968"],["61a6ba2ca42d9d557b3a2ff0867c1b8bb8fc40192d31ff637431a302bc065a10","63d805f5a79f845ea2915a25cf0a8cab2e0255212a1bd3c8852b25579b63721d"],["03d963eeae48556e88305f91c478efcfd2168c346b9ba185884ec8621e8cb414","74b75cc839a944ad8c639719d20fd9d48d2099ef24c8633eabec7a9ec1e7e183"],["0f04da69e0202f7b44c58b103c88de09a0599951fedb17e7f2152d6b93a58ae9","1fbc1c9cd03c4cfd46e8e90019debf86e8036587eade038346f91070c800b8c4"],["797899e488353ed0c6666aff11913b33be0190833766e809b2a68cbc671a9cfe","5dd70a33ff94a84b3fe660f7070e6179e86b5c846689265bf985ce424b8909cc"],["735b64bb872606510e4e7d57833eb7ffdc4aa0dbaa242439806be68379f77cdd","384aaaee3ca7ba2436fcb65910859ca5ec30c10af11df7d777d287bc1a2bce2c"],["6f6ea532a62cf4766f55a0a72a86b55e73fe9d3328ee94bfc271e122f99dc1ac","61d8203ef6da5d0b584541c02331c7f58617cf8d4f26d11776236ce8b113ac10"],["5d99a2a3d4aed730b827b68ed836a9910dce4e7b93faf456981ad6cd85748773","7eeacf5680fb6108a8b7edb45f7134644111b08e17c236469685af5a79474b9e"],["31d0b4bb57bd7b69363c064a49bf3c3b9d7635bcc287e7b3059d3d99fd8382e8","1592e581034e13d47d02b8966f5359097e652391be8fb1e803f4219a22aba2c0"],["424cf5c498bbbe8fa7e5c3247049cc3f45946d0e5f38c44a36a6c84b60a84aa0","34acd712d334a2315dc8fd00c5c9b7c5c9f29bca27380a018882a5ab4a0fcb43"],["33a6ae0522936ba774837aa7959972f9804e3ef02ae84c8039be6595598be247","37022798cc08be9b4ded34c1c5062ab3a26081d375cadf517972fb48135a6602"],["5939635b72aeba595b5f6e376d11a3e07d4b1153ab4d0a7ab267b8bcc47cc3cb","382162eb33db2322cbe01a38fa4d13720b6d8edfaf8116a628725ef4293a6c27"],["3649e78d2ae9fb0ee86b691c27386efce4f3e383790e3cfee2bd59c2e85c4036","09b0d9e0dd82e697b9be9d61ce0d1410e281122b483125c48f7942b22f5d5be4"],["62c7585d1677b7619d8200175346ec99118416d8fdf0103730d165934e96a973","5fef7955ee07304429995433a468d68dec4ecf6b08bbe8cd06869080094044de"],["0c94537d311e17f5b0c58989b5be7e40c88b978a8c074a1e9bb07a713f77f6d3","6deaaa5001bcbbbe9ae436fe42f7042ce74fbf83c14058427fad4587ed33c4e2"],["6f5c6894a8d3877312e608c11809c15dffec3df551711095c8cfc810533e1b3e","74eadab9389b40d6ac6cc0d6e333d628ced60a9ef7617751c20630d23477af7b"],["4e16e88e171f9a07e11f97bba65c0fe5483501f255343afb3335ed47fbcee08f","41bcd7dd328871247cb7995bc6bd2e1961e94b0fb12e5fb2f264f9ad2cf47d4c"],["65d8484cef146e6c232fb262c2ac8200a52c63ccec26ff6f038aa5c74982c741","67283346bbae9391952b141e57ca8e3a36f0363d3b81b1c0f2b3c30a92c74235"],["1c588485b64be8cb99bf97f065e75a82138ea2e035ba90b63745354e9cf729f8","7c9a18d6ebf5465a197989cfb9b5b2a66a5402f46c4708ac04187c6b157a0d77"],["2c80c4ad0aebcafab7e9d2519a329f8a1c7df21cb6b1acec7403c0204d6dce71","7f8e62983160756e35356df95d44467e621c7274372997ca74a9fb760b4db36f"],["1e1e5fc87fa2c49e2c44d5718e3d73c73a91a64ac1374652080bd9004291b9c6","153828e90ed8d94c0f86e0eb54ccb31073cd29ed62c34cd9f2dbc5d98872e597"],["0ce0488a30ed446d445efb1bd21ba32ec3d05d538e6393bc0e58e0849ad57129","7278074ac66ac779136f4d6a334b27633645dea0fc98d137e3dbd4015d12b5a1"],["01a6b81f7285f293f19ba019b009aed8280ce285af42fab91e87fb0bbfa6dea4","60f910dc7c9a82e7836f36acfe7ec26b9babfa8bf26b2945b3c1a43b0c19b4dc"],["79b4ce3c6990023859646690c9ea800174902acfa1aad7ff34eca032dbde7150","53a1053d3fc6c749bf8a928854f392d09fa851ba963ca661bffbe74f012ba45b"],["220ee355b5c39c1901ed34c0f50f7778ad1bedcd7259ae167c16514ffe333498","05fd9374986e1e06035dbfada0117035b96b159354262f2b2695af1256d6aa2a"],["1e2f97d2cb4a19ca40403b364253da71f65d2d4665894267e3c6a9db8b4a3a18","22804fb035acb519210ff99ed7a974a725d896a77933789b4dd45a37dea3466d"],["35b8699fa20987876ac3b3086965b05f8cc809d71cab45e017c68ac96e24ed5b","155079de21981778dc438353bf2c6a65967a1a33ebb74c866fb42f4e3cce3e39"],["3cb40c55f5f19c52958e8c4ecd9c459b1d3268b3971b2286d3e58d1fc6b6a6bd","379e1f1f59df05c74485615b87441ba6203f0cdddc6873a883d4cc6dd1b75921"],["6ad916290e0d003ce5c961679f77704dcd768589d7cb728c60f56852031803bf","1e602b4a6725832a56944234f84c4f85f79911b55beef903549089925f2ccbea"],["7c0162492ae668160aa56a60e8bd43ec088555f750d2223cc37362dead5de123","34e60b446eae100d4c3abc6cb02e4ca559457fb5a9030a290a2568fa4cbf118f"],["354c25bf7b3e83dd0c5e1f39b82e3567edeb5337634056c1091cd6a016caacdf","7abb271ef121630f85a9a1049b3ad78d5b889f533b37a713b8801de46770fc3a"],["1e581a4bcf7504f33f4342b2097504d13f9b5a27f4790a6cdde1242209862850","2164d56564360fd2b5dba2f2c6ef1045ab448c3b60b2f2196c2f74625fc39e07"],["533b56f18283ee79b9a180b887c298961bd9aaa6fa3ef97fcb0d5688e694bc3d","6011366753812df2bce83634a92dbac18dd1cffdbf9a97fa1b1d5b49e0026764"],["4b508b94e6e2e6cd260a20664ea7d727ad20587b63ebe826032e0d20cdc6627b","1e8ecd6ff5aabae78172a0214d07a5013992d133af58afa74049de726df2a6c4"],["3398c0c0219f5ac87a8c73fcd17b89311d120a53f5231cb761030c194fed4265","025b234a1dc8662c068c4ba903939c2f79f3f7a3ae64e5edbf667b13599142d9"],["5941a17b04cd3465031cb6745cb94eed24e1ff8d38a6e832f1637ae8e89c78e6","5309792c546b6cda458be331957763b5adb5d535d54a4a61023678faa2ee02ee"],["2cb490d2c0047fcbaffe1df26640bee73c158af6fec91343d606ce9d124a20c9","2e2952ebf089200aebfa3947f241e2fe85797afebdc1ea06d9d26de1b446a964"],["79305236b583232a91c63c7d9ca3750be7ee21711e4d6d257c39ae398212bde1","6f9ecdfa953e302c2014fd8512405e4be0d48302acd15e93936e8dba7d01053b"],["57d9fcb884b94664f35387fa6665cd9bc8136f90d804d77416ea99c3c653ee63","14197e65f0a3599c0b9fcef75b5fbb93580d1b2457b59fb70ce7b9bac88d0fbc"],["6d99df2c28c9fa1e38acddefd3e0931109143d873f3330377a9926bdacdd6523","2f21987905f397f092fc56c5ccd301a1e6afa3c4611627e25017b2e68d07c150"],["749d19591f1755bd481fa12a288166aac42911654c8c551395b265116269ceb9","7ec145aa7558d0342cd87b1750933cb6f3717e727a86a1cc1f2b0c274213688d"],["340f7f5ae19292957902635a5786d14fa38036b324ae759da501e32b8c4073f1","64e231a413f1379a26f4e8223ff91fe2ccd865549571d3c6c28871964b40a0ea"],["4aa33e00bf6e92cac4e84384e5dde0727394233afd5d24d357a8afeb94b08109","3385bb4fbc441937ee01b671d506227a654fd6c1c532cf5221710c6c56ec7e21"],["34b2ffca05f01088de266306c5cc122661e9308eab16929774e58565afc0e4eb","7662faf0f70e82c062c2b835fc6da3353d3cb20b80611ffa6ef2982cf62fa605"],["820fcb51326f1536ddb8dc1052aa198406c7e48f2c81e7664d15f8f9d3715e","756574c23bb01170b97d9fa1663a8ff2f5b97eaa5cd53f34140c1bcec8c262d9"],["0861d7e84cec6d6e33641ff6c85202fc0e9160797809ddc2193802499caf05d3","34936e0a5dc7e2a6217d475fbb8c1c607fb8b3565908a04fd5948abdd399c59f"],["5b4a1dc887ef684d7b4b165b70acb70842a2fa105935af15ecb4a097e33b8f2b","54d21511c05805e5298a72372b8289e9d59c46dc8b5c368bbfda620b68aa652c"],["755493ed60b13f03f9c019362a5af73fb49842dd6916e2572b1b6a312cd20cfc","0750bcbf7e449cec422b93ace1489e1b177d4dbbaa781d315c74d54bb444e9a9"],["5f1c341065b6a81ed2edb6bc38ba81b4c2e3fe2058e5baa13e1406eb2c5b4b4b","6179ebfa7f8086f26820fc99ca2f94c1be19bca672d79cea5b02a836119e06ba"],["1915024ee86acfba3f61ced9707521197195166fb1c4639bf3b3fcf0bf0ded46","5f2e0547032221d2b00937cf524590e3d90901ef0286ea0b032c1a81461b6d92"],["4e942d95930f38c8786ff4a8e576e7a29fb7627afe1fff91cda5006ba0624f5d","45902f695d512d70ce4c1e0520c0060896b94e14d2960b2fcf2ed5e138e0217b"],["63e45f3d91ab915d412bbaa17d1d249e1a1445077fbfaa6be7d35041c5116a91","46dad5a4ec2ad0b86938f5e09f1c03b53b660fc5137648b08527cd20708003da"],["5e2ddd2175417f72c9962c503ac5adf94ed11f28b9d41fccb6a4512886f3cc87","3523b218478911145af1dc431feb7db0a04066eb6e2ade3c7b67d11bc55323aa"],["62ff30a6b179a26e7247a8312cb3af3289e5d722f76a29f203aa623889aa05ec","562beb7999019346beaa80dfd5b95d614e1ff96c1cb1037f65c44997b797d066"],["14988b5d62084fb8335c2f261cdeddc1b634b09cedfce713ff5f0a0bb588a556","447068731fb98e821b8e413b3b48f2d1c8bea308f05aac877006b0f4c3b0cab3"],["1ac777f708a5942cc434236920e82ccc6af920c0a0676712255aa7082b37a5b6","52a6f88d92af1887c781501c6e3a88169a2831b74aefd416f22b47e8335ce317"],["5959792833b71bd5042b78e42212af671f5f87a08eafd8cdde2dcec8140e4bb3","41ce94633eabb8a1b08fac66f762997ed8c9e2af3558e1f6586ad6a5bf5b7b64"],["4464a7962e6722b457336fe98c91765b1ff178f9e892e90129e65fa7688a0607","3d1510b92fd33c501f058a7a86bddedf1b83f9b6e4f04829d321117013f891fe"],["62906d81e7f800e662519f4324ab4c8aac197661c729eed3e744d09efe721c08","4b68efb5b1b709ab86e3253d70bee87ba07875c04a64ecf7e35cd8cdc6c0f7d8"],["4300ff025ac78ef36e58ee7d0d732cf76cd0929fe265b3a093a57f23fc326757","2f92880570846ff2e90d91f16bce3705c9c3ca8011cc543091463b623e4b3c01"],["5427ba28d94652527a9b0c76f57a451e46bdc06cbc8a2481df17f66ffb1524e3","547a97c4afc8d1f74a5d51f7e524f68472f589cc0b396b21368628721537d722"],["424c4493810bfd5e3ffa21776326d8ff62bf8fe74504d7a2db5d3f74e5ce1015","74d0daa832d40405d01551a58b330ffc5abd5356230d6d7cabeb5b1a55046f32"],["54e10980d81b4ae8778896684295fa5c5475e8d68ec2a26e1b0a65383507b3cd","6b1eb48da6886c4d88cea720e9dc8b0d8c51a8f0e1943afa31a40eeb553c0676"],["732eb9e9ebb556e9f024c5574166738f4707b0fd005f568212ab575c1db71ddb","1fc6b00c89e48114d6b13d9920a0c78093994f2b08df147bdbb56bead2cea165"],["74029c04b34b7f314855fee42a04d0ddfdeb92ef3bf7cff629928a97733d96fb","501f63a252dfbc090733b5a208bfe08f81c91419ce3d2d6c0de8cdc5a5625014"],["04524402ebb71a60bf1055001000203a6d4917f112e50dd766cdd7b718a6edd7","71c9e2d15cdc47c565a696ffbe55277570930ed7ade13b9a254059365d5bf338"],["2555c620a50f2bbeeacac66228a96941fa733aa6070855331613578ed7c12794","2b3c1bc5cda7f93242561dbf7572237ac43bf013553230633a5e18b7e71597e5"],["555ea607b0ad18afaf70d7450543d7ffb5b883a3cad3e2778826ca97bf3211a6","6df903158f51aa530d411720a760f8ad0ce9904d54955fda74a349be58eddf5f"],["4db3cfa284207a250a9c83e1fec07e804d70065da586ff2c2a7d2bcb92e6fca6","2a4fbf1c51dc0b2a7783db2be3bd35c2d6462470c88c8b73ae3ce8503fa07154"],["5174e33ffdf28a87184a4d6427d821cbaa3b88ac293a90ca7e1eeae8c5050b16","315ca6bc8e35e4a3d06f89e1db1575b16197963ee8e64746fa998ccd403561cc"]]},"doubles":{"step":4,"points":[["23a4860627e53aeeb8e22b1508249c9109578d33e7bf237459b2596d6c28f9f8","709696f2827fc3729f980f2e3aad6e78b06a11ff8e079c27d87aab37c16727eb"],["5e7e07ed4e1decbfe6e9cbc126905449d4b578fbb561576d20b8bcdd0cc2a556","0f55755c51f102796bf5ebaa81d3260e7d1b3d9ac127d9a80e142031566cf6c7"],["7d13c0248b891b47eb524f2692008e2f97b199bac426cb5902b9003a29ded6ea","59a976ab2c01a81a91f1a56c75ccc77a9e1e9e878e9fe9c3952080a6805b20d5"],["5de7faa2ee4e70132f541f79ca07cd54a39fe1347a6844d19e9d678a8411a565","2c9f23641e1c2e0aab8ea9926b432d92c0e8bc08901d6ff6df85e4cef854ec36"],["06b349eebfed4dad4a805b63a6ed2231a565cda752d9477ff427dd9a8c9ab5ed","07a09289ff3e1f9aab68aa374c48df65f550c2323607b97744dee990608b64f8"],["0af367956af630266b1cc760154256ed79da960dddca9d72a1e8cf27d8d43a77","21108d900134d3b3708dd28ace96b0b23dda9100e4b6a62a8131bd2f2ba408c5"],["1e45a60140a3b2dee9b8dc6ff307154a1b410bcd38e0e38fb10b2f6da1afbe2b","0e730da473dffd60d2f3241a85e68acb47d26e5043ad047d893f072c8dda0a76"],["4d1e116d136158c5ddabd4276832800f2c081c1072de6f2d931797a46abc0cbb","6d415be49d4e35b65cc51354b5008f8c43e84b7b5e8a4b84f44e1efb10c9b91a"],["2b6b892ae94b454b2c2d92bb947fc4d506d173d281779c2c153c001ded42d3d0","7f1cf64e0e180fc4d6e12c1b5c5285f376e979616a52c94a0dea4d48c5880cd2"],["0f6c3a96e0032a9394337a02ffb2c83ba70efb8f566feab530fc90fa3b4710e5","3d4e97e286378675038a4b58e84224ee515e1d6697ac79389f78479be167635a"],["52ee53b981dfbc41ddaa5ddc2754c4175f4811aa45f8e2b19a425657c238a83e","7eb0a1be3400dec87b388cad51613957643cdf0595b891cc6f925fb36da7f1c3"],["52a837bc7a7bc9459bcc2ecf80f74d9ed99def0342e18cfbe8e799fbc504fd52","50d6460185d8924e5485f23f36a98c86053514d163547adab6fe91478a411196"],["6b2bd5d00fab38ceca21a27d6aaec82626b14b555d859527718f8ca404eba4","727340c27a15f6ab3d80547f0827c56ab1ba33bc30d1ef3909ea9a3af10c67e5"],["71dd75fe35761c01a48597ec730bc33237902fd4ad8612cbed1031eebdf40de4","39674a4532078e34378667beae5cb55f814ead9bbaf7e01b3b69533e9f88a411"],["57426aefc21be9ccf162e23d25ac3002ba8534351e65613f870f690f2fd46cf5","6b45b002fb4e8a6f59a6ffb006ed71f75434217333b266325204c7d1ac2e1f34"],["6222bd88bf2df9d5d44b60cfb4a08a960078db7ed51a35eb3e0b6b8ff4eda202","0325bb42ea4ed025dd6bdaed261b7c4f5410b608ba902b068f1efa5782e45313"],["71ac99647b61b9eca6f0c23432a518f738aee708d5932d4ef0f172240250a226","3a96c2c028ebe5f48913be30147e41bc5e1cab9595d5404138a9aa1b5574cf25"],["1f6a1fd8cc0e05b2742ba0fc0369b5247670543637dd033e64dbce90b2f23e9f","779964401ee869a9b31c0ef874a86440ba85d25c2ce932bd31a0865869605e19"],["22e2c039067920c42980dcb3a905fc91601c2b34e819ce1532ada4a5fc39d5cc","631cf9945a09bf26d7e595b3f8e3390696870512820df63c5418577089e1a8bb"],["608de273a9f6a534219d7aaede3cf65a81e4dc03d7a2765eced1d2b7be4610f4","3b31d0113f98d81ab1312fb2837aa9c8dcc7960f84eb371358c6d841f67144fa"],["3f748617ca63ab3e44c6e34f63e7328ea56a2a146da34368a57dca181254fe02","0fed89e6420fc47b3938a2891ba9acee4cbb2899ee4e9ca15a13dc527dc1641e"],["69d98b5ecc35d56c97c0bf312955d199befe116b417d70f5f57e2dfd0af81ce5","3e26d487fbfe36ab44e0ca3b248fe94bce92a69b8154d50e2d5481f8259f4e8e"],["1e34443347f9e627b3531157faab6eaca1bc3114df4a1423cc12bf8417b5d622","295955a5ed061eca7f87b9485666ba9489ec20a9c484224dc920350bb4a6fc79"],["51f4ff8c599b1c96da82941520a9f5abf4a31eb8b84fc95056145ceb3b5775d0","35ac9588d46e41f3f6f99aee3852eeb4b12e807807d4bd1b7f8406b0d7863ac1"],["3faa2a093a19a02424f65a10955101f4dc015c43b2dfce8e001507abd741b845","7a1de10dacfda389ca663b15574bdc8ae8c5b6e7cee647e77b11ddbfc6eb8edc"],["1924416956ea2c1269062588569b18178011ea7cba1a3266284f48aa01d5a90f","0c8e28127b7dcdd206fb6fee96eb88cfc7db7319826ac8cdb8b1fb8adaf021de"],["49761c57ce3c8c4f1435d495903e2f536f3be3712e76af8d0b5a8b7d1ebc8fac","3225035e1065094ef32d7f3e7a6f8ff2748025f96e0c0b44eb35576b61e150a8"],["4339fa86a23242851a16afc3ab05b352a7b4bf53599a49dd7e29d364fc3a757b","6d07cc3462bae9160bbebb997510817040767faa9dbd13f158a5fe8a63a34b0e"],["6bda13918dcbaf8529d6326ae7a9c278b72417c2188c5ea4f062fc50639295fb","2c3fa803b162ee887d0d97a6734866f992f846625f314117075da54bb6c20a36"],["4da4821314574d4fed4dcf692c8b15b99b73f13633210333ce7871359b6e6424","314016034673d2d20529bc93a2dab6e462bcb5f66e1f4a6bf2170759a40a6e65"],["0b2cea0029ee963c0034b61bf19e384435f14554a7d297b5144838c38e375586","47ea95da28d39aaade5edb8ed941c687603cfdd1508776e96d6683199e99daea"],["4c27afff3c45f32c952d3984e14e29a098e685c9c2e723e5fc8047ae60b7e824","5f2c99e6526dc87d95f11eb626c29c3a90d0be1e51a4c49e5bbabd114bf5a66b"],["53e2a4ed1bbb48bd016c524a02f797654cfc969849f867681da94e341f377534","5a2334fdda642732a3c9520ce06581aa7f0f082882554c37b8d390a25a9bd559"],["7b8d2c823baafe0d878a55e8af1db150dec85b1424a4901f9beffd3a6196e3d6","1c45a557b3624f9b89ed15b3c3e1a065f1b453d948f7cf45d9494483f8af0c85"],["78877b5d8777410997dacaeea59400fc9db4421fac02c4282301c67d35fb7ffe","0341b46c328333e4484ce8607619014d41775c408c88856d2f9e19812d90fbf5"],["2b556bbc070b5c4bae9e575836d1d68ee9fbe800448c0d2c233f78185eed3f91","7ba01332807ebd892e00ddb368c0fa1b3f19b5b32efd90b178d984e1d7174d6f"],["0f72556998b0044799f0fd03210ded3d984e3843bbaf3c1d5d692bc94d43c4e7","16c19c5037c103d447caef4efe6bd81a490e7c668f6870f1b080863b5315df5e"],["1cd96ef237b213cd446f13b3ec40d32ecc593bc6ea71e77efc284341a5f3da1a","7a626aeb91efcb5f9777264f5e17ced8b411f68c713673ef0f184a5ccd60dbe3"],["31a75b21cb532622a7caf9e29e652ac4e47b1450edf6655acaf3797b55a7ca46","77006e7cf104982f8865081a2ff8a6911546755e31c3586353b0bd0826c5d790"],["543d84cb04fb2bf787b7aa382eaab5cd8d050ad8ee52aa8a285b945652014031","0358fdc5b63ed49e693d838f182b275846f42dd49a42ec2e6e932ba4de59ef20"],["0a2818f5f5d8937800c30ac6b847db2cdef655b864126302249144a5a15b205a","187c76a49af10851bb049ba97c0fbbb14b2621522a4e8d9670ea46e56c9a1bd6"],["7efb45d3a2851109d7a8d50ddb08fe308bbf674c019b965cdad4570a141e648a","0fe1198b11a1bf56867091c69d71f8b7792257dda321d43652e818acd0c28cda"],["472e960dd122a534f52377235350549df4a1dd7a08cfc580bff5fb4b0a70aa7b","10585d04fc529fef4c0c0776154fc7ebbaedbae8a99937e47598d0578932b7cc"],["04892cfff7f94ff7f07c1241e3ac4945bc46ea9d6a3c1c3adbce109a9afceb6a","3ae2aa25e2555135a7a3251c11a3f8eebe81758bc1c3e2cbc6e6ca461a543130"],["2401d311a3abfd2583f1c6aa519c1f18ff730a0abf730ddcc9c9739b04d8a85e","653224f3488cae1ae19a414a9932035a2bf2c46803b5532bbb645e62387ee34d"],["0ea2c846a535a115972161612a192588d92d68a3c9050eae91b2817b94e68325","3b82a8337b05f11bbac176a113be183a50a0331f3d3116f24b971b5a8b0d031b"],["0fb3f87c2c6c89c65b74299b77f3736546a8b9e41b19197476bff27354e1c128","1034d42c15a2bfe3e682fad49dbc2812caadf0c584bc30b51625b85d74e9d5f7"],["1bc7af1e38185e7c2d8d04371c7e177d7a9ddee1b81d7d26db7ad644c7dad28d","61d909d855661f2f7a5eef87795dc0491d027e12631b270fcaf2f65900314833"],["469d0960dbd0ef9c91c4597ccf7c209549b187ff63bd378b7dac577198d74a4d","0b5f21c7f86832241f2157c288bdc9394f83f8d57457f6d9f6b345e4909478cb"],["5e9ac4ab2f4a3c3526e1317f913d69e3826fe862efd0c80d9310319170c5cbeb","505f00fa8aee03ccbd2f33529ae1e4e4bcf2644fe673d0b0290ec32be5b51bab"],["11cd80e1fdcbc565efed81d17f3f54643ffeed1cff38f3825e115adbd82759f1","43f11943f7ef3fa68b980fee45e98134f1df22263b2d14419d61ffe62822dbe0"],["3328bc121616a9477165ed282053d203c24f4826076c638a2c6723d42c9bfadb","2bbf3f26c21b5cb273e5f4f0114c6718c5eb7291939b7697c74333cdfafac039"],["0ba774bb605dd804cae6887e81f6bd2c59e024fac8bf5f5c48a841a037c28398","54ba013ad2d04dcdfb5a151b7347ee9a10067ddd0a3907e9bc337a77bf911321"],["1074ff0267662dc2b4ce65aaa0229c375a3d0d843ce9349233949581c869b64c","299be0decb680ec28923da4d049770107d42c180b460da13a7b1efc7e6d5b022"],["25ed76d78c87c3bd64b4331902c5a853734283e25f19f320295667b80a340d35","179b5f92f545c7b326b3a63fb0b32a0f52b4159988436d5af50c1d0d76373947"],["75d942c04210dcde5d1bd4fabfc732d3f95568e399382c0423c83c41cb05dc3f","696cc14856cdc13c8fd7e2c5771731cbf38e3fad47a424679765c4874e35ab2d"],["5d9324f56975477d5945599eeeccec67708c996cd3f3f2818bf2591507e3502a","10985a3cfd573205281aec24e2c8b41f5cd8cdfc9d7be34675cf306bbe1b4f6a"],["7511066c0e12105a7b937c7ecef367d5afe6e621e5cabf4e490b09b7ada7ee07","604df365b8391cbca8848f88daa700b770da5bb136f70bfb0a3ea33ba386fcd5"],["2596e5b3cf5494e60d2a750d03c66abc2e0183af53620b893f9cf9fc3b76dc26","68a0a7ac9a0cc093884a6b84f45a2cde595194e0f48dbd566fa78a3174b182fe"],["28bd38d44030dd9ca028b2a2f31a795f4c7a5e85a785df7847e3d525e99d4787","552dd7405c4183733ad3c4e7ccb999b4fed81b7a4444aab499d41d6d78d5bbfc"],["59233a3346f61135f431f96cf0197e24ad38240b222c010a6ce538cf4c24347b","3cce55908611d2b93f221613f09cfc4dbcd2e2b609233eea5439ad1908a10b20"],["5830f025f1078d408948f73096af97de1e9e70b3be85890acb21132c34ff961f","67d451752c2433ffe66e47242e301e56db2b2f8203553cab9de717e25793d41e"],["6a0c8b194571e874b82d904da36d43096bbe36d512e24ff8dcb2b00b57ffd3ec","5f85adb7749cc735ec838bcccfe7d4b52902c6132998d7ac8e032cad031c42b8"],["53b3f967bff8760948dec5e9282f35d1434a5503790b9012e17faefbe7c4d699","404462283c8664a17daa5b4059dcd10e2699fd86d0140de9f3e8ad0566098ae5"]]}}')},function(t,e,r){"use strict";
/*!
 * chacha20.js - chacha20 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(68)},function(t,e,r){"use strict";(function(e){
/*!
 * keccak.js - Keccak/SHA3 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on emn178/js-sha3:
 *   Copyright (c) 2015-2017, Chen, Yi-Cyuan (MIT License).
 *   https://github.com/emn178/js-sha3
 *
 * Parts of this software are based on rhash/RHash:
 *   Copyright (c) 2005-2014, Aleksey Kravchenko
 *   https://github.com/rhash/RHash
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/SHA-3
 *   https://keccak.team/specifications.html
 *   https://csrc.nist.gov/projects/hash-functions/sha-3-project/sha-3-standardization
 *   http://dx.doi.org/10.6028/NIST.FIPS.202
 *   https://github.com/rhash/RHash/blob/master/librhash/sha3.c
 *   https://github.com/emn178/js-sha3/blob/master/src/sha3.js
 */
const i=r(1),n=r(3),s=new Uint32Array([1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648]);class o{constructor(){this.state=new Uint32Array(50),this.block=e.alloc(200),this.bs=136,this.pos=2147483648}init(t){null==t&&(t=256),i(t>>>0===t),i(t>=128),i(t<=512);const e=1600-2*t;return i(e>=0&&0==(63&e)),this.bs=e>>>3,this.pos=0,this}update(t){i(e.isBuffer(t)),i(!(2147483648&this.pos),"Context is not initialized.");let r=t.length,n=this.pos,s=0;if(this.pos=(this.pos+r)%this.bs,n>0){let e=this.bs-n;if(e>r&&(e=r),t.copy(this.block,n,s,s+e),n+=e,r-=e,s+=e,n<this.bs)return this;this._transform(this.block,0)}for(;r>=this.bs;)this._transform(t,s),s+=this.bs,r-=this.bs;return r>0&&t.copy(this.block,0,s,s+r),this}final(t,r){null==t&&(t=1),null!=r&&0!==r||(r=100-(this.bs>>>1)),i((255&t)===t),i(r>>>0===r),i(!(2147483648&this.pos),"Context is not initialized."),this.block.fill(0,this.pos,this.bs),this.block[this.pos]|=t,this.block[this.bs-1]|=128,this._transform(this.block,0),this.pos=2147483648,i(r<=this.bs);const n=e.alloc(r);for(let t=0;t<r;t++)n[t]=this.state[t>>>2]>>>8*(3&t);for(let t=0;t<50;t++)this.state[t]=0;for(let t=0;t<this.bs;t++)this.block[t]=0;return n}_transform(t,e){const r=this.bs>>>2,i=this.state;for(let n=0;n<r;n++)i[n]^=f(t,e+4*n);for(let t=0;t<48;t+=2){const e=i[0]^i[10]^i[20]^i[30]^i[40],r=i[1]^i[11]^i[21]^i[31]^i[41],n=i[2]^i[12]^i[22]^i[32]^i[42],o=i[3]^i[13]^i[23]^i[33]^i[43],f=i[4]^i[14]^i[24]^i[34]^i[44],a=i[5]^i[15]^i[25]^i[35]^i[45],c=i[6]^i[16]^i[26]^i[36]^i[46],h=i[7]^i[17]^i[27]^i[37]^i[47],u=i[8]^i[18]^i[28]^i[38]^i[48],d=i[9]^i[19]^i[29]^i[39]^i[49],l=u^(n<<1|o>>>31),b=d^(o<<1|n>>>31),p=e^(f<<1|a>>>31),m=r^(a<<1|f>>>31),g=n^(c<<1|h>>>31),w=o^(h<<1|c>>>31),y=f^(u<<1|d>>>31),v=a^(d<<1|u>>>31),S=c^(e<<1|r>>>31),E=h^(r<<1|e>>>31);i[0]^=l,i[1]^=b,i[10]^=l,i[11]^=b,i[20]^=l,i[21]^=b,i[30]^=l,i[31]^=b,i[40]^=l,i[41]^=b,i[2]^=p,i[3]^=m,i[12]^=p,i[13]^=m,i[22]^=p,i[23]^=m,i[32]^=p,i[33]^=m,i[42]^=p,i[43]^=m,i[4]^=g,i[5]^=w,i[14]^=g,i[15]^=w,i[24]^=g,i[25]^=w,i[34]^=g,i[35]^=w,i[44]^=g,i[45]^=w,i[6]^=y,i[7]^=v,i[16]^=y,i[17]^=v,i[26]^=y,i[27]^=v,i[36]^=y,i[37]^=v,i[46]^=y,i[47]^=v,i[8]^=S,i[9]^=E,i[18]^=S,i[19]^=E,i[28]^=S,i[29]^=E,i[38]^=S,i[39]^=E,i[48]^=S,i[49]^=E;const M=i[0],A=i[1],I=i[11]<<4|i[10]>>>28,_=i[10]<<4|i[11]>>>28,x=i[20]<<3|i[21]>>>29,B=i[21]<<3|i[20]>>>29,k=i[31]<<9|i[30]>>>23,z=i[30]<<9|i[31]>>>23,q=i[40]<<18|i[41]>>>14,N=i[41]<<18|i[40]>>>14,P=i[2]<<1|i[3]>>>31,R=i[3]<<1|i[2]>>>31,O=i[13]<<12|i[12]>>>20,U=i[12]<<12|i[13]>>>20,C=i[22]<<10|i[23]>>>22,T=i[23]<<10|i[22]>>>22,D=i[33]<<13|i[32]>>>19,L=i[32]<<13|i[33]>>>19,K=i[42]<<2|i[43]>>>30,H=i[43]<<2|i[42]>>>30,j=i[5]<<30|i[4]>>>2,F=i[4]<<30|i[5]>>>2,Z=i[14]<<6|i[15]>>>26,V=i[15]<<6|i[14]>>>26,G=i[25]<<11|i[24]>>>21,J=i[24]<<11|i[25]>>>21,Y=i[34]<<15|i[35]>>>17,X=i[35]<<15|i[34]>>>17,W=i[45]<<29|i[44]>>>3,$=i[44]<<29|i[45]>>>3,Q=i[6]<<28|i[7]>>>4,tt=i[7]<<28|i[6]>>>4,et=i[17]<<23|i[16]>>>9,rt=i[16]<<23|i[17]>>>9,it=i[26]<<25|i[27]>>>7,nt=i[27]<<25|i[26]>>>7,st=i[36]<<21|i[37]>>>11,ot=i[37]<<21|i[36]>>>11,ft=i[47]<<24|i[46]>>>8,at=i[46]<<24|i[47]>>>8,ct=i[8]<<27|i[9]>>>5,ht=i[9]<<27|i[8]>>>5,ut=i[18]<<20|i[19]>>>12,dt=i[19]<<20|i[18]>>>12,lt=i[29]<<7|i[28]>>>25,bt=i[28]<<7|i[29]>>>25,pt=i[38]<<8|i[39]>>>24,mt=i[39]<<8|i[38]>>>24,gt=i[48]<<14|i[49]>>>18,wt=i[49]<<14|i[48]>>>18;i[0]=M^~O&G,i[1]=A^~U&J,i[10]=Q^~ut&x,i[11]=tt^~dt&B,i[20]=P^~Z&it,i[21]=R^~V&nt,i[30]=ct^~I&C,i[31]=ht^~_&T,i[40]=j^~et&lt,i[41]=F^~rt&bt,i[2]=O^~G&st,i[3]=U^~J&ot,i[12]=ut^~x&D,i[13]=dt^~B&L,i[22]=Z^~it&pt,i[23]=V^~nt&mt,i[32]=I^~C&Y,i[33]=_^~T&X,i[42]=et^~lt&k,i[43]=rt^~bt&z,i[4]=G^~st&gt,i[5]=J^~ot&wt,i[14]=x^~D&W,i[15]=B^~L&$,i[24]=it^~pt&q,i[25]=nt^~mt&N,i[34]=C^~Y&ft,i[35]=T^~X&at,i[44]=lt^~k&K,i[45]=bt^~z&H,i[6]=st^~gt&M,i[7]=ot^~wt&A,i[16]=D^~W&Q,i[17]=L^~$&tt,i[26]=pt^~q&P,i[27]=mt^~N&R,i[36]=Y^~ft&ct,i[37]=X^~at&ht,i[46]=k^~K&j,i[47]=z^~H&F,i[8]=gt^~M&O,i[9]=wt^~A&U,i[18]=W^~Q&ut,i[19]=$^~tt&dt,i[28]=q^~P&Z,i[29]=N^~R&V,i[38]=ft^~ct&I,i[39]=at^~ht&_,i[48]=K^~j&et,i[49]=H^~F&rt,i[0]^=s[t+0],i[1]^=s[t+1]}}static hash(){return new o}static hmac(t,e,r){null==t&&(t=256),i(t>>>0===t);const s=1600-2*t;return i(s>=0&&0==(63&s)),new n(o,s>>>3,[t],[e,r])}static digest(t,e,r,i){return o.ctx.init(e).update(t).final(r,i)}static root(t,r,n,s,f){return null==n&&(n=256),null==f&&(f=0),0===f&&(f=n>>>3),i(n>>>0===n),i(0==(7&n)),i(f>>>0===f),i(e.isBuffer(t)&&t.length===f),i(e.isBuffer(r)&&r.length===f),o.ctx.init(n).update(t).update(r).final(s,f)}static multi(t,e,r,i,n,s){const{ctx:f}=o;return f.init(i),f.update(t),f.update(e),r&&f.update(r),f.final(n,s)}static mac(t,e,r,i,n){return o.hmac(r,i,n).init(e).update(t).final()}}function f(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]}o.native=0,o.id="KECCAK256",o.size=32,o.bits=256,o.blockSize=136,o.zero=e.alloc(32,0),o.ctx=new o,t.exports=o}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * dsa.js - DSA for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(209)},function(t,e,r){"use strict";
/*!
 * primes.js - Prime number generation for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009, The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Parts of this software are based on indutny/miller-rabin:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/miller-rabin
 *
 * Resources:
 *   https://github.com/golang/go/blob/master/src/crypto/rsa/rsa.go
 *   https://github.com/golang/go/blob/master/src/math/big/prime.go
 *   https://github.com/golang/go/blob/master/src/math/big/int.go
 *   https://github.com/golang/go/blob/master/src/math/big/nat.go
 *   https://github.com/golang/go/blob/master/src/crypto/rand/util.go
 *   https://github.com/indutny/miller-rabin/blob/master/lib/mr.js
 */const i=r(1),n=r(6),s=r(5),o=new Uint8Array([3,5,7,11,13,17,19,23,29,31,37,41,43,47,53]),f=new n("16294579238595022365",10),a=new n(4127218095),c=new n(3948078067);function h(t,e,r=s){if(i(t instanceof n),t.sign()<=0)return!1;if(t.cmpn(64)<0){const e=t.word(0);return e>31?0!=(673221152&1<<e-32):0!=(-1601558356&1<<e)}if(t.isEven())return!1;const o=t.mod(a).toNumber(),f=t.mod(c).toNumber();return o%3!=0&&o%5!=0&&o%7!=0&&o%11!=0&&o%13!=0&&o%17!=0&&o%19!=0&&o%23!=0&&o%37!=0&&f%29!=0&&f%31!=0&&f%41!=0&&f%43!=0&&f%47!=0&&f%53!=0&&t.isPrime(r,e)}e.randomPrime=function(t,e=20,r=s){if(i(t>>>0===t),i(e>>>0===e),i(null!=r),t<2)throw new Error("Prime must be at least 2 bits.");for(;;){const i=n.randomBits(r,t);i.setn(t-1,1),i.setn(t-2,1),i.setn(0,1);const s=i.mod(f);t:for(let e=0;e<1<<20;e+=2){const r=s.addn(e);for(let e=0;e<o.length;e++){const i=o[e];if(0===r.modrn(i)&&(t>6||0!==r.cmpn(i)))continue t}i.iaddn(e);break}if(i.bitLength()===t&&h(i,e,r))return i}},e.isProbablePrime=h,e.isSafePrime=function(t,e,r){return!!h(t,e,r)&&!!h(t.subn(1).iushrn(1),e,r)}},function(t,e,r){"use strict";
/*!
 * eb2k.js - eb2k for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(212)},function(t,e,r){"use strict";
/*!
 * ed25519.js - ed25519 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(214)},function(t,e,r){"use strict";(function(e){
/*!
 * eddsa.js - EdDSA for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/elliptic:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/elliptic
 *
 * References:
 *
 *   [EDDSA] High-speed high-security signatures
 *     D. J. Bernstein, N. Duif, T. Lange, P. Schwabe, B. Yang
 *     https://ed25519.cr.yp.to/ed25519-20110926.pdf
 *
 *   [RFC8032] Edwards-Curve Digital Signature Algorithm (EdDSA)
 *     S. Josefsson, I. Liusvaara
 *     https://tools.ietf.org/html/rfc8032
 *
 * Implementation Notes:
 *
 *   - In contrast to the ECDSA backend, we allow points at
 *     infinity (in all functions).
 *
 *   - Mike Hamburg's Ed448-Goldilocks rejects both infinity as
 *     well as the torsion point (0, -1). We do not replicate
 *     this behavior.
 *
 *   - For Ed25519, we do "cofactor-less" verification by default.
 *     This means torsion components will affect the result of the
 *     verification.
 *
 *   - For Ed448, we do cofactor verification by default to mimic
 *     OpenSSL and Mike Hamburg's Ed448-Goldilocks implementation.
 *
 *   - `verifySingle`/`verifyBatch` do cofactor verification. Do
 *     not use `verifyBatch` expecting the same results as the
 *     regular `verify` call[1]. This will not be the case for
 *     Ed25519.
 *
 *   - All functions are completely unaware of points of small
 *     order and torsion components (in other words, points will
 *     not be explicitly checked for this, anywhere).
 *
 *   - `deriveWithScalar` and `exchangeWithScalar` automatically
 *     clamp scalars before multiplying (meaning torsion components
 *     are removed from the result and points of small order will
 *     be normalized to infinity).
 *
 *   - The HD function, `publicKeyTweakMul`, _does not_ clamp
 *     automatically. It is possible to end up with a torsion
 *     component in the resulting point (assuming the input
 *     point had one).
 *
 *   - Ed448-Goldilocks is 4-isogenous to Curve448. This means
 *     that when converting to Curve448, small order points will
 *     be normalized to (0, 0). When converting back to Ed448,
 *     any small order points will be normalized to infinity,
 *     and any torsion components will be removed completely.
 *     Also note that when converting back, the implementation
 *     needs to divide the point by 4. This is a major perf hit,
 *     so treat `x448.publicKeyConvert` as if it were a point
 *     multiplication.
 *
 *   - Elligators should not be used with Edwards curves. As
 *     Tibouchi notes[2], regular public keys will map to
 *     _distinguishable_ field elements as they are always in
 *     the primary subgroup. Either the Ristretto Elligator[3],
 *     or a prime order curve with an Elligator Squared[2]
 *     construction are suitable alternatives here.
 *
 *   - These notes also spell out why you should avoid using
 *     Edwards curves on a blockchain[4].
 *
 *   [1] https://moderncrypto.org/mail-archive/curves/2016/000836.html
 *   [2] https://eprint.iacr.org/2014/043.pdf
 *   [3] https://ristretto.group/formulas/elligator.html
 *   [4] https://src.getmonero.org/2017/05/17/disclosure-of-a-major-bug-in-cryptonote-based-currencies.html
 */
const i=r(1),n=r(50),s=r(6),o=r(33),f=r(5);class a{constructor(t){this.curve=t.curve,this.hash=new t.hash}init(t,r){return i(null==t||"boolean"==typeof t),i(e.isBuffer(r)),r.length>255&&(r=r.slice(0,255)),this.hash.init(),(this.curve.context||null!=t||r.length>0)&&(this.curve.prefix&&this.hash.update(this.curve.prefix),this.hash.update(c(t)),this.hash.update(c(r.length)),this.hash.update(r)),this}update(t){return this.hash.update(t),this}final(){const t=this.hash.final(2*this.curve.adjustedSize);return s.decode(t,this.curve.endian).imod(this.curve.n)}}function c(t){const r=e.alloc(1);return r[0]=255&t,r}t.exports=class{constructor(t,e,r,n,s){i("string"==typeof t),i(!e||"string"==typeof e),i(!r||"string"==typeof r),i(n),this.id=t,this.type="eddsa",this.mid=e||null,this.eid=r||null,this.hash=n,this.native=0,this._pre=s||null,this._curve=null,this._mont=null,this._iso=null,this._rng=null}get curve(){return this._curve||(this._curve=o.curve(this.id,this._pre),this._curve.precompute(f),this._pre=null),this._curve}get mont(){return this.mid&&!this._mont&&(this._mont=o.curve(this.mid)),this._mont}get iso(){return this.eid?(this._iso||(this._iso=o.curve(this.eid)),this._iso):this.mont}get rng(){return this._rng||(this._rng=new n(this.curve)),this._rng}get size(){return this.curve.adjustedSize}get bits(){return this.curve.fieldBits}hashNonce(t,e,r,i){const n=new a(this);return n.init(r,i),n.update(t),n.update(e),n.final()}hashChallenge(t,e,r,i,n){const s=new a(this);return s.init(i,n),s.update(t),s.update(e),s.update(r),s.final()}privateKeyGenerate(){return f.randomBytes(this.curve.adjustedSize)}scalarGenerate(){const t=f.randomBytes(this.curve.scalarSize);return this.curve.clamp(t)}privateKeyExpand(t){i(e.isBuffer(t)),i(t.length===this.curve.adjustedSize);const r=this.hash.digest(t,2*this.curve.adjustedSize);return this.curve.splitHash(r)}privateKeyConvert(t){const[e]=this.privateKeyExpand(t);return e}privateKeyVerify(t){return i(e.isBuffer(t)),t.length===this.curve.adjustedSize}scalarVerify(t){return i(e.isBuffer(t)),t.length===this.curve.scalarSize}scalarIsZero(t){let r;i(e.isBuffer(t));try{r=this.curve.decodeScalar(t).imod(this.curve.n)}catch(t){return!1}return r.isZero()}scalarClamp(t){return i(e.isBuffer(t)),i(t.length===this.curve.scalarSize),this.curve.clamp(e.from(t))}privateKeyExport(t){const r=this.publicKeyCreate(t),{x:i,y:n}=this.publicKeyExport(r);return{d:e.from(t),x:i,y:n}}privateKeyImport(t){if(i(t&&"object"==typeof t),i(e.isBuffer(t.d)),t.d.length!==this.curve.adjustedSize)throw new Error("Invalid private key.");return e.from(t.d)}scalarTweakAdd(t,e){const r=this.curve.decodeScalar(t),i=this.curve.decodeScalar(e),n=r.add(i).imod(this.curve.n);return this.curve.encodeScalar(n)}scalarTweakMul(t,e){const r=this.curve.decodeScalar(t),i=this.curve.decodeScalar(e),n=r.mul(i).imod(this.curve.n);return this.curve.encodeScalar(n)}scalarReduce(t){const e=this.curve.decodeScalar(t).imod(this.curve.n);return this.curve.encodeScalar(e)}scalarNegate(t){const e=this.curve.decodeScalar(t).imod(this.curve.n).neg().imod(this.curve.n);return this.curve.encodeScalar(e)}scalarInvert(t){const e=this.curve.decodeScalar(t).imod(this.curve.n);if(e.isZero())return this.curve.encodeScalar(e);const r=e.invert(this.curve.n);return this.curve.encodeScalar(r)}publicKeyCreate(t){const e=this.privateKeyConvert(t);return this.publicKeyFromScalar(e)}publicKeyFromScalar(t){const e=this.curve.decodeScalar(t).imod(this.curve.n);return this.curve.g.mulBlind(e).encode()}publicKeyConvert(t){if(!this.mont)throw new Error("No equivalent montgomery curve.");const e=this.curve.decodePoint(t);return this.mont.pointFromEdwards(e).encode()}publicKeyFromUniform(t){const e=this.curve.decodeUniform(t);return this.curve.pointFromUniform(e,this.iso).encode()}publicKeyToUniform(t,e=f.randomInt()){const r=this.curve.decodePoint(t),i=this.curve.pointToUniform(r,e,this.iso);return this.curve.encodeUniform(i,e>>>8)}publicKeyFromHash(t,e=!1){return this.curve.pointFromHash(t,e,this.iso).encode()}publicKeyToHash(t,e=f.randomInt()){const r=this.curve.decodePoint(t);return this.curve.pointToHash(r,e,f,this.iso)}publicKeyVerify(t){i(e.isBuffer(t));try{this.curve.decodePoint(t)}catch(t){return!1}return!0}publicKeyIsInfinity(t){let r;i(e.isBuffer(t));try{r=this.curve.decodePoint(t)}catch(t){return!1}return r.isInfinity()}publicKeyIsSmall(t){let r;i(e.isBuffer(t));try{r=this.curve.decodePoint(t)}catch(t){return!1}return r.isSmall()}publicKeyHasTorsion(t){let r;i(e.isBuffer(t));try{r=this.curve.decodePoint(t)}catch(t){return!1}return r.hasTorsion()}publicKeyExport(t){const{x:e,y:r}=this.curve.decodePoint(t);return{x:this.curve.encodeField(e.fromRed()),y:this.curve.encodeField(r.fromRed())}}publicKeyImport(t){i(t&&"object"==typeof t);let e,r=null,n=null;if(null!=t.x&&(r=s.decode(t.x,this.curve.endian),r.cmp(this.curve.p)>=0))throw new Error("Invalid point.");if(null!=t.y&&(n=s.decode(t.y,this.curve.endian),n.cmp(this.curve.p)>=0))throw new Error("Invalid point.");if(r&&n){if(e=this.curve.point(r,n),!e.validate())throw new Error("Invalid point.")}else if(r)e=this.curve.pointFromX(r,t.sign);else{if(!n)throw new Error("Invalid point.");e=this.curve.pointFromY(n,t.sign)}return e.encode()}publicKeyTweakAdd(t,e){const r=this.curve.decodeScalar(e).imod(this.curve.n),i=this.curve.decodePoint(t);return this.curve.g.mul(r).add(i).encode()}publicKeyTweakMul(t,e){const r=this.curve.decodeScalar(e);return this.curve.decodePoint(t).mul(r).encode()}publicKeyCombine(t){i(Array.isArray(t));let e=this.curve.point();for(const r of t){const t=this.curve.decodePoint(r);e=e.add(t)}return e.encode()}publicKeyNegate(t){return this.curve.decodePoint(t).neg().encode()}sign(t,e,r,i){const[n,s]=this.privateKeyExpand(e);return this.signWithScalar(t,n,s,r,i)}signWithScalar(t,r,n,s,o){null==o&&(o=e.alloc(0)),i(e.isBuffer(t)),i(e.isBuffer(n)),i(n.length===this.curve.adjustedSize);const{n:f}=this.curve,a=this.curve.g,c=this.hashNonce(n,t,s,o),h=a.mulBlind(c).encode(),u=this.curve.decodeScalar(r),d=a.mulBlind(u).encode(),l=this.hashChallenge(h,d,t,s,o),b=c.add(l.mul(u)).imod(f);return e.concat([h,this.curve.encodeAdjusted(b)])}signTweakAdd(t,e,r,i,n){const[s,o]=this.privateKeyExpand(e),f=this.scalarTweakAdd(s,r),a=this.hash.multi(o,r,null,2*this.curve.adjustedSize).slice(0,this.curve.adjustedSize);return this.signWithScalar(t,f,a,i,n)}signTweakMul(t,e,r,i,n){const[s,o]=this.privateKeyExpand(e),f=this.scalarTweakMul(s,r),a=this.hash.multi(o,r,null,2*this.curve.adjustedSize).slice(0,this.curve.adjustedSize);return this.signWithScalar(t,f,a,i,n)}verify(t,r,n,s,o){if(null==o&&(o=e.alloc(0)),i(e.isBuffer(t)),i(e.isBuffer(r)),i(e.isBuffer(n)),i(null==s||"boolean"==typeof s),i(e.isBuffer(o)),r.length!==2*this.curve.adjustedSize)return!1;if(n.length!==this.curve.adjustedSize)return!1;try{return this._verify(t,r,n,s,o)}catch(t){return!1}}_verify(t,e,r,i,n){const{n:s}=this.curve,o=this.curve.g,f=e.slice(0,this.curve.adjustedSize),a=e.slice(this.curve.adjustedSize),c=this.curve.decodePoint(f),h=this.curve.decodeAdjusted(a),u=this.curve.decodePoint(r);if(h.cmp(s)>=0)return!1;const d=this.hashChallenge(f,r,t,i,n);return o.mulAdd(h,u.neg(),d).eq(c)}verifySingle(t,r,n,s,o){if(null==o&&(o=e.alloc(0)),i(e.isBuffer(t)),i(e.isBuffer(r)),i(e.isBuffer(n)),i(null==s||"boolean"==typeof s),i(e.isBuffer(o)),r.length!==2*this.curve.adjustedSize)return!1;if(n.length!==this.curve.adjustedSize)return!1;try{return this._verifySingle(t,r,n,s,o)}catch(t){return!1}}_verifySingle(t,e,r,i,n){const{n:s}=this.curve,o=this.curve.g,f=e.slice(0,this.curve.adjustedSize),a=e.slice(this.curve.adjustedSize),c=this.curve.decodePoint(f),h=this.curve.decodeAdjusted(a),u=this.curve.decodePoint(r);if(h.cmp(s)>=0)return!1;const d=this.hashChallenge(f,r,t,i,n),l=this.curve.imulH(h),b=u.mulH(),p=c.mulH();return o.mulAdd(l,b.neg(),d).eq(p)}verifyBatch(t,r,n){null==n&&(n=e.alloc(0)),i(Array.isArray(t)),i(null==r||"boolean"==typeof r),i(e.isBuffer(n));for(const r of t){i(Array.isArray(r)&&3===r.length);const[t,n,s]=r;if(i(e.isBuffer(t)),i(e.isBuffer(n)),i(e.isBuffer(s)),n.length!==2*this.curve.adjustedSize)return!1;if(s.length!==this.curve.adjustedSize)return!1}try{return this._verifyBatch(t,r,n)}catch(t){return!1}}_verifyBatch(t,e,r){const{n:i}=this.curve,n=this.curve.g,o=new Array(1+2*t.length),f=new Array(1+2*t.length),a=new s(0);this.rng.init(t),o[0]=n,f[0]=a;for(let n=0;n<t.length;n++){const[s,c,h]=t[n],u=c.slice(0,this.curve.adjustedSize),d=c.slice(this.curve.adjustedSize),l=this.curve.decodePoint(u),b=this.curve.decodeAdjusted(d),p=this.curve.decodePoint(h);if(b.cmp(i)>=0)return!1;const m=this.hashChallenge(u,h,s,e,r),g=this.rng.generate(n),w=m.mul(g).imod(i);a.iadd(b.mul(g)).imod(i),o[1+2*n+0]=l.mulH(),f[1+2*n+0]=g,o[1+2*n+1]=p.mulH(),f[1+2*n+1]=w}return this.curve.imulH(a.ineg()),this.curve.mulAll(o,f).isInfinity()}derive(t,e){const r=this.privateKeyConvert(e);return this.deriveWithScalar(t,r)}deriveWithScalar(t,e){const r=this.curve.decodePoint(t),i=this.curve.decodeClamped(e),n=r.mulBlind(i,f);if(n.isInfinity())throw new Error("Invalid point.");return n.encode()}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";e.custom="inspect"},function(t,e,r){"use strict";(function(e){
/*!
 * reader.js - buffer reader for bcoin
 * Copyright (c) 2014-2015, Fedor Indutny (MIT License)
 * Copyright (c) 2014-2017, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */
const i=r(20),n=r(39),s=r(27),o=e.alloc(0);t.exports=class{constructor(t,r=!1){i(e.isBuffer(t),"data","buffer"),i("boolean"==typeof r,"zeroCopy","boolean"),this.data=t,this.offset=0,this.zeroCopy=r,this.stack=[]}check(t){if(this.offset+t>this.data.length)throw new s(this.offset,"Out of bounds read",this.check)}getSize(){return this.data.length}left(){return this.check(0),this.data.length-this.offset}seek(t){if(i(Number.isSafeInteger(t),"off","integer"),this.offset+t<0)throw new s(this.offset,"Out of bounds read");return this.check(t),this.offset+=t,this}start(){return this.stack.push(this.offset),this.offset}end(){if(0===this.stack.length)throw new Error("Cannot end without a stack item.");const t=this.stack.pop();return this.offset-t}endData(t=!1){if(i("boolean"==typeof t,"zeroCopy","boolean"),0===this.stack.length)throw new Error("Cannot end without a stack item.");const r=this.stack.pop(),n=this.offset,s=n-r,o=this.data;if(s===o.length)return o;if(this.zeroCopy||t)return o.slice(r,n);const f=e.allocUnsafeSlow(s);return o.copy(f,0,r,n),f}destroy(){return this.data=o,this.offset=0,this.stack.length=0,this}readU8(){this.check(1);const t=this.data[this.offset];return this.offset+=1,t}readU16(){this.check(2);const t=n.readU16(this.data,this.offset);return this.offset+=2,t}readU16BE(){this.check(2);const t=n.readU16BE(this.data,this.offset);return this.offset+=2,t}readU24(){this.check(3);const t=n.readU24(this.data,this.offset);return this.offset+=3,t}readU24BE(){this.check(3);const t=n.readU24BE(this.data,this.offset);return this.offset+=3,t}readU32(){this.check(4);const t=n.readU32(this.data,this.offset);return this.offset+=4,t}readU32BE(){this.check(4);const t=n.readU32BE(this.data,this.offset);return this.offset+=4,t}readU40(){this.check(5);const t=n.readU40(this.data,this.offset);return this.offset+=5,t}readU40BE(){this.check(5);const t=n.readU40BE(this.data,this.offset);return this.offset+=5,t}readU48(){this.check(6);const t=n.readU48(this.data,this.offset);return this.offset+=6,t}readU48BE(){this.check(6);const t=n.readU48BE(this.data,this.offset);return this.offset+=6,t}readU56(){this.check(7);const t=n.readU56(this.data,this.offset);return this.offset+=7,t}readU56BE(){this.check(7);const t=n.readU56BE(this.data,this.offset);return this.offset+=7,t}readU64(){this.check(8);const t=n.readU64(this.data,this.offset);return this.offset+=8,t}readU64BE(){this.check(8);const t=n.readU64BE(this.data,this.offset);return this.offset+=8,t}readI8(){this.check(1);const t=n.readI8(this.data,this.offset);return this.offset+=1,t}readI16(){this.check(2);const t=n.readI16(this.data,this.offset);return this.offset+=2,t}readI16BE(){this.check(2);const t=n.readI16BE(this.data,this.offset);return this.offset+=2,t}readI24(){this.check(3);const t=n.readI24(this.data,this.offset);return this.offset+=3,t}readI24BE(){this.check(3);const t=n.readI24BE(this.data,this.offset);return this.offset+=3,t}readI32(){this.check(4);const t=n.readI32(this.data,this.offset);return this.offset+=4,t}readI32BE(){this.check(4);const t=n.readI32BE(this.data,this.offset);return this.offset+=4,t}readI40(){this.check(5);const t=n.readI40(this.data,this.offset);return this.offset+=5,t}readI40BE(){this.check(5);const t=n.readI40BE(this.data,this.offset);return this.offset+=5,t}readI48(){this.check(6);const t=n.readI48(this.data,this.offset);return this.offset+=6,t}readI48BE(){this.check(6);const t=n.readI48BE(this.data,this.offset);return this.offset+=6,t}readI56(){this.check(7);const t=n.readI56(this.data,this.offset);return this.offset+=7,t}readI56BE(){this.check(7);const t=n.readI56BE(this.data,this.offset);return this.offset+=7,t}readI64(){this.check(8);const t=n.readI64(this.data,this.offset);return this.offset+=8,t}readI64BE(){this.check(8);const t=n.readI64BE(this.data,this.offset);return this.offset+=8,t}readFloat(){this.check(4);const t=n.readFloat(this.data,this.offset);return this.offset+=4,t}readFloatBE(){this.check(4);const t=n.readFloatBE(this.data,this.offset);return this.offset+=4,t}readDouble(){this.check(8);const t=n.readDouble(this.data,this.offset);return this.offset+=8,t}readDoubleBE(){this.check(8);const t=n.readDoubleBE(this.data,this.offset);return this.offset+=8,t}readVarint(){const{size:t,value:e}=n.readVarint(this.data,this.offset);return this.offset+=t,e}readVarint2(){const{size:t,value:e}=n.readVarint2(this.data,this.offset);return this.offset+=t,e}readBytes(t,r=!1){let n;return i(t>>>0===t,"size","integer"),i("boolean"==typeof r,"zeroCopy","boolean"),this.check(t),this.zeroCopy||r?n=this.data.slice(this.offset,this.offset+t):(n=e.allocUnsafeSlow(t),this.data.copy(n,0,this.offset,this.offset+t)),this.offset+=t,n}readVarBytes(t=!1){return this.readBytes(this.readVarint(),t)}readChild(t){i(t>>>0===t,"size","integer"),this.check(t);const e=this.data.slice(0,this.offset+t),r=new this.constructor(e);return r.offset=this.offset,this.offset+=t,r}readString(t,e){null==e&&(e="binary"),i(t>>>0===t,"size","integer"),i("string"==typeof e,"enc","string"),this.check(t);const r=this.data.toString(e,this.offset,this.offset+t);return this.offset+=t,r}readHash(t){return t?this.readString(32,t):this.readBytes(32)}readVarString(t,e=0){null==t&&(t="binary"),i("string"==typeof t,"enc","string"),i(e>>>0===e,"limit","integer");const r=this.readVarint();if(0!==e&&r>e)throw new s(this.offset,"String exceeds limit");return this.readString(r,t)}readNullString(t){null==t&&(t="binary"),i("string"==typeof t,"enc","string");let e=this.offset;for(;e<this.data.length&&0!==this.data[e];e++);if(e===this.data.length)throw new s(this.offset,"No NUL terminator");const r=this.readString(e-this.offset,t);return this.offset=e+1,r}createChecksum(t){t&&"function"==typeof t.digest||i("function"==typeof t,"hash","function");let e=0;this.stack.length>0&&(e=this.stack[this.stack.length-1]);const r=this.data.slice(e,this.offset),s=t.digest?t.digest(r):t(r);return n.readU32(s,0)}verifyChecksum(t){const e=this.createChecksum(t);if(e!==this.readU32())throw new s(this.offset,"Checksum mismatch");return e}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * writer.js - buffer writer for bcoin
 * Copyright (c) 2014-2015, Fedor Indutny (MIT License)
 * Copyright (c) 2014-2017, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */
const i=r(20),n=r(39),s=r(27);class o{constructor(t){this.type=t}}class f extends o{constructor(t,e){super(t),this.value=e}}class a extends o{constructor(t,e){super(t),this.data=e}}class c extends o{constructor(t,e,r){super(t),this.value=e,this.enc=r}}class h extends o{constructor(t,e){super(t),this.func=e}}class u extends o{constructor(t,e,r){super(t),this.value=e,this.size=r}}t.exports=class{constructor(){this.ops=[],this.offset=0}render(){const t=e.allocUnsafeSlow(this.offset);let r=0;for(const e of this.ops)switch(e.type){case 0:r+=e.value;break;case 1:r=n.writeU8(t,e.value,r);break;case 2:r=n.writeU16(t,e.value,r);break;case 3:r=n.writeU16BE(t,e.value,r);break;case 4:r=n.writeU24(t,e.value,r);break;case 5:r=n.writeU24BE(t,e.value,r);break;case 6:r=n.writeU32(t,e.value,r);break;case 7:r=n.writeU32BE(t,e.value,r);break;case 8:r=n.writeU40(t,e.value,r);break;case 9:r=n.writeU40BE(t,e.value,r);break;case 10:r=n.writeU48(t,e.value,r);break;case 11:r=n.writeU48BE(t,e.value,r);break;case 12:r=n.writeU56(t,e.value,r);break;case 13:r=n.writeU56BE(t,e.value,r);break;case 14:r=n.writeU64(t,e.value,r);break;case 15:r=n.writeU64BE(t,e.value,r);break;case 16:r=n.writeI8(t,e.value,r);break;case 17:r=n.writeI16(t,e.value,r);break;case 18:r=n.writeI16BE(t,e.value,r);break;case 19:r=n.writeI24(t,e.value,r);break;case 20:r=n.writeI24BE(t,e.value,r);break;case 21:r=n.writeI32(t,e.value,r);break;case 22:r=n.writeI32BE(t,e.value,r);break;case 23:r=n.writeI40(t,e.value,r);break;case 24:r=n.writeI40BE(t,e.value,r);break;case 25:r=n.writeI48(t,e.value,r);break;case 26:r=n.writeI48BE(t,e.value,r);break;case 27:r=n.writeI56(t,e.value,r);break;case 28:r=n.writeI56BE(t,e.value,r);break;case 29:r=n.writeI64(t,e.value,r);break;case 30:r=n.writeI64BE(t,e.value,r);break;case 31:r=n.writeFloat(t,e.value,r);break;case 32:r=n.writeFloatBE(t,e.value,r);break;case 33:r=n.writeDouble(t,e.value,r);break;case 34:r=n.writeDoubleBE(t,e.value,r);break;case 35:r=n.writeVarint(t,e.value,r);break;case 36:r=n.writeVarint2(t,e.value,r);break;case 37:r+=e.data.copy(t,r);break;case 38:r+=t.write(e.value,r,e.enc);break;case 39:r+=e.func(t.slice(0,r)).copy(t,r,0,4);break;case 40:t.fill(e.value,r,r+e.size),r+=e.size;break;default:throw new Error("Invalid type.")}if(r!==t.length)throw new s(r,"Out of bounds write");return this.destroy(),t}getSize(){return this.offset}seek(t){if(i(Number.isSafeInteger(t),"off","integer"),this.offset+t<0)throw new s(this.offset,"Out of bounds write");return this.offset+=t,this.ops.push(new f(0,t)),this}destroy(){return this.ops.length=0,this.offset=0,this}writeU8(t){return this.offset+=1,this.ops.push(new f(1,t)),this}writeU16(t){return this.offset+=2,this.ops.push(new f(2,t)),this}writeU16BE(t){return this.offset+=2,this.ops.push(new f(3,t)),this}writeU24(t){return this.offset+=3,this.ops.push(new f(4,t)),this}writeU24BE(t){return this.offset+=3,this.ops.push(new f(5,t)),this}writeU32(t){return this.offset+=4,this.ops.push(new f(6,t)),this}writeU32BE(t){return this.offset+=4,this.ops.push(new f(7,t)),this}writeU40(t){return this.offset+=5,this.ops.push(new f(8,t)),this}writeU40BE(t){return this.offset+=5,this.ops.push(new f(9,t)),this}writeU48(t){return this.offset+=6,this.ops.push(new f(10,t)),this}writeU48BE(t){return this.offset+=6,this.ops.push(new f(11,t)),this}writeU56(t){return this.offset+=7,this.ops.push(new f(12,t)),this}writeU56BE(t){return this.offset+=7,this.ops.push(new f(13,t)),this}writeU64(t){return this.offset+=8,this.ops.push(new f(14,t)),this}writeU64BE(t){return this.offset+=8,this.ops.push(new f(15,t)),this}writeI8(t){return this.offset+=1,this.ops.push(new f(16,t)),this}writeI16(t){return this.offset+=2,this.ops.push(new f(17,t)),this}writeI16BE(t){return this.offset+=2,this.ops.push(new f(18,t)),this}writeI24(t){return this.offset+=3,this.ops.push(new f(19,t)),this}writeI24BE(t){return this.offset+=3,this.ops.push(new f(20,t)),this}writeI32(t){return this.offset+=4,this.ops.push(new f(21,t)),this}writeI32BE(t){return this.offset+=4,this.ops.push(new f(22,t)),this}writeI40(t){return this.offset+=5,this.ops.push(new f(23,t)),this}writeI40BE(t){return this.offset+=5,this.ops.push(new f(24,t)),this}writeI48(t){return this.offset+=6,this.ops.push(new f(25,t)),this}writeI48BE(t){return this.offset+=6,this.ops.push(new f(26,t)),this}writeI56(t){return this.offset+=7,this.ops.push(new f(27,t)),this}writeI56BE(t){return this.offset+=7,this.ops.push(new f(28,t)),this}writeI64(t){return this.offset+=8,this.ops.push(new f(29,t)),this}writeI64BE(t){return this.offset+=8,this.ops.push(new f(30,t)),this}writeFloat(t){return this.offset+=4,this.ops.push(new f(31,t)),this}writeFloatBE(t){return this.offset+=4,this.ops.push(new f(32,t)),this}writeDouble(t){return this.offset+=8,this.ops.push(new f(33,t)),this}writeDoubleBE(t){return this.offset+=8,this.ops.push(new f(34,t)),this}writeVarint(t){return this.offset+=n.sizeVarint(t),this.ops.push(new f(35,t)),this}writeVarint2(t){return this.offset+=n.sizeVarint2(t),this.ops.push(new f(36,t)),this}writeBytes(t){return i(e.isBuffer(t),"value","buffer"),0===t.length||(this.offset+=t.length,this.ops.push(new a(37,t))),this}writeVarBytes(t){return i(e.isBuffer(t),"value","buffer"),this.offset+=n.sizeVarint(t.length),this.ops.push(new f(35,t.length)),0===t.length||(this.offset+=t.length,this.ops.push(new a(37,t))),this}copy(t,r,n){i(e.isBuffer(t),"value","buffer"),i(r>>>0===r,"start","integer"),i(n>>>0===n,"end","integer"),i(n>=r,"start","integer");const s=t.slice(r,n);return this.writeBytes(s),this}writeString(t,r){return null==r&&(r="binary"),i("string"==typeof t,"value","string"),i("string"==typeof r,"enc","string"),0===t.length||(this.offset+=e.byteLength(t,r),this.ops.push(new c(38,t,r))),this}writeHash(t){return"string"!=typeof t?(i(e.isBuffer(t),"value","buffer"),i(32===t.length,"value","32-byte hash"),this.writeBytes(t),this):(i(64===t.length,"value","32-byte hash"),this.writeString(t,"hex"),this)}writeVarString(t,r){if(null==r&&(r="binary"),i("string"==typeof t,"value","string"),i("string"==typeof r,"enc","string"),0===t.length)return this.ops.push(new f(35,0)),this;const s=e.byteLength(t,r);return this.offset+=n.sizeVarint(s),this.offset+=s,this.ops.push(new f(35,s)),this.ops.push(new c(38,t,r)),this}writeNullString(t,e){return this.writeString(t,e),this.writeU8(0),this}writeChecksum(t){return t&&"function"==typeof t.digest&&(t=t.digest.bind(t)),i("function"==typeof t,"hash","function"),this.offset+=4,this.ops.push(new h(39,t)),this}fill(t,e){return i((255&t)===t,"value","byte"),i(e>>>0===e,"size","integer"),0===e||(this.offset+=e,this.ops.push(new u(40,t,e))),this}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * staticwriter.js - buffer writer for bcoin
 * Copyright (c) 2014-2017, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */
const i=r(20),n=r(39),s=r(27),o=e.alloc(0);let f=null;class a{constructor(t){this.data=o,this.offset=0,null!=t&&this.init(t)}check(t){if(this.offset+t>this.data.length)throw new s(this.offset,"Out of bounds write",this.check)}init(t){return e.isBuffer(t)?(this.data=t,this.offset=0,this):(i(t>>>0===t,"size","integer"),this.data=e.allocUnsafeSlow(t),this.offset=0,this)}static pool(t){if(i(t>>>0===t,"size","integer"),t<=102400){f||(f=e.allocUnsafeSlow(102400));const r=new a;return r.data=f.slice(0,t),r}return new a(t)}render(){const{data:t,offset:e}=this;if(e!==t.length)throw new s(e,"Out of bounds write");return this.destroy(),t}slice(){const{data:t,offset:e}=this;if(e>t.length)throw new s(e,"Out of bounds write");return this.destroy(),t.slice(0,e)}getSize(){return this.offset}seek(t){if(i(Number.isSafeInteger(t),"off","integer"),this.offset+t<0)throw new s(this.offset,"Out of bounds write");return this.check(t),this.offset+=t,this}destroy(){return this.data=o,this.offset=0,this}writeU8(t){return this.check(1),this.offset=n.writeU8(this.data,t,this.offset),this}writeU16(t){return this.check(2),this.offset=n.writeU16(this.data,t,this.offset),this}writeU16BE(t){return this.check(2),this.offset=n.writeU16BE(this.data,t,this.offset),this}writeU24(t){return this.check(3),this.offset=n.writeU24(this.data,t,this.offset),this}writeU24BE(t){return this.check(3),this.offset=n.writeU24BE(this.data,t,this.offset),this}writeU32(t){return this.check(4),this.offset=n.writeU32(this.data,t,this.offset),this}writeU32BE(t){return this.check(4),this.offset=n.writeU32BE(this.data,t,this.offset),this}writeU40(t){return this.check(5),this.offset=n.writeU40(this.data,t,this.offset),this}writeU40BE(t){return this.check(5),this.offset=n.writeU40BE(this.data,t,this.offset),this}writeU48(t){return this.check(6),this.offset=n.writeU48(this.data,t,this.offset),this}writeU48BE(t){return this.check(6),this.offset=n.writeU48BE(this.data,t,this.offset),this}writeU56(t){return this.check(7),this.offset=n.writeU56(this.data,t,this.offset),this}writeU56BE(t){return this.check(7),this.offset=n.writeU56BE(this.data,t,this.offset),this}writeU64(t){return this.check(8),this.offset=n.writeU64(this.data,t,this.offset),this}writeU64BE(t){return this.check(8),this.offset=n.writeU64BE(this.data,t,this.offset),this}writeI8(t){return this.check(1),this.offset=n.writeI8(this.data,t,this.offset),this}writeI16(t){return this.check(2),this.offset=n.writeI16(this.data,t,this.offset),this}writeI16BE(t){return this.check(2),this.offset=n.writeI16BE(this.data,t,this.offset),this}writeI24(t){return this.check(3),this.offset=n.writeI24(this.data,t,this.offset),this}writeI24BE(t){return this.check(3),this.offset=n.writeI24BE(this.data,t,this.offset),this}writeI32(t){return this.check(4),this.offset=n.writeI32(this.data,t,this.offset),this}writeI32BE(t){return this.check(4),this.offset=n.writeI32BE(this.data,t,this.offset),this}writeI40(t){return this.check(5),this.offset=n.writeI40(this.data,t,this.offset),this}writeI40BE(t){return this.check(5),this.offset=n.writeI40BE(this.data,t,this.offset),this}writeI48(t){return this.check(6),this.offset=n.writeI48(this.data,t,this.offset),this}writeI48BE(t){return this.check(6),this.offset=n.writeI48BE(this.data,t,this.offset),this}writeI56(t){return this.check(7),this.offset=n.writeI56(this.data,t,this.offset),this}writeI56BE(t){return this.check(7),this.offset=n.writeI56BE(this.data,t,this.offset),this}writeI64(t){return this.check(8),this.offset=n.writeI64(this.data,t,this.offset),this}writeI64BE(t){return this.check(8),this.offset=n.writeI64BE(this.data,t,this.offset),this}writeFloat(t){return this.check(4),this.offset=n.writeFloat(this.data,t,this.offset),this}writeFloatBE(t){return this.check(4),this.offset=n.writeFloatBE(this.data,t,this.offset),this}writeDouble(t){return this.check(8),this.offset=n.writeDouble(this.data,t,this.offset),this}writeDoubleBE(t){return this.check(8),this.offset=n.writeDoubleBE(this.data,t,this.offset),this}writeVarint(t){return this.offset=n.writeVarint(this.data,t,this.offset),this}writeVarint2(t){return this.offset=n.writeVarint2(this.data,t,this.offset),this}writeBytes(t){return i(e.isBuffer(t),"value","buffer"),this.check(t.length),this.offset+=t.copy(this.data,this.offset),this}writeVarBytes(t){return i(e.isBuffer(t),"value","buffer"),this.writeVarint(t.length),this.writeBytes(t),this}copy(t,r,n){return i(e.isBuffer(t),"value","buffer"),i(r>>>0===r,"start","integer"),i(n>>>0===n,"end","integer"),i(n>=r,"start","integer"),this.check(n-r),this.offset+=t.copy(this.data,this.offset,r,n),this}writeString(t,r){if(null==r&&(r="binary"),i("string"==typeof t,"value","string"),i("string"==typeof r,"enc","string"),0===t.length)return this;const n=e.byteLength(t,r);return this.check(n),this.offset+=this.data.write(t,this.offset,r),this}writeHash(t){return"string"!=typeof t?(i(e.isBuffer(t),"value","buffer"),i(32===t.length,"value","32-byte hash"),this.writeBytes(t),this):(i(64===t.length,"value","32-byte hash"),this.check(32),this.offset+=this.data.write(t,this.offset,"hex"),this)}writeVarString(t,r){if(null==r&&(r="binary"),i("string"==typeof t,"value","string"),i("string"==typeof r,"enc","string"),0===t.length)return this.writeVarint(0),this;const n=e.byteLength(t,r);return this.writeVarint(n),this.check(n),this.offset+=this.data.write(t,this.offset,r),this}writeNullString(t,e){return this.writeString(t,e),this.writeU8(0),this}writeChecksum(t){t&&"function"==typeof t.digest||i("function"==typeof t,"hash","function"),this.check(4);const e=this.data.slice(0,this.offset);return(t.digest?t.digest(e):t(e)).copy(this.data,this.offset,0,4),this.offset+=4,this}fill(t,e){return i((255&t)===t,"value","byte"),i(e>>>0===e,"size","integer"),this.check(e),this.data.fill(t,this.offset,this.offset+e),this.offset+=e,this}}t.exports=a}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * lines.js - line reader for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */const i=r(1);function n(t){i("string"==typeof t);for(let e=t.length-1;e>=0;e--){switch(t.charCodeAt(e)){case 9:case 11:case 12:case 32:case 160:continue}return t.substring(0,e+1)}return t}t.exports=function*(t){i("string"==typeof t);let e=0,r=0,s=0;for(t.length>0&&65279===t.charCodeAt(0)&&(e+=1,r+=1);e<t.length;e++){const i=t.charCodeAt(e);switch(i){case 13:case 10:case 133:if(r!==e){const i=n(t.substring(r,e));i.length>0&&(yield[s,i])}13===i&&e+1<t.length&&10===t.charCodeAt(e+1)&&(e+=1),r=e+1,s+=1}}if(r!==e){const i=n(t.substring(r,e));i.length>0&&(yield[s,i])}}},function(t,e,r){"use strict";
/*!
 * openssl.js - openssl-specific encoding for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://www.openssl.org/docs/man1.1.0/apps/dsa.html
 *   https://superuser.com/questions/478966/dsa-private-key-format
 *   https://github.com/dlitz/pycrypto/blob/master/lib/Crypto/PublicKey/DSA.py
 *   https://github.com/openssl/openssl/blob/master/crypto/dsa/dsa_asn1.c
 */const i=r(14),n=r(9);class s extends i.Sequence{constructor(t,e,r){super(),this.p=new i.Unsigned(t),this.q=new i.Unsigned(e),this.g=new i.Unsigned(r)}getBodySize(){let t=0;return t+=this.p.getSize(),t+=this.q.getSize(),t+=this.g.getSize(),t}writeBody(t){return this.p.write(t),this.q.write(t),this.g.write(t),t}readBody(t){return this.p.read(t),this.q.read(t),this.g.read(t),this}clean(){return this.p.clean()&&this.q.clean()&&this.g.clean()}toPEM(){return n.toPEM(this.encode(),"DSA PARAMETERS")}fromPEM(t){const e=n.fromPEM(t,"DSA PARAMETERS");return this.decode(e)}format(){return{type:this.constructor.name,p:this.p,q:this.q,g:this.g}}}class o extends i.Sequence{constructor(t,e,r,n){super(),this.y=new i.Unsigned(t),this.p=new i.Unsigned(e),this.q=new i.Unsigned(r),this.g=new i.Unsigned(n)}getBodySize(){let t=0;return t+=this.y.getSize(),t+=this.p.getSize(),t+=this.q.getSize(),t+=this.g.getSize(),t}writeBody(t){return this.y.write(t),this.p.write(t),this.q.write(t),this.g.write(t),t}readBody(t){return this.y.read(t),this.p.read(t),this.q.read(t),this.g.read(t),this}clean(){return this.y.clean()&&this.p.clean()&&this.q.clean()&&this.g.clean()}toPEM(){return n.toPEM(this.encode(),"DSA PUBLIC KEY")}fromPEM(t){const e=n.fromPEM(t,"DSA PUBLIC KEY");return this.decode(e)}format(){return{type:this.constructor.name,y:this.y,p:this.p,q:this.q,g:this.g}}}class f extends i.Sequence{constructor(t,e,r,n,s,o){super(),this.version=new i.Unsigned(t),this.p=new i.Unsigned(e),this.q=new i.Unsigned(r),this.g=new i.Unsigned(n),this.y=new i.Unsigned(s),this.x=new i.Unsigned(o)}getBodySize(){let t=0;return t+=this.version.getSize(),t+=this.p.getSize(),t+=this.q.getSize(),t+=this.g.getSize(),t+=this.y.getSize(),t+=this.x.getSize(),t}writeBody(t){return this.version.write(t),this.p.write(t),this.q.write(t),this.g.write(t),this.y.write(t),this.x.write(t),t}readBody(t){return this.version.read(t),this.p.read(t),this.q.read(t),this.g.read(t),this.y.read(t),this.x.read(t),this}clean(){return this.p.clean()&&this.q.clean()&&this.g.clean()&&this.y.clean()&&this.x.clean()}toPEM(){return n.toPEM(this.encode(),"DSA PRIVATE KEY")}fromPEM(t){const e=n.fromPEM(t,"DSA PRIVATE KEY");return this.decode(e)}format(){return{type:this.constructor.name,version:this.version,p:this.p,q:this.q,g:this.g,y:this.y,x:this.x}}}e.DSAParams=s,e.DSAPublicKey=o,e.DSAPrivateKey=f},function(t,e,r){"use strict";
/*!
 * pemcrypt.js - PEM encryption for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://tools.ietf.org/html/rfc1421
 */const i=r(1),{PEMBlock:n}=r(9),s=r(34),o=r(5),f=r(86),a=r(53),c={__proto__:null,"AES-128":[16,16],"AES-192":[24,16],"AES-256":[32,16],"ARC2-40":[5,8],"ARC2-64":[8,8],"ARC2-128":[16,8],BF:[16,8],BLOWFISH:[16,8],"CAMELLIA-128":[16,16],"CAMELLIA-192":[24,16],"CAMELLIA-256":[32,16],CAST5:[16,8],DES:[8,8],"DES-EDE":[16,8],"DES-EDE3":[24,8],IDEA:[16,8],"SERPENT-128":[16,16],"SERPENT-192":[24,16],"SERPENT-256":[32,16],"TWOFISH-128":[16,16],"TWOFISH-192":[24,16],"TWOFISH-256":[32,16]};function h(t){if(i("string"==typeof t),"RC2"===t.substring(0,3)&&(t="A"+t),t.length<5||"-"!==t[t.length-4])throw new Error(`Unsupported cipher: ${t}.`);const e=t.substring(0,t.length-4),r=c[e];if(!r)throw new Error(`Unsupported cipher: ${t}.`);return r}e.encrypt=function(t,e,r){if(i(t instanceof n),i("string"==typeof e),i("string"==typeof r),t.isEncrypted())throw new Error("PEM block is already encrypted.");const[c,u]=h(e),d=o.randomBytes(u),[l]=f.derive(a,r,d,c,u);return t.data=s.encrypt(e,l,d,t.data),t.setProcType(4,"ENCRYPTED"),t.setDEKInfo(e,d),t},e.decrypt=function(t,e){if(i(t instanceof n),i("string"==typeof e),!t.isEncrypted())throw new Error("PEM block is not encrypted.");const r=t.getDEKInfo();if(!r)throw new Error("DEK-Info not found.");const[o,c]=h(r.name),[u]=f.derive(a,e,r.iv,o,c);return t.data=s.decrypt(r.name,u,r.iv,t.data),t.unsetProcType(),t.unsetDEKInfo(),t}},function(t,e,r){"use strict";(function(e){
/*!
 * md5.js - MD5 implementation for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/MD5
 *   https://tools.ietf.org/html/rfc1321
 */
const i=r(1),n=r(3),s=e.alloc(8,0),o=e.alloc(64,0);o[0]=128;const f=new Uint32Array([3614090360,3905402710,606105819,3250441966,4118548399,1200080426,2821735955,4249261313,1770035416,2336552879,4294925233,2304563134,1804603682,4254626195,2792965006,1236535329,4129170786,3225465664,643717713,3921069994,3593408605,38016083,3634488961,3889429448,568446438,3275163606,4107603335,1163531501,2850285829,4243563512,1735328473,2368359562,4294588738,2272392833,1839030562,4259657740,2763975236,1272893353,4139469664,3200236656,681279174,3936430074,3572445317,76029189,3654602809,3873151461,530742520,3299628645,4096336452,1126891415,2878612391,4237533241,1700485571,2399980690,4293915773,2240044497,1873313359,4264355552,2734768916,1309151649,4149444226,3174756917,718787259,3951481745]),a=new Uint8Array([7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21]);class c{constructor(){this.state=new Uint32Array(4),this.msg=new Uint32Array(16),this.block=e.alloc(64),this.size=-1}init(){return this.state[0]=1732584193,this.state[1]=4023233417,this.state[2]=2562383102,this.state[3]=271733878,this.size=0,this}update(t){return i(e.isBuffer(t)),this._update(t,t.length),this}final(){return this._final(e.alloc(16))}_update(t,e){i(-1!==this.size,"Context is not initialized.");let r=63&this.size,n=0;if(this.size+=e,r>0){let i=64-r;if(i>e&&(i=e),t.copy(this.block,r,n,n+i),r+=i,e-=i,n+=i,r<64)return;this._transform(this.block,0)}for(;e>=64;)this._transform(t,n),n+=64,e-=64;e>0&&t.copy(this.block,0,n,n+e)}_final(t){i(-1!==this.size,"Context is not initialized.");const e=63&this.size,r=8*this.size;u(s,r>>>0,0),u(s,r*(1/4294967296)>>>0,4),this._update(o,1+(119-e&63)),this._update(s,8);for(let e=0;e<4;e++)u(t,this.state[e],4*e),this.state[e]=0;for(let t=0;t<16;t++)this.msg[t]=0;for(let t=0;t<64;t++)this.block[t]=0;return this.size=-1,t}_transform(t,e){const r=this.msg;let i=this.state[0],n=this.state[1],s=this.state[2],o=this.state[3],c=0;for(;c<16;c++)r[c]=(d=e+4*c,(u=t)[d++]+256*u[d++]+65536*u[d++]+16777216*u[d]);var u,d;for(c=0;c<64;c++){let t,e;c<16?(t=n&s|~n&o,e=c):c<32?(t=o&n|~o&s,e=5*c+1&15):c<48?(t=n^s^o,e=3*c+5&15):(t=s^(n|~o),e=7*c&15),t>>>=0,t=t+i+f[c]+r[e],t>>>=0,i=o,o=s,s=n,n+=h(t,a[c]),n>>>=0}this.state[0]+=i,this.state[1]+=n,this.state[2]+=s,this.state[3]+=o}static hash(){return new c}static hmac(){return new n(c,64)}static digest(t){return c.ctx.init().update(t).final()}static root(t,r){return i(e.isBuffer(t)&&16===t.length),i(e.isBuffer(r)&&16===r.length),c.ctx.init().update(t).update(r).final()}static multi(t,e,r){const{ctx:i}=c;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return c.hmac().init(e).update(t).final()}}function h(t,e){return t<<e|t>>>32-e}function u(t,e,r){return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}c.native=0,c.id="MD5",c.size=16,c.bits=128,c.blockSize=64,c.zero=e.alloc(16,0),c.ctx=new c,t.exports=c}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * pkcs1.js - PKCS1 encoding for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009 The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/PKCS_1
 *   https://tools.ietf.org/html/rfc3447
 *   https://tools.ietf.org/html/rfc8017#appendix-A.1.1
 *   https://tools.ietf.org/html/rfc8017#appendix-A.1.2
 *   https://github.com/golang/go/blob/master/src/crypto/x509/pkcs1.go
 *   https://github.com/openssl/openssl/blob/master/crypto/rsa/rsa_asn1.c
 */const i=r(14),n=r(9);class s extends i.Sequence{constructor(t,e){super(),this.n=new i.Unsigned(t),this.e=new i.Unsigned(e)}getBodySize(){let t=0;return t+=this.n.getSize(),t+=this.e.getSize(),t}writeBody(t){return this.n.write(t),this.e.write(t),t}readBody(t){return this.n.read(t),this.e.read(t),this}clean(){return this.n.clean()&&this.e.clean()}toPEM(){return n.toPEM(this.encode(),"RSA PUBLIC KEY")}fromPEM(t){const e=n.fromPEM(t,"RSA PUBLIC KEY");return this.decode(e)}format(){return{type:this.constructor.name,n:this.n,e:this.e}}}class o extends i.Sequence{constructor(t,e,r,n,s,o,f,a,c){super(),this.version=new i.Unsigned(t),this.n=new i.Unsigned(e),this.e=new i.Unsigned(r),this.d=new i.Unsigned(n),this.p=new i.Unsigned(s),this.q=new i.Unsigned(o),this.dp=new i.Unsigned(f),this.dq=new i.Unsigned(a),this.qi=new i.Unsigned(c)}getBodySize(){let t=0;return t+=this.version.getSize(),t+=this.n.getSize(),t+=this.e.getSize(),t+=this.d.getSize(),t+=this.p.getSize(),t+=this.q.getSize(),t+=this.dp.getSize(),t+=this.dq.getSize(),t+=this.qi.getSize(),t}writeBody(t){return this.version.write(t),this.n.write(t),this.e.write(t),this.d.write(t),this.p.write(t),this.q.write(t),this.dp.write(t),this.dq.write(t),this.qi.write(t),t}readBody(t){return this.version.read(t),this.n.read(t),this.e.read(t),this.d.read(t),this.p.read(t),this.q.read(t),this.dp.read(t),this.dq.read(t),this.qi.read(t),this}clean(){return this.n.clean()&&this.e.clean()&&this.d.clean()&&this.p.clean()&&this.q.clean()&&this.dp.clean()&&this.dq.clean()&&this.qi.clean()}toPEM(){return n.toPEM(this.encode(),"RSA PRIVATE KEY")}fromPEM(t){const e=n.fromPEM(t,"RSA PRIVATE KEY");return this.decode(e)}format(){return{type:this.constructor.name,version:this.version,n:this.n,e:this.e,d:this.d,p:this.p,q:this.q,dp:this.dp,dq:this.dq,qi:this.qi}}}e.RSAPublicKey=s,e.RSAPrivateKey=o},function(t,e,r){"use strict";
/*!
 * x509.js - X509 for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/asn1.js:
 *   Copyright Fedor Indutny, 2013.
 *   https://github.com/indutny/asn1.js
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/X.509
 *   https://tools.ietf.org/html/rfc4158
 *   https://www.ietf.org/rfc/rfc2560.txt
 *   https://www.ietf.org/rfc/rfc5280.txt
 *   https://github.com/indutny/asn1.js/blob/master/rfc/2560/index.js
 *   https://github.com/indutny/asn1.js/blob/master/rfc/5280/index.js
 *   https://github.com/indutny/asn1.js/blob/master/lib/asn1/base/node.js
 *   https://github.com/indutny/asn1.js/blob/master/lib/asn1/encoders/der.js
 *   https://github.com/indutny/asn1.js/blob/master/lib/asn1/decoders/der.js
 */const i=r(1),n=r(14),s=r(9),{types:o}=n;class f extends n.Sequence{constructor(){super(),this.tbsCertificate=new a,this.signatureAlgorithm=new c,this.signature=new n.BitString}get isRaw(){return!0}getBodySize(){let t=0;return t+=this.tbsCertificate.getSize(),t+=this.signatureAlgorithm.getSize(),t+=this.signature.getSize(),t}writeBody(t){return this.tbsCertificate.write(t),this.signatureAlgorithm.write(t),this.signature.write(t),t}readBody(t){return this.tbsCertificate.read(t),this.signatureAlgorithm.read(t),this.signature.read(t),this}clean(){return this.tbsCertificate.clean()&&this.signatureAlgorithm.clean()&&this.signature.clean()}toPEM(){return s.toPEM(this.encode(),"CERTIFICATE")}fromPEM(t){const e=s.fromPEM(t,"CERTIFICATE");return this.decode(e)}format(){return{type:this.constructor.name,tbsCertificate:this.tbsCertificate,signatureAlgorithm:this.signatureAlgorithm,signature:this.signature}}}class a extends n.Sequence{constructor(){super(),this.version=(new n.Unsigned).explicit(0).optional(),this.serialNumber=new n.Integer,this.signature=new c,this.issuer=new h,this.validity=new l,this.subject=new h,this.subjectPublicKeyInfo=new p,this.issuerUniqueID=(new n.BitString).implicit(1).optional(),this.subjectUniqueID=(new n.BitString).implicit(2).optional(),this.extensions=(new m).explicit(3).optional()}get isRaw(){return!0}getBodySize(){let t=0;return t+=this.version.getSize(),t+=this.serialNumber.getSize(),t+=this.signature.getSize(),t+=this.issuer.getSize(),t+=this.validity.getSize(),t+=this.subject.getSize(),t+=this.subjectPublicKeyInfo.getSize(),t+=this.issuerUniqueID.getSize(),t+=this.subjectUniqueID.getSize(),t+=this.extensions.getSize(),t}writeBody(t){return this.version.write(t),this.serialNumber.write(t),this.signature.write(t),this.issuer.write(t),this.validity.write(t),this.subject.write(t),this.subjectPublicKeyInfo.write(t),this.issuerUniqueID.write(t),this.subjectUniqueID.write(t),this.extensions.write(t),t}readBody(t){return this.version.read(t),this.serialNumber.read(t),this.signature.read(t),this.issuer.read(t),this.validity.read(t),this.subject.read(t),this.subjectPublicKeyInfo.read(t),this.issuerUniqueID.read(t),this.subjectUniqueID.read(t),this.extensions.read(t),this}clean(){return this.version.clean()&&this.serialNumber.clean()&&this.signature.clean()&&this.issuer.clean()&&this.validity.clean()&&this.subject.clean()&&this.subjectPublicKeyInfo.clean()&&this.issuerUniqueID.clean()&&this.subjectUniqueID.clean()&&this.extensions.clean()}toPEM(){return s.toPEM(this.encode(),"TBS CERTIFICATE")}fromPEM(t){const e=s.fromPEM(t,"TBS CERTIFICATE");return this.decode(e)}format(){return{type:this.constructor.name,version:this.version,serialNumber:this.serialNumber,signature:this.signature,issuer:this.issuer,validity:this.validity,subject:this.subject,subjectPublicKeyInfo:this.subjectPublicKeyInfo,issuerUniqueID:this.issuerUniqueID,subjectUniqueID:this.subjectUniqueID,extensions:this.extensions}}}class c extends n.Sequence{constructor(t,e){super(),this.algorithm=new n.OID(t),this.parameters=new n.Any(e).optional()}getBodySize(){let t=0;return t+=this.algorithm.getSize(),t+=this.parameters.getSize(),t}writeBody(t){return this.algorithm.write(t),this.parameters.write(t),t}readBody(t){return this.algorithm.read(t),this.parameters.read(t),this}clean(){return this.algorithm.clean()&&this.parameters.clean()}format(){return{type:this.constructor.name,algorithm:this.algorithm,parameters:this.parameters}}}class h extends n.Sequence{constructor(){super(),this.names=[]}getBodySize(){let t=0;for(const e of this.names)t+=e.getSize();return t}writeBody(t){for(const e of this.names)e.write(t);return t}readBody(t){for(;t.left();){const e=u.read(t);this.names.push(e)}return this}clean(){return 0===this.names.length}format(){return{type:this.constructor.name,names:this.names}}}class u extends n.Set{constructor(t,e){super(),this.attributes=[new d(t,e)]}getBodySize(){let t=0;i(this.attributes.length>=1);for(const e of this.attributes)t+=e.getSize();return t}writeBody(t){i(this.attributes.length>=1);for(const e of this.attributes)e.write(t);return t}readBody(t){for(this.attributes[0].read(t);t.left();){const e=d.read(t);this.attributes.push(e)}return this}clean(){return 1===this.attributes.length&&this.attributes[0].clean()}format(){return{type:this.constructor.name,attributes:this.attributes}}}class d extends n.Sequence{constructor(t,e){super(),this.id=new n.OID(t),this.value=new n.Any(e)}getBodySize(){let t=0;return t+=this.id.getSize(),t+=this.value.getSize(),t}writeBody(t){return this.id.write(t),this.value.write(t),t}readBody(t){return this.id.read(t),this.value.read(t),this}clean(){return this.id.clean()&&this.value.clean()}format(){return{type:this.constructor.name,id:this.id,value:this.value}}}class l extends n.Sequence{constructor(){super(),this.notBefore=new b,this.notAfter=new b}getBodySize(){let t=0;return t+=this.notBefore.getSize(),t+=this.notAfter.getSize(),t}writeBody(t){return this.notBefore.write(t),this.notAfter.write(t),t}readBody(t){return this.notBefore.read(t),this.notAfter.read(t),this}clean(){return this.notBefore.clean()&&this.notAfter.clean()}format(){return{type:this.constructor.name,notBefore:this.notBefore,notAfter:this.notAfter}}}class b extends n.Choice{constructor(t){super(new n.UTCTime,t)}choices(){return[o.UTCTIME,o.GENTIME]}}class p extends n.Sequence{constructor(t,e,r){super(),this.algorithm=new c(t,e),this.publicKey=new n.BitString(r)}get isRaw(){return!0}getBodySize(){let t=0;return t+=this.algorithm.getSize(),t+=this.publicKey.getSize(),t}writeBody(t){return this.algorithm.write(t),this.publicKey.write(t),t}readBody(t){return this.algorithm.read(t),this.publicKey.read(t),this}clean(){return this.algorithm.clean()&&this.publicKey.clean()}toPEM(){return s.toPEM(this.encode(),"PUBLIC KEY")}fromPEM(t){const e=s.fromPEM(t,"PUBLIC KEY");return this.decode(e)}format(){return{type:this.constructor.name,algorithm:this.algorithm,publicKey:this.publicKey}}}class m extends n.Sequence{constructor(){super(),this.extensions=[]}getBodySize(){let t=0;for(const e of this.extensions)t+=e.getSize();return t}writeBody(t){for(const e of this.extensions)e.write(t);return t}readBody(t){for(const e of this.extensions)e.read(t);return this}clean(){return 0===this.extensions.length}format(){return{type:this.constructor.name,extensions:this.extensions}}}class g extends n.Sequence{constructor(){super(),this.extnID=new n.OID,this.critical=(new n.Bool).optional(),this.extnValue=new n.OctString}getBodySize(){let t=0;return t+=this.extnID.getSize(),t+=this.critical.getSize(),t+=this.extnValue.getSize(),t}writeBody(t){return this.extnID.write(t),this.critical.write(t),this.extnValue.write(t),t}readBody(t){return this.extnID.read(t),this.critical.read(t),this.extnValue.read(t),this}clean(){return this.extnID.clean()&&this.critical.clean()&&this.extnValue.clean()}format(){return{type:this.constructor.name,extnID:this.extnID,critical:this.critical,extnValue:this.extnValue}}}class w extends n.Sequence{constructor(t,e){super(),this.algorithm=new c(t),this.algorithm.parameters.optional(!1),this.digest=new n.OctString(e)}getBodySize(){let t=0;return t+=this.algorithm.getSize(),t+=this.digest.getSize(),t}writeBody(t){return this.algorithm.write(t),this.digest.write(t),t}readBody(t){return this.algorithm.read(t),this.digest.read(t),this}clean(){return this.algorithm.clean()&&this.digest.clean()}format(){return{type:this.constructor.name,algorithm:this.algorithm,digest:this.digest}}}e.Certificate=f,e.TBSCertificate=a,e.AlgorithmIdentifier=c,e.RDNSequence=h,e.RDN=u,e.Attribute=d,e.Validity=l,e.Time=b,e.SubjectPublicKeyInfo=p,e.Extensions=m,e.Extension=g,e.DigestInfo=w},function(t,e,r){"use strict";
/*!
 * sec1.js - SEC1 encoding for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009, The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Resources:
 *   http://www.secg.org/sec1-v2.pdf
 *   https://github.com/openssl/openssl/blob/master/crypto/ec/ec_asn1.c
 *   https://github.com/golang/go/blob/master/src/crypto/x509/sec1.go
 *   https://tools.ietf.org/html/rfc5915
 */const i=r(14),n=r(9);class s extends i.Sequence{constructor(t,e,r,n){super(),this.version=new i.Unsigned(t),this.privateKey=new i.OctString(e),this.namedCurveOID=new i.OID(r).explicit(0).optional(),this.publicKey=new i.BitString(n).explicit(1).optional()}getBodySize(){let t=0;return t+=this.version.getSize(),t+=this.privateKey.getSize(),t+=this.namedCurveOID.getSize(),t+=this.publicKey.getSize(),t}writeBody(t){return this.version.write(t),this.privateKey.write(t),this.namedCurveOID.write(t),this.publicKey.write(t),t}readBody(t){return this.version.read(t),this.privateKey.read(t),this.namedCurveOID.read(t),this.publicKey.read(t),this}clean(){return this.version.clean()&&this.privateKey.clean()&&this.namedCurveOID.clean()&&this.publicKey.clean()}toPEM(){return n.toPEM(this.encode(),"EC PRIVATE KEY")}fromPEM(t){const e=n.fromPEM(t,"EC PRIVATE KEY");return this.decode(e)}format(){return{type:this.constructor.name,version:this.version,privateKey:this.privateKey,namedCurveOID:this.namedCurveOID,publicKey:this.publicKey}}}class o extends i.Sequence{constructor(t,e){super(),this.r=new i.Unsigned(t),this.s=new i.Unsigned(e)}getBodySize(){let t=0;return t+=this.r.getSize(),t+=this.s.getSize(),t}writeBody(t){return this.r.write(t),this.s.write(t),t}readBody(t){return this.r.read(t),this.s.read(t),this}clean(){return this.r.clean()&&this.s.clean()}toPEM(){return n.toPEM(this.encode(),"EC SIGNATURE")}fromPEM(t){const e=n.fromPEM(t,"EC SIGNATURE");return this.decode(e)}format(){return{type:this.constructor.name,r:this.r,s:this.s}}}e.ECPrivateKey=s,e.ECDSASignature=o},function(t,e,r){"use strict";(function(e){
/*!
 * ripemd160.js - RIPEMD160 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/hash.js:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/hash.js
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/RIPEMD-160
 *   https://homes.esat.kuleuven.be/~bosselae/ripemd160/pdf/AB-9601/AB-9601.pdf
 *   https://github.com/indutny/hash.js/blob/master/lib/hash/ripemd.js
 */
const i=r(1),n=r(3),s=e.alloc(8,0),o=e.alloc(64,0);o[0]=128;const f=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),a=new Uint8Array([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=new Uint8Array([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=new Uint8Array([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]);class u{constructor(){this.state=new Uint32Array(5),this.msg=new Uint32Array(16),this.block=e.alloc(64),this.size=-1}init(){return this.state[0]=1732584193,this.state[1]=4023233417,this.state[2]=2562383102,this.state[3]=271733878,this.state[4]=3285377520,this.size=0,this}update(t){return i(e.isBuffer(t)),this._update(t,t.length),this}final(){return this._final(e.alloc(20))}_update(t,e){i(-1!==this.size,"Context is not initialized.");let r=63&this.size,n=0;if(this.size+=e,r>0){let i=64-r;if(i>e&&(i=e),t.copy(this.block,r,n,n+i),r+=i,e-=i,n+=i,r<64)return;this._transform(this.block,0)}for(;e>=64;)this._transform(t,n),n+=64,e-=64;e>0&&t.copy(this.block,0,n,n+e)}_final(t){i(-1!==this.size,"Context is not initialized.");const e=63&this.size,r=8*this.size;m(s,r>>>0,0),m(s,r*(1/4294967296)>>>0,4),this._update(o,1+(119-e&63)),this._update(s,8);for(let e=0;e<5;e++)m(t,this.state[e],4*e),this.state[e]=0;for(let t=0;t<16;t++)this.msg[t]=0;for(let t=0;t<64;t++)this.block[t]=0;return this.size=-1,t}_transform(t,e){const r=this.msg;let i=this.state[0],n=this.state[1],s=this.state[2],o=this.state[3],u=this.state[4],m=i,g=n,w=s,y=o,v=u;for(let i=0;i<16;i++)r[i]=(E=e+4*i,(S=t)[E++]+256*S[E++]+65536*S[E++]+16777216*S[E]);var S,E;for(let t=0;t<80;t++){let e=i+l(t,n,s,o)+r[f[t]]+b(t),S=d(e,c[t]),E=S+u;i=u,u=o,o=d(s,10),s=n,n=E,e=m+l(79-t,g,w,y)+r[a[t]]+p(t),S=d(e,h[t]),E=S+v,m=v,v=y,y=d(w,10),w=g,g=E}const M=this.state[1]+s+y;this.state[1]=this.state[2]+o+v,this.state[2]=this.state[3]+u+m,this.state[3]=this.state[4]+i+g,this.state[4]=this.state[0]+n+w,this.state[0]=M}static hash(){return new u}static hmac(){return new n(u,64)}static digest(t){return u.ctx.init().update(t).final()}static root(t,r){return i(e.isBuffer(t)&&20===t.length),i(e.isBuffer(r)&&20===r.length),u.ctx.init().update(t).update(r).final()}static multi(t,e,r){const{ctx:i}=u;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return u.hmac().init(e).update(t).final()}}function d(t,e){return t<<e|t>>>32-e}function l(t,e,r,i){return t<=15?e^r^i:t<=31?e&r|~e&i:t<=47?(e|~r)^i:t<=63?e&i|r&~i:e^(r|~i)}function b(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function p(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}function m(t,e,r){return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}u.native=0,u.id="RIPEMD160",u.size=20,u.bits=160,u.blockSize=64,u.zero=e.alloc(20,0),u.ctx=new u,t.exports=u}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * sha1.js - SHA1 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/hash.js:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/hash.js
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/SHA-1
 *   https://tools.ietf.org/html/rfc3174
 *   http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf
 *   https://github.com/indutny/hash.js/blob/master/lib/hash/sha/1.js
 */
const i=r(1),n=r(3),s=e.alloc(8,0),o=e.alloc(64,0);o[0]=128;const f=new Uint32Array([1518500249,1859775393,2400959708,3395469782]);class a{constructor(){this.state=new Uint32Array(5),this.msg=new Uint32Array(80),this.block=e.alloc(64),this.size=-1}init(){return this.state[0]=1732584193,this.state[1]=4023233417,this.state[2]=2562383102,this.state[3]=271733878,this.state[4]=3285377520,this.size=0,this}update(t){return i(e.isBuffer(t)),this._update(t,t.length),this}final(){return this._final(e.alloc(20))}_update(t,e){i(-1!==this.size,"Context is not initialized.");let r=63&this.size,n=0;if(this.size+=e,r>0){let i=64-r;if(i>e&&(i=e),t.copy(this.block,r,n,n+i),r+=i,e-=i,n+=i,r<64)return;this._transform(this.block,0)}for(;e>=64;)this._transform(t,n),n+=64,e-=64;e>0&&t.copy(this.block,0,n,n+e)}_final(t){i(-1!==this.size,"Context is not initialized.");const e=63&this.size,r=8*this.size;u(s,r*(1/4294967296)>>>0,0),u(s,r>>>0,4),this._update(o,1+(119-e&63)),this._update(s,8);for(let e=0;e<5;e++)u(t,this.state[e],4*e),this.state[e]=0;for(let t=0;t<80;t++)this.msg[t]=0;for(let t=0;t<64;t++)this.block[t]=0;return this.size=-1,t}_transform(t,e){const r=this.msg;let i=this.state[0],n=this.state[1],s=this.state[2],o=this.state[3],a=this.state[4],u=0;for(;u<16;u++)r[u]=(l=e+4*u,16777216*(d=t)[l++]+65536*d[l++]+256*d[l++]+d[l]);for(var d,l;u<80;u++)r[u]=c(r[u-3]^r[u-8]^r[u-14]^r[u-16],1);for(u=0;u<80;u++){const t=u/20|0,e=c(i,5)+h(t,n,s,o)+a+r[u]+f[t];a=o,o=s,s=c(n,30),n=i,i=e>>>0}this.state[0]+=i,this.state[1]+=n,this.state[2]+=s,this.state[3]+=o,this.state[4]+=a}static hash(){return new a}static hmac(){return new n(a,64)}static digest(t){return a.ctx.init().update(t).final()}static root(t,r){return i(e.isBuffer(t)&&20===t.length),i(e.isBuffer(r)&&20===r.length),a.ctx.init().update(t).update(r).final()}static multi(t,e,r){const{ctx:i}=a;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return a.hmac().init(e).update(t).final()}}function c(t,e){return t<<e|t>>>32-e}function h(t,e,r,i){return 0===t?function(t,e,r){return t&e^~t&r}(e,r,i):1===t||3===t?function(t,e,r){return t^e^r}(e,r,i):2===t?function(t,e,r){return t&e^t&r^e&r}(e,r,i):0}function u(t,e,r){return t[r++]=e>>>24,t[r++]=e>>>16,t[r++]=e>>>8,t[r++]=e,r}a.native=0,a.id="SHA1",a.size=20,a.bits=160,a.blockSize=64,a.zero=e.alloc(20,0),a.ctx=new a,t.exports=a}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * p256.js - p256 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(266)},function(t,e,r){"use strict";
/*!
 * p384.js - p384 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(267)},function(t,e,r){"use strict";
/*!
 * p521.js - p521 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(269)},function(t,e,r){"use strict";
/*!
 * pbkdf2.js - pbkdf2 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(270)},function(t,e,r){"use strict";
/*!
 * sha1.js - sha1 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(101)},function(t,e,r){"use strict";
/*!
 * ripemd160.js - ripemd160 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(100)},function(t,e,r){"use strict";
/*!
 * sha224.js - SHA224 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(272)},function(t,e,r){"use strict";
/*!
 * rsa.js - RSA for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(275)},function(t,e,r){"use strict";(function(t){
/*!
 * safe.js - constant-time equals for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009 The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Resources:
 *   https://github.com/golang/go/blob/master/src/crypto/subtle/constant_time.go
 */
const i=r(1);function n(t,e){return(t^e)-1>>>31}function s(t,e,r){return t&r-1|e&~(r-1)}function o(t,e){return t-e>>>31}function f(t,e){return e-t>>>31}e.safeCompare=function(e,r){if(i(t.isBuffer(e)),i(t.isBuffer(r)),n(e.length,0))return n(r.length,0);let s=e.length^r.length;for(let t=0;t<r.length;t++)s|=e[t%e.length]^r[t];return s-1>>>31},e.safeEqual=function(e,r){if(i(t.isBuffer(e)),i(t.isBuffer(r)),!n(e.length,r.length))return 0;let s=0;for(let t=0;t<e.length;t++)s|=e[t]^r[t];return s-1>>>31},e.safeEqualByte=function(t,e){return n(255&t,255&e)},e.safeEqualInt=n,e.safeSelect=s,e.safeLT=o,e.safeLTE=function(t,e){return t-e-1>>>31},e.safeGT=f,e.safeGTE=function(t,e){return e-t-1>>>31},e.safeMin=function(t,e){return s(t,e,o(e,t))},e.safeMax=function(t,e){return s(t,e,f(e,t))},e.safeAbs=function(t){return(0|t)*(t>>31|1)},e.safeBool=function(t){return 1&(t>>31|-t>>31)},e.safeCopy=function(e,r,s){i(t.isBuffer(e)),i(t.isBuffer(r)),i(n(e.length,r.length));const o=s-1&255,f=255&~(s-1);for(let t=0;t<e.length;t++)e[t]=e[t]&o|r[t]&f}}).call(this,r(0).Buffer)},function(t){t.exports=JSON.parse('{"naf":{"width":9,"points":[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","0ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","02de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","02972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","0d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["049370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","091b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","0673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","0a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","09414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["078c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","04f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","073867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["0336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","060660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","0b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["04e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["0c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","021ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","0c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","09731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","0cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","0712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]},"doubles":{"step":4,"points":[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","04e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["06f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["0948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","0e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","067c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["0928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","0d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["08ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]}}')},function(t,e,r){"use strict";(function(t){var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&i(e,t,r);return n(e,t),e},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.tapRoot=e.treeHelper=e.tagHash=e.publicKeyTweakCheckWithPrefix=e.publicKeyTweakCheck=e.tweakAdd=void 0;var f=o(r(8)),a=r(42),c=r(41),h=s(r(298)),u=o(r(67)),d=r(113),l=o(r(301));e.tweakAdd=function(r,i){if(32!==r.bytes.length)throw"Pubkey length must be equal 32 byte";var n=f.default.fromHex(u.default.schnorr.publicKeyTweakAdd(t.from(r.hex,"hex"),t.from(i.hex,"hex")).toString("hex"));return(0,e.publicKeyTweakCheck)(r,i,n)};e.publicKeyTweakCheck=function(e,r,i){if(32!==e.bytes.length)throw"Pubkey length must be equal 32 byte";return u.default.schnorr.publicKeyTweakCheck(t.from(e.hex,"hex"),t.from(r.hex,"hex"),t.from(i.hex,"hex"),!0)?f.default.fromHex("03"+i.hex):f.default.fromHex("02"+i.hex)};e.publicKeyTweakCheckWithPrefix=function(e,r,i){if(32!==e.bytes.length)throw"Pubkey length must be equal 32 byte";var n=i.bytes.slice(1,i.bytes.length),s=f.default.fromBytes(n);return u.default.schnorr.publicKeyTweakCheck(t.from(e.hex,"hex"),t.from(r.hex,"hex"),t.from(s.hex,"hex"),3===i.bytes[0])};e.tagHash=function(t,e){var r=(0,a.sha256)(f.default.fromText(t)).toString();return r=(r=r.concat(r)).concat((0,c.toHexString)(e.bytes)),(0,a.sha256)(f.default.fromHex(r)).toString()};e.treeHelper=function(t,r){var i="",n="c4"===r?"TapLeaf/elements":"TapLeaf";return t.forEach((function(t){var s=l.default.encode(t.bytes.length).toString("hex"),o=r+s+t.hex,a=(0,e.tagHash)(n,f.default.fromHex(o));i+=a})),i};e.tapRoot=function(t,r,i){var n=i===d.TAPROOT_VERSION.LIQUID?"c4":"c0",s=i===d.TAPROOT_VERSION.LIQUID?"TapTweak/elements":"TapTweak",o=(0,e.treeHelper)(r,n);console.log("tap leaf result",o);var a=(0,e.tagHash)(s,f.default.fromHex(t.hex+o));console.log("tap tweak result",a);var c=(0,e.tweakAdd)(t,f.default.fromHex(a));console.log("tap tweaked result:",c.hex);var u=c.hex.substr(2);console.log("final tweaked",u);var l=h.encode("bc",1,f.default.fromHex(u).bytes)||"",b=f.default.fromHex("51"+f.default.fromNumber(u.length/2).hex+u);return console.log("script pub key",b.hex),{scriptPubKey:b,tweak:c,bech32:l}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TAPROOT_VERSION=void 0;var i=r(300);Object.defineProperty(e,"TAPROOT_VERSION",{enumerable:!0,get:function(){return i.TAPROOT_VERSION}})},function(t,e,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&i(e,t,r);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.TAPROOT_VERSION=e.taproot=e.stacks=e.splices=e.locktime=e.introspection=e.crypto=e.arithmetics64=e.conversion=e.bitwise=e.arithmetics=void 0;var o=s(r(115));e.arithmetics=o;var f=s(r(116));e.bitwise=f;var a=s(r(57));e.conversion=a;var c=s(r(118));e.arithmetics64=c;var h=s(r(42));e.crypto=h;var u=s(r(303));e.introspection=u;var d=s(r(304));e.locktime=d;var l=s(r(305));e.splices=l;var b=s(r(306));e.stacks=b;var p=s(r(112));e.taproot=p;var m=r(113);Object.defineProperty(e,"TAPROOT_VERSION",{enumerable:!0,get:function(){return m.TAPROOT_VERSION}})},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.withIn=e.max=e.min=e.graterThanOrEqual=e.lessThanOrEqual=e.graterThan=e.lessThan=e.numNotEqual=e.numEqualVerify=e.numEqual=e.boolOr=e.boolAnd=e.rshift=e.lshift=e.div=e.mul=e.sub=e.add=e.notEqual0=e.not=e.abs=e.negate=e.sub1=e.add1=void 0;var n=i(r(8));e.add1=function(t){if(void 0!==t.number){var e=t.number+1;return n.default.fromNumber(e)}throw"Error: this operation requires 1 valid number wizData"};e.sub1=function(t){if(void 0!==t.number){var e=t.number-1;return n.default.fromNumber(e)}throw"Error: this operation requires 1 valid number wizData"};e.negate=function(t){if(void 0!==t.number){var e=-1*t.number;return n.default.fromNumber(e)}throw"Error: this operation requires 1 valid number wizData"};e.abs=function(t){if(void 0!==t.number){var e=Math.abs(t.number);return n.default.fromNumber(e)}throw"Error: this operation requires 1 valid number wizData"};e.not=function(t){if(void 0!==t.number){var e=!t.number;return n.default.fromNumber(e?1:0)}throw"Error: this operation requires 1 valid number wizData"};e.notEqual0=function(t){if(void 0!==t.number){var e=!t.number;return n.default.fromNumber(e?0:1)}throw"Error: this operation requires 1 valid number wizData"};e.add=function(t,e){if(void 0!==t.number&&void 0!==e.number){var r=t.number+e.number;return n.default.fromNumber(r)}throw"Error: this operation requires 2 valid number wizData"};e.sub=function(t,e){if(void 0!==t.number&&void 0!==e.number){var r=t.number-e.number;return n.default.fromNumber(r)}throw"Error: this operation requires 2 valid number wizData"};e.mul=function(t,e){if(void 0!==t.number&&void 0!==e.number){var r=t.number*e.number;return n.default.fromNumber(r)}throw"Error: this operation requires 2 valid number wizData"};e.div=function(t,e){if(void 0!==t.number&&void 0!==e.number){if(0===e.number)throw"Error: dividing can't be eqaul 0.";var r=t.number/e.number;return r=r>0?Math.floor(r):Math.ceil(r),n.default.fromNumber(r)}throw"Error: this operation requires 2 valid number wizData"};e.lshift=function(t,e){if(void 0!==t.number&&void 0!==e.number){var r=t.number<<e.number;return n.default.fromNumber(r)}throw"Error: this operation requires 2 valid number wizData"};e.rshift=function(t,e){if(void 0!==t.number&&void 0!==e.number){var r=t.number>>e.number;return n.default.fromNumber(r)}throw"Error: this operation requires 2 valid number wizData"};e.boolAnd=function(t,e){if(void 0!==t.number&&void 0!==e.number)return 0===t.number||0===e.number?n.default.fromNumber(0):n.default.fromNumber(1);throw"Error: this operation requires 2 valid number wizData"};e.boolOr=function(t,e){if(void 0!==t.number&&void 0!==e.number)return 0===t.number&&0===e.number?n.default.fromNumber(0):n.default.fromNumber(1);throw"Error: this operation requires 2 valid number wizData"};e.numEqual=function(t,e){if(void 0!==t.number&&void 0!==e.number)return n.default.fromNumber(t.number===e.number?1:0);throw"Error: this operation requires 2 valid number wizData"};e.numEqualVerify=function(t,r){return(0,e.numEqual)(t,r)};e.numNotEqual=function(t,r){var i=1===(0,e.numEqual)(t,r).number;return n.default.fromNumber(i?0:1)};e.lessThan=function(t,e){if(void 0!==t.number&&void 0!==e.number)return n.default.fromNumber(t.number<e.number?1:0);throw"Error: this operation requires 2 valid number wizData"};e.graterThan=function(t,e){if(void 0!==t.number&&void 0!==e.number)return n.default.fromNumber(t.number>e.number?1:0);throw"Error: this operation requires 2 valid number wizData"};e.lessThanOrEqual=function(t,e){if(void 0!==t.number&&void 0!==e.number)return n.default.fromNumber(t.number<=e.number?1:0);throw"Error: this operation requires 2 valid number wizData"};e.graterThanOrEqual=function(t,e){if(void 0!==t.number&&void 0!==e.number)return n.default.fromNumber(t.number>=e.number?1:0);throw"Error: this operation requires 2 valid number wizData"};e.min=function(t,e){if(void 0!==t.number&&void 0!==e.number){if(t.number>=e.number)return e;if(e.number>t.number)return t}throw"Error: this operation requires 2 valid number wizData"};e.max=function(t,e){if(void 0!==t.number&&void 0!==e.number){if(t.number>=e.number)return t;if(e.number>t.number)return e}throw"Error: this operation requires 2 valid number wizData"};e.withIn=function(t,e,r){var i=t.number,s=e.number,o=r.number;if(void 0!==i&&void 0!==s&&void 0!==o)return i>=s&&i<=o?n.default.fromNumber(1):n.default.fromNumber(0);throw"Error: this operation requires 3 valid number wizData"}},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.equal=e.xor=e.or=e.and=e.invert=void 0;var n=i(r(8)),s=r(41);e.invert=function(t){var e=(0,s.flipbits)(t.bin);return n.default.fromBin(e)};e.and=function(t,e){var r=t.bin,i=e.bin;if(r.length===i.length){var s=r.split("").map((function(t){return+t})),o=i.split("").map((function(t){return+t})),f="";for(var a in s)f+=s[a]&o[a];return n.default.fromBin(f)}throw"Bitwise operation on operands of different lengths."};e.or=function(t,e){var r=t.bin,i=e.bin;if(r.length===i.length){var s=r.split("").map((function(t){return+t})),o=i.split("").map((function(t){return+t})),f="";for(var a in s)f+=s[a]|o[a];return n.default.fromBin(f)}throw"Bitwise operation on operands of different lengths."};e.xor=function(t,e){var r=t.bin,i=e.bin;if(r.length===i.length){var s=r.split("").map((function(t){return+t})),o=i.split("").map((function(t){return+t})),f="";for(var a in s)f+=s[a]^o[a];return n.default.fromBin(f)}throw"Bitwise operation on operands of different lengths."};e.equal=function(t,e){var r=t.hex===e.hex&&t.bin===e.bin;return n.default.fromNumber(r?1:0)}},function(t,e){},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.greaterThanOrEqual64=e.greaterThan64=e.lessThanOrEqual64=e.lessThan64=e.neg64=e.div64=e.mul64=e.sub64=e.add64=void 0;var n=i(r(8)),s=i(r(29)),o=r(41);e.add64=function(t,e){if(8!=t.bytes.length||8!=e.bytes.length)throw"Input bytes length must be equal 8 byte";var r=new s.default(t.bin,2),i=new s.default(e.bin,2),f="1"===r.toString(2).charAt(0);if(!f&&i.gt(o.MAX_INTEGER_64.sub(r))||f&&i.lt(o.MIN_INTEGER_64.sub(r)))return[n.default.fromNumber(0)];var a=r.add(i).toString(2,64).slice(-64);return[n.default.fromBin(a),n.default.fromNumber(1)]};e.sub64=function(t,e){if(8!=t.bytes.length||8!=e.bytes.length)throw"Input bytes length must be equal 8 byte";var r=new s.default(t.bin,2),i=new s.default(e.bin,2),f="1"===i.toString(2).charAt(0);if(!f&&r.lt(o.MIN_INTEGER_64.add(i))||f&&r.gt(o.MAX_INTEGER_64.add(i)))return[n.default.fromNumber(0)];var a=r.sub(i),c=a.toString(2,64);a.isNeg()&&(c=a.toTwos(64).toString(2,64));var h=c.slice(-64);return[n.default.fromBin(h),n.default.fromNumber(1)]};e.mul64=function(t,e){if(8!==t.bytes.length||8!==e.bytes.length)throw"Input bytes length must be equal 8 byte";var r=new s.default(t.bin,2),i=new s.default(e.bin,2),f="1"===r.toString(2).charAt(0);if(!f&&i.gt(o.ZERO_64)&&r.gt(o.MAX_INTEGER_64.div(i))||!f&&i.lt(o.ZERO_64)&&i.lt(o.MIN_INTEGER_64.div(r))||f&&i.gt(o.ZERO_64)&&r.lt(o.MIN_INTEGER_64.div(i))||f&&i.lt(o.ZERO_64)&&i.lt(o.MAX_INTEGER_64.div(r)))return[n.default.fromNumber(0)];var a=r.mul(i).toString(2,64).slice(-64);return[n.default.fromBin(a),n.default.fromNumber(1)]};e.div64=function(t,e){if(8!=t.bytes.length||8!=e.bytes.length)throw"Input bytes length must be equal 8 byte";var r=new s.default(t.bin,2),i=new s.default(e.bin,2);if(i.eq(o.ZERO_64)||i.eq(o.NEGATIVE_1_64)&&r.eq(o.MIN_INTEGER_64))return[n.default.fromNumber(0)];var f=r.mod(i),a=r.div(i);return f.lt(o.ZERO_64)&&i.gt(o.ZERO_64)?(f=f.add(i),a=a.sub(new s.default(1))):f.lt(o.ZERO_64)&&i.lt(o.ZERO_64)&&(f=f.sub(i),a=a.add(new s.default(1))),[n.default.fromBin(f.toString(2,64)),n.default.fromBin(a.toString(2,64)),n.default.fromNumber(1)]};e.neg64=function(t){if(8!=t.bytes.length)throw"Input bytes length must be equal 8 byte";var e=new s.default(t.bin,2);if(e.eq(o.MIN_INTEGER_64))return[n.default.fromNumber(0)];var r=e.neg().toTwos(64).toString(2,64);return[n.default.fromBin(r),n.default.fromNumber(1)]};e.lessThan64=function(t,e){if(8!=t.bytes.length||8!=e.bytes.length)throw"Input bytes length must be equal 8 byte";var r=new s.default(t.bin,2),i=new s.default(e.bin,2),o="1"===t.bin.charAt(0),f="1"===e.bin.charAt(0);return o&&!f?n.default.fromNumber(1):!o&&f?n.default.fromNumber(0):o&&f?n.default.fromNumber(i.neg().lt(r.neg())?1:0):n.default.fromNumber(r.lt(i)?1:0)};e.lessThanOrEqual64=function(t,e){if(8!=t.bytes.length||8!=e.bytes.length)throw"Input bytes length must be equal 8 byte";var r=new s.default(t.bin,2),i=new s.default(e.bin,2),o="1"===t.bin.charAt(0),f="1"===e.bin.charAt(0);return o&&!f?n.default.fromNumber(1):!o&&f?n.default.fromNumber(0):o&&f?n.default.fromNumber(i.neg().lte(r.neg())?1:0):n.default.fromNumber(r.lte(i)?1:0)};e.greaterThan64=function(t,e){if(8!=t.bytes.length||8!=e.bytes.length)throw"Input bytes length must be equal 8 byte";var r=new s.default(t.bin,2),i=new s.default(e.bin,2),o="1"===t.bin.charAt(0),f="1"===e.bin.charAt(0);return o&&!f?n.default.fromNumber(0):!o&&f?n.default.fromNumber(1):o&&f?n.default.fromNumber(i.neg().gt(r.neg())?1:0):n.default.fromNumber(r.gt(i)?1:0)};e.greaterThanOrEqual64=function(t,e){if(8!=t.bytes.length||8!=e.bytes.length)throw"Input bytes length must be equal 8 byte";var r=new s.default(t.bin,2),i=new s.default(e.bin,2),o="1"===t.bin.charAt(0),f="1"===e.bin.charAt(0);return o&&!f?n.default.fromNumber(0):!o&&f?n.default.fromNumber(1):o&&f?n.default.fromNumber(i.neg().gte(r.neg())?1:0):n.default.fromNumber(r.gte(i)?1:0)}},function(t,e,r){"use strict";e.byteLength=function(t){var e=c(t),r=e[0],i=e[1];return 3*(r+i)/4-i},e.toByteArray=function(t){var e,r,i=c(t),o=i[0],f=i[1],a=new s(function(t,e,r){return 3*(e+r)/4-r}(0,o,f)),h=0,u=f>0?o-4:o;for(r=0;r<u;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],a[h++]=e>>16&255,a[h++]=e>>8&255,a[h++]=255&e;2===f&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,a[h++]=255&e);1===f&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,a[h++]=e>>8&255,a[h++]=255&e);return a},e.fromByteArray=function(t){for(var e,r=t.length,n=r%3,s=[],o=0,f=r-n;o<f;o+=16383)s.push(h(t,o,o+16383>f?f:o+16383));1===n?(e=t[r-1],s.push(i[e>>2]+i[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],s.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"="));return s.join("")};for(var i=[],n=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,a=o.length;f<a;++f)i[f]=o[f],n[o.charCodeAt(f)]=f;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function h(t,e,r){for(var n,s,o=[],f=e;f<r;f+=3)n=(t[f]<<16&16711680)+(t[f+1]<<8&65280)+(255&t[f+2]),o.push(i[(s=n)>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,r,i,n){var s,o,f=8*n-i-1,a=(1<<f)-1,c=a>>1,h=-7,u=r?n-1:0,d=r?-1:1,l=t[e+u];for(u+=d,s=l&(1<<-h)-1,l>>=-h,h+=f;h>0;s=256*s+t[e+u],u+=d,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=i;h>0;o=256*o+t[e+u],u+=d,h-=8);if(0===s)s=1-c;else{if(s===a)return o?NaN:1/0*(l?-1:1);o+=Math.pow(2,i),s-=c}return(l?-1:1)*o*Math.pow(2,s-i)},e.write=function(t,e,r,i,n,s){var o,f,a,c=8*s-n-1,h=(1<<c)-1,u=h>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,l=i?0:s-1,b=i?1:-1,p=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(f=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-o))<1&&(o--,a*=2),(e+=o+u>=1?d/a:d*Math.pow(2,1-u))*a>=2&&(o++,a/=2),o+u>=h?(f=0,o=h):o+u>=1?(f=(e*a-1)*Math.pow(2,n),o+=u):(f=e*Math.pow(2,u-1)*Math.pow(2,n),o=0));n>=8;t[r+l]=255&f,l+=b,f/=256,n-=8);for(o=o<<n|f,c+=n;c>0;t[r+l]=255&o,l+=b,o/=256,c-=8);t[r+l-b]|=128*p}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e,r){var i;t.exports=(i=r(2),r(30),r(123),r(124),r(18),r(125),r(19),r(43),r(59),r(126),r(60),r(127),r(128),r(129),r(44),r(130),r(15),r(4),r(131),r(132),r(133),r(134),r(135),r(136),r(137),r(138),r(139),r(140),r(141),r(142),r(143),r(144),r(145),r(146),i)},function(t,e,r){var i;t.exports=(i=r(2),function(){if("function"==typeof ArrayBuffer){var t=i.lib.WordArray,e=t.init;(t.init=function(t){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(t instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)&&(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),t instanceof Uint8Array){for(var r=t.byteLength,i=[],n=0;n<r;n++)i[n>>>2]|=t[n]<<24-n%4*8;e.call(this,i,r)}else e.apply(this,arguments)}).prototype=t}}(),i.lib.WordArray)},function(t,e,r){var i;t.exports=(i=r(2),function(){var t=i,e=t.lib.WordArray,r=t.enc;function n(t){return t<<8&4278255360|t>>>8&16711935}r.Utf16=r.Utf16BE={stringify:function(t){for(var e=t.words,r=t.sigBytes,i=[],n=0;n<r;n+=2){var s=e[n>>>2]>>>16-n%4*8&65535;i.push(String.fromCharCode(s))}return i.join("")},parse:function(t){for(var r=t.length,i=[],n=0;n<r;n++)i[n>>>1]|=t.charCodeAt(n)<<16-n%2*16;return e.create(i,2*r)}},r.Utf16LE={stringify:function(t){for(var e=t.words,r=t.sigBytes,i=[],s=0;s<r;s+=2){var o=n(e[s>>>2]>>>16-s%4*8&65535);i.push(String.fromCharCode(o))}return i.join("")},parse:function(t){for(var r=t.length,i=[],s=0;s<r;s++)i[s>>>1]|=n(t.charCodeAt(s)<<16-s%2*16);return e.create(i,2*r)}}}(),i.enc.Utf16)},function(t,e,r){var i,n,s;t.exports=(s=r(2),n=(i=s).lib.WordArray,i.enc.Base64url={stringify:function(t,e=!0){var r=t.words,i=t.sigBytes,n=e?this._safe_map:this._map;t.clamp();for(var s=[],o=0;o<i;o+=3)for(var f=(r[o>>>2]>>>24-o%4*8&255)<<16|(r[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|r[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<i;a++)s.push(n.charAt(f>>>6*(3-a)&63));var c=n.charAt(64);if(c)for(;s.length%4;)s.push(c);return s.join("")},parse:function(t,e=!0){var r=t.length,i=e?this._safe_map:this._map,s=this._reverseMap;if(!s){s=this._reverseMap=[];for(var o=0;o<i.length;o++)s[i.charCodeAt(o)]=o}var f=i.charAt(64);if(f){var a=t.indexOf(f);-1!==a&&(r=a)}return function(t,e,r){for(var i=[],s=0,o=0;o<e;o++)if(o%4){var f=r[t.charCodeAt(o-1)]<<o%4*2,a=r[t.charCodeAt(o)]>>>6-o%4*2,c=f|a;i[s>>>2]|=c<<24-s%4*8,s++}return n.create(i,s)}(t,r,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"},s.enc.Base64url)},function(t,e,r){var i,n,s,o,f,a;t.exports=(a=r(2),r(59),n=(i=a).lib.WordArray,s=i.algo,o=s.SHA256,f=s.SHA224=o.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var t=o._doFinalize.call(this);return t.sigBytes-=4,t}}),i.SHA224=o._createHelper(f),i.HmacSHA224=o._createHmacHelper(f),a.SHA224)},function(t,e,r){var i,n,s,o,f,a,c,h;t.exports=(h=r(2),r(30),r(60),n=(i=h).x64,s=n.Word,o=n.WordArray,f=i.algo,a=f.SHA512,c=f.SHA384=a.extend({_doReset:function(){this._hash=new o.init([new s.init(3418070365,3238371032),new s.init(1654270250,914150663),new s.init(2438529370,812702999),new s.init(355462360,4144912697),new s.init(1731405415,4290775857),new s.init(2394180231,1750603025),new s.init(3675008525,1694076839),new s.init(1203062813,3204075428)])},_doFinalize:function(){var t=a._doFinalize.call(this);return t.sigBytes-=16,t}}),i.SHA384=a._createHelper(c),i.HmacSHA384=a._createHmacHelper(c),h.SHA384)},function(t,e,r){var i;t.exports=(i=r(2),r(30),function(t){var e=i,r=e.lib,n=r.WordArray,s=r.Hasher,o=e.x64.Word,f=e.algo,a=[],c=[],h=[];!function(){for(var t=1,e=0,r=0;r<24;r++){a[t+5*e]=(r+1)*(r+2)/2%64;var i=(2*t+3*e)%5;t=e%5,e=i}for(t=0;t<5;t++)for(e=0;e<5;e++)c[t+5*e]=e+(2*t+3*e)%5*5;for(var n=1,s=0;s<24;s++){for(var f=0,u=0,d=0;d<7;d++){if(1&n){var l=(1<<d)-1;l<32?u^=1<<l:f^=1<<l-32}128&n?n=n<<1^113:n<<=1}h[s]=o.create(f,u)}}();var u=[];!function(){for(var t=0;t<25;t++)u[t]=o.create()}();var d=f.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),_doReset:function(){for(var t=this._state=[],e=0;e<25;e++)t[e]=new o.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(t,e){for(var r=this._state,i=this.blockSize/2,n=0;n<i;n++){var s=t[e+2*n],o=t[e+2*n+1];s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),(B=r[n]).high^=o,B.low^=s}for(var f=0;f<24;f++){for(var d=0;d<5;d++){for(var l=0,b=0,p=0;p<5;p++)l^=(B=r[d+5*p]).high,b^=B.low;var m=u[d];m.high=l,m.low=b}for(d=0;d<5;d++){var g=u[(d+4)%5],w=u[(d+1)%5],y=w.high,v=w.low;for(l=g.high^(y<<1|v>>>31),b=g.low^(v<<1|y>>>31),p=0;p<5;p++)(B=r[d+5*p]).high^=l,B.low^=b}for(var S=1;S<25;S++){var E=(B=r[S]).high,M=B.low,A=a[S];A<32?(l=E<<A|M>>>32-A,b=M<<A|E>>>32-A):(l=M<<A-32|E>>>64-A,b=E<<A-32|M>>>64-A);var I=u[c[S]];I.high=l,I.low=b}var _=u[0],x=r[0];for(_.high=x.high,_.low=x.low,d=0;d<5;d++)for(p=0;p<5;p++){var B=r[S=d+5*p],k=u[S],z=u[(d+1)%5+5*p],q=u[(d+2)%5+5*p];B.high=k.high^~z.high&q.high,B.low=k.low^~z.low&q.low}B=r[0];var N=h[f];B.high^=N.high,B.low^=N.low}},_doFinalize:function(){var e=this._data,r=e.words,i=(this._nDataBytes,8*e.sigBytes),s=32*this.blockSize;r[i>>>5]|=1<<24-i%32,r[(t.ceil((i+1)/s)*s>>>5)-1]|=128,e.sigBytes=4*r.length,this._process();for(var o=this._state,f=this.cfg.outputLength/8,a=f/8,c=[],h=0;h<a;h++){var u=o[h],d=u.high,l=u.low;d=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),l=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8),c.push(l),c.push(d)}return new n.init(c,f)},clone:function(){for(var t=s.clone.call(this),e=t._state=this._state.slice(0),r=0;r<25;r++)e[r]=e[r].clone();return t}});e.SHA3=s._createHelper(d),e.HmacSHA3=s._createHmacHelper(d)}(Math),i.SHA3)},function(t,e,r){var i;t.exports=(i=r(2),
/** @preserve
	(c) 2012 by Cédric Mesnil. All rights reserved.

	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	*/
function(t){var e=i,r=e.lib,n=r.WordArray,s=r.Hasher,o=e.algo,f=n.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),a=n.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=n.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=n.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=n.create([0,1518500249,1859775393,2400959708,2840853838]),d=n.create([1352829926,1548603684,1836072691,2053994217,0]),l=o.RIPEMD160=s.extend({_doReset:function(){this._hash=n.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var r=0;r<16;r++){var i=e+r,n=t[i];t[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}var s,o,l,v,S,E,M,A,I,_,x,B=this._hash.words,k=u.words,z=d.words,q=f.words,N=a.words,P=c.words,R=h.words;for(E=s=B[0],M=o=B[1],A=l=B[2],I=v=B[3],_=S=B[4],r=0;r<80;r+=1)x=s+t[e+q[r]]|0,x+=r<16?b(o,l,v)+k[0]:r<32?p(o,l,v)+k[1]:r<48?m(o,l,v)+k[2]:r<64?g(o,l,v)+k[3]:w(o,l,v)+k[4],x=(x=y(x|=0,P[r]))+S|0,s=S,S=v,v=y(l,10),l=o,o=x,x=E+t[e+N[r]]|0,x+=r<16?w(M,A,I)+z[0]:r<32?g(M,A,I)+z[1]:r<48?m(M,A,I)+z[2]:r<64?p(M,A,I)+z[3]:b(M,A,I)+z[4],x=(x=y(x|=0,R[r]))+_|0,E=_,_=I,I=y(A,10),A=M,M=x;x=B[1]+l+I|0,B[1]=B[2]+v+_|0,B[2]=B[3]+S+E|0,B[3]=B[4]+s+M|0,B[4]=B[0]+o+A|0,B[0]=x},_doFinalize:function(){var t=this._data,e=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(e.length+1),this._process();for(var n=this._hash,s=n.words,o=0;o<5;o++){var f=s[o];s[o]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8)}return n},clone:function(){var t=s.clone.call(this);return t._hash=this._hash.clone(),t}});function b(t,e,r){return t^e^r}function p(t,e,r){return t&e|~t&r}function m(t,e,r){return(t|~e)^r}function g(t,e,r){return t&r|e&~r}function w(t,e,r){return t^(e|~r)}function y(t,e){return t<<e|t>>>32-e}e.RIPEMD160=s._createHelper(l),e.HmacRIPEMD160=s._createHmacHelper(l)}(Math),i.RIPEMD160)},function(t,e,r){var i,n,s,o,f,a,c,h,u;t.exports=(u=r(2),r(43),r(44),n=(i=u).lib,s=n.Base,o=n.WordArray,f=i.algo,a=f.SHA1,c=f.HMAC,h=f.PBKDF2=s.extend({cfg:s.extend({keySize:4,hasher:a,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var r=this.cfg,i=c.create(r.hasher,t),n=o.create(),s=o.create([1]),f=n.words,a=s.words,h=r.keySize,u=r.iterations;f.length<h;){var d=i.update(e).finalize(s);i.reset();for(var l=d.words,b=l.length,p=d,m=1;m<u;m++){p=i.finalize(p),i.reset();for(var g=p.words,w=0;w<b;w++)l[w]^=g[w]}n.concat(d),a[0]++}return n.sigBytes=4*h,n}}),i.PBKDF2=function(t,e,r){return h.create(r).compute(t,e)},u.PBKDF2)},function(t,e,r){var i;t.exports=(i=r(2),r(4),i.mode.CFB=function(){var t=i.lib.BlockCipherMode.extend();function e(t,e,r,i){var n,s=this._iv;s?(n=s.slice(0),this._iv=void 0):n=this._prevBlock,i.encryptBlock(n,0);for(var o=0;o<r;o++)t[e+o]^=n[o]}return t.Encryptor=t.extend({processBlock:function(t,r){var i=this._cipher,n=i.blockSize;e.call(this,t,r,n,i),this._prevBlock=t.slice(r,r+n)}}),t.Decryptor=t.extend({processBlock:function(t,r){var i=this._cipher,n=i.blockSize,s=t.slice(r,r+n);e.call(this,t,r,n,i),this._prevBlock=s}}),t}(),i.mode.CFB)},function(t,e,r){var i,n,s;t.exports=(s=r(2),r(4),s.mode.CTR=(i=s.lib.BlockCipherMode.extend(),n=i.Encryptor=i.extend({processBlock:function(t,e){var r=this._cipher,i=r.blockSize,n=this._iv,s=this._counter;n&&(s=this._counter=n.slice(0),this._iv=void 0);var o=s.slice(0);r.encryptBlock(o,0),s[i-1]=s[i-1]+1|0;for(var f=0;f<i;f++)t[e+f]^=o[f]}}),i.Decryptor=n,i),s.mode.CTR)},function(t,e,r){var i;t.exports=(i=r(2),r(4),
/** @preserve
	 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
	 * derived from CryptoJS.mode.CTR
	 * Jan Hruby jhruby.web@gmail.com
	 */
i.mode.CTRGladman=function(){var t=i.lib.BlockCipherMode.extend();function e(t){if(255==(t>>24&255)){var e=t>>16&255,r=t>>8&255,i=255&t;255===e?(e=0,255===r?(r=0,255===i?i=0:++i):++r):++e,t=0,t+=e<<16,t+=r<<8,t+=i}else t+=1<<24;return t}var r=t.Encryptor=t.extend({processBlock:function(t,r){var i=this._cipher,n=i.blockSize,s=this._iv,o=this._counter;s&&(o=this._counter=s.slice(0),this._iv=void 0),function(t){0===(t[0]=e(t[0]))&&(t[1]=e(t[1]))}(o);var f=o.slice(0);i.encryptBlock(f,0);for(var a=0;a<n;a++)t[r+a]^=f[a]}});return t.Decryptor=r,t}(),i.mode.CTRGladman)},function(t,e,r){var i,n,s;t.exports=(s=r(2),r(4),s.mode.OFB=(i=s.lib.BlockCipherMode.extend(),n=i.Encryptor=i.extend({processBlock:function(t,e){var r=this._cipher,i=r.blockSize,n=this._iv,s=this._keystream;n&&(s=this._keystream=n.slice(0),this._iv=void 0),r.encryptBlock(s,0);for(var o=0;o<i;o++)t[e+o]^=s[o]}}),i.Decryptor=n,i),s.mode.OFB)},function(t,e,r){var i,n;t.exports=(n=r(2),r(4),n.mode.ECB=((i=n.lib.BlockCipherMode.extend()).Encryptor=i.extend({processBlock:function(t,e){this._cipher.encryptBlock(t,e)}}),i.Decryptor=i.extend({processBlock:function(t,e){this._cipher.decryptBlock(t,e)}}),i),n.mode.ECB)},function(t,e,r){var i;t.exports=(i=r(2),r(4),i.pad.AnsiX923={pad:function(t,e){var r=t.sigBytes,i=4*e,n=i-r%i,s=r+n-1;t.clamp(),t.words[s>>>2]|=n<<24-s%4*8,t.sigBytes+=n},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},i.pad.Ansix923)},function(t,e,r){var i;t.exports=(i=r(2),r(4),i.pad.Iso10126={pad:function(t,e){var r=4*e,n=r-t.sigBytes%r;t.concat(i.lib.WordArray.random(n-1)).concat(i.lib.WordArray.create([n<<24],1))},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},i.pad.Iso10126)},function(t,e,r){var i;t.exports=(i=r(2),r(4),i.pad.Iso97971={pad:function(t,e){t.concat(i.lib.WordArray.create([2147483648],1)),i.pad.ZeroPadding.pad(t,e)},unpad:function(t){i.pad.ZeroPadding.unpad(t),t.sigBytes--}},i.pad.Iso97971)},function(t,e,r){var i;t.exports=(i=r(2),r(4),i.pad.ZeroPadding={pad:function(t,e){var r=4*e;t.clamp(),t.sigBytes+=r-(t.sigBytes%r||r)},unpad:function(t){var e=t.words,r=t.sigBytes-1;for(r=t.sigBytes-1;r>=0;r--)if(e[r>>>2]>>>24-r%4*8&255){t.sigBytes=r+1;break}}},i.pad.ZeroPadding)},function(t,e,r){var i;t.exports=(i=r(2),r(4),i.pad.NoPadding={pad:function(){},unpad:function(){}},i.pad.NoPadding)},function(t,e,r){var i,n,s,o;t.exports=(o=r(2),r(4),n=(i=o).lib.CipherParams,s=i.enc.Hex,i.format.Hex={stringify:function(t){return t.ciphertext.toString(s)},parse:function(t){var e=s.parse(t);return n.create({ciphertext:e})}},o.format.Hex)},function(t,e,r){var i;t.exports=(i=r(2),r(18),r(19),r(15),r(4),function(){var t=i,e=t.lib.BlockCipher,r=t.algo,n=[],s=[],o=[],f=[],a=[],c=[],h=[],u=[],d=[],l=[];!function(){for(var t=[],e=0;e<256;e++)t[e]=e<128?e<<1:e<<1^283;var r=0,i=0;for(e=0;e<256;e++){var b=i^i<<1^i<<2^i<<3^i<<4;b=b>>>8^255&b^99,n[r]=b,s[b]=r;var p=t[r],m=t[p],g=t[m],w=257*t[b]^16843008*b;o[r]=w<<24|w>>>8,f[r]=w<<16|w>>>16,a[r]=w<<8|w>>>24,c[r]=w,w=16843009*g^65537*m^257*p^16843008*r,h[b]=w<<24|w>>>8,u[b]=w<<16|w>>>16,d[b]=w<<8|w>>>24,l[b]=w,r?(r=p^t[t[t[g^p]]],i^=t[t[i]]):r=i=1}}();var b=[0,1,2,4,8,16,32,64,128,27,54],p=r.AES=e.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var t=this._keyPriorReset=this._key,e=t.words,r=t.sigBytes/4,i=4*((this._nRounds=r+6)+1),s=this._keySchedule=[],o=0;o<i;o++)o<r?s[o]=e[o]:(c=s[o-1],o%r?r>6&&o%r==4&&(c=n[c>>>24]<<24|n[c>>>16&255]<<16|n[c>>>8&255]<<8|n[255&c]):(c=n[(c=c<<8|c>>>24)>>>24]<<24|n[c>>>16&255]<<16|n[c>>>8&255]<<8|n[255&c],c^=b[o/r|0]<<24),s[o]=s[o-r]^c);for(var f=this._invKeySchedule=[],a=0;a<i;a++){if(o=i-a,a%4)var c=s[o];else c=s[o-4];f[a]=a<4||o<=4?c:h[n[c>>>24]]^u[n[c>>>16&255]]^d[n[c>>>8&255]]^l[n[255&c]]}}},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,o,f,a,c,n)},decryptBlock:function(t,e){var r=t[e+1];t[e+1]=t[e+3],t[e+3]=r,this._doCryptBlock(t,e,this._invKeySchedule,h,u,d,l,s),r=t[e+1],t[e+1]=t[e+3],t[e+3]=r},_doCryptBlock:function(t,e,r,i,n,s,o,f){for(var a=this._nRounds,c=t[e]^r[0],h=t[e+1]^r[1],u=t[e+2]^r[2],d=t[e+3]^r[3],l=4,b=1;b<a;b++){var p=i[c>>>24]^n[h>>>16&255]^s[u>>>8&255]^o[255&d]^r[l++],m=i[h>>>24]^n[u>>>16&255]^s[d>>>8&255]^o[255&c]^r[l++],g=i[u>>>24]^n[d>>>16&255]^s[c>>>8&255]^o[255&h]^r[l++],w=i[d>>>24]^n[c>>>16&255]^s[h>>>8&255]^o[255&u]^r[l++];c=p,h=m,u=g,d=w}p=(f[c>>>24]<<24|f[h>>>16&255]<<16|f[u>>>8&255]<<8|f[255&d])^r[l++],m=(f[h>>>24]<<24|f[u>>>16&255]<<16|f[d>>>8&255]<<8|f[255&c])^r[l++],g=(f[u>>>24]<<24|f[d>>>16&255]<<16|f[c>>>8&255]<<8|f[255&h])^r[l++],w=(f[d>>>24]<<24|f[c>>>16&255]<<16|f[h>>>8&255]<<8|f[255&u])^r[l++],t[e]=p,t[e+1]=m,t[e+2]=g,t[e+3]=w},keySize:8});t.AES=e._createHelper(p)}(),i.AES)},function(t,e,r){var i;t.exports=(i=r(2),r(18),r(19),r(15),r(4),function(){var t=i,e=t.lib,r=e.WordArray,n=e.BlockCipher,s=t.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],f=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],a=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],u=s.DES=n.extend({_doReset:function(){for(var t=this._key.words,e=[],r=0;r<56;r++){var i=o[r]-1;e[r]=t[i>>>5]>>>31-i%32&1}for(var n=this._subKeys=[],s=0;s<16;s++){var c=n[s]=[],h=a[s];for(r=0;r<24;r++)c[r/6|0]|=e[(f[r]-1+h)%28]<<31-r%6,c[4+(r/6|0)]|=e[28+(f[r+24]-1+h)%28]<<31-r%6;for(c[0]=c[0]<<1|c[0]>>>31,r=1;r<7;r++)c[r]=c[r]>>>4*(r-1)+3;c[7]=c[7]<<5|c[7]>>>27}var u=this._invSubKeys=[];for(r=0;r<16;r++)u[r]=n[15-r]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._subKeys)},decryptBlock:function(t,e){this._doCryptBlock(t,e,this._invSubKeys)},_doCryptBlock:function(t,e,r){this._lBlock=t[e],this._rBlock=t[e+1],d.call(this,4,252645135),d.call(this,16,65535),l.call(this,2,858993459),l.call(this,8,16711935),d.call(this,1,1431655765);for(var i=0;i<16;i++){for(var n=r[i],s=this._lBlock,o=this._rBlock,f=0,a=0;a<8;a++)f|=c[a][((o^n[a])&h[a])>>>0];this._lBlock=o,this._rBlock=s^f}var u=this._lBlock;this._lBlock=this._rBlock,this._rBlock=u,d.call(this,1,1431655765),l.call(this,8,16711935),l.call(this,2,858993459),d.call(this,16,65535),d.call(this,4,252645135),t[e]=this._lBlock,t[e+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function d(t,e){var r=(this._lBlock>>>t^this._rBlock)&e;this._rBlock^=r,this._lBlock^=r<<t}function l(t,e){var r=(this._rBlock>>>t^this._lBlock)&e;this._lBlock^=r,this._rBlock^=r<<t}t.DES=n._createHelper(u);var b=s.TripleDES=n.extend({_doReset:function(){var t=this._key.words;if(2!==t.length&&4!==t.length&&t.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var e=t.slice(0,2),i=t.length<4?t.slice(0,2):t.slice(2,4),n=t.length<6?t.slice(0,2):t.slice(4,6);this._des1=u.createEncryptor(r.create(e)),this._des2=u.createEncryptor(r.create(i)),this._des3=u.createEncryptor(r.create(n))},encryptBlock:function(t,e){this._des1.encryptBlock(t,e),this._des2.decryptBlock(t,e),this._des3.encryptBlock(t,e)},decryptBlock:function(t,e){this._des3.decryptBlock(t,e),this._des2.encryptBlock(t,e),this._des1.decryptBlock(t,e)},keySize:6,ivSize:2,blockSize:2});t.TripleDES=n._createHelper(b)}(),i.TripleDES)},function(t,e,r){var i;t.exports=(i=r(2),r(18),r(19),r(15),r(4),function(){var t=i,e=t.lib.StreamCipher,r=t.algo,n=r.RC4=e.extend({_doReset:function(){for(var t=this._key,e=t.words,r=t.sigBytes,i=this._S=[],n=0;n<256;n++)i[n]=n;n=0;for(var s=0;n<256;n++){var o=n%r,f=e[o>>>2]>>>24-o%4*8&255;s=(s+i[n]+f)%256;var a=i[n];i[n]=i[s],i[s]=a}this._i=this._j=0},_doProcessBlock:function(t,e){t[e]^=s.call(this)},keySize:8,ivSize:0});function s(){for(var t=this._S,e=this._i,r=this._j,i=0,n=0;n<4;n++){r=(r+t[e=(e+1)%256])%256;var s=t[e];t[e]=t[r],t[r]=s,i|=t[(t[e]+t[r])%256]<<24-8*n}return this._i=e,this._j=r,i}t.RC4=e._createHelper(n);var o=r.RC4Drop=n.extend({cfg:n.cfg.extend({drop:192}),_doReset:function(){n._doReset.call(this);for(var t=this.cfg.drop;t>0;t--)s.call(this)}});t.RC4Drop=e._createHelper(o)}(),i.RC4)},function(t,e,r){var i;t.exports=(i=r(2),r(18),r(19),r(15),r(4),function(){var t=i,e=t.lib.StreamCipher,r=t.algo,n=[],s=[],o=[],f=r.Rabbit=e.extend({_doReset:function(){for(var t=this._key.words,e=this.cfg.iv,r=0;r<4;r++)t[r]=16711935&(t[r]<<8|t[r]>>>24)|4278255360&(t[r]<<24|t[r]>>>8);var i=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],n=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]];for(this._b=0,r=0;r<4;r++)a.call(this);for(r=0;r<8;r++)n[r]^=i[r+4&7];if(e){var s=e.words,o=s[0],f=s[1],c=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),h=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),u=c>>>16|4294901760&h,d=h<<16|65535&c;for(n[0]^=c,n[1]^=u,n[2]^=h,n[3]^=d,n[4]^=c,n[5]^=u,n[6]^=h,n[7]^=d,r=0;r<4;r++)a.call(this)}},_doProcessBlock:function(t,e){var r=this._X;a.call(this),n[0]=r[0]^r[5]>>>16^r[3]<<16,n[1]=r[2]^r[7]>>>16^r[5]<<16,n[2]=r[4]^r[1]>>>16^r[7]<<16,n[3]=r[6]^r[3]>>>16^r[1]<<16;for(var i=0;i<4;i++)n[i]=16711935&(n[i]<<8|n[i]>>>24)|4278255360&(n[i]<<24|n[i]>>>8),t[e+i]^=n[i]},blockSize:4,ivSize:2});function a(){for(var t=this._X,e=this._C,r=0;r<8;r++)s[r]=e[r];for(e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<s[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<s[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<s[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<s[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<s[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<s[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<s[6]>>>0?1:0)|0,this._b=e[7]>>>0<s[7]>>>0?1:0,r=0;r<8;r++){var i=t[r]+e[r],n=65535&i,f=i>>>16,a=((n*n>>>17)+n*f>>>15)+f*f,c=((4294901760&i)*i|0)+((65535&i)*i|0);o[r]=a^c}t[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,t[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,t[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,t[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,t[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,t[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,t[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,t[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}t.Rabbit=e._createHelper(f)}(),i.Rabbit)},function(t,e,r){var i;t.exports=(i=r(2),r(18),r(19),r(15),r(4),function(){var t=i,e=t.lib.StreamCipher,r=t.algo,n=[],s=[],o=[],f=r.RabbitLegacy=e.extend({_doReset:function(){var t=this._key.words,e=this.cfg.iv,r=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],i=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]];this._b=0;for(var n=0;n<4;n++)a.call(this);for(n=0;n<8;n++)i[n]^=r[n+4&7];if(e){var s=e.words,o=s[0],f=s[1],c=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),h=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),u=c>>>16|4294901760&h,d=h<<16|65535&c;for(i[0]^=c,i[1]^=u,i[2]^=h,i[3]^=d,i[4]^=c,i[5]^=u,i[6]^=h,i[7]^=d,n=0;n<4;n++)a.call(this)}},_doProcessBlock:function(t,e){var r=this._X;a.call(this),n[0]=r[0]^r[5]>>>16^r[3]<<16,n[1]=r[2]^r[7]>>>16^r[5]<<16,n[2]=r[4]^r[1]>>>16^r[7]<<16,n[3]=r[6]^r[3]>>>16^r[1]<<16;for(var i=0;i<4;i++)n[i]=16711935&(n[i]<<8|n[i]>>>24)|4278255360&(n[i]<<24|n[i]>>>8),t[e+i]^=n[i]},blockSize:4,ivSize:2});function a(){for(var t=this._X,e=this._C,r=0;r<8;r++)s[r]=e[r];for(e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<s[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<s[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<s[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<s[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<s[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<s[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<s[6]>>>0?1:0)|0,this._b=e[7]>>>0<s[7]>>>0?1:0,r=0;r<8;r++){var i=t[r]+e[r],n=65535&i,f=i>>>16,a=((n*n>>>17)+n*f>>>15)+f*f,c=((4294901760&i)*i|0)+((65535&i)*i|0);o[r]=a^c}t[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,t[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,t[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,t[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,t[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,t[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,t[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,t[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}t.RabbitLegacy=e._createHelper(f)}(),i.RabbitLegacy)},function(t,e,r){"use strict";var i=e;i.version=r(148).version,i.utils=r(7),i.rand=r(62),i.curve=r(63),i.curves=r(45),i.ec=r(160),i.eddsa=r(164)},function(t){t.exports=JSON.parse('{"name":"elliptic","version":"6.5.4","description":"EC cryptography","main":"lib/elliptic.js","files":["lib"],"scripts":{"lint":"eslint lib test","lint:fix":"npm run lint -- --fix","unit":"istanbul test _mocha --reporter=spec test/index.js","test":"npm run lint && npm run unit","version":"grunt dist && git add dist/"},"repository":{"type":"git","url":"git@github.com:indutny/elliptic"},"keywords":["EC","Elliptic","curve","Cryptography"],"author":"Fedor Indutny <fedor@indutny.com>","license":"MIT","bugs":{"url":"https://github.com/indutny/elliptic/issues"},"homepage":"https://github.com/indutny/elliptic","devDependencies":{"brfs":"^2.0.2","coveralls":"^3.1.0","eslint":"^7.6.0","grunt":"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1","istanbul":"^0.4.5","mocha":"^8.0.1"},"dependencies":{"bn.js":"^4.11.9","brorand":"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1","inherits":"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}')},function(t,e){},function(t,e,r){"use strict";var i=r(7),n=r(12),s=r(32),o=r(31),f=i.assert;function a(t){o.call(this,"short",t),this.a=new n(t.a,16).toRed(this.red),this.b=new n(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function c(t,e,r,i){o.BasePoint.call(this,t,"affine"),null===e&&null===r?(this.x=null,this.y=null,this.inf=!0):(this.x=new n(e,16),this.y=new n(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function h(t,e,r,i){o.BasePoint.call(this,t,"jacobian"),null===e&&null===r&&null===i?(this.x=this.curve.one,this.y=this.curve.one,this.z=new n(0)):(this.x=new n(e,16),this.y=new n(r,16),this.z=new n(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}s(a,o),t.exports=a,a.prototype._getEndomorphism=function(t){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var e,r;if(t.beta)e=new n(t.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);e=(e=i[0].cmp(i[1])<0?i[0]:i[1]).toRed(this.red)}if(t.lambda)r=new n(t.lambda,16);else{var s=this._getEndoRoots(this.n);0===this.g.mul(s[0]).x.cmp(this.g.x.redMul(e))?r=s[0]:(r=s[1],f(0===this.g.mul(r).x.cmp(this.g.x.redMul(e))))}return{beta:e,lambda:r,basis:t.basis?t.basis.map((function(t){return{a:new n(t.a,16),b:new n(t.b,16)}})):this._getEndoBasis(r)}}},a.prototype._getEndoRoots=function(t){var e=t===this.p?this.red:n.mont(t),r=new n(2).toRed(e).redInvm(),i=r.redNeg(),s=new n(3).toRed(e).redNeg().redSqrt().redMul(r);return[i.redAdd(s).fromRed(),i.redSub(s).fromRed()]},a.prototype._getEndoBasis=function(t){for(var e,r,i,s,o,f,a,c,h,u=this.n.ushrn(Math.floor(this.n.bitLength()/2)),d=t,l=this.n.clone(),b=new n(1),p=new n(0),m=new n(0),g=new n(1),w=0;0!==d.cmpn(0);){var y=l.div(d);c=l.sub(y.mul(d)),h=m.sub(y.mul(b));var v=g.sub(y.mul(p));if(!i&&c.cmp(u)<0)e=a.neg(),r=b,i=c.neg(),s=h;else if(i&&2==++w)break;a=c,l=d,d=c,m=b,b=h,g=p,p=v}o=c.neg(),f=h;var S=i.sqr().add(s.sqr());return o.sqr().add(f.sqr()).cmp(S)>=0&&(o=e,f=r),i.negative&&(i=i.neg(),s=s.neg()),o.negative&&(o=o.neg(),f=f.neg()),[{a:i,b:s},{a:o,b:f}]},a.prototype._endoSplit=function(t){var e=this.endo.basis,r=e[0],i=e[1],n=i.b.mul(t).divRound(this.n),s=r.b.neg().mul(t).divRound(this.n),o=n.mul(r.a),f=s.mul(i.a),a=n.mul(r.b),c=s.mul(i.b);return{k1:t.sub(o).sub(f),k2:a.add(c).neg()}},a.prototype.pointFromX=function(t,e){(t=new n(t,16)).red||(t=t.toRed(this.red));var r=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),i=r.redSqrt();if(0!==i.redSqr().redSub(r).cmp(this.zero))throw new Error("invalid point");var s=i.fromRed().isOdd();return(e&&!s||!e&&s)&&(i=i.redNeg()),this.point(t,i)},a.prototype.validate=function(t){if(t.inf)return!0;var e=t.x,r=t.y,i=this.a.redMul(e),n=e.redSqr().redMul(e).redIAdd(i).redIAdd(this.b);return 0===r.redSqr().redISub(n).cmpn(0)},a.prototype._endoWnafMulAdd=function(t,e,r){for(var i=this._endoWnafT1,n=this._endoWnafT2,s=0;s<t.length;s++){var o=this._endoSplit(e[s]),f=t[s],a=f._getBeta();o.k1.negative&&(o.k1.ineg(),f=f.neg(!0)),o.k2.negative&&(o.k2.ineg(),a=a.neg(!0)),i[2*s]=f,i[2*s+1]=a,n[2*s]=o.k1,n[2*s+1]=o.k2}for(var c=this._wnafMulAdd(1,i,n,2*s,r),h=0;h<2*s;h++)i[h]=null,n[h]=null;return c},s(c,o.BasePoint),a.prototype.point=function(t,e,r){return new c(this,t,e,r)},a.prototype.pointFromJSON=function(t,e){return c.fromJSON(this,t,e)},c.prototype._getBeta=function(){if(this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var e=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var r=this.curve,i=function(t){return r.point(t.x.redMul(r.endo.beta),t.y)};t.beta=e,e.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(i)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(i)}}}return e}},c.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},c.fromJSON=function(t,e,r){"string"==typeof e&&(e=JSON.parse(e));var i=t.point(e[0],e[1],r);if(!e[2])return i;function n(e){return t.point(e[0],e[1],r)}var s=e[2];return i.precomputed={beta:null,doubles:s.doubles&&{step:s.doubles.step,points:[i].concat(s.doubles.points.map(n))},naf:s.naf&&{wnd:s.naf.wnd,points:[i].concat(s.naf.points.map(n))}},i},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return this.inf},c.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(0===this.x.cmp(t.x))return this.curve.point(null,null);var e=this.y.redSub(t.y);0!==e.cmpn(0)&&(e=e.redMul(this.x.redSub(t.x).redInvm()));var r=e.redSqr().redISub(this.x).redISub(t.x),i=e.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,i)},c.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(0===t.cmpn(0))return this.curve.point(null,null);var e=this.curve.a,r=this.x.redSqr(),i=t.redInvm(),n=r.redAdd(r).redIAdd(r).redIAdd(e).redMul(i),s=n.redSqr().redISub(this.x.redAdd(this.x)),o=n.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,o)},c.prototype.getX=function(){return this.x.fromRed()},c.prototype.getY=function(){return this.y.fromRed()},c.prototype.mul=function(t){return t=new n(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)},c.prototype.mulAdd=function(t,e,r){var i=[this,e],n=[t,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,n):this.curve._wnafMulAdd(1,i,n,2)},c.prototype.jmulAdd=function(t,e,r){var i=[this,e],n=[t,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,n,!0):this.curve._wnafMulAdd(1,i,n,2,!0)},c.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||0===this.x.cmp(t.x)&&0===this.y.cmp(t.y))},c.prototype.neg=function(t){if(this.inf)return this;var e=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var r=this.precomputed,i=function(t){return t.neg()};e.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(i)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(i)}}}return e},c.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},s(h,o.BasePoint),a.prototype.jpoint=function(t,e,r){return new h(this,t,e,r)},h.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),e=t.redSqr(),r=this.x.redMul(e),i=this.y.redMul(e).redMul(t);return this.curve.point(r,i)},h.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},h.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.z.redSqr(),r=this.z.redSqr(),i=this.x.redMul(e),n=t.x.redMul(r),s=this.y.redMul(e.redMul(t.z)),o=t.y.redMul(r.redMul(this.z)),f=i.redSub(n),a=s.redSub(o);if(0===f.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=f.redSqr(),h=c.redMul(f),u=i.redMul(c),d=a.redSqr().redIAdd(h).redISub(u).redISub(u),l=a.redMul(u.redISub(d)).redISub(s.redMul(h)),b=this.z.redMul(t.z).redMul(f);return this.curve.jpoint(d,l,b)},h.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var e=this.z.redSqr(),r=this.x,i=t.x.redMul(e),n=this.y,s=t.y.redMul(e).redMul(this.z),o=r.redSub(i),f=n.redSub(s);if(0===o.cmpn(0))return 0!==f.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var a=o.redSqr(),c=a.redMul(o),h=r.redMul(a),u=f.redSqr().redIAdd(c).redISub(h).redISub(h),d=f.redMul(h.redISub(u)).redISub(n.redMul(c)),l=this.z.redMul(o);return this.curve.jpoint(u,d,l)},h.prototype.dblp=function(t){if(0===t)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var e;if(this.curve.zeroA||this.curve.threeA){var r=this;for(e=0;e<t;e++)r=r.dbl();return r}var i=this.curve.a,n=this.curve.tinv,s=this.x,o=this.y,f=this.z,a=f.redSqr().redSqr(),c=o.redAdd(o);for(e=0;e<t;e++){var h=s.redSqr(),u=c.redSqr(),d=u.redSqr(),l=h.redAdd(h).redIAdd(h).redIAdd(i.redMul(a)),b=s.redMul(u),p=l.redSqr().redISub(b.redAdd(b)),m=b.redISub(p),g=l.redMul(m);g=g.redIAdd(g).redISub(d);var w=c.redMul(f);e+1<t&&(a=a.redMul(d)),s=p,f=w,c=g}return this.curve.jpoint(s,c.redMul(n),f)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},h.prototype._zeroDbl=function(){var t,e,r;if(this.zOne){var i=this.x.redSqr(),n=this.y.redSqr(),s=n.redSqr(),o=this.x.redAdd(n).redSqr().redISub(i).redISub(s);o=o.redIAdd(o);var f=i.redAdd(i).redIAdd(i),a=f.redSqr().redISub(o).redISub(o),c=s.redIAdd(s);c=(c=c.redIAdd(c)).redIAdd(c),t=a,e=f.redMul(o.redISub(a)).redISub(c),r=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),u=this.y.redSqr(),d=u.redSqr(),l=this.x.redAdd(u).redSqr().redISub(h).redISub(d);l=l.redIAdd(l);var b=h.redAdd(h).redIAdd(h),p=b.redSqr(),m=d.redIAdd(d);m=(m=m.redIAdd(m)).redIAdd(m),t=p.redISub(l).redISub(l),e=b.redMul(l.redISub(t)).redISub(m),r=(r=this.y.redMul(this.z)).redIAdd(r)}return this.curve.jpoint(t,e,r)},h.prototype._threeDbl=function(){var t,e,r;if(this.zOne){var i=this.x.redSqr(),n=this.y.redSqr(),s=n.redSqr(),o=this.x.redAdd(n).redSqr().redISub(i).redISub(s);o=o.redIAdd(o);var f=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),a=f.redSqr().redISub(o).redISub(o);t=a;var c=s.redIAdd(s);c=(c=c.redIAdd(c)).redIAdd(c),e=f.redMul(o.redISub(a)).redISub(c),r=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),u=this.y.redSqr(),d=this.x.redMul(u),l=this.x.redSub(h).redMul(this.x.redAdd(h));l=l.redAdd(l).redIAdd(l);var b=d.redIAdd(d),p=(b=b.redIAdd(b)).redAdd(b);t=l.redSqr().redISub(p),r=this.y.redAdd(this.z).redSqr().redISub(u).redISub(h);var m=u.redSqr();m=(m=(m=m.redIAdd(m)).redIAdd(m)).redIAdd(m),e=l.redMul(b.redISub(t)).redISub(m)}return this.curve.jpoint(t,e,r)},h.prototype._dbl=function(){var t=this.curve.a,e=this.x,r=this.y,i=this.z,n=i.redSqr().redSqr(),s=e.redSqr(),o=r.redSqr(),f=s.redAdd(s).redIAdd(s).redIAdd(t.redMul(n)),a=e.redAdd(e),c=(a=a.redIAdd(a)).redMul(o),h=f.redSqr().redISub(c.redAdd(c)),u=c.redISub(h),d=o.redSqr();d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var l=f.redMul(u).redISub(d),b=r.redAdd(r).redMul(i);return this.curve.jpoint(h,l,b)},h.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),e=this.y.redSqr(),r=this.z.redSqr(),i=e.redSqr(),n=t.redAdd(t).redIAdd(t),s=n.redSqr(),o=this.x.redAdd(e).redSqr().redISub(t).redISub(i),f=(o=(o=(o=o.redIAdd(o)).redAdd(o).redIAdd(o)).redISub(s)).redSqr(),a=i.redIAdd(i);a=(a=(a=a.redIAdd(a)).redIAdd(a)).redIAdd(a);var c=n.redIAdd(o).redSqr().redISub(s).redISub(f).redISub(a),h=e.redMul(c);h=(h=h.redIAdd(h)).redIAdd(h);var u=this.x.redMul(f).redISub(h);u=(u=u.redIAdd(u)).redIAdd(u);var d=this.y.redMul(c.redMul(a.redISub(c)).redISub(o.redMul(f)));d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var l=this.z.redAdd(o).redSqr().redISub(r).redISub(f);return this.curve.jpoint(u,d,l)},h.prototype.mul=function(t,e){return t=new n(t,e),this.curve._wnafMul(this,t)},h.prototype.eq=function(t){if("affine"===t.type)return this.eq(t.toJ());if(this===t)return!0;var e=this.z.redSqr(),r=t.z.redSqr();if(0!==this.x.redMul(r).redISub(t.x.redMul(e)).cmpn(0))return!1;var i=e.redMul(this.z),n=r.redMul(t.z);return 0===this.y.redMul(n).redISub(t.y.redMul(i)).cmpn(0)},h.prototype.eqXToP=function(t){var e=this.z.redSqr(),r=t.toRed(this.curve.red).redMul(e);if(0===this.x.cmp(r))return!0;for(var i=t.clone(),n=this.curve.redN.redMul(e);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(n),0===this.x.cmp(r))return!0}},h.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},h.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},function(t,e,r){"use strict";var i=r(12),n=r(32),s=r(31),o=r(7);function f(t){s.call(this,"mont",t),this.a=new i(t.a,16).toRed(this.red),this.b=new i(t.b,16).toRed(this.red),this.i4=new i(4).toRed(this.red).redInvm(),this.two=new i(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function a(t,e,r){s.BasePoint.call(this,t,"projective"),null===e&&null===r?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new i(e,16),this.z=new i(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}n(f,s),t.exports=f,f.prototype.validate=function(t){var e=t.normalize().x,r=e.redSqr(),i=r.redMul(e).redAdd(r.redMul(this.a)).redAdd(e);return 0===i.redSqrt().redSqr().cmp(i)},n(a,s.BasePoint),f.prototype.decodePoint=function(t,e){return this.point(o.toArray(t,e),1)},f.prototype.point=function(t,e){return new a(this,t,e)},f.prototype.pointFromJSON=function(t){return a.fromJSON(this,t)},a.prototype.precompute=function(){},a.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},a.fromJSON=function(t,e){return new a(t,e[0],e[1]||t.one)},a.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},a.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},a.prototype.dbl=function(){var t=this.x.redAdd(this.z).redSqr(),e=this.x.redSub(this.z).redSqr(),r=t.redSub(e),i=t.redMul(e),n=r.redMul(e.redAdd(this.curve.a24.redMul(r)));return this.curve.point(i,n)},a.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},a.prototype.diffAdd=function(t,e){var r=this.x.redAdd(this.z),i=this.x.redSub(this.z),n=t.x.redAdd(t.z),s=t.x.redSub(t.z).redMul(r),o=n.redMul(i),f=e.z.redMul(s.redAdd(o).redSqr()),a=e.x.redMul(s.redISub(o).redSqr());return this.curve.point(f,a)},a.prototype.mul=function(t){for(var e=t.clone(),r=this,i=this.curve.point(null,null),n=[];0!==e.cmpn(0);e.iushrn(1))n.push(e.andln(1));for(var s=n.length-1;s>=0;s--)0===n[s]?(r=r.diffAdd(i,this),i=i.dbl()):(i=r.diffAdd(i,this),r=r.dbl());return i},a.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},a.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},a.prototype.eq=function(t){return 0===this.getX().cmp(t.getX())},a.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},a.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},function(t,e,r){"use strict";var i=r(7),n=r(12),s=r(32),o=r(31),f=i.assert;function a(t){this.twisted=1!=(0|t.a),this.mOneA=this.twisted&&-1==(0|t.a),this.extended=this.mOneA,o.call(this,"edwards",t),this.a=new n(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new n(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new n(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),f(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|t.c)}function c(t,e,r,i,s){o.BasePoint.call(this,t,"projective"),null===e&&null===r&&null===i?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new n(e,16),this.y=new n(r,16),this.z=i?new n(i,16):this.curve.one,this.t=s&&new n(s,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}s(a,o),t.exports=a,a.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)},a.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)},a.prototype.jpoint=function(t,e,r,i){return this.point(t,e,r,i)},a.prototype.pointFromX=function(t,e){(t=new n(t,16)).red||(t=t.toRed(this.red));var r=t.redSqr(),i=this.c2.redSub(this.a.redMul(r)),s=this.one.redSub(this.c2.redMul(this.d).redMul(r)),o=i.redMul(s.redInvm()),f=o.redSqrt();if(0!==f.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");var a=f.fromRed().isOdd();return(e&&!a||!e&&a)&&(f=f.redNeg()),this.point(t,f)},a.prototype.pointFromY=function(t,e){(t=new n(t,16)).red||(t=t.toRed(this.red));var r=t.redSqr(),i=r.redSub(this.c2),s=r.redMul(this.d).redMul(this.c2).redSub(this.a),o=i.redMul(s.redInvm());if(0===o.cmp(this.zero)){if(e)throw new Error("invalid point");return this.point(this.zero,t)}var f=o.redSqrt();if(0!==f.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");return f.fromRed().isOdd()!==e&&(f=f.redNeg()),this.point(f,t)},a.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var e=t.x.redSqr(),r=t.y.redSqr(),i=e.redMul(this.a).redAdd(r),n=this.c2.redMul(this.one.redAdd(this.d.redMul(e).redMul(r)));return 0===i.cmp(n)},s(c,o.BasePoint),a.prototype.pointFromJSON=function(t){return c.fromJSON(this,t)},a.prototype.point=function(t,e,r,i){return new c(this,t,e,r,i)},c.fromJSON=function(t,e){return new c(t,e[0],e[1],e[2])},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},c.prototype._extDbl=function(){var t=this.x.redSqr(),e=this.y.redSqr(),r=this.z.redSqr();r=r.redIAdd(r);var i=this.curve._mulA(t),n=this.x.redAdd(this.y).redSqr().redISub(t).redISub(e),s=i.redAdd(e),o=s.redSub(r),f=i.redSub(e),a=n.redMul(o),c=s.redMul(f),h=n.redMul(f),u=o.redMul(s);return this.curve.point(a,c,u,h)},c.prototype._projDbl=function(){var t,e,r,i,n,s,o=this.x.redAdd(this.y).redSqr(),f=this.x.redSqr(),a=this.y.redSqr();if(this.curve.twisted){var c=(i=this.curve._mulA(f)).redAdd(a);this.zOne?(t=o.redSub(f).redSub(a).redMul(c.redSub(this.curve.two)),e=c.redMul(i.redSub(a)),r=c.redSqr().redSub(c).redSub(c)):(n=this.z.redSqr(),s=c.redSub(n).redISub(n),t=o.redSub(f).redISub(a).redMul(s),e=c.redMul(i.redSub(a)),r=c.redMul(s))}else i=f.redAdd(a),n=this.curve._mulC(this.z).redSqr(),s=i.redSub(n).redSub(n),t=this.curve._mulC(o.redISub(i)).redMul(s),e=this.curve._mulC(i).redMul(f.redISub(a)),r=i.redMul(s);return this.curve.point(t,e,r)},c.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},c.prototype._extAdd=function(t){var e=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),r=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.dd).redMul(t.t),n=this.z.redMul(t.z.redAdd(t.z)),s=r.redSub(e),o=n.redSub(i),f=n.redAdd(i),a=r.redAdd(e),c=s.redMul(o),h=f.redMul(a),u=s.redMul(a),d=o.redMul(f);return this.curve.point(c,h,d,u)},c.prototype._projAdd=function(t){var e,r,i=this.z.redMul(t.z),n=i.redSqr(),s=this.x.redMul(t.x),o=this.y.redMul(t.y),f=this.curve.d.redMul(s).redMul(o),a=n.redSub(f),c=n.redAdd(f),h=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(s).redISub(o),u=i.redMul(a).redMul(h);return this.curve.twisted?(e=i.redMul(c).redMul(o.redSub(this.curve._mulA(s))),r=a.redMul(c)):(e=i.redMul(c).redMul(o.redSub(s)),r=this.curve._mulC(a).redMul(c)),this.curve.point(u,e,r)},c.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)},c.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)},c.prototype.mulAdd=function(t,e,r){return this.curve._wnafMulAdd(1,[this,e],[t,r],2,!1)},c.prototype.jmulAdd=function(t,e,r){return this.curve._wnafMulAdd(1,[this,e],[t,r],2,!0)},c.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this},c.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()},c.prototype.getY=function(){return this.normalize(),this.y.fromRed()},c.prototype.eq=function(t){return this===t||0===this.getX().cmp(t.getX())&&0===this.getY().cmp(t.getY())},c.prototype.eqXToP=function(t){var e=t.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(e))return!0;for(var r=t.clone(),i=this.curve.redN.redMul(this.z);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(e.redIAdd(i),0===this.x.cmp(e))return!0}},c.prototype.toP=c.prototype.normalize,c.prototype.mixedAdd=c.prototype.add},function(t,e,r){"use strict";e.sha1=r(154),e.sha224=r(155),e.sha256=r(65),e.sha384=r(156),e.sha512=r(66)},function(t,e,r){"use strict";var i=r(10),n=r(22),s=r(64),o=i.rotl32,f=i.sum32,a=i.sum32_5,c=s.ft_1,h=n.BlockHash,u=[1518500249,1859775393,2400959708,3395469782];function d(){if(!(this instanceof d))return new d;h.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}i.inherits(d,h),t.exports=d,d.blockSize=512,d.outSize=160,d.hmacStrength=80,d.padLength=64,d.prototype._update=function(t,e){for(var r=this.W,i=0;i<16;i++)r[i]=t[e+i];for(;i<r.length;i++)r[i]=o(r[i-3]^r[i-8]^r[i-14]^r[i-16],1);var n=this.h[0],s=this.h[1],h=this.h[2],d=this.h[3],l=this.h[4];for(i=0;i<r.length;i++){var b=~~(i/20),p=a(o(n,5),c(b,s,h,d),l,r[i],u[b]);l=d,d=h,h=o(s,30),s=n,n=p}this.h[0]=f(this.h[0],n),this.h[1]=f(this.h[1],s),this.h[2]=f(this.h[2],h),this.h[3]=f(this.h[3],d),this.h[4]=f(this.h[4],l)},d.prototype._digest=function(t){return"hex"===t?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},function(t,e,r){"use strict";var i=r(10),n=r(65);function s(){if(!(this instanceof s))return new s;n.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}i.inherits(s,n),t.exports=s,s.blockSize=512,s.outSize=224,s.hmacStrength=192,s.padLength=64,s.prototype._digest=function(t){return"hex"===t?i.toHex32(this.h.slice(0,7),"big"):i.split32(this.h.slice(0,7),"big")}},function(t,e,r){"use strict";var i=r(10),n=r(66);function s(){if(!(this instanceof s))return new s;n.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}i.inherits(s,n),t.exports=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(t){return"hex"===t?i.toHex32(this.h.slice(0,12),"big"):i.split32(this.h.slice(0,12),"big")}},function(t,e,r){"use strict";var i=r(10),n=r(22),s=i.rotl32,o=i.sum32,f=i.sum32_3,a=i.sum32_4,c=n.BlockHash;function h(){if(!(this instanceof h))return new h;c.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function u(t,e,r,i){return t<=15?e^r^i:t<=31?e&r|~e&i:t<=47?(e|~r)^i:t<=63?e&i|r&~i:e^(r|~i)}function d(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function l(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}i.inherits(h,c),e.ripemd160=h,h.blockSize=512,h.outSize=160,h.hmacStrength=192,h.padLength=64,h.prototype._update=function(t,e){for(var r=this.h[0],i=this.h[1],n=this.h[2],c=this.h[3],h=this.h[4],w=r,y=i,v=n,S=c,E=h,M=0;M<80;M++){var A=o(s(a(r,u(M,i,n,c),t[b[M]+e],d(M)),m[M]),h);r=h,h=c,c=s(n,10),n=i,i=A,A=o(s(a(w,u(79-M,y,v,S),t[p[M]+e],l(M)),g[M]),E),w=E,E=S,S=s(v,10),v=y,y=A}A=f(this.h[1],n,S),this.h[1]=f(this.h[2],c,E),this.h[2]=f(this.h[3],h,w),this.h[3]=f(this.h[4],r,y),this.h[4]=f(this.h[0],i,v),this.h[0]=A},h.prototype._digest=function(t){return"hex"===t?i.toHex32(this.h,"little"):i.split32(this.h,"little")};var b=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],m=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],g=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},function(t,e,r){"use strict";var i=r(10),n=r(16);function s(t,e,r){if(!(this instanceof s))return new s(t,e,r);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(i.toArray(e,r))}t.exports=s,s.prototype._init=function(t){t.length>this.blockSize&&(t=(new this.Hash).update(t).digest()),n(t.length<=this.blockSize);for(var e=t.length;e<this.blockSize;e++)t.push(0);for(e=0;e<t.length;e++)t[e]^=54;for(this.inner=(new this.Hash).update(t),e=0;e<t.length;e++)t[e]^=106;this.outer=(new this.Hash).update(t)},s.prototype.update=function(t,e){return this.inner.update(t,e),this},s.prototype.digest=function(t){return this.outer.update(this.inner.digest()),this.outer.digest(t)}},function(t,e){t.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},function(t,e,r){"use strict";var i=r(12),n=r(161),s=r(7),o=r(45),f=r(62),a=s.assert,c=r(162),h=r(163);function u(t){if(!(this instanceof u))return new u(t);"string"==typeof t&&(a(Object.prototype.hasOwnProperty.call(o,t),"Unknown curve "+t),t=o[t]),t instanceof o.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}t.exports=u,u.prototype.keyPair=function(t){return new c(this,t)},u.prototype.keyFromPrivate=function(t,e){return c.fromPrivate(this,t,e)},u.prototype.keyFromPublic=function(t,e){return c.fromPublic(this,t,e)},u.prototype.genKeyPair=function(t){t||(t={});for(var e=new n({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||f(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),r=this.n.byteLength(),s=this.n.sub(new i(2));;){var o=new i(e.generate(r));if(!(o.cmp(s)>0))return o.iaddn(1),this.keyFromPrivate(o)}},u.prototype._truncateToN=function(t,e){var r=8*t.byteLength()-this.n.bitLength();return r>0&&(t=t.ushrn(r)),!e&&t.cmp(this.n)>=0?t.sub(this.n):t},u.prototype.sign=function(t,e,r,s){"object"==typeof r&&(s=r,r=null),s||(s={}),e=this.keyFromPrivate(e,r),t=this._truncateToN(new i(t,16));for(var o=this.n.byteLength(),f=e.getPrivate().toArray("be",o),a=t.toArray("be",o),c=new n({hash:this.hash,entropy:f,nonce:a,pers:s.pers,persEnc:s.persEnc||"utf8"}),u=this.n.sub(new i(1)),d=0;;d++){var l=s.k?s.k(d):new i(c.generate(this.n.byteLength()));if(!((l=this._truncateToN(l,!0)).cmpn(1)<=0||l.cmp(u)>=0)){var b=this.g.mul(l);if(!b.isInfinity()){var p=b.getX(),m=p.umod(this.n);if(0!==m.cmpn(0)){var g=l.invm(this.n).mul(m.mul(e.getPrivate()).iadd(t));if(0!==(g=g.umod(this.n)).cmpn(0)){var w=(b.getY().isOdd()?1:0)|(0!==p.cmp(m)?2:0);return s.canonical&&g.cmp(this.nh)>0&&(g=this.n.sub(g),w^=1),new h({r:m,s:g,recoveryParam:w})}}}}}},u.prototype.verify=function(t,e,r,n){t=this._truncateToN(new i(t,16)),r=this.keyFromPublic(r,n);var s=(e=new h(e,"hex")).r,o=e.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var f,a=o.invm(this.n),c=a.mul(t).umod(this.n),u=a.mul(s).umod(this.n);return this.curve._maxwellTrick?!(f=this.g.jmulAdd(c,r.getPublic(),u)).isInfinity()&&f.eqXToP(s):!(f=this.g.mulAdd(c,r.getPublic(),u)).isInfinity()&&0===f.getX().umod(this.n).cmp(s)},u.prototype.recoverPubKey=function(t,e,r,n){a((3&r)===r,"The recovery param is more than two bits"),e=new h(e,n);var s=this.n,o=new i(t),f=e.r,c=e.s,u=1&r,d=r>>1;if(f.cmp(this.curve.p.umod(this.curve.n))>=0&&d)throw new Error("Unable to find sencond key candinate");f=d?this.curve.pointFromX(f.add(this.curve.n),u):this.curve.pointFromX(f,u);var l=e.r.invm(s),b=s.sub(o).mul(l).umod(s),p=c.mul(l).umod(s);return this.g.mulAdd(b,f,p)},u.prototype.getKeyRecoveryParam=function(t,e,r,i){if(null!==(e=new h(e,i)).recoveryParam)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(t,e,n)}catch(t){continue}if(s.eq(r))return n}throw new Error("Unable to find valid recovery factor")}},function(t,e,r){"use strict";var i=r(46),n=r(61),s=r(16);function o(t){if(!(this instanceof o))return new o(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=n.toArray(t.entropy,t.entropyEnc||"hex"),r=n.toArray(t.nonce,t.nonceEnc||"hex"),i=n.toArray(t.pers,t.persEnc||"hex");s(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,i)}t.exports=o,o.prototype._init=function(t,e,r){var i=t.concat(e).concat(r);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var n=0;n<this.V.length;n++)this.K[n]=0,this.V[n]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656},o.prototype._hmac=function(){return new i.hmac(this.hash,this.K)},o.prototype._update=function(t){var e=this._hmac().update(this.V).update([0]);t&&(e=e.update(t)),this.K=e.digest(),this.V=this._hmac().update(this.V).digest(),t&&(this.K=this._hmac().update(this.V).update([1]).update(t).digest(),this.V=this._hmac().update(this.V).digest())},o.prototype.reseed=function(t,e,r,i){"string"!=typeof e&&(i=r,r=e,e=null),t=n.toArray(t,e),r=n.toArray(r,i),s(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(t.concat(r||[])),this._reseed=1},o.prototype.generate=function(t,e,r,i){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof e&&(i=r,r=e,e=null),r&&(r=n.toArray(r,i||"hex"),this._update(r));for(var s=[];s.length<t;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,t);return this._update(r),this._reseed++,n.encode(o,e)}},function(t,e,r){"use strict";var i=r(12),n=r(7).assert;function s(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}t.exports=s,s.fromPublic=function(t,e,r){return e instanceof s?e:new s(t,{pub:e,pubEnc:r})},s.fromPrivate=function(t,e,r){return e instanceof s?e:new s(t,{priv:e,privEnc:r})},s.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},s.prototype.getPublic=function(t,e){return"string"==typeof t&&(e=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),e?this.pub.encode(e,t):this.pub},s.prototype.getPrivate=function(t){return"hex"===t?this.priv.toString(16,2):this.priv},s.prototype._importPrivate=function(t,e){this.priv=new i(t,e||16),this.priv=this.priv.umod(this.ec.curve.n)},s.prototype._importPublic=function(t,e){if(t.x||t.y)return"mont"===this.ec.curve.type?n(t.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||n(t.x&&t.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(t.x,t.y));this.pub=this.ec.curve.decodePoint(t,e)},s.prototype.derive=function(t){return t.validate()||n(t.validate(),"public point not validated"),t.mul(this.priv).getX()},s.prototype.sign=function(t,e,r){return this.ec.sign(t,this,e,r)},s.prototype.verify=function(t,e){return this.ec.verify(t,e,this)},s.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},function(t,e,r){"use strict";var i=r(12),n=r(7),s=n.assert;function o(t,e){if(t instanceof o)return t;this._importDER(t,e)||(s(t.r&&t.s,"Signature without r or s"),this.r=new i(t.r,16),this.s=new i(t.s,16),void 0===t.recoveryParam?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}function f(){this.place=0}function a(t,e){var r=t[e.place++];if(!(128&r))return r;var i=15&r;if(0===i||i>4)return!1;for(var n=0,s=0,o=e.place;s<i;s++,o++)n<<=8,n|=t[o],n>>>=0;return!(n<=127)&&(e.place=o,n)}function c(t){for(var e=0,r=t.length-1;!t[e]&&!(128&t[e+1])&&e<r;)e++;return 0===e?t:t.slice(e)}function h(t,e){if(e<128)t.push(e);else{var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(128|r);--r;)t.push(e>>>(r<<3)&255);t.push(e)}}t.exports=o,o.prototype._importDER=function(t,e){t=n.toArray(t,e);var r=new f;if(48!==t[r.place++])return!1;var s=a(t,r);if(!1===s)return!1;if(s+r.place!==t.length)return!1;if(2!==t[r.place++])return!1;var o=a(t,r);if(!1===o)return!1;var c=t.slice(r.place,o+r.place);if(r.place+=o,2!==t[r.place++])return!1;var h=a(t,r);if(!1===h)return!1;if(t.length!==h+r.place)return!1;var u=t.slice(r.place,h+r.place);if(0===c[0]){if(!(128&c[1]))return!1;c=c.slice(1)}if(0===u[0]){if(!(128&u[1]))return!1;u=u.slice(1)}return this.r=new i(c),this.s=new i(u),this.recoveryParam=null,!0},o.prototype.toDER=function(t){var e=this.r.toArray(),r=this.s.toArray();for(128&e[0]&&(e=[0].concat(e)),128&r[0]&&(r=[0].concat(r)),e=c(e),r=c(r);!(r[0]||128&r[1]);)r=r.slice(1);var i=[2];h(i,e.length),(i=i.concat(e)).push(2),h(i,r.length);var s=i.concat(r),o=[48];return h(o,s.length),o=o.concat(s),n.encode(o,t)}},function(t,e,r){"use strict";var i=r(46),n=r(45),s=r(7),o=s.assert,f=s.parseBytes,a=r(165),c=r(166);function h(t){if(o("ed25519"===t,"only tested with ed25519 so far"),!(this instanceof h))return new h(t);t=n[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=i.sha512}t.exports=h,h.prototype.sign=function(t,e){t=f(t);var r=this.keyFromSecret(e),i=this.hashInt(r.messagePrefix(),t),n=this.g.mul(i),s=this.encodePoint(n),o=this.hashInt(s,r.pubBytes(),t).mul(r.priv()),a=i.add(o).umod(this.curve.n);return this.makeSignature({R:n,S:a,Rencoded:s})},h.prototype.verify=function(t,e,r){t=f(t),e=this.makeSignature(e);var i=this.keyFromPublic(r),n=this.hashInt(e.Rencoded(),i.pubBytes(),t),s=this.g.mul(e.S());return e.R().add(i.pub().mul(n)).eq(s)},h.prototype.hashInt=function(){for(var t=this.hash(),e=0;e<arguments.length;e++)t.update(arguments[e]);return s.intFromLE(t.digest()).umod(this.curve.n)},h.prototype.keyFromPublic=function(t){return a.fromPublic(this,t)},h.prototype.keyFromSecret=function(t){return a.fromSecret(this,t)},h.prototype.makeSignature=function(t){return t instanceof c?t:new c(this,t)},h.prototype.encodePoint=function(t){var e=t.getY().toArray("le",this.encodingLength);return e[this.encodingLength-1]|=t.getX().isOdd()?128:0,e},h.prototype.decodePoint=function(t){var e=(t=s.parseBytes(t)).length-1,r=t.slice(0,e).concat(-129&t[e]),i=0!=(128&t[e]),n=s.intFromLE(r);return this.curve.pointFromY(n,i)},h.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)},h.prototype.decodeInt=function(t){return s.intFromLE(t)},h.prototype.isPoint=function(t){return t instanceof this.pointClass}},function(t,e,r){"use strict";var i=r(7),n=i.assert,s=i.parseBytes,o=i.cachedProperty;function f(t,e){this.eddsa=t,this._secret=s(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=s(e.pub)}f.fromPublic=function(t,e){return e instanceof f?e:new f(t,{pub:e})},f.fromSecret=function(t,e){return e instanceof f?e:new f(t,{secret:e})},f.prototype.secret=function(){return this._secret},o(f,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),o(f,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),o(f,"privBytes",(function(){var t=this.eddsa,e=this.hash(),r=t.encodingLength-1,i=e.slice(0,t.encodingLength);return i[0]&=248,i[r]&=127,i[r]|=64,i})),o(f,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),o(f,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),o(f,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),f.prototype.sign=function(t){return n(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)},f.prototype.verify=function(t,e){return this.eddsa.verify(t,e,this)},f.prototype.getSecret=function(t){return n(this._secret,"KeyPair is public only"),i.encode(this.secret(),t)},f.prototype.getPublic=function(t){return i.encode(this.pubBytes(),t)},t.exports=f},function(t,e,r){"use strict";var i=r(12),n=r(7),s=n.assert,o=n.cachedProperty,f=n.parseBytes;function a(t,e){this.eddsa=t,"object"!=typeof e&&(e=f(e)),Array.isArray(e)&&(e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),s(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof i&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}o(a,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),o(a,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),o(a,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),o(a,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),a.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},a.prototype.toHex=function(){return n.encode(this.toBytes(),"hex").toUpperCase()},t.exports=a},function(t,e,r){"use strict";
/*!
 * aead.js - aead for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(168)},function(t,e,r){"use strict";(function(e){
/*!
 * aead.js - aead for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://tools.ietf.org/html/rfc7539#section-2.8
 *   https://github.com/openssh/openssh-portable
 */
const i=r(1),n=r(68),s=r(69),o=e.alloc(16,0);class f{constructor(){this.chacha=new n,this.poly=new s,this.key=e.alloc(64),this.mode=-1,this.aadLen=0,this.cipherLen=0}init(t,r){return i(e.isBuffer(t)),i(e.isBuffer(r)),this.key.fill(0),this.chacha.init(t,r,0),this.chacha.encrypt(this.key),this.poly.init(this.key),this.mode=0,this.aadLen=0,this.cipherLen=0,this}aad(t){if(-1===this.mode)throw new Error("Context is not initialized.");if(0!==this.mode)throw new Error("Invalid state for aad.");return this.poly.update(t),this.aadLen+=t.length,this}encrypt(t){if(-1===this.mode)throw new Error("Context is not initialized.");if(0!==this.mode&&1!==this.mode)throw new Error("Invalid state for encrypt.");return 0===this.mode&&(this._pad16(this.aadLen),this.mode=1),this.chacha.encrypt(t),this.poly.update(t),this.cipherLen+=t.length,t}decrypt(t){if(i(e.isBuffer(t)),-1===this.mode)throw new Error("Context is not initialized.");if(0!==this.mode&&2!==this.mode)throw new Error("Invalid state for decrypt.");return 0===this.mode&&(this._pad16(this.aadLen),this.mode=2),this.cipherLen+=t.length,this.poly.update(t),this.chacha.encrypt(t),t}auth(t){if(i(e.isBuffer(t)),-1===this.mode)throw new Error("Context is not initialized.");if(0!==this.mode&&3!==this.mode)throw new Error("Invalid state for auth.");return 0===this.mode&&(this._pad16(this.aadLen),this.mode=3),this.cipherLen+=t.length,this.poly.update(t),t}final(){if(-1===this.mode)throw new Error("Context is not initialized.");const t=e.alloc(16);c(t,this.aadLen,0),c(t,this.cipherLen,8),0===this.mode&&this._pad16(this.aadLen),this._pad16(this.cipherLen),this.poly.update(t);const r=this.poly.final();return this.destroy(),r}destroy(){this.chacha.destroy(),this.poly.destroy();for(let t=0;t<64;t++)this.key[t]=0;return this.mode=-1,this.aadLen=0,this.cipherLen=0,this}verify(t){i(e.isBuffer(t)),i(16===t.length);const r=this.final();let n=0;for(let e=0;e<16;e++)n|=r[e]^t[e];return n-1>>>31!=0}_pad16(t){const e=15&t;e>0&&this.poly.update(o.slice(0,16-e))}static encrypt(t,e,r,i){const n=new f;return n.init(t,e),i&&n.aad(i),n.encrypt(r),n.final()}static decrypt(t,e,r,i,n){const s=new f;return s.init(t,e),n&&s.aad(n),s.decrypt(r),s.verify(i)}static auth(t,e,r,i,n){const s=new f;return s.init(t,e),n&&s.aad(n),s.auth(r),s.verify(i)}}function a(t,e,r){return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}function c(t,e,r){const i=e*(1/4294967296)>>>0;return a(t,e>>>0,r+0),a(t,i,r+4),r+8}f.native=n.native,t.exports=f}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * aes.js - aes for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(170)},function(t,e,r){"use strict";(function(t){
/*!
 * aes.js - aes128/192/256 for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(47),{CBCCipher:n,CBCDecipher:s}=r(70);e.native=0,e.encipher=function(e,r,s){const o=new n(new i(256));return o.init(r,s),t.concat([o.update(e),o.final()])},e.decipher=function(e,r,n){const o=new s(new i(256));return o.init(r,n),t.concat([o.update(e),o.final()])}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * ghash.js - ghash for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009, The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Galois/Counter_Mode
 *   https://dx.doi.org/10.6028/NIST.SP.800-38D
 *   https://github.com/golang/go/blob/master/src/crypto/cipher/gcm.go
 *   https://github.com/golang/go/blob/master/src/crypto/cipher/gcm_test.go
 *   https://github.com/DaGenix/rust-crypto/blob/master/src/ghash.rs
 */
const i=r(1),n=e.alloc(16,0),s=new Uint16Array([0,7200,14400,9312,28800,27808,18624,21728,57600,64800,55616,50528,37248,36256,43456,46560]);function o(t){return t*(1/4294967296)>>>0}function f(t){return t>>>0}function a(t){return t=(t=t<<2&12|t>>>2&3)<<1&10|t>>>1&5}function c(t,e){return 16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e++]}function h(t,e,r){return t[r++]=e>>>24,t[r++]=e>>>16,t[r++]=e>>>8,t[r++]=e,r}t.exports=class{constructor(){this.state=new Uint32Array(4),this.block=e.alloc(16),this.size=-1,this.adLen=0,this.ctLen=0,this.table=new Array(16);for(let t=0;t<16;t++)this.table[t]=new Uint32Array(4)}init(t){i(e.isBuffer(t)),i(16===t.length);for(let t=0;t<4;t++)this.state[t]=0;this.size=0,this.adLen=0,this.ctLen=0;for(let t=0;t<16;t++)for(let e=0;e<4;e++)this.table[t][e]=0;const r=new Uint32Array(4);r[1]=c(t,0),r[0]=c(t,4),r[3]=c(t,8),r[2]=c(t,12),this.table[a(1)]=r;for(let t=2;t<16;t+=2)this.table[a(t)]=this.double(this.table[a(t>>>1)]),this.table[a(t+1)]=this.add(this.table[a(t)],r);return this}absorb(t){return this._absorb(t,t.length),this}_absorb(t,e){i(-1!==this.size,"Context is not initialized.");let r=15&this.size,n=0;if(this.size+=e,r>0){let i=16-r;if(i>e&&(i=e),t.copy(this.block,r,n,n+i),r+=i,e-=i,n+=i,r<16)return;this.transform(this.block,0)}for(;e>=16;)this.transform(t,n),n+=16,e-=16;e>0&&t.copy(this.block,0,n,n+e)}transform(t,e){this.state[1]^=c(t,e+0),this.state[0]^=c(t,e+4),this.state[3]^=c(t,e+8),this.state[2]^=c(t,e+12),this.mul(this.state)}pad(){const t=15&this.size;0!==t&&this._absorb(n,16-t)}aad(t){return i(e.isBuffer(t)),i(0===this.ctLen),this.adLen+=t.length,this.absorb(t)}update(t){return i(e.isBuffer(t)),0===t.length?this:(0===this.ctLen&&this.pad(),this.ctLen+=t.length,this.absorb(t))}final(){const t=e.alloc(16);this.pad();const r=8*this.adLen,i=8*this.ctLen;this.state[1]^=o(r),this.state[0]^=f(r),this.state[3]^=o(i),this.state[2]^=f(i),this.mul(this.state),h(t,this.state[1],0),h(t,this.state[0],4),h(t,this.state[3],8),h(t,this.state[2],12);for(let t=0;t<4;t++)this.state[t]=0;for(let t=0;t<16;t++)this.block[t]=0;this.size=-1,this.adLen=0,this.ctLen=0;for(let t=0;t<16;t++)for(let e=0;e<4;e++)this.table[t][e]=0;return t}destroy(){for(let t=0;t<4;t++)this.state[t]=0;for(let t=0;t<16;t++)this.block[t]=0;this.size=-1,this.adLen=0,this.ctLen=0;for(let t=0;t<16;t++)for(let e=0;e<4;e++)this.table[t][e]=0}add(t,e){i(t instanceof Uint32Array),i(4===t.length),i(e instanceof Uint32Array),i(4===e.length);const r=new Uint32Array(4);return r[0]=t[0]^e[0],r[1]=t[1]^e[1],r[2]=t[2]^e[2],r[3]=t[3]^e[3],r}double(t){i(t instanceof Uint32Array),i(4===t.length);const e=new Uint32Array(4),r=1==(1&t[2]);let n;return e[3]=t[3],e[2]=t[2],n=1&e[3],e[3]>>>=1,e[2]>>>=1,e[2]|=n<<31,e[3]|=(1&t[0])<<31,e[1]=t[1],e[0]=t[0],n=1&e[1],e[1]>>>=1,e[0]>>>=1,e[0]|=n<<31,r&&(e[1]^=3774873600,e[0]^=0),e}mul(t){i(t instanceof Uint32Array),i(4===t.length);const e=new Uint32Array(4),r=new Uint32Array(2);let n,o;for(let i=0;i<2;i++){r[0]=t[2],r[1]=t[3],1===i&&(r[0]=t[0],r[1]=t[1]);for(let t=0;t<64;t+=4){const t=15&e[2];n=15&e[3],e[3]>>>=4,e[2]>>>=4,e[2]|=n<<28,e[3]|=e[0]<<28,n=15&e[1],e[1]>>>=4,e[0]>>>=4,e[0]|=n<<28,e[1]^=s[t]<<16,o=this.table[15&r[0]],e[0]^=o[0],e[1]^=o[1],e[2]^=o[2],e[3]^=o[3],n=15&r[1],r[1]>>>=4,r[0]>>>=4,r[0]|=n<<28}}t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * arc4.js - arc4 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(173)},function(t,e,r){"use strict";(function(e){
/*!
 * arc4.js - ARC4 for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009, The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/RC4
 *   http://cypherpunks.venona.com/archive/1994/09/msg00304.html
 *   https://web.archive.org/web/20080207125928/http://cypherpunks.venona.com/archive/1994/09/msg00304.html
 *   https://tools.ietf.org/html/rfc4345
 *   https://tools.ietf.org/html/rfc6229
 *   https://github.com/golang/go/blob/master/src/crypto/rc4/rc4.go
 */
const i=r(1);class n{constructor(){this.s=new Uint32Array(256),this.i=-1,this.j=-1}init(t){i(e.isBuffer(t));const r=t.length;if(r<1||r>256)throw new Error("Invalid key size.");const n=this.s;for(let t=0;t<256;t++)n[t]=t;let s=0;for(let e=0;e<256;e++)s+=n[e]+t[e%r],s&=255,[n[e],n[s]]=[n[s],n[e]];return this.i=0,this.j=0,this}encrypt(t){if(i(e.isBuffer(t)),-1===this.i)throw new Error("Context is not initialized.");const r=this.s;let n,s,{i:o,j:f}=this;for(let e=0;e<t.length;e++)o=o+1&255,n=r[o],f=f+n&255,s=r[f],r[o]=s,r[f]=n,t[e]^=r[n+s&255];return this.i=o,this.j=f,t}destroy(){for(let t=0;t<256;t++)this.s[t]=0;return this.i=-1,this.j=-1,this}}n.native=0,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * bcrypt.js - bcrypt for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on joyent/node-bcrypt-pbkdf:
 *   Copyright (c) 2016, Joyent Inc
 *   https://github.com/joyent/node-bcrypt-pbkdf
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Bcrypt
 *   http://www.usenix.org/events/usenix99/provos/provos_html/node1.html
 *   https://hackernoon.com/the-bcrypt-protocol-is-kind-of-a-mess-4aace5eb31bd
 *   https://github.com/openbsd/src/blob/master/lib/libc/crypt/bcrypt.c
 *   https://github.com/openssh/openssh-portable
 *   https://github.com/openssh/openssh-portable/blob/master/openbsd-compat/bcrypt_pbkdf.c
 *   https://github.com/openssh/openssh-portable/blob/master/openbsd-compat/blowfish.c
 *   https://github.com/joyent/node-bcrypt-pbkdf/blob/master/index.js
 */
const i=r(1),n=r(23),s=r(73),o=t.from("OrpheanBeholderScryDoubt","binary"),f=t.from("OxychromaticBlowfishSwatDynamite","binary"),a=t.alloc(1,0);function c(e,r,n){if("string"==typeof e&&(e=t.from(e,"utf8")),"string"==typeof r&&(r=t.from(r,"utf8")),null==r&&(r=t.alloc(0)),i(t.isBuffer(e)),i(t.isBuffer(r)),i(n>>>0===n),n<4||n>31)throw new RangeError("Invalid rounds.");return function(t,e,r,i){const n=new s,f=new Uint32Array(6);n.init(e,r);const a=2**i;for(let t=0;t<a;t++)n.expand0state(e),n.expand0state(r);for(let t=0;t<6;t++)f[t]=n.stream2word(o);for(let t=0;t<64;t++)n.enc(f);for(let e=0;e<6;e++)t[4*e+0]=f[e]>>>24,t[4*e+1]=f[e]>>>16,t[4*e+2]=f[e]>>>8,t[4*e+3]=f[e];return t}(t.alloc(24),e,r,n)}function h(e,r,n,s="b"){if("string"==typeof e&&(e=t.from(e,"utf8")),"string"==typeof r&&(r=t.from(r,"utf8")),i(t.isBuffer(e)),i(t.isBuffer(r)),i(n>>>0===n),i("string"==typeof s),16!==r.length)throw new RangeError("Invalid salt length.");switch(s){case"a":e=(e=t.concat([e,a])).slice(0,255&e.length);break;case"b":e=e.length>72?e.slice(0,73):t.concat([e,a]);break;default:throw new Error("Invalid minor version.")}return c(e,r,n).slice(0,23)}function u(e,r,s,o){"string"==typeof e&&(e=t.from(e,"utf8")),"string"==typeof r&&(r=t.from(r,"utf8")),null==r&&(r=t.alloc(0)),i(t.isBuffer(e)),i(t.isBuffer(r)),i(s>>>0===s),i(o>>>0===o);const f=t.alloc(32),a=t.alloc(32),c=t.alloc(r.length+4),h=t.alloc(o);if(s<1||0===e.length||0===r.length||0===o||o>f.length**2||r.length>1<<20)throw new Error("Invalid bcrypt parameters.");const u=(o+f.length-1)/f.length>>>0,l=(o+u-1)/u>>>0;r.copy(c,0);const b=n.digest(e);let p=t.alloc(0),m=o,g=l;for(let t=1;m>0;t++){c[r.length+0]=t>>>24,c[r.length+1]=t>>>16,c[r.length+2]=t>>>8,c[r.length+3]=t,p=n.digest(c),d(a,b,p,6),a.copy(f,0);for(let t=1;t<s;t++){p=n.digest(a),d(a,b,p,6);for(let t=0;t<f.length;t++)f[t]^=a[t]}g=Math.min(g,m);let e=0;for(;e<g;e++){const r=e*u+(t-1);if(r>=o)break;h[r]=f[e]}m-=e}return h}function d(t,e,r,i){const n=new s,o=new Uint32Array(8);n.init(e,r);const a=2**i;for(let t=0;t<a;t++)n.expand0state(r),n.expand0state(e);for(let t=0;t<8;t++)o[t]=n.stream2word(f);for(let t=0;t<64;t++)n.enc(o);for(let e=0;e<8;e++)t[4*e+3]=o[e]>>>24,t[4*e+2]=o[e]>>>16,t[4*e+1]=o[e]>>>8,t[4*e+0]=o[e];return t}const l="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function p(e){i(t.isBuffer(e));let r,n,s=0,o="";for(;s<e.length;){if(r=e[s++],o+=l[r>>>2],r=(3&r)<<4,s>=e.length){o+=l[r];break}if(n=e[s++],r|=n>>>4&15,o+=l[r],r=(15&n)<<2,s>=e.length){o+=l[r];break}n=e[s++],r|=n>>>6&3,o+=l[r],o+=l[63&n]}return o}function m(e,r,n){i("string"==typeof e),i(r>>>0===r),i(n>>>0===n);const s=t.alloc(n);let o,f,a,c,h=0;for(;h<n;){if(o=g(e,r++),-1===o)return[r,null];if(f=g(e,r++),-1===f)return[r,null];if(s[h++]=o<<2|(48&f)>>>4,h>=n)break;if(a=g(e,r++),-1===a)return[r,null];if(s[h++]=(15&f)<<4|(60&a)>>>2,h>=n)break;if(c=g(e,r++),-1===c)return[r,null];s[h++]=(3&a)<<6|c}return[r,s]}function g(t,e){if(e>=t.length)return-1;const r=t.charCodeAt(e);return 65408&r?-1:b[r]}e.native=0,e.hash192=c,e.derive=h,e.generate=function(e,r,n,s="b"){if("string"==typeof r){const[t,e]=m(r,0,16);if(t!==r.length||null==e)throw new Error("Invalid salt string.");r=e}return function(e,r,n,s){i("string"==typeof e),i(r>>>0===r),i(t.isBuffer(n)),i(t.isBuffer(s)),i("a"===e||"b"===e),i(r>=4&&r<=31),i(16===n.length),i(23===s.length);let o=r.toString(10);r<10&&(o="0"+o);return`$2${e}$${o}$${p(n)}${p(s)}`}(s,n,r,h(e,r,n,s))},e.verify=function(t,e){const[r,n,s,o]=function(t){if(i("string"==typeof t),t.length<46)throw new Error("Invalid bcrypt string.");if("$"!==t[0]||"2"!==t[1])throw new Error("Invalid major version.");const e=t[2];switch(e){case"a":case"b":break;default:throw new Error("Invalid minor version.")}if("$"!==t[3])throw new Error("Invalid bcrypt string.");const r=t.charCodeAt(4)-48,n=t.charCodeAt(5)-48;if(r<0||r>9||n<0||n>9)throw new Error("Invalid bcrypt string.");const s=10*r+n;if(s<4||s>31)throw new Error("Invalid log rounds.");if("$"!==t[6])throw new Error("Invalid bcrypt string.");let o,f,a=7;if([a,o]=m(t,a,16),null==o)throw new Error("Invalid salt.");if([a,f]=m(t,a,23),null==f)throw new Error("Invalid hash.");if(a!==t.length)throw new Error("Invalid bcrypt string.");return[e,s,o,f]}(e),f=h(t,s,n,r);let a=0;for(let t=0;t<23;t++)a|=f[t]^o[t];return a-1>>>31!=0},e.hash256=function(e,r,n){if("string"==typeof e&&(e=t.from(e,"utf8")),"string"==typeof r&&(r=t.from(r,"utf8")),null==r&&(r=t.alloc(0)),i(t.isBuffer(e)),i(t.isBuffer(r)),i(n>>>0===n),n<4||n>31)throw new RangeError("Invalid rounds.");return d(t.alloc(32),e,r,n)},e.pbkdf=u,e.pbkdfAsync=async function(t,e,r,i){return u(t,e,r,i)}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * blake2b.js - BLAKE2b implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on dcposch/blakejs:
 *   Daniel Clemens Posch (CC0)
 *   https://github.com/dcposch/blakejs/blob/master/blake2b.js
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/BLAKE_(hash_function)
 *   https://tools.ietf.org/html/rfc7693
 */
const i=r(1),n=r(3),s=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),o=new Uint8Array([0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,28,20,8,16,18,30,26,12,2,24,0,4,22,14,10,6,22,16,24,0,10,4,30,26,20,28,6,12,14,2,18,8,14,18,6,2,26,24,22,28,4,12,10,20,8,0,30,16,18,0,10,14,4,8,20,30,28,2,22,24,12,16,6,26,4,24,12,20,0,22,16,6,8,26,14,10,30,28,2,18,24,10,2,30,28,26,8,20,0,14,12,6,18,4,16,22,26,22,14,28,24,2,6,18,10,0,30,8,16,12,4,20,12,30,28,18,22,6,0,16,24,4,26,14,2,8,20,10,20,4,16,8,14,12,2,10,30,22,18,28,6,24,26,0,0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,28,20,8,16,18,30,26,12,2,24,0,4,22,14,10,6]);class f{constructor(){this.state=new Uint32Array(16),this.V=new Uint32Array(32),this.M=new Uint32Array(32),this.block=e.alloc(128),this.size=32,this.count=0,this.pos=2147483648}init(t,r){if(null==t&&(t=32),i(t>>>0===t),i(null==r||e.isBuffer(r)),0===t||t>64)throw new Error("Bad output length.");if(r&&r.length>64)throw new Error("Bad key length.");const n=r?r.length:0;for(let t=0;t<16;t++)this.state[t]=s[t];if(this.size=t,this.count=0,this.pos=0,this.state[0]^=16842752^n<<8^this.size,n>0){const t=e.alloc(128,0);r.copy(t,0),this.update(t)}return this}update(t){i(e.isBuffer(t)),i(!(2147483648&this.pos),"Context is not initialized.");let r=0,n=t.length;if(n>0){const e=this.pos,i=128-e;if(n>i)for(this.pos=0,t.copy(this.block,e,r,r+i),this.count+=128,this._compress(this.block,0,!1),r+=i,n-=i;n>128;)this.count+=128,this._compress(t,r,!1),r+=128,n-=128;t.copy(this.block,this.pos,r,r+n),this.pos+=n}return this}final(){i(!(2147483648&this.pos),"Context is not initialized."),this.count+=this.pos,this.block.fill(0,this.pos,128),this._compress(this.block,0,!0),this.pos=2147483648;const t=e.alloc(this.size);for(let e=0;e<this.size;e++)t[e]=this.state[e>>>2]>>>8*(3&e);for(let t=0;t<16;t++)this.state[t]=0;for(let t=0;t<32;t++)this.V[t]=0,this.M[t]=0;for(let t=0;t<128;t++)this.block[t]=0;return t}_compress(t,e,r){const{V:i,M:n}=this;for(let t=0;t<16;t++)i[t]=this.state[t],i[t+16]=s[t];i[24]^=this.count,i[25]^=this.count*(1/4294967296),i[26]^=0,i[27]^=0,r&&(i[28]^=-1,i[29]^=-1,i[29]^=0,i[30]^=0);for(let r=0;r<32;r++)n[r]=u(t,e),e+=4;for(let t=0;t<12;t++)h(i,n,0,8,16,24,o[16*t+0],o[16*t+1]),h(i,n,2,10,18,26,o[16*t+2],o[16*t+3]),h(i,n,4,12,20,28,o[16*t+4],o[16*t+5]),h(i,n,6,14,22,30,o[16*t+6],o[16*t+7]),h(i,n,0,10,20,30,o[16*t+8],o[16*t+9]),h(i,n,2,12,22,24,o[16*t+10],o[16*t+11]),h(i,n,4,14,16,26,o[16*t+12],o[16*t+13]),h(i,n,6,8,18,28,o[16*t+14],o[16*t+15]);for(let t=0;t<16;t++)this.state[t]^=i[t]^i[t+16]}static hash(){return new f}static hmac(t){return new n(f,128,[t])}static digest(t,e,r){const{ctx:i}=f;return i.init(e,r),i.update(t),i.final()}static root(t,r,n,s){null==n&&(n=32),i(e.isBuffer(t)&&t.length===n),i(e.isBuffer(r)&&r.length===n);const{ctx:o}=f;return o.init(n,s),o.update(t),o.update(r),o.final()}static multi(t,e,r,i,n){const{ctx:s}=f;return s.init(i,n),s.update(t),s.update(e),r&&s.update(r),s.final()}static mac(t,e,r){return f.hmac(r).init(e).update(t).final()}}function a(t,e,r){const i=t[e+0]+t[r+0],n=t[e+1]+t[r+1],s=i>=4294967296|0;t[e+0]=i,t[e+1]=n+s}function c(t,e,r,i){const n=t[e+0]+r,s=t[e+1]+i,o=n>=4294967296|0;t[e+0]=n,t[e+1]=s+o}function h(t,e,r,i,n,s,o,f){const h=e[o+0],u=e[o+1],d=e[f+0],l=e[f+1];a(t,r,i),c(t,r,h,u);const b=t[s+0]^t[r+0],p=t[s+1]^t[r+1];t[s+0]=p,t[s+1]=b,a(t,n,s);const m=t[i+0]^t[n+0],g=t[i+1]^t[n+1];t[i+0]=m>>>24^g<<8,t[i+1]=g>>>24^m<<8,a(t,r,i),c(t,r,d,l);const w=t[s+0]^t[r+0],y=t[s+1]^t[r+1];t[s+0]=w>>>16^y<<16,t[s+1]=y>>>16^w<<16,a(t,n,s);const v=t[i+0]^t[n+0],S=t[i+1]^t[n+1];t[i+0]=S>>>31^v<<1,t[i+1]=v>>>31^S<<1}function u(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]}f.native=0,f.id="BLAKE2B256",f.size=32,f.bits=256,f.blockSize=128,f.zero=e.alloc(32,0),f.ctx=new f,t.exports=f}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * blake2b160.js - BLAKE2b implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(24);class n extends i{constructor(){super()}init(t){return super.init(20,t)}static hash(){return new n}static hmac(){return super.hmac(20)}static digest(t,e){return super.digest(t,20,e)}static root(t,e,r){return super.root(t,e,20,r)}static multi(t,e,r,i){return super.multi(t,e,r,20,i)}static mac(t,e){return super.mac(t,e,20)}}n.native=i.native,n.id="BLAKE2B160",n.size=20,n.bits=160,n.blockSize=128,n.zero=e.alloc(20,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * blake2b256.js - BLAKE2b implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(24);class n extends i{constructor(){super()}init(t){return super.init(32,t)}static hash(){return new n}static hmac(){return super.hmac(32)}static digest(t,e){return super.digest(t,32,e)}static root(t,e,r){return super.root(t,e,32,r)}static multi(t,e,r,i){return super.multi(t,e,r,32,i)}static mac(t,e){return super.mac(t,e,32)}}n.native=i.native,n.id="BLAKE2B256",n.size=32,n.bits=256,n.blockSize=128,n.zero=e.alloc(32,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * blake2b384.js - BLAKE2b implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(24);class n extends i{constructor(){super()}init(t){return super.init(48,t)}static hash(){return new n}static hmac(){return super.hmac(48)}static digest(t,e){return super.digest(t,48,e)}static root(t,e,r){return super.root(t,e,48,r)}static multi(t,e,r,i){return super.multi(t,e,r,48,i)}static mac(t,e){return super.mac(t,e,48)}}n.native=i.native,n.id="BLAKE2B384",n.size=48,n.bits=384,n.blockSize=128,n.zero=e.alloc(48,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * blake2b512.js - BLAKE2b implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(24);class n extends i{constructor(){super()}init(t){return super.init(64,t)}static hash(){return new n}static hmac(){return super.hmac(64)}static digest(t,e){return super.digest(t,64,e)}static root(t,e,r){return super.root(t,e,64,r)}static multi(t,e,r,i){return super.multi(t,e,r,64,i)}static mac(t,e){return super.mac(t,e,64)}}n.native=i.native,n.id="BLAKE2B512",n.size=64,n.bits=512,n.blockSize=128,n.zero=e.alloc(64,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * blake2s.js - BLAKE2s implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on dcposch/blakejs:
 *   Daniel Clemens Posch (CC0)
 *   https://github.com/dcposch/blakejs/blob/master/blake2s.js
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/BLAKE_(hash_function)
 *   https://tools.ietf.org/html/rfc7693
 */
const i=r(1),n=r(3),s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),o=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]);class f{constructor(){this.state=new Uint32Array(8),this.V=new Uint32Array(16),this.M=new Uint32Array(16),this.block=e.alloc(64),this.size=32,this.count=0,this.pos=2147483648}init(t,r){if(null==t&&(t=32),i(t>>>0===t),i(null==r||e.isBuffer(r)),0===t||t>32)throw new Error("Bad output length.");if(r&&r.length>32)throw new Error("Bad key length.");const n=r?r.length:0;for(let t=0;t<8;t++)this.state[t]=s[t];if(this.size=t,this.count=0,this.pos=0,this.state[0]^=16842752^n<<8^this.size,n>0){const t=e.alloc(64,0);r.copy(t,0),this.update(t)}return this}update(t){i(e.isBuffer(t)),i(!(2147483648&this.pos),"Context is not initialized.");let r=0,n=t.length;if(n>0){const e=this.pos,i=64-e;if(n>i)for(this.pos=0,t.copy(this.block,e,r,r+i),this.count+=64,this._compress(this.block,0,!1),r+=i,n-=i;n>64;)this.count+=64,this._compress(t,r,!1),r+=64,n-=64;t.copy(this.block,this.pos,r,r+n),this.pos+=n}return this}final(){i(!(2147483648&this.pos),"Context is not initialized."),this.count+=this.pos,this.block.fill(0,this.pos,64),this._compress(this.block,0,!0),this.pos=2147483648;const t=e.alloc(this.size);for(let e=0;e<this.size;e++)t[e]=this.state[e>>>2]>>>8*(3&e);for(let t=0;t<8;t++)this.state[t]=0;for(let t=0;t<16;t++)this.V[t]=0,this.M[t]=0;for(let t=0;t<64;t++)this.block[t]=0;return t}_compress(t,e,r){const{V:i,M:n}=this;for(let t=0;t<8;t++)i[t]=this.state[t],i[t+8]=s[t];i[12]^=this.count,i[13]^=this.count*(1/4294967296),r&&(i[14]^=-1,i[15]^=0);for(let r=0;r<16;r++)n[r]=h(t,e),e+=4;for(let t=0;t<10;t++)c(i,n,0,4,8,12,o[16*t+0],o[16*t+1]),c(i,n,1,5,9,13,o[16*t+2],o[16*t+3]),c(i,n,2,6,10,14,o[16*t+4],o[16*t+5]),c(i,n,3,7,11,15,o[16*t+6],o[16*t+7]),c(i,n,0,5,10,15,o[16*t+8],o[16*t+9]),c(i,n,1,6,11,12,o[16*t+10],o[16*t+11]),c(i,n,2,7,8,13,o[16*t+12],o[16*t+13]),c(i,n,3,4,9,14,o[16*t+14],o[16*t+15]);for(let t=0;t<8;t++)this.state[t]^=i[t]^i[t+8]}static hash(){return new f}static hmac(t){return new n(f,64,[t])}static digest(t,e,r){const{ctx:i}=f;return i.init(e,r),i.update(t),i.final()}static root(t,r,n,s){null==n&&(n=32),i(e.isBuffer(t)&&t.length===n),i(e.isBuffer(r)&&r.length===n);const{ctx:o}=f;return o.init(n,s),o.update(t),o.update(r),o.final()}static multi(t,e,r,i,n){const{ctx:s}=f;return s.init(i,n),s.update(t),s.update(e),r&&s.update(r),s.final()}static mac(t,e,r){return f.hmac(r).init(e).update(t).final()}}function a(t,e){return t>>>e^t<<32-e}function c(t,e,r,i,n,s,o,f){const c=e[o],h=e[f];t[r]=t[r]+t[i]+c,t[s]=a(t[s]^t[r],16),t[n]=t[n]+t[s],t[i]=a(t[i]^t[n],12),t[r]=t[r]+t[i]+h,t[s]=a(t[s]^t[r],8),t[n]=t[n]+t[s],t[i]=a(t[i]^t[n],7)}function h(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]}f.native=0,f.id="BLAKE2S256",f.size=32,f.bits=256,f.blockSize=64,f.zero=e.alloc(32,0),f.ctx=new f,t.exports=f}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * blake2s128.js - BLAKE2s implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(25);class n extends i{constructor(){super()}init(t){return super.init(16,t)}static hash(){return new n}static hmac(){return super.hmac(16)}static digest(t,e){return super.digest(t,16,e)}static root(t,e,r){return super.root(t,e,16,r)}static multi(t,e,r,i){return super.multi(t,e,r,16,i)}static mac(t,e){return super.mac(t,e,16)}}n.native=i.native,n.id="BLAKE2S128",n.size=16,n.bits=128,n.blockSize=64,n.zero=e.alloc(16,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * blake2s160.js - BLAKE2s implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(25);class n extends i{constructor(){super()}init(t){return super.init(20,t)}static hash(){return new n}static hmac(){return super.hmac(20)}static digest(t,e){return super.digest(t,20,e)}static root(t,e,r){return super.root(t,e,20,r)}static multi(t,e,r,i){return super.multi(t,e,r,20,i)}static mac(t,e){return super.mac(t,e,20)}}n.native=i.native,n.id="BLAKE2S160",n.size=20,n.bits=160,n.blockSize=64,n.zero=e.alloc(20,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * blake2s224.js - BLAKE2s implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(25);class n extends i{constructor(){super()}init(t){return super.init(28,t)}static hash(){return new n}static hmac(){return super.hmac(28)}static digest(t,e){return super.digest(t,28,e)}static root(t,e,r){return super.root(t,e,28,r)}static multi(t,e,r,i){return super.multi(t,e,r,28,i)}static mac(t,e){return super.mac(t,e,28)}}n.native=i.native,n.id="BLAKE2S224",n.size=28,n.bits=224,n.blockSize=64,n.zero=e.alloc(28,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * blake2s256.js - BLAKE2s implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(25);class n extends i{constructor(){super()}init(t){return super.init(32,t)}static hash(){return new n}static hmac(){return super.hmac(32)}static digest(t,e){return super.digest(t,32,e)}static root(t,e,r){return super.root(t,e,32,r)}static multi(t,e,r,i){return super.multi(t,e,r,32,i)}static mac(t,e){return super.mac(t,e,32)}}n.native=i.native,n.id="BLAKE2S256",n.size=32,n.bits=256,n.blockSize=64,n.zero=e.alloc(32,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * bn.js - big numbers for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/bn.js:
 *   Copyright (c) 2015, Fedor Indutny (MIT License).
 *   https://github.com/indutny/bn.js
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009, The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Parts of this software are based on openssl/openssl:
 *   Copyright (c) 1998-2018, The OpenSSL Project (Apache License v2.0).
 *   Copyright (c) 1995-1998, Eric A. Young, Tim J. Hudson. All rights reserved.
 *   https://github.com/openssl/openssl
 *
 * Parts of this software are based on libgmp:
 *   Copyright (c) 1991-1997, 1999-2014, Free Software Foundation, Inc.
 *   https://gmplib.org/
 *
 * Parts of this software are based on v8/v8:
 *   Copyright (c) 2017, The V8 Project Authors (BSD-Style License).
 *   https://github.com/v8/v8
 *
 * Resources:
 *   https://github.com/indutny/bn.js/blob/master/lib/bn.js
 *   https://github.com/indutny/miller-rabin/blob/master/lib/mr.js
 *   https://github.com/golang/go/blob/master/src/math/big/int.go
 *   https://github.com/golang/go/blob/master/src/math/big/nat.go
 *   https://github.com/golang/go/blob/master/src/math/big/prime.go
 *   https://github.com/openssl/openssl/tree/master/crypto/bn
 *   https://github.com/openssl/openssl/blob/master/crypto/bn/bn_kron.c
 *   https://github.com/gnutls/nettle/blob/master/mini-gmp.c
 *   https://github.com/v8/v8/blob/master/src/objects/bigint.cc
 */
const{custom:i}=r(74),n=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],s=[0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],o=[0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176],f={p192:null,p224:null,p521:null,k256:null,p251:null,p25519:null,p448:null},a=0,c=1,h=2,u=3,d=4,l=7,b="function"==typeof BigInt;class p{constructor(t,e,r){this.words=[0],this.length=1,this.negative=0,this.red=null,this.from(t,e,r)}_iadd(t,e){let r=0,i=0;for(t.length<e.length&&([t,e]=[e,t]),t!==this&&this._alloc(t.length);i<e.length;i++){const n=(0|t.words[i])+(0|e.words[i])+r;this.words[i]=67108863&n,r=n>>>26}for(;0!==r&&i<t.length;i++){const e=(0|t.words[i])+r;this.words[i]=67108863&e,r=e>>>26}if(this.length=t.length,0!==r)this._alloc(this.length+1),this.words[this.length++]=r;else if(t!==this)for(;i<t.length;i++)this.words[i]=t.words[i];return this}_iaddn(t){if(this.words[0]+=t,this.words[0]<67108864)return this;let e=0;for(this._alloc(this.length+1),this.words[this.length]=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,this.words[e+1]+=1;return this.length=Math.max(this.length,e+1),this}iadd(t){if(N(p.isBN(t),"num","bignum"),this.negative===t.negative)this._iadd(this,t);else{const e=this.ucmp(t);if(0===e)return this.words[0]=0,this.length=1,this.negative=0,this;e<0?(this._isub(t,this),this.negative^=1):this._isub(this,t)}return this}iaddn(t){N(D(t),"num","smi");const e=t<0|0;return e&&(t=-t),this.negative===e?this._iaddn(t):1===this.length&&this.words[0]<t?(this.words[0]=t-this.words[0],this.negative^=1):this._isubn(t),this}add(t){return N(p.isBN(t),"num","bignum"),t.length>this.length?t.clone().iadd(this):this.clone().iadd(t)}addn(t){return this.clone().iaddn(t)}_isub(t,e){let r=0,i=0;for(q(t.length>=e.length),t!==this&&this._alloc(t.length);i<e.length;i++){const n=(0|t.words[i])-(0|e.words[i])+r;r=n>>26,this.words[i]=67108863&n}for(;0!==r&&i<t.length;i++){const e=(0|t.words[i])+r;r=e>>26,this.words[i]=67108863&e}if(q(0===r),t!==this)for(;i<t.length;i++)this.words[i]=t.words[i];return this.length=Math.max(this.length,i),this._strip()}_isubn(t){if(this.words[0]-=t,this.words[0]>=0)return this._normalize();q(1!==this.length),this._alloc(this.length+1);for(let t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.words[this.length]=0,this._strip()}isub(t){if(N(p.isBN(t),"num","bignum"),this.negative!==t.negative)this._iadd(this,t);else{const e=this.ucmp(t);if(0===e)return this.words[0]=0,this.length=1,this.negative=0,this;e<0?(this._isub(t,this),this.negative^=1):this._isub(this,t)}return this}isubn(t){N(D(t),"num","smi");const e=t<0|0;return e&&(t=-t),this.negative!==e?this._iaddn(t):1===this.length&&this.words[0]<t?(this.words[0]=t-this.words[0],this.negative^=1):this._isubn(t),this}sub(t){return this.clone().isub(t)}subn(t){return this.clone().isubn(t)}_mul(t,e){if(N(p.isBN(t),"num","bignum"),N(p.isBN(e),"out","bignum"),10===this.length&&10===t.length)return J(this,t,e);const r=this.length+t.length;return r<63?V(this,t,e):r<1024?G(this,t,e):function(t,e,r){if(!b||t.length+e.length>82595519)return G(t,e,r);const i=BigInt(0),n=BigInt(67108863),s=BigInt(26);let o=t.toBigInt()*e.toBigInt();const f=o<i|0;f&&(o=-o);let a=0;for(;o>i;)r.words[a++]=Number(o&n),o>>=s;0===a&&(r.words[a++]=0);return r.length=a,r.negative=f,r}(this,t,e)}imul(t){return this.mul(t)._move(this)}imuln(t){N(D(t),"num","smi");const e=t<0|0;e&&(t=-t);let r=0;for(let e=0;e<this.length;e++){const i=this.words[e]*t,n=(67108863&i)+(67108863&r);r>>=26,r+=i/67108864|0,r+=n>>>26,this.words[e]=67108863&n}return this.negative^=e,0!==r?(this._alloc(this.length+1),this.words[this.length++]=r):this._strip(),this}mul(t){N(p.isBN(t),"num","bignum");const e=this.length+t.length,r=new p;r.words=new Array(e);for(let t=0;t<e;t++)r.words[t]=0;return this._mul(t,r)}muln(t){return this.clone().imuln(t)}mulShift(t,e){N(p.isBN(t),"num","bignum"),N(e>>>0===e,"bits","uint32");const r=this.mul(t),i=r.utestn(e-1);return r.iushrn(e),this.negative^t.negative?r.isubn(i):r.iaddn(i)}_div(t,e){N(p.isBN(t),"num","bignum"),q((e&l)===e),q(e!==a);const r=this,i=t;if(U(!i.isZero()),r.isZero())return[new p(0),new p(0)];const n=r.negative,s=i.negative;r.negative=0,i.negative=0;let o=null,f=null;return r.ucmp(i)<0?(e&c&&(o=new p(0)),e&h&&(f=r.clone())):1===i.length?(e&c&&(o=r.quon(i.words[0])),e&h&&(f=r.remn(i.words[0]))):[o,f]=r._wordDiv(i,e),r.negative=n,i.negative=s,e&c&&(o.negative=r.negative^i.negative,o._normalize()),e&h&&(f.negative=r.negative,f._normalize()),e&d&&(e&c&&(q(0!=(e&h)),0!==f.negative&&(0!==i.negative?o.iaddn(1):o.isubn(1))),e&h&&0!==f.negative&&(0!==i.negative?f.isub(i):f.iadd(i))),[o,f]}_wordDiv(t,e){let r,i=this.clone(),n=t,s=null;const o=0|n.words[n.length-1],f=26-K(o);0!==f?(n=n.clone(),i.iushln(f),n.iushln(f),r=0|n.words[n.length-1]):r=o;const a=i.length-n.length;if(q(a>=0),e&c){s=new p(0),s.length=a+1,s.words=new Array(s.length);for(let t=0;t<s.length;t++)s.words[t]=0}const u=i.clone();u._ishlnsubmul(n,1,a),0===u.negative&&(s&&(s.words[a]=1),i=u);for(let t=a-1;t>=0;t--){const e=(67108864*i.words[n.length+t]+i.words[n.length+t-1])/r|0;let o=Math.min(e,67108863);for(i._ishlnsubmul(n,o,t);0!==i.negative;)o-=1,i.negative=0,i._ishlnsubmul(n,1,t),i.ineg();s&&(s.words[t]=o)}return s&&s._strip(),e&h&&0!==f&&i.iushrn(f),[s,i]}_ishlnsubmul(t,e,r){let i=0,n=0;for(this._expand(t.length+r);n<t.length;n++){const s=(0|this.words[n+r])+i,o=t.words[n]*e,f=s-(67108863&o);i=(f>>26)-(o/67108864|0),this.words[n+r]=67108863&f}for(;n<this.length-r;n++){const t=(0|this.words[n+r])+i;i=t>>26,this.words[n+r]=67108863&t}if(0===i)return this._strip();q(-1===i),i=0;for(let t=0;t<this.length;t++){const e=-(0|this.words[t])+i;i=e>>26,this.words[t]=67108863&e}return this.negative=1,this._strip()}quorem(t){return this._div(t,u)}iquo(t){return this.quo(t)._move(this)}iquon(t){N(D(t),"num","smi"),U(0!==t);const e=t<0|0;e&&(t=-t);let r=0;for(let e=this.length-1;e>=0;e--){const i=(0|this.words[e])+67108864*r;this.words[e]=i/t|0,r=i%t}return this.negative^=e,this._strip()}quo(t){return this._div(t,c)[0]}quon(t){return this.clone().iquon(t)}irem(t){return this.rem(t)._move(this)}iremn(t){let e=this.remrn(t);return e<0&&(e=-e),this.words[0]=e,this.length=1,this._normalize()}rem(t){return this._div(t,h)[1]}remn(t){return this.clone().iremn(t)}remrn(t){N(D(t),"num","smi"),U(0!==t),t<0&&(t=-t);const e=(1<<26)%t;let r=0;for(let i=this.length-1;i>=0;i--)r=(e*r+(0|this.words[i]))%t;return 0!==this.negative?0|-r:r}divmod(t){return this._div(t,u|d)}idiv(t){return this.div(t)._move(this)}idivn(t){if(0===this.negative)return this.iquon(t);const e=this.remrn(t);return this.iquon(t),e<0&&(t<0?this.iaddn(1):this.isubn(1)),this}div(t){return this._div(t,u|d)[0]}divn(t){return this.clone().idivn(t)}imod(t){return this.ucmp(t)<0?(0!==this.negative&&(this._isub(t,this),this.negative=0),this):this.mod(t)._move(this)}imodn(t){return this.words[0]=this.modrn(t),this.length=1,this.negative=0,this}mod(t){return this._div(t,h|d)[1]}modn(t){return this.clone().imodn(t)}modrn(t){N(D(t),"num","smi");let e=this.remrn(t);return e<0&&(t<0?e-=t:e+=t),e}divRound(t){const[e,r]=this.quorem(t);if(r.isZero())return e;const i=1&t.words[0];t.iushrn(1);const n=r.ucmp(t);return t.iushln(1),t.words[0]|=i,n<0||t.isOdd()&&0===n?e:this.negative^t.negative?e.isubn(1):e.iaddn(1)}ipow(t){return this.pow(t)._move(this)}ipown(t){return this.pown(t)._move(this)}pow(t){N(p.isBN(t),"num","bignum");let e=K(t.words[t.length-1]),r=new p(1);for(let i=t.length-1;i>=0;i--){const n=t.words[i];for(let t=e-1;t>=0;t--)r=r.sqr(),n>>t&1&&(r=r.mul(this));e=26}return r}pown(t){if(N(D(t),"num","smi"),t<0&&(t=-t),0===t)return new p(1);if(1===t)return this.clone();let e=this;for(let r=K(t)-2;r>=0;r--)e=e.sqr(),t>>r&1&&(e=e.mul(this));return e}isqr(){return this.imul(this)}sqr(){return this.mul(this)}_rootrem(t,e){if(N(t>>>0===t,"num","uint32"),0===t)throw new RangeError("Zeroth root.");if(~t&this.negative)throw new RangeError("Negative with even root.");if(this.ucmpn(1)<=0)return[this.clone(),new p(0)];let r,i,n=new p(0),s=p.shift(1,this.bitLength()/t+1|0);if(0!==this.negative&&s.ineg(),2===t)do{n=s,s=this.quo(n),s.iadd(n),s.iushrn(1)}while(s.ucmp(n)<0);else do{n=s,s=n.pown(t-1),s=this.quo(s),r=n.muln(t-1),s.iadd(r),s=s.quon(t)}while(s.ucmp(n)<0);return e&&(s=n.pown(t),i=this.sub(s)),[n,i]}rootrem(t){return this._rootrem(t,1)}iroot(t){return this.root(t)._move(this)}root(t){return this._rootrem(t,0)[0]}isPower(t){if(N(t>>>0===t,"num","uint32"),0===t||~t&this.negative)return!1;const[,e]=this.rootrem(t);return 0===e.sign()}sqrtrem(){return this.rootrem(2)}isqrt(){return this.sqrt()._move(this)}sqrt(){return this.root(2)}isSquare(){return this.isPower(2)}iand(t){N(p.isBN(t),"num","bignum");let e=this,r=t;if(e===r)return e;if(0==(e.negative|r.negative))return e.iuand(r);if(1==(e.negative&r.negative))return e.iaddn(1),r.iaddn(1),e.iuor(r),e.isubn(1),r.isubn(1),e;0!==e.negative&&([e,r]=[r.clone(),e]);const i=e.bitLength();return r.iaddn(1),r.inotn(i),e.iuand(r),r.inotn(i),r.isubn(1),e._move(this)}iandn(t){return N(D(t),"num","smi"),0!=(this.negative|t<0)?this.iand(new p(t)):(this.words[0]&=t,this.length=1,this)}and(t){return this.clone().iand(t)}andn(t){return this.clone().iandn(t)}andrn(t){if(N(D(t),"num","smi"),0!=(this.negative|t<0)){const e=this.iand(new p(t));if(e.length>1)throw new RangeError("Number exceeds 26 bits.");return 0!==e.negative?-e.words[0]:e.words[0]}return this.words[0]&t}iuand(t){N(p.isBN(t),"num","bignum"),this.length=Math.min(this.length,t.length);for(let e=0;e<this.length;e++)this.words[e]&=t.words[e];return this._strip()}iuandn(t){return N(D(t),"num","smi"),this.words[0]&=Math.abs(t),this.length=1,this._normalize()}uand(t){return this.clone().iuand(t)}uandn(t){return this.clone().iuandn(t)}uandrn(t){N(D(t),"num","smi");const e=this.words[0]&Math.abs(t);return 0!==this.negative?0|-e:e}ior(t){N(p.isBN(t),"num","bignum");let e=this,r=t;return e===r?e:0==(e.negative|r.negative)?e.iuor(r):1==(e.negative&r.negative)?(e.iaddn(1),r.iaddn(1),e.iuand(r),e.isubn(1),r.isubn(1),e):(r=r.clone(),0!==e.negative&&([e,r]=[r,e]),r.iaddn(1),e.inotn(r.bitLength()),r.iuand(e),r.isubn(1),r._move(this))}iorn(t){return N(D(t),"num","smi"),0!=(this.negative|t<0)?this.ior(new p(t)):(this.words[0]|=t,this)}or(t){return this.clone().ior(t)}orn(t){return this.clone().iorn(t)}iuor(t){N(p.isBN(t),"num","bignum"),this._expand(t.length);for(let e=0;e<t.length;e++)this.words[e]|=t.words[e];return this}iuorn(t){return N(D(t),"num","smi"),this.words[0]|=Math.abs(t),this}uor(t){return this.clone().iuor(t)}uorn(t){return this.clone().iuorn(t)}ixor(t){N(p.isBN(t),"num","bignum");let e=this,r=t;return e===r?(e.words[0]=0,e.length=1,e.negative=0,e):0==(e.negative|r.negative)?e.iuxor(r):1==(e.negative&r.negative)?(e.iaddn(1),r.iaddn(1),e.iuxor(r),e.ineg(),r.isubn(1),e):(0!==e.negative&&([e,r]=[r.clone(),e]),r.iaddn(1),e.iuxor(r),e.iaddn(1),e.ineg(),r.isubn(1),e._move(this))}ixorn(t){return N(D(t),"num","smi"),0!=(this.negative|t<0)?this.ixor(new p(t)):(this.words[0]^=t,this)}xor(t){return this.clone().ixor(t)}xorn(t){return this.clone().ixorn(t)}iuxor(t){N(p.isBN(t),"num","bignum");let e=this,r=t;e.length<r.length&&([e,r]=[r,e]);let i=0;for(;i<r.length;i++)this.words[i]=e.words[i]^r.words[i];if(e!==this)for(this._alloc(e.length);i<e.length;i++)this.words[i]=e.words[i];return this.length=e.length,this._strip()}iuxorn(t){return N(D(t),"num","smi"),this.words[0]^=Math.abs(t),this._normalize()}uxor(t){return this.clone().iuxor(t)}uxorn(t){return this.clone().iuxorn(t)}inot(){return 0!==this.negative?this.ineg().isubn(1):this.iaddn(1).ineg(),this}not(){return this.clone().inot()}inotn(t){N(t>>>0===t,"width","uint32");const e=t%26;let r=Math.ceil(t/26),i=0;for(this._expand(r),e>0&&(r-=1);i<r;i++)this.words[i]^=67108863;return e>0&&(this.words[i]^=(1<<e)-1),this._strip()}notn(t){return this.clone().inotn(t)}ishl(t){return N(p.isBN(t),"bits","bignum"),N(t.bitLength()<=32,"bits","uint32"),this.ishln(t.toNumber())}ishln(t){return this.iushln(t)}shl(t){return this.clone().ishl(t)}shln(t){return this.clone().ishln(t)}iushl(t){return N(p.isBN(t),"bits","bignum"),N(t.bitLength()<=32,"bits","uint32"),this.iushln(t.toNumber())}iushln(t){N(t>>>0===t,"bits","uint32");const e=t%26,r=(t-e)/26,i=(1<<e)-1<<26-e;if(0!==e){let t=0;for(let r=0;r<this.length;r++){const n=this.words[r]&i,s=(0|this.words[r])-n<<e;this.words[r]=s|t,t=n>>>26-e}0!==t&&(this._alloc(this.length+1),this.words[this.length++]=t)}if(0!==r){this._alloc(this.length+r);for(let t=this.length-1;t>=0;t--)this.words[t+r]=this.words[t];for(let t=0;t<r;t++)this.words[t]=0;this.length+=r}return this._strip()}ushl(t){return this.clone().iushl(t)}ushln(t){return this.clone().iushln(t)}_split(t,e){const r=t%26,i=Math.min((t-r)/26,this.length),n=(1<<r)-1;if(e){e._alloc(i);for(let t=0;t<i;t++)e.words[t]=this.words[t];e.length=i}if(0===i);else if(this.length>i){this.length-=i;for(let t=0;t<this.length;t++)this.words[t]=this.words[t+i]}else this.words[0]=0,this.length=1;let s=0;if(0!==r)for(let t=this.length-1;t>=0;t--){const e=0|this.words[t];this.words[t]=s<<26-r|e>>>r,s=e&n}return e&&(0!==s?(e._alloc(e.length+1),e.words[e.length++]=s):(0===e.length&&(e.words[e.length++]=0),e._strip())),this._strip()}ishr(t){return N(p.isBN(t),"bits","bignum"),N(t.bitLength()<=32,"bits","uint32"),this.ishrn(t.toNumber())}ishrn(t){return N(t>>>0===t,"bits","uint32"),0!==this.negative?(this.iaddn(1),this.iushrn(t),this.isubn(1),this):this.iushrn(t)}shr(t){return this.clone().ishr(t)}shrn(t){return this.clone().ishrn(t)}iushr(t){return N(p.isBN(t),"bits","bignum"),N(t.bitLength()<=32,"bits","uint32"),this.iushrn(t.toNumber())}iushrn(t){return N(t>>>0===t,"bits","uint32"),this._split(t,null)}ushr(t){return this.clone().iushr(t)}ushrn(t){return this.clone().iushrn(t)}setn(t,e){return N(t>>>0===t,"bit","uint32"),0!==this.negative?(this.iaddn(1),this.usetn(t,!e),this.isubn(1),this):this.usetn(t,e)}usetn(t,e){N(t>>>0===t,"bit","uint32");const r=t%26,i=(t-r)/26;return this._expand(i+1),e?this.words[i]|=1<<r:this.words[i]&=~(1<<r),this._strip()}testn(t){N(t>>>0===t,"bit","uint32");const e=t%26,r=(t-e)/26;if(this.length<=r)return this.negative;const i=this.words[r],n=i>>e&1;if(0!==this.negative){if(e>0&&i&(1<<e)-1)return 1^n;let t=r;for(;t--;)if(this.words[t]>0)return 1^n}return n}utestn(t){N(t>>>0===t,"bit","uint32");const e=t%26,r=(t-e)/26;return this.length<=r?0:this.words[r]>>e&1}imaskn(t){return N(t>>>0===t,"bits","uint32"),0!==this.negative&&(this.iaddn(1),this.inotn(t+1),this.ineg()),this.iumaskn(t)}maskn(t){return this.clone().imaskn(t)}iumaskn(t){N(t>>>0===t,"bits","uint32");const e=t%26;let r=(t-e)/26;return this.length<=r?this:(0!==e&&(r+=1),this.length=Math.min(r,this.length),0!==e&&(this.words[this.length-1]&=(1<<e)-1),0===this.length&&(this.words[this.length++]=0),this._strip())}umaskn(t){return this.clone().iumaskn(t)}andln(t){return this.words[0]&t}bit(t){return this.utestn(t)}bits(t,e){N(t>>>0===t,"pos","uint32"),N(e>>>0===e,"width","uint32"),N(e<=26,"width","width");const r=t%26,i=(t-r)/26;if(i>=this.length)return 0;let n=this.words[i]>>r&(1<<e)-1;if(r+e>26&&i+1<this.length){const t=r+e-26;n|=(this.words[i+1]&(1<<t)-1)<<26-r}return n}ineg(){return this.isZero()||(this.negative^=1),this}neg(){return this.clone().ineg()}iabs(){return this.negative=0,this}abs(){return this.clone().iabs()}cmp(t){if(N(p.isBN(t),"num","bignum"),this.negative!==t.negative)return t.negative-this.negative;const e=this.ucmp(t);return 0!==this.negative?0|-e:e}cmpn(t){N(D(t),"num","smi");const e=t<0|0;if(this.negative!==e)return e-this.negative;const r=this.ucmpn(t);return 0!==this.negative?0|-r:r}eq(t){return 0===this.cmp(t)}eqn(t){return 0===this.cmpn(t)}gt(t){return this.cmp(t)>0}gtn(t){return this.cmpn(t)>0}gte(t){return this.cmp(t)>=0}gten(t){return this.cmpn(t)>=0}lt(t){return this.cmp(t)<0}ltn(t){return this.cmpn(t)<0}lte(t){return this.cmp(t)<=0}lten(t){return this.cmpn(t)<=0}sign(){return 0!==this.negative?-1:1===this.length&&0===this.words[0]?0:1}isZero(){return 1===this.length&&0===this.words[0]}isNeg(){return 0!==this.negative}isPos(){return 0===this.negative}isOdd(){return 1==(1&this.words[0])}isEven(){return 0==(1&this.words[0])}ucmp(t){if(N(p.isBN(t),"num","bignum"),this.length<t.length)return-1;if(this.length>t.length)return 1;for(let e=this.length-1;e>=0;e--){const r=0|this.words[e],i=0|t.words[e];if(r!==i)return(r>i)-(r<i)}return 0}ucmpn(t){if(N(D(t),"num","smi"),this.length>1)return 1;const e=0|this.words[0];return t<0&&(t=-t),(e>t)-(e<t)}legendre(t){const e=b?p.red(t):p.mont(t);return this.toRed(e).redLegendre()}jacobi(t){if(N(p.isBN(t),"num","bignum"),t.isZero()||t.isEven())throw new Error("jacobi: `num` must be odd.");let e=this._cloneNormal(),r=t.clone(),i=1;for(r.isNeg()&&(e.isNeg()&&(i=-1),r.ineg()),(e.isNeg()||e.ucmp(r)>=0)&&e.imod(r);!e.isZero();){if(1&e._makeOdd()){const t=r.andln(7);3!==t&&5!==t||(i=-i)}e.ucmp(r)<0&&([e,r]=[r,e],3===e.andln(3)&&3===r.andln(3)&&(i=-i)),e._isub(e,r).iushrn(1);const t=r.andln(7);3!==t&&5!==t||(i=-i)}return 0!==r.cmpn(1)?0:i}kronecker(t){N(p.isBN(t),"num","bignum");const e=[0,1,0,-1,0,-1,0,1];let r=this._cloneNormal(),i=t.clone(),n=1;if(i.isZero())return 0===r.ucmpn(1)?n:0;if(!r.isOdd()&&!i.isOdd())return 0;for(1&i._makeOdd()&&(n=e[r.andln(7)]),i.isNeg()&&(r.isNeg()&&(n=-n),i.ineg());!r.isZero();){1&r._makeOdd()&&(n*=e[i.andln(7)]);(r.words[0]^67108863*r.negative)&i.words[0]&2&&(n=-n),i.imod(r),[r,i]=[i,r],i.negative=0}return 0!==i.cmpn(1)?0:n}igcd(t){return this.gcd(t)._move(this)}gcd(t){if(N(p.isBN(t),"num","bignum"),this.isZero())return t.abs();if(t.isZero())return this.abs();let e=this.clone(),r=t.clone();e.negative=0,r.negative=0;const i=e._factor2(r);for(0!==i&&(e.iushrn(i),r.iushrn(i));;){e._makeOdd(),r._makeOdd();const t=e.ucmp(r);if(t<0)[e,r]=[r,e];else if(0===t||0===r.ucmpn(1))break;e._isub(e,r)}return r.iushln(i)}ilcm(t){return this.lcm(t)._move(this)}lcm(t){return N(p.isBN(t),"num","bignum"),this.isZero()||t.isZero()?new p(0):this.quo(this.gcd(t)).mul(t).iabs()}egcd(t){if(N(p.isBN(t),"num","bignum"),this.isZero())return[new p(0),new p(t.sign()),t.abs()];if(t.isZero())return[new p(this.sign()),new p(0),this.abs()];const e=this.clone(),r=t.clone();e.negative=0,r.negative=0;const i=new p(1),n=new p(0),s=new p(0),o=new p(1),f=e._factor2(r);f>0&&(e.iushrn(f),r.iushrn(f));const a=e.clone(),c=r.clone();for(;!e.isZero();){let t=e._makeOdd(),f=r._makeOdd();for(;t--;)(i.isOdd()||n.isOdd())&&(i.iadd(c),n.isub(a)),i.iushrn(1),n.iushrn(1);for(;f--;)(s.isOdd()||o.isOdd())&&(s.iadd(c),o.isub(a)),s.iushrn(1),o.iushrn(1);e.cmp(r)>=0?(e.isub(r),i.isub(s),n.isub(o)):(r.isub(e),s.isub(i),o.isub(n))}return 0!==this.negative&&s.ineg(),0!==t.negative&&o.ineg(),[s,o,r.iushln(f)]}iinvert(t){return this.invert(t)._move(this)}invert(t){if(N(p.isBN(t),"num","bignum"),P(t.sign()>0,"invert"),t.isOdd())return this._invertp(t);if(0===t.cmpn(1))throw new RangeError("Not invertible.");const[e,,r]=this.egcd(t);if(0!==r.cmpn(1))throw new RangeError("Not invertible.");return e.imod(t)}ifermat(t){return this.fermat(t)._move(this)}fermat(t){const e=b?p.red(t):p.mont(t);return this.toRed(e).redFermat().fromRed()}ipowm(t,e,r){return this.powm(t,e,r)._move(this)}powm(t,e,r){const i=!b&&r?p.mont(e):p.red(e);return this.toRed(i).redPow(t).fromRed()}ipowmn(t,e,r){return this.powmn(t,e,r)._move(this)}powmn(t,e,r){const i=r?p.mont(e):p.red(e);return this.toRed(i).redPown(t).fromRed()}isqrtm(t){return this.sqrtm(t)._move(this)}sqrtm(t){let e;return N(p.isBN(t),"p","bignum"),e=3===t.andln(3)||5===t.andln(7)?p.red(t):p.mont(t),this.toRed(e).redSqrt().fromRed()}isqrtpq(t,e){return this.sqrtpq(t,e)._move(this)}sqrtpq(t,e){const r=this.sqrtm(t),i=this.sqrtm(e),[n,s]=t.egcd(e),o=i.mul(n).mul(t),f=r.mul(s).mul(e),a=t.mul(e);return o.iadd(f).imod(a)}isPrime(t,e,r){return N(e>>>0===e,"reps","uint32"),!!this.isPrimeMR(t,e+1,!0)&&!!this.isPrimeLucas(r)}isPrimeMR(t,e,r=!1){N(e>>>0===e,"reps","uint32"),N(e>0,"reps","integer"),N("boolean"==typeof r,"force2","boolean");const i=this;if(i.cmpn(7)<0)return 0===i.cmpn(2)||0===i.cmpn(3)||0===i.cmpn(5);if(i.isEven())return!1;const n=i.subn(1),s=n.subn(2),o=n.zeroBits(),f=n.ushrn(o),a=p.red(i),c=n.toRed(a),h=new p(1).toRed(a);t:for(let i=0;i<e;i++){let n;i===e-1&&r?n=new p(2):(n=p.random(t,0,s),n.iaddn(2));let u=n.toRed(a).redPow(f);if(0!==u.cmp(h)&&0!==u.cmp(c)){for(let t=1;t<o;t++){if(u=u.redSqr(),0===u.cmp(c))continue t;if(0===u.cmp(h))return!1}return!1}}return!0}isPrimeLucas(t=0){N(t>>>0===t,"limit","uint32");const e=this;if(e.cmpn(1)<=0)return!1;if(e.isEven())return 0===e.cmpn(2);let r=3;for(;;){if(r>1e4)throw new Error(`Cannot find (D/n) = -1 for ${e.toString(10)}.`);if(0!==t&&r>t)return!1;const i=new p(r*r-4).jacobi(e);if(-1===i)break;if(0===i)return 0===e.cmpn(r+2);if(40===r&&e.isSquare())return!1;r+=1}const i=e.addn(1),n=i._makeOdd();let s=new p(2),o=new p(r);for(let t=i.bitLength();t>=0;t--)i.utestn(t)?(s=s.mul(o).isubn(r).imod(e),o=o.sqr().isubn(2).imod(e)):(o=o.mul(s).isubn(r).imod(e),s=s.sqr().isubn(2).imod(e));if(0===s.cmpn(2)||0===s.cmp(e.subn(2))){const t=s.muln(r).imod(e),i=o.ushln(1).imod(e);if(0===t.cmp(i))return!0}for(let t=0;t<n-1;t++){if(s.isZero())return!0;if(0===s.cmpn(2))return!1;s=s.sqr().isubn(2).imod(e)}return!1}toTwos(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()}fromTwos(t){return N(t>>>0===t,"width","uint32"),P(t>0,"width"),this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()}toRed(t){if(N(t instanceof x,"ctx","reduction context"),this.red)throw new Error("Already in reduction context.");return t.convertTo(this)}fromRed(){return R(this.red,"fromRed"),this.red.convertFrom(this)}forceRed(t){if(N(t instanceof x,"ctx","reduction context"),this.red){if(!t.m.eq(this.red.m)||t.mont!==this.red.mont)throw new Error("Already in reduction context.")}else P(0===this.negative,"red"),P(this.ucmp(t.m)<0,"red");return this.clone()._forceRed(t)}redIAdd(t){return N(p.isBN(t),"num","bignum"),R(this.red,"redIAdd"),this.red.iadd(this,t)}redAdd(t){return N(p.isBN(t),"num","bignum"),R(this.red,"redAdd"),this.red.add(this,t)}redIAddn(t){return N(D(t),"num","smi"),R(this.red,"redIAddn"),this.red.iaddn(this,t)}redAddn(t){return N(D(t),"num","smi"),R(this.red,"redAddn"),this.red.addn(this,t)}redISub(t){return N(p.isBN(t),"num","bignum"),R(this.red,"redISub"),this.red.isub(this,t)}redSub(t){return N(p.isBN(t),"num","bignum"),R(this.red,"redSub"),this.red.sub(this,t)}redISubn(t){return N(D(t),"num","smi"),R(this.red,"redISubn"),this.red.isubn(this,t)}redSubn(t){return N(D(t),"num","smi"),R(this.red,"redSubn"),this.red.subn(this,t)}redIMul(t){return N(p.isBN(t),"num","bignum"),R(this.red,"redIMul"),this.red.imul(this,t)}redMul(t){return N(p.isBN(t),"num","bignum"),R(this.red,"redMul"),this.red.mul(this,t)}redIMuln(t){return N(D(t),"num","smi"),R(this.red,"redIMuln"),this.red.imuln(this,t)}redMuln(t){return N(D(t),"num","smi"),R(this.red,"redMuln"),this.red.muln(this,t)}redIDiv(t){return N(p.isBN(t),"num","bignum"),R(this.red,"redIDiv"),this.red.idiv(this,t)}redDiv(t){return N(p.isBN(t),"num","bignum"),R(this.red,"redDiv"),this.red.div(this,t)}redIDivn(t){return N(D(t),"num","smi"),R(this.red,"redIDivn"),this.red.idivn(this,t)}redDivn(t){return N(D(t),"num","smi"),R(this.red,"redDivn"),this.red.divn(this,t)}redIPow(t){return N(p.isBN(t),"num","bignum"),R(this.red,"redIPow"),O(!t.red,"redIPow"),this.red.ipow(this,t)}redPow(t){return N(p.isBN(t),"num","bignum"),R(this.red,"redPow"),O(!t.red,"redPow"),this.red.pow(this,t)}redIPown(t){return N(D(t),"num","smi"),R(this.red,"redIPown"),this.red.ipown(this,t)}redPown(t){return N(D(t),"num","smi"),R(this.red,"redPown"),this.red.pown(this,t)}redISqr(){return R(this.red,"redISqr"),this.red.isqr(this)}redSqr(){return R(this.red,"redSqr"),this.red.sqr(this)}redISqrt(){return R(this.red,"redISqrt"),this.red.isqrt(this)}redSqrt(){return R(this.red,"redSqrt"),this.red.sqrt(this)}redIDivSqrt(t){return R(this.red,"redIDivSqrt"),this.red.idivsqrt(this,t)}redDivSqrt(t){return R(this.red,"redDivSqrt"),this.red.divsqrt(this,t)}redIsSquare(){return R(this.red,"redIsSquare"),this.red.isSquare(this)}redIShl(t){return N(p.isBN(t),"num","bignum"),R(this.red,"redIShl"),O(!t.red,"redIShl"),this.red.ishl(this,t)}redShl(t){return N(p.isBN(t),"num","bignum"),R(this.red,"redShl"),O(!t.red,"redShl"),this.red.shl(this,t)}redIShln(t){return N(t>>>0===t,"num","uint32"),R(this.red,"redIShln"),this.red.ishln(this,t)}redShln(t){return N(t>>>0===t,"num","uint32"),R(this.red,"redShln"),this.red.shln(this,t)}redINeg(){return R(this.red,"redINeg"),this.red.ineg(this)}redNeg(){return R(this.red,"redNeg"),this.red.neg(this)}redEq(t){return N(p.isBN(t),"num","bignum"),R(this.red,"redEq"),this.red.eq(this,t)}redEqn(t){return N(D(t),"num","smi"),R(this.red,"redEqn"),this.red.eqn(this,t)}redIsHigh(){return R(this.red,"redIsHigh"),this.red.isHigh(this)}redIsLow(){return R(this.red,"redIsLow"),this.red.isLow(this)}redIsOdd(){return R(this.red,"redIsOdd"),this.red.isOdd(this)}redIsEven(){return R(this.red,"redIsEven"),this.red.isEven(this)}redLegendre(){return R(this.red,"redLegendre"),this.red.legendre(this)}redJacobi(){return R(this.red,"redJacobi"),this.red.jacobi(this)}redKronecker(){return R(this.red,"redKronecker"),this.red.kronecker(this)}redIInvert(){return R(this.red,"redIInvert"),this.red.iinvert(this)}redInvert(){return R(this.red,"redInvert"),this.red.invert(this)}redIFermat(){return R(this.red,"redIFermat"),this.red.ifermat(this)}redFermat(){return R(this.red,"redFermat"),this.red.fermat(this)}_move(t){return t.words=this.words,t.length=this.length,t.negative=this.negative,t.red=this.red,t}_alloc(t){for(;this.words.length<t;)this.words.push(0);return this}_expand(t){for(this._alloc(t);this.length<t;)this.words[this.length++]=0;return this}_strip(){for(;this.length>1&&0===this.words[this.length-1];)this.length-=1;return this._normalize()}_normalize(){return q(this.length>0),1===this.length&&0===this.words[0]&&(this.negative=0),this}_check(){return q(this.length>0),q(this.length<=this.words.length),1===this.length?(0===this.words[0]&&q(0===this.negative),this):(q(0!==this.words[this.length-1]),this)}_invertp(t){if(N(p.isBN(t),"p","bignum"),P(t.sign()>0,"invert"),q(t.isOdd()),0===t.cmpn(1))throw new RangeError("Not invertible.");const e=this.clone(),r=t.clone(),i=new p(1),n=new p(0);for((e.isNeg()||e.ucmp(r)>=0)&&e.imod(r);!e.isZero();){let s=e._makeOdd(),o=r._makeOdd();for(;s--;)i.isOdd()&&i._iadd(i,t),i.iushrn(1);for(;o--;)n.isOdd()&&n._iadd(n,t),n.iushrn(1);e.ucmp(r)>=0?(e._isub(e,r),i.ucmp(n)<0?(i._isub(n,i),i._isub(t,i)):i._isub(i,n)):(r._isub(r,e),n.ucmp(i)<0?(n._isub(i,n),n._isub(t,n)):n._isub(n,i))}if(0!==r.cmpn(1))throw new RangeError("Not invertible.");return q(0===n.negative),q(n.ucmp(t)<0),n}_makeOdd(){const t=this.zeroBits();return t>0&&this.iushrn(t),t}_factor2(t){if(1&(this.words[0]|t.words[0]))return 0;const e=Math.min(this.length,t.length);let r=0;for(let i=0;i<e;i++){const e=H(this.words[i]|t.words[i]);if(r+=e,26!==e)break}return r}_cloneNormal(){return this.red?this.fromRed():this.clone()}_forceRed(t){return this.red=t,this}clone(){const t=new p;t.words=new Array(this.length);for(let e=0;e<this.length;e++)t.words[e]=this.words[e];return t.length=this.length,t.negative=this.negative,t.red=this.red,t}inject(t){N(p.isBN(t),"num","bignum"),this._alloc(t.length);for(let e=0;e<t.length;e++)this.words[e]=t.words[e];return this.length=t.length,this.negative=t.negative,this.red=t.red,this}set(t,e){return this.fromNumber(t,e)}swap(t){N(p.isBN(t),"num","bignum");const e=this,r=t;return[e.words,r.words]=[r.words,e.words],[e.length,r.length]=[r.length,e.length],[e.negative,r.negative]=[r.negative,e.negative],[e.red,r.red]=[r.red,e.red],e}reverse(){const t=this.negative;return this.fromBuffer(this.toBuffer("be"),"le"),this.negative=t,this}byteLength(){return Math.ceil(this.bitLength()/8)}bitLength(){const t=K(this.words[this.length-1]);return 26*(this.length-1)+t}zeroBits(){if(this.isZero())return 0;if(this.isOdd())return 0;let t=0;for(let e=0;e<this.length;e++){const r=H(this.words[e]);if(t+=r,26!==r)break}return t}isSafe(){return this.length<=2||3===this.length&&1===this.words[2]}word(t){return N(t>>>0===t,"pos","uint32"),t>=this.length?0:this.words[t]}[i](){let t="BN";return this.red&&(t="BN-R"),`<${t}: ${this.toString(10)}>`}toNumber(){let t=this.words[0];if(2===this.length)t+=67108864*this.words[1];else if(3===this.length&&1===this.words[2])t+=4503599627370496+67108864*this.words[1];else if(this.length>2)throw new RangeError("Number can only safely store up to 53 bits.");return 0!==this.negative?-t:t}toDouble(){let t=0;for(let e=this.length-1;e>=0;e--)t=67108864*t+this.words[e];return 0!==this.negative?-t:t}valueOf(){return this.toDouble()}toBigInt(){if(!b)throw new Error("BigInt is not supported!");const t=BigInt(52),e=BigInt(26);let r=this.length-1,i=BigInt(0);for(;r>=1;r-=2){const e=67108864*this.words[r],n=this.words[r-1];i=i<<t|BigInt(e+n)}return r>=0&&(i=i<<e|BigInt(this.words[0])),0!==this.negative?-i:i}toBool(){return!this.isZero()}toString(t,e){if(null==e&&(e=0),0===e&&(e=1),N((t=L(t))>>>0===t,"base","uint32"),N(e>>>0===e,"padding","uint32"),t<2||t>36)throw new RangeError("Base ranges between 2 and 36.");if(this._check(),16===t){let t="",r=0,i=0;for(let e=0;e<this.length;e++){const s=this.words[e],o=(16777215&(s<<r|i)).toString(16);i=s>>>24-r&16777215,t=0!==i||e!==this.length-1?n[6-o.length]+o+t:o+t,r+=2,r>=26&&(r-=26,e-=1)}for(0!==i&&(t=i.toString(16)+t);t.length%e!=0;)t="0"+t;return 0!==this.negative&&(t="-"+t),t}const r=s[t-1],i=o[t-1],f=this.clone();let a="";for(f.negative=0;!f.isZero();){const e=f.remrn(i).toString(t);f.iquon(i),a=f.isZero()?e+a:n[r-e.length]+e+a}for(this.isZero()&&(a="0");a.length%e!=0;)a="0"+a;return 0!==this.negative&&(a="-"+a),a}toJSON(){return this.toString(16,2)}toArray(t,e){return this.toArrayLike(Array,t,e)}toBuffer(t,r){return this.toArrayLike(e,t,r)}toArrayLike(t,e,r){null==e&&(e="be"),null==r&&(r=0),N("function"==typeof t,"ArrayType","function"),N("be"===e||"le"===e,"endian","endianness"),N(r>>>0===r,"length","uint32"),this._check();const i=this.byteLength(),n=r||Math.max(1,i);if(i>n)throw new RangeError("Byte array longer than desired length.");const s=function(t,e){return t.allocUnsafeSlow?t.allocUnsafeSlow(e):new t(e)}(t,n);if("be"===e){let t=s.length-1,e=0;for(let r=0;r<this.length;r++){const i=(3&r)<<1,n=this.words[r]<<i|e;s[t--]=255&n,t>=0&&(s[t--]=n>>>8&255),t>=0&&(s[t--]=n>>>16&255),6===i?(t>=0&&(s[t--]=n>>>24&255),e=0):e=n>>>24}if(t>=0){for(s[t--]=e;t>=0;)s[t--]=0;e=0}q(0===e)}else{let t=0,e=0;for(let r=0;r<this.length;r++){const i=(3&r)<<1,n=this.words[r]<<i|e;s[t++]=255&n,t<s.length&&(s[t++]=n>>>8&255),t<s.length&&(s[t++]=n>>>16&255),6===i?(t<s.length&&(s[t++]=n>>>24&255),e=0):e=n>>>24}if(t<s.length){for(s[t++]=e;t<s.length;)s[t++]=0;e=0}q(0===e)}return s}encode(t,e){return this.toBuffer(t,e)}of(t,e){return this.fromNumber(t,e)}fromNumber(t,e){null==e&&(e="be"),N(T(t),"num","integer"),N("be"===e||"le"===e,"endian","endianness");const r=t<0|0;return r&&(t=-t),t<67108864?(this.words[0]=67108863&t,this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(this.words=[67108863&t,t/67108864&67108863,1],this.length=3),this.negative=r,"le"===e&&this.reverse(),this}fromDouble(t,e){null==e&&(e="be"),N("number"==typeof t,"num","double"),N("be"===e||"le"===e,"endian","endianness"),isFinite(t)||(t=0);const r=t<=-1|0;for(t<0&&(t=-t),t=Math.floor(t),this.words=[];t>0;){const e=t%67108864,r=(t-e)/67108864;this.words.push(e),t=r}return 0===this.words.length&&this.words.push(0),this.length=this.words.length,this.negative=r,"le"===e&&this.reverse(),this}fromBigInt(t,e){if(null==e&&(e="be"),N("bigint"==typeof t,"num","bigint"),N("be"===e||"le"===e,"endian","endianness"),!b)throw new Error("BigInt is not supported!");const r=t<BigInt(0)|0;return this._fromHex(t.toString(16),r),this.negative=r,"le"===e&&this.reverse(),this}fromBool(t){return N("boolean"==typeof t,"value","boolean"),this.words[0]=0|t,this.length=1,this.negative=0,this}fromString(t,e,r){if("le"!==e&&"be"!==e||([e,r]=[r,e]),e=L(e),null==r&&(r="be"),N("string"==typeof t,"string","string"),N(e>>>0===e,"base","uint32"),N("be"===r||"le"===r,"endian","endianness"),e<2||e>36)throw new Error("Base ranges between 2 and 36.");let i=0;return(t=t.replace(/\s+/g,"")).length>0&&45===t.charCodeAt(0)&&(i=1),16===e?this._fromHex(t,i):this._fromBase(t,e,i),this.negative=i,this._normalize(),"le"===r&&this.reverse(),this}_fromHex(t,e){this.length=Math.max(2,Math.ceil((t.length-e)/6)),this.words=new Array(this.length);for(let t=0;t<this.length;t++)this.words[t]=0;let r=0,i=t.length-6,n=0;for(;i>=e;i-=6){const e=j(t,i,i+6);this.words[n]|=e<<r&67108863,this.words[n+1]|=e>>>26-r&4194303,r+=24,r>=26&&(r-=26,n+=1)}if(i+6!==e){const s=j(t,e,i+6);this.words[n]|=s<<r&67108863,this.words[n+1]|=s>>>26-r&4194303}return this._strip()}_fromBase(t,e,r){this.words[0]=0,this.length=1,this.negative=0;let i=0,n=1;for(;n<=67108863;n*=e)i+=1;i-=1,n=n/e|0;const s=t.length-r,o=s%i,f=Math.min(s,s-o)+r;let a=r;for(;a<f;a+=i){const r=F(t,a,a+i,e);this.imuln(n),this._iaddn(r)}if(0!==o){const r=Math.pow(e,o),i=F(t,a,t.length,e);this.imuln(r),this._iaddn(i)}return this}fromJSON(t){if(p.isBN(t))return t.red?t.fromRed():t.clone();if(Array.isArray(t)){for(const e of t)N("string"==typeof e,"chunk","string");t=t.join("")}return this.fromString(t,16)}fromBN(t){return this.inject(t)}fromArray(t,e){return N(Array.isArray(t),"data","array"),this.fromArrayLike(t,e)}fromBuffer(t,r){return N(e.isBuffer(t),"data","buffer"),this.fromArrayLike(t,r)}fromArrayLike(t,e){if(null==e&&(e="be"),N(t&&t.length>>>0===t.length,"data","array-like"),N("be"===e||"le"===e,"endian","endianness"),0===t.length)return this.words[0]=0,this.length=1,this.negative=0,this;this.length=Math.max(2,Math.ceil(t.length/3)),this.words=new Array(this.length),this.negative=0;for(let t=0;t<this.length;t++)this.words[t]=0;const r=t.length%3;let i=0,n=0,s=0;if("be"===e){for(let e=t.length-1;e>=2;e-=3){const r=t[e]|t[e-1]<<8|t[e-2]<<16;this.words[n]|=r<<i&67108863,this.words[n+1]=r>>>26-i&67108863,i+=24,i>=26&&(i-=26,n+=1)}switch(r){case 2:s=t[1]|t[0]<<8;break;case 1:s=t[0]}}else{const e=t.length-r;for(let r=0;r<e;r+=3){const e=t[r]|t[r+1]<<8|t[r+2]<<16;this.words[n]|=e<<i&67108863,this.words[n+1]=e>>>26-i&67108863,i+=24,i>=26&&(i-=26,n+=1)}switch(r){case 2:s=t[e]|t[e+1]<<8;break;case 1:s=t[e]}}return r>0&&(this.words[n]|=s<<i&67108863,this.words[n+1]=s>>>26-i&67108863),this._strip()}decode(t,e){return this.fromBuffer(t,e)}from(t,e,r){if(null==t)return this;if("le"!==e&&"be"!==e||([e,r]=[r,e]),"number"==typeof t)return this.fromNumber(t,r);if("bigint"==typeof t)return this.fromBigInt(t,r);if("string"==typeof t)return this.fromString(t,e,r);if("object"==typeof t){if(p.isBN(t))return this.fromBN(t,r);if(t.length>>>0===t.length)return this.fromArrayLike(t,r)}if("boolean"==typeof t)return this.fromBool(t);throw new TypeError("Non-numeric object passed to BN.")}static min(...t){let e=null;for(const r of t)N(p.isBN(r),"num","bignum"),(!e||r.cmp(e)<0)&&(e=r);return e||new p(0)}static max(...t){let e=null;for(const r of t)N(p.isBN(r),"num","bignum"),(!e||r.cmp(e)>0)&&(e=r);return e||new p(0)}static cmp(t,e){return N(p.isBN(t),"a","bignum"),t.cmp(e)}static ucmp(t,e){return N(p.isBN(t),"a","bignum"),t.ucmp(e)}static red(t){return new x(t)}static barrett(t){return new B(t)}static mont(t){return new k(t)}static _prime(t){if(f[t])return f[t];let e;if("p192"===t)e=new v;else if("p224"===t)e=new S;else if("p521"===t)e=new E;else if("k256"===t)e=new M;else if("p251"===t)e=new A;else if("p25519"===t)e=new I;else{if("p448"!==t)throw new Error(`Unknown prime: "${t}".`);e=new _}return f[t]=e,e}static prime(t){return p._prime(t).p.clone()}static pow(t,e){return 2===t?p.shift(1,e):(new p).fromNumber(t).pown(e)}static shift(t,e){return 1===t?new p(0).usetn(e,1):(new p).fromNumber(t).ishln(e)}static mask(t){return p.shift(1,t).isubn(1)}static randomBits(t,r){if(N(null!=t,"rng","rng"),N(r>>>0===r,"bits","uint32"),"object"==typeof t){N("function"==typeof t.randomBytes,"rng","rng");const i=r+7>>>3,n=8*i,s=t.randomBytes(i);if(N(e.isBuffer(s),"bytes","buffer"),s.length!==i)throw new RangeError("Invalid number of bytes returned from RNG.");const o=p.fromBuffer(s);return n>r&&o.iushrn(n-r),o}N("function"==typeof t,"rng","rng");const i=t(r);if(N(p.isBN(i),"num","bignum"),P(0===i.negative,"RNG"),O(!i.red,"RNG"),i.bitLength()>r)throw new RangeError("Invalid number of bits returned from RNG.");return i}static random(t,e,r){if(e=p.cast(e,16),r=p.cast(r,16),e.cmp(r)>0)throw new RangeError("Minimum cannot be greater than maximum.");const i=r.sub(e).iabs(),n=i.bitLength();if(0===n)return e.clone();for(;;){const r=p.randomBits(t,n);if(!(r.cmp(i)>=0))return r.iadd(e),r}}static of(t,e){return(new p).of(t,e)}static fromNumber(t,e){return(new p).fromNumber(t,e)}static fromDouble(t,e){return(new p).fromDouble(t,e)}static fromBigInt(t,e){return(new p).fromBigInt(t,e)}static fromBool(t){return(new p).fromBool(t)}static fromString(t,e,r){return(new p).fromString(t,e,r)}static fromJSON(t){return(new p).fromJSON(t)}static fromBN(t){return(new p).fromBN(t)}static fromArray(t,e){return(new p).fromArray(t,e)}static fromBuffer(t,e){return(new p).fromBuffer(t,e)}static fromArrayLike(t,e){return(new p).fromArrayLike(t,e)}static decode(t,e){return(new p).decode(t,e)}static from(t,e,r){return(new p).from(t,e,r)}static cast(t,e,r){return p.isBN(t)?t:new p(t,e,r)}static isBN(t){return t instanceof p}}p.BN=p,p.wordSize=26,p.native=0;class m{constructor(t,e){this.name=t,this.p=new p(e,16),this.n=this.p.bitLength(),this.k=p.shift(1,this.n).isub(this.p),this.lo=this.p.clone(),this.one=this.p.clone()}ireduce(t){const e=0!==t.negative;let r=t.bitLength();for(q(r<=2*this.n),t.negative=0;r>this.n;)this.split(t,this.lo),this.imulK(t),t._iadd(t,this.lo),r=t.bitLength();const i=r<this.n?-1:t.ucmp(this.p);return 0===i?(t.words[0]=0,t.length=1):i>0&&t._isub(t,this.p),e&&!t.isZero()&&t._isub(this.p,t),t}split(t,e){t._split(this.n,e)}imulK(t){return t.imul(this.k)}pm2(t){throw new Error("Not implemented.")}fermat(t){return this.pm2(t)}}class g extends m{constructor(t,e){super(t,e)}pm3d4(t){throw new Error("Not implemented.")}pp1d4(t){throw new Error("Not implemented.")}sqrt(t){const{red:e}=t,r=this.pp1d4(t);if(!e.sqr(r).eq(t))throw new C(r);return r}divsqrt(t,e){const{red:r}=t,i=r.sqr(t),n=r.mul(i,t),s=r.mul(n,i),o=r.mul(r.sqr(e),e),f=this.pm3d4(r.mul(s,o)),a=r.mul(r.mul(n,e),f);if(r.mul(e,r.sqr(a)).eq(t))return a;throw new C(a)}}class w extends m{constructor(t,e,r){super(t,e),this.sm1=new p(r,16)}pm5d8(t){throw new Error("Not implemented.")}pp3d8(t){throw new Error("Not implemented.")}sqrt(t){const{red:e}=t,r=this.sm1._forceRed(e),i=this.pp3d8(t);if(e.sqr(i).eq(t))return i;const n=e.mul(i,r);if(e.sqr(n).eq(t))return n;throw new C(i)}divsqrt(t,e){const{red:r}=t,i=this.sm1._forceRed(r),n=r.mul(r.sqr(e),e),s=r.mul(r.sqr(n),e),o=this.pm5d8(r.mul(t,s)),f=r.mul(r.mul(t,n),o),a=r.mul(e,r.sqr(f));if(a.eq(t))return f;const c=r.ineg(a);if(c.eq(t))return r.mul(f,i);if(c.eq(r.mul(t,i)))throw new C(r.mul(f,i));throw new C(f)}}class y extends m{constructor(t,e,r){super(t,e),this.g=new p(r,16),this.z=this.p.subn(1).zeroBits()}powS(t){throw new Error("Not implemented.")}powE(t){throw new Error("Not implemented.")}sqrt(t){const{red:e}=t;switch(e.jacobi(t)){case-1:throw new C(t);case 0:return t.clone()}let r=this.g._forceRed(e),i=this.powE(t),n=this.powS(t),s=this.z;for(;;){let t=n,o=0;for(;0!==t.cmpn(1)&&o<s;)t=e.sqr(t),o+=1;if(0===o)break;q(o<s),t=e.sqrn(r,s-o-1),r=e.sqr(t),i=e.mul(i,t),n=e.mul(n,r),s=o}return i}divsqrt(t,e){const{red:r}=t;if(e.isZero())throw new C(e);return this.sqrt(r.div(t,e))}}class v extends g{constructor(){super("p192","ffffffff ffffffff ffffffff fffffffeffffffff ffffffff")}imulK(t){const e=this.one.inject(t);return t.iushln(64)._iadd(t,e)}core(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=e.sqrnmul(r,1,t),n=e.sqrnmul(i,3,i),s=e.sqrnmul(n,6,n),o=e.sqrnmul(s,12,s),f=e.sqrnmul(o,6,n),a=e.sqrnmul(f,1,t),c=e.sqrnmul(a,31,a),h=e.sqrnmul(c,62,c),u=e.sqrnmul(h,3,i),d=e.sqrn(u,1);return e.sqrnmul(d,62,c)}pm3d4(t){return this.core(t)}pm2(t){const{red:e}=t,r=this.core(t),i=e.sqrn(r,1);return e.sqrnmul(i,1,t)}pp1d4(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=e.sqrnmul(r,2,r),n=e.sqrnmul(i,4,i),s=e.sqrnmul(n,8,n),o=e.sqrnmul(s,16,s),f=e.sqrnmul(o,32,o),a=e.sqrnmul(f,64,f);return e.sqrn(a,62)}}class S extends y{constructor(){super("p224","ffffffff ffffffff ffffffff ffffffff00000000 00000000 00000001","6a0fec67 8598a792 0c55b2d4 0b2d6ffbbea3d8ce f3fb3632 dc691b74")}imulK(t){const e=this.one.inject(t);return t.iushln(96)._isub(t,e)}powS(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=e.sqrnmul(r,2,r),n=e.sqrnmul(i,4,i),s=e.sqrnmul(n,8,n),o=e.sqrnmul(s,16,s),f=e.sqrnmul(o,32,o);return e.sqrnmul(f,64,f)}powE(t){const{red:e}=t;return e.sqrn(t,127)}pm2(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=e.sqrnmul(r,1,t),n=e.sqrnmul(i,3,i),s=e.sqrnmul(n,6,n),o=e.sqrnmul(s,12,s),f=e.sqrnmul(o,24,o),a=e.sqrnmul(f,48,f),c=e.sqrnmul(a,24,o),h=e.sqrnmul(c,6,n),u=e.sqrnmul(h,1,t),d=e.sqrn(u,1);return e.sqrnmul(d,96,a)}}class E extends g{constructor(){super("p521","000001ff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff")}imulK(t){return t}core(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=e.sqrnmul(r,1,t),n=e.sqrnmul(i,3,i),s=e.sqrnmul(n,1,t),o=e.sqrnmul(s,1,t),f=e.sqrnmul(o,8,o),a=e.sqrnmul(f,16,f),c=e.sqrnmul(a,32,a),h=e.sqrnmul(c,64,c),u=e.sqrnmul(h,128,h),d=e.sqrnmul(u,256,u);return e.sqrnmul(d,7,s)}pm3d4(t){return this.core(t)}pm2(t){const{red:e}=t,r=this.core(t),i=e.sqrn(r,1);return e.sqrnmul(i,1,t)}pp1d4(t){const{red:e}=t;return e.sqrn(t,519)}}class M extends g{constructor(){super("k256","ffffffff ffffffff ffffffff ffffffffffffffff ffffffff fffffffe fffffc2f")}split(t,e){const r=Math.min(t.length,9);e._alloc(r+1);for(let i=0;i<r;i++)e.words[i]=t.words[i];if(e.length=r,t.length<=9)return e._strip(),t.words[0]=0,void(t.length=1);let i=t.words[9],n=10;for(e.words[e.length++]=4194303&i,e._strip();n<t.length;n++){const e=0|t.words[n];t.words[n-10]=(4194303&e)<<4|i>>>22,i=e}i>>>=22,t.words[n-10]=i,0===i&&t.length>10?t.length-=10:t.length-=9,t._strip()}imulK(t){t._expand(t.length+2);let e=0;for(let r=0;r<t.length;r++){const i=t.words[r];e+=977*i,t.words[r]=67108863&e,e=64*i+Math.floor(e/67108864)}return 0===t.words[t.length-1]&&(t.length-=1,0===t.words[t.length-1]&&(t.length-=1)),t}core(t,e){const{red:r}=t,i=r.sqrnmul(e,1,t),n=r.sqrnmul(i,3,i),s=r.sqrnmul(n,3,i),o=r.sqrnmul(s,2,e),f=r.sqrnmul(o,11,o),a=r.sqrnmul(f,22,f),c=r.sqrnmul(a,44,a),h=r.sqrnmul(c,88,c),u=r.sqrnmul(h,44,a),d=r.sqrnmul(u,3,i),l=r.sqrn(d,1),b=r.sqrnmul(l,22,f);return r.sqrn(b,4)}pm3d4(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=this.core(t,r),n=e.sqrnmul(i,1,t),s=e.sqrn(n,1);return e.sqrnmul(s,2,r)}pm2(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=this.core(t,r),n=e.sqrnmul(i,1,t),s=e.sqrn(n,1),o=e.sqrnmul(s,2,r),f=e.sqrn(o,1);return e.sqrnmul(f,1,t)}pp1d4(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=this.core(t,r),n=e.sqrnmul(i,2,r);return e.sqrn(n,2)}}class A extends g{constructor(){super("p251","07ffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff fffffff7")}imulK(t){if(t.isZero())return t;let e=0;for(let r=0;r<t.length;r++){const i=9*t.words[r]+e;e=i>>>26,t.words[r]=67108863&i}return 0!==e&&(t._alloc(t.length+1),t.words[t.length++]=e),t}core(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=e.sqrnmul(r,1,t),n=e.sqrnmul(i,3,i),s=e.sqrnmul(n,6,n),o=e.sqrnmul(s,12,s),f=e.sqrnmul(o,24,o),a=e.sqrnmul(f,48,f),c=e.sqrnmul(a,96,a),h=e.sqrnmul(c,48,f),u=e.sqrnmul(h,6,n);return e.sqrnmul(u,1,t)}pm3d4(t){const{red:e}=t,r=this.core(t),i=e.sqrn(r,1);return e.sqrnmul(i,1,t)}pm2(t){const{red:e}=t,r=this.core(t),i=e.sqrn(r,1),n=e.sqrnmul(i,1,t),s=e.sqrn(n,1);return e.sqrnmul(s,1,t)}pp1d4(t){const{red:e}=t,r=this.core(t),i=e.sqrnmul(r,1,t);return e.sqrn(i,1)}}class I extends w{constructor(){super("p25519","7fffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffed","2b832480 4fc1df0b 2b4d0099 3dfbd7a72f431806 ad2fe478 c4ee1b27 4a0ea0b0")}imulK(t){let e=0;for(let r=0;r<t.length;r++){const i=19*t.words[r]+e;e=i>>>26,t.words[r]=67108863&i}return 0!==e&&(t._alloc(t.length+1),t.words[t.length++]=e),t}core(t,e){const{red:r}=t,i=r.sqrnmul(e,2,e),n=r.sqrnmul(i,1,t),s=r.sqrnmul(n,5,n),o=r.sqrnmul(s,10,s),f=r.sqrnmul(o,20,o),a=r.sqrnmul(f,10,s),c=r.sqrnmul(a,50,a),h=r.sqrnmul(c,100,c);return r.sqrnmul(h,50,a)}pm5d8(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=this.core(t,r),n=e.sqrn(i,1);return e.sqrnmul(n,1,t)}pm2(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=this.core(t,r),n=e.sqrn(i,1),s=e.sqrnmul(n,1,t),o=e.sqrn(s,1);return e.sqrnmul(o,2,r)}pp3d8(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=this.core(t,r),n=e.sqrnmul(i,1,t);return e.sqrn(n,1)}}class _ extends g{constructor(){super("p448","ffffffff ffffffff ffffffff ffffffffffffffff ffffffff fffffffe ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff")}imulK(t){const e=this.one.inject(t);return t.iushln(224)._iadd(t,e)}core(t,e){const{red:r}=t,i=r.sqrnmul(e,1,t),n=r.sqrnmul(i,3,i),s=r.sqrnmul(n,3,i),o=r.sqrnmul(s,2,e),f=r.sqrnmul(o,11,o),a=r.sqrnmul(f,22,f),c=r.sqrnmul(a,44,a),h=r.sqrnmul(c,88,c),u=r.sqrnmul(h,44,a);return r.sqrnmul(u,2,e)}pm3d4(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=this.core(t,r),n=e.sqrnmul(i,1,t),s=e.sqrn(n,1);return e.sqrnmul(s,222,i)}pm2(t){const{red:e}=t,r=this.pm3d4(t),i=e.sqrn(r,1);return e.sqrnmul(i,1,t)}pp1d4(t){const{red:e}=t,r=e.sqrnmul(t,1,t),i=this.core(t,r),n=e.sqrnmul(i,2,r);return e.sqrn(n,222)}}class x{constructor(t){let e=null;"string"==typeof t&&(e=p._prime(t),t=e.p),N(p.isBN(t),"m","bignum"),O(!t.red,"reduction"),P(t.sign()>0,"reduction"),this.m=t,this.prime=e,this.mb=null,this.sm1=null}_verify1(t){P(0===t.negative,"red"),R(null!=t.red,"red")}_verify2(t,e){P(0==(t.negative|e.negative),"red"),R(null!=t.red&&t.red===e.red,"red")}get mont(){return!1}precompute(){if(null===this.sm1&&5===this.m.andln(7))if(this.prime)this.sm1=this.prime.sm1.clone()._forceRed(this);else{const t=new p(2).toRed(this),e=this.m.subn(1).iushrn(2);this.sm1=this.pow(t,e)}return this}convertTo(t){const e=t.mod(this.m);return e.red=this,e}convertFrom(t){const e=t.clone();return e.red=null,e}intTo(t){return t}intFrom(t){return t}imod(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.imod(this.m)._forceRed(this)}iadd(t,e){return this._verify2(t,e),t._iadd(t,e),t.ucmp(this.m)>=0&&t._isub(t,this.m),t}add(t,e){return t.length<e.length?this.iadd(e.clone(),t):this.iadd(t.clone(),e)}iaddn(t,e){return this._verify1(t),e<0?this.isubn(t,-e):(1===this.m.length&&(e%=this.m.words[0]),t._iaddn(e),t.ucmp(this.m)>=0&&t._isub(t,this.m),t)}addn(t,e){return this.iaddn(t.clone(),e)}isub(t,e){this._verify2(t,e);const r=t.ucmp(e);return 0===r?(t.words[0]=0,t.length=1,t):(r<0?(t._isub(e,t),t._isub(this.m,t)):t._isub(t,e),t)}sub(t,e){return this.isub(t.clone(),e)}isubn(t,e){return this._verify1(t),e<0?this.iaddn(t,-e):(1===this.m.length&&(e%=this.m.words[0]),1===t.length&&t.words[0]<e?(t.words[0]=e-t.words[0],t._isub(this.m,t)):t._isubn(e),t)}subn(t,e){return this.isubn(t.clone(),e)}imul(t,e){return this._verify2(t,e),this.imod(t.imul(e))}mul(t,e){return this._verify2(t,e),this.imod(t.mul(e))}imuln(t,e){if(this._verify1(t),t.isZero())return t;if(0===e)return t.words[0]=0,t.length=1,t;const r=e<0;if(r&&(e=-e),1===this.m.length&&(e%=this.m.words[0]),t.imuln(e),e<=16)for(;t.ucmp(this.m)>=0;)t._isub(t,this.m);else this.imod(t);return r&&this.ineg(t),t}muln(t,e){return this.imuln(t.clone(),e)}idiv(t,e){return this.div(t,e)._move(t)}div(t,e){return this.mul(t,this.invert(e))}idivn(t,e){return this.divn(t,e)._move(t)}divn(t,e){return this.div(t,this.convertTo(new p(e)))}ipow(t,e){return this.pow(t,e)._move(t)}pow(t,e){return this._verify1(t),e.isNeg()&&(t=this.invert(t)),1===e.length?this.pown(t,e.words[0]):b&&!this.prime?this.powInt(t,e):this.powNum(t,e)}powNum(t,e){const r=new p(1).toRed(this),i=new Array(8),n=this.sqr(t);i[0]=t;for(let t=1;t<8;t++)i[t]=this.mul(i[t-1],n);let s=e.bitLength(),o=r;for(;s>=4;){let t=4,n=e.bits(s-t,t);if(n<8)o=this.sqr(o),s-=1;else{for(;0==(1&n);)t-=1,n>>=1;o===r?o=i[n>>1].clone():(o=this.sqrn(o,t),o=this.mul(o,i[n>>1])),s-=t}}if(s>0){const r=e.bits(0,s);for(;s--;)o=this.sqr(o),r>>s&1&&(o=this.mul(o,t))}return o}powInt(t,e){null===this.mb&&(this.mb=this.m.toBigInt());const r=function(t,e,r){const i=BigInt(1),n=new Array(8),s=t*t%r;n[0]=t;for(let t=1;t<8;t++)n[t]=n[t-1]*s%r;let o=e.bitLength(),f=i;for(;o>=4;){let t=4,s=e.bits(o-t,t);if(s<8)f=f*f%r,o-=1;else{for(;0==(1&s);)t-=1,s>>=1;f===i?f=n[s>>1]:(f=Z(f,t,r),f=f*n[s>>1]%r),o-=t}}if(o>0){const i=e.bits(0,o);for(;o--;)f=f*f%r,i>>o&1&&(f=f*t%r)}return f}(this.intFrom(t.toBigInt()),e,this.mb),i=this.intTo(r);return p.fromBigInt(i)._forceRed(this)}sqrn(t,e){for(;e--;)t=this.sqr(t);return t}sqrnmul(t,e,r){return this.mul(this.sqrn(t,e),r)}ipown(t,e){return this.pown(t,e)._move(t)}pown(t,e){if(this._verify1(t),e<0&&(t=this.invert(t),e=-e),0===e)return new p(1).toRed(this);if(1===e)return t.clone();let r=t;for(let i=K(e)-2;i>=0;i--)r=this.sqr(r),e>>i&1&&(r=this.mul(r,t));return r}isqr(t){return this.imul(t,t)}sqr(t){return this.mul(t,t)}isqrt(t){return this.sqrt(t)._move(t)}sqrt(t){return this._verify1(t),this.prime?this.prime.sqrt(t):3===this.m.andln(3)?this.sqrt3mod4(t):5===this.m.andln(7)?null!=this.sm1?this.sqrt5mod8sm1(t):this.sqrt5mod8(t):this.sqrt0(t)}sqrt3mod4(t){const e=this.m.addn(1).iushrn(2),r=this.pow(t,e);if(!this.sqr(r).eq(t))throw new C(r);return r}sqrt5mod8(t){const e=new p(1).toRed(this),r=this.m.ushrn(3),i=this.add(t,t),n=this.pow(i,r),s=this.mul(i,this.sqr(n)),o=this.mul(this.mul(n,t),this.isub(s,e));if(!this.sqr(o).eq(t))throw new C(o);return o}sqrt5mod8sm1(t){const e=this.m.addn(3).iushrn(3),r=this.pow(t,e);if(this.sqr(r).eq(t))return r;const i=this.mul(r,this.sm1);if(this.sqr(i).eq(t))return i;throw new C(r)}sqrt0(t){if(0===this.m.cmpn(1)||!this.m.isOdd())throw new Error("Invalid prime.");switch(this.jacobi(t)){case-1:throw new C(t);case 0:return t.clone()}const e=new p(1).toRed(this),r=this.m.subn(1),i=r._makeOdd(),n=new p(2).toRed(this);for(;-1!==this.jacobi(n);)this.iadd(n,e);let s=this.pow(n,r),o=this.pow(t,r),f=this.pow(t,r.iaddn(1).iushrn(1)),a=i;for(;;){let t=o,r=0;for(;!t.eq(e)&&r<a;)t=this.sqr(t),r+=1;if(0===r)break;q(r<a),t=this.sqrn(s,a-r-1),s=this.sqr(t),f=this.mul(f,t),o=this.mul(o,s),a=r}return f}idivsqrt(t,e){return this.divsqrt(t,e)._move(t)}divsqrt(t,e){if(this._verify2(t,e),t.isZero()&&e.isZero())throw new C(e);if(this.prime)return this.prime.divsqrt(t,e);if(3===this.m.andln(3))return this.divsqrt3mod4(t,e);if(null!=this.sm1&&5===this.m.andln(7))return this.divsqrt5mod8(t,e);if(e.isZero())throw new C(e);return this.sqrt(this.div(t,e))}divsqrt3mod4(t,e){const r=this.m.subn(3).iushrn(2),i=this.sqr(t),n=this.mul(i,t),s=this.mul(n,i),o=this.mul(this.sqr(e),e),f=this.pow(this.mul(s,o),r),a=this.mul(this.mul(n,e),f);if(this.mul(e,this.sqr(a)).eq(t))return a;throw new C(a)}divsqrt5mod8(t,e){const r=this.m.subn(5).iushrn(3),i=this.mul(this.sqr(e),e),n=this.mul(this.sqr(i),e),s=this.pow(this.mul(t,n),r),o=this.mul(this.mul(t,i),s),f=this.mul(e,this.sqr(o));if(f.eq(t))return o;const a=this.ineg(f);if(a.eq(t))return this.mul(o,this.sm1);if(a.eq(this.mul(t,this.sm1)))throw new C(this.mul(o,this.sm1));throw new C(o)}isSquare(t){return this.m.isOdd()?this.jacobi(t)>=0:this.kronecker(t)>=0}ishl(t,e){return this._verify1(t),this.imod(t.iushl(e))}shl(t,e){return this.ishl(t.clone(),e)}ishln(t,e){if(this._verify1(t),t.iushln(e),e<=4)for(;t.ucmp(this.m)>=0;)t._isub(t,this.m);else this.imod(t);return t}shln(t,e){return this.ishln(t.clone(),e)}ineg(t){return this._verify1(t),t.isZero()||t._isub(this.m,t),t}neg(t){return this.ineg(t.clone())}eq(t,e){return this._verify2(t,e),0===t.ucmp(e)}eqn(t,e){if(this._verify1(t),1===this.m.length)return(e%=this.m.words[0])<0&&(e+=this.m.words[0]),0===t.ucmpn(e);if(e<0){this.m._isubn(-e);const r=t.ucmp(this.m);return this.m._iaddn(-e),0===r}return 0===t.ucmpn(e)}isHigh(t){return!this.isLow(t)}isLow(t){return this._verify1(t),t.ucmp(this.m.ushrn(1))<=0}isOdd(t){return this._verify1(t),t.isOdd()}isEven(t){return this._verify1(t),t.isEven()}legendre(t){if(this._verify1(t),this.m.isEven())throw new Error("legendre: `num` must be odd.");const e=this.m.subn(1).iushrn(1),r=this.pow(t,e);if(r.isZero())return 0;const i=new p(1).toRed(this);if(r.eq(i))return 1;if(r.eq(this.ineg(i)))return-1;throw new Error("Invalid prime.")}jacobi(t){return this._verify1(t),t.jacobi(this.m)}kronecker(t){return this._verify1(t),t.kronecker(this.m)}iinvert(t){return this.invert(t)._move(t)}invert(t){return this._verify1(t),t.invert(this.m)._forceRed(this)}ifermat(t){return this.fermat(t)._move(t)}fermat(t){if(this._verify1(t),t.isZero()||0===this.m.cmpn(1))throw new RangeError("Not invertible.");return this.prime?this.prime.fermat(t):this.pow(t,this.m.subn(2))}invertAll(t){N(Array.isArray(t),"elems","array");for(const e of t)N(p.isBN(e),"elem","bignum"),this._verify1(e);if(0===this.m.cmpn(1)||this.m.isEven())throw new RangeError("Not invertible.");const e=t.length,r=new Array(e);if(0===e)return r;let i=new p(1).toRed(this);for(let n=0;n<e;n++)t[n].isZero()?r[n]=t[n].clone():(r[n]=i,i=this.mul(i,t[n]));i=this.invert(i);for(let n=e-1;n>=0;n--)t[n].isZero()||(r[n]=this.mul(i,r[n]),i=this.mul(i,t[n]));return r}[i](){return this.prime?`<Red: ${this.prime.name}>`:`<Red: ${this.m.toString(10)}>`}}class B extends x{constructor(t){super(t),this.prime=null,this.n=this.m.bitLength(),this.n%26!=0&&(this.n+=26-this.n%26),this.k=2*this.n,this.w=this.k/26,this.b=p.shift(1,this.k).div(this.m)}convertTo(t){return t.length>this.w?super.convertTo(t):this.imod(t.clone())}_shift(t){let e=0,r=this.w;for(;r<t.length;)t.words[e++]=t.words[r++];0===e&&(t.words[e++]=0),t.length=e}imod(t){const e=t.negative;q(t.length<=this.w),t.negative=0;const r=t.mul(this.b);return this._shift(r),t._isub(t,r.mul(this.m)),t.ucmp(this.m)>=0&&t._isub(t,this.m),e&&!t.isZero()&&t._isub(this.m,t),t.red=this,t}}class k extends x{constructor(t){super(t),this.prime=null,this.n=26*this.m.length,this.r=p.shift(1,this.n),this.r2=p.shift(1,2*this.n).imod(this.m),this.ri=this.r.invert(this.m),this.mi=this.r.mul(this.ri).isubn(1).div(this.m),this.rib=null}get mont(){return!0}convertTo(t){return t.isNeg()||t.ucmp(this.m)>=0?this.imod(t.ushln(this.n)):this.mul(t,this.r2)}convertFrom(t){const e=this.mul(t,new p(1));return e.red=null,e}intTo(t){return(t<<BigInt(this.n))%this.mb}intFrom(t){return null===this.rib&&(this.rib=this.ri.toBigInt()),t*this.rib%this.mb}iaddn(t,e){return this.iadd(t,this.convertTo(new p(e)))}isubn(t,e){return this.isub(t,this.convertTo(new p(e)))}imul(t,e){return this.mul(t,e)._move(t)}mul(t,e){if(t.isZero()||e.isZero())return new p(0)._forceRed(this);const r=t.mul(e),i=r.umaskn(this.n).mul(this.mi).iumaskn(this.n),n=r.iadd(i.mul(this.m)).iushrn(this.n);return n.ucmp(this.m)>=0&&n._isub(n,this.m),n._forceRed(this)}imuln(t,e){if(this._verify1(t),t.isZero())return t;if(0===e)return t.words[0]=0,t.length=1,t;const r=e<0;r&&(e=-e),1===this.m.length&&(e%=this.m.words[0]);const i=K(e);if(i>5)this.imul(t,this.convertTo(new p(e)));else if(0==(e&e-1))for(let e=0;e<i-1;e++)this.iadd(t,t);else{const r=t.clone();for(let n=i-2;n>=0;n--)this.iadd(t,t),e>>n&1&&this.iadd(t,r)}return r&&this.ineg(t),t}eqn(t,e){return this._verify1(t),0===e?t.isZero():0===t.ucmp(this.convertTo(new p(e)))}isLow(t){return this._verify1(t),this.convertFrom(t).ucmp(this.m.ushrn(1))<=0}isOdd(t){return this._verify1(t),this.convertFrom(t).isOdd()}isEven(t){return this._verify1(t),this.convertFrom(t).isEven()}invert(t){return this._verify1(t),this.imod(t.invert(this.m).mul(this.r2))}}function z(t,e,r){const i=new t(e);return t.captureStackTrace&&t.captureStackTrace(i,r),i}function q(t,e){if(!t){throw z(Error,e||"Assertion failed.",q)}}function N(t,e,r){if(!t){throw z(TypeError,`"${e}" must be a(n) ${r}.`,N)}}function P(t,e){if(!t){throw z(RangeError,`"${e}" only works with positive numbers.`,P)}}function R(t,e){if(!t){throw z(TypeError,`"${e}" only works with red numbers.`,R)}}function O(t,e){if(!t){throw z(TypeError,`"${e}" only works with normal numbers.`,O)}}function U(t){if(!t){throw z(RangeError,"Cannot divide by zero.",U)}}class C extends Error{constructor(t){super(),this.name="SquareRootError",this.message="X is not a square mod P.",this.result=t.fromRed(),Error.captureStackTrace&&Error.captureStackTrace(this,C)}}function T(t){return Number.isSafeInteger(t)}function D(t){return T(t)&&t>=-67108863&&t<=67108863}function L(t){if(null==t)return 10;if("number"==typeof t)return t;switch(t){case"bin":return 2;case"oct":return 8;case"dec":return 10;case"hex":return 16}return 0}function K(t){if(Math.clz32)return 32-Math.clz32(t);let e=t,r=0;return e>=4096&&(r+=13,e>>>=13),e>=64&&(r+=7,e>>>=7),e>=8&&(r+=4,e>>>=4),e>=2&&(r+=2,e>>>=2),r+e}function H(t){if(0===t)return 26;let e=t,r=0;return 0==(8191&e)&&(r+=13,e>>>=13),0==(127&e)&&(r+=7,e>>>=7),0==(15&e)&&(r+=4,e>>>=4),0==(3&e)&&(r+=2,e>>>=2),0==(1&e)&&(r+=1),r}function j(t,e,r){const i=Math.min(t.length,r);let n=0,s=0;for(let r=e;r<i;r++){const e=t.charCodeAt(r)-48;let i;n<<=4,i=e>=49&&e<=54?e-49+10:e>=17&&e<=22?e-17+10:e,n|=i,s|=i}if(-16&s)throw new Error("Invalid string.");return n}function F(t,e,r,i){const n=Math.min(t.length,r);let s=0;for(let r=e;r<n;r++){const e=t.charCodeAt(r)-48;let n;if(s*=i,n=e>=49?e-49+10:e>=17?e-17+10:e,e<0||e>207||n>=i)throw new Error("Invalid string.");s+=n}return s}function Z(t,e,r){for(let i=0;i<e;i++)t=t*t%r;return t}function V(t,e,r){const i=t.length+e.length;r.negative=t.negative^e.negative,r._alloc(i),r.length=i;const n=t.words[0]*e.words[0],s=67108863&n;let o=n/67108864|0,f=1;for(r.words[0]=s;f<r.length-1;f++){let i=o>>>26,n=67108863&o;const s=Math.max(0,f-t.length+1),a=Math.min(f,e.length-1);for(let r=s;r<=a;r++){const s=f-r,o=t.words[s]*e.words[r]+n;i+=o/67108864|0,n=67108863&o}r.words[f]=0|n,o=0|i}return 0!==o?r.words[f]=0|o:r.length-=1,r._strip()}function G(t,e,r){const i=t.length+e.length;r.negative=t.negative^e.negative,r._alloc(i),r.length=i;let n=0,s=0,o=0;for(;o<r.length-1;o++){let i=s;s=0;let f=67108863&n;const a=Math.max(0,o-t.length+1),c=Math.min(o,e.length-1);for(let r=a;r<=c;r++){const n=o-r,a=t.words[n]*e.words[r];let c=67108863&a;i=i+(a/67108864|0)|0,c=c+f|0,f=67108863&c,i=i+(c>>>26)|0,s+=i>>>26,i&=67108863}r.words[o]=f,n=i,i=s}return 0!==n?r.words[o]=n:r.length-=1,r._strip()}function J(t,e,r){const i=t.words,n=e.words,s=r.words,o=0|i[0],f=8191&o,a=o>>>13,c=0|i[1],h=8191&c,u=c>>>13,d=0|i[2],l=8191&d,b=d>>>13,p=0|i[3],m=8191&p,g=p>>>13,w=0|i[4],y=8191&w,v=w>>>13,S=0|i[5],E=8191&S,M=S>>>13,A=0|i[6],I=8191&A,_=A>>>13,x=0|i[7],B=8191&x,k=x>>>13,z=0|i[8],q=8191&z,N=z>>>13,P=0|i[9],R=8191&P,O=P>>>13,U=0|n[0],C=8191&U,T=U>>>13,D=0|n[1],L=8191&D,K=D>>>13,H=0|n[2],j=8191&H,F=H>>>13,Z=0|n[3],V=8191&Z,G=Z>>>13,J=0|n[4],Y=8191&J,X=J>>>13,W=0|n[5],$=8191&W,Q=W>>>13,tt=0|n[6],et=8191&tt,rt=tt>>>13,it=0|n[7],nt=8191&it,st=it>>>13,ot=0|n[8],ft=8191&ot,at=ot>>>13,ct=0|n[9],ht=8191&ct,ut=ct>>>13;let dt,lt,bt,pt=0;r.negative=t.negative^e.negative,r._alloc(20),r.length=19,dt=Math.imul(f,C),lt=Math.imul(f,T),lt=lt+Math.imul(a,C)|0,bt=Math.imul(a,T);let mt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(mt>>>26)|0,mt&=67108863,dt=Math.imul(h,C),lt=Math.imul(h,T),lt=lt+Math.imul(u,C)|0,bt=Math.imul(u,T),dt=dt+Math.imul(f,L)|0,lt=lt+Math.imul(f,K)|0,lt=lt+Math.imul(a,L)|0,bt=bt+Math.imul(a,K)|0;let gt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(gt>>>26)|0,gt&=67108863,dt=Math.imul(l,C),lt=Math.imul(l,T),lt=lt+Math.imul(b,C)|0,bt=Math.imul(b,T),dt=dt+Math.imul(h,L)|0,lt=lt+Math.imul(h,K)|0,lt=lt+Math.imul(u,L)|0,bt=bt+Math.imul(u,K)|0,dt=dt+Math.imul(f,j)|0,lt=lt+Math.imul(f,F)|0,lt=lt+Math.imul(a,j)|0,bt=bt+Math.imul(a,F)|0;let wt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(wt>>>26)|0,wt&=67108863,dt=Math.imul(m,C),lt=Math.imul(m,T),lt=lt+Math.imul(g,C)|0,bt=Math.imul(g,T),dt=dt+Math.imul(l,L)|0,lt=lt+Math.imul(l,K)|0,lt=lt+Math.imul(b,L)|0,bt=bt+Math.imul(b,K)|0,dt=dt+Math.imul(h,j)|0,lt=lt+Math.imul(h,F)|0,lt=lt+Math.imul(u,j)|0,bt=bt+Math.imul(u,F)|0,dt=dt+Math.imul(f,V)|0,lt=lt+Math.imul(f,G)|0,lt=lt+Math.imul(a,V)|0,bt=bt+Math.imul(a,G)|0;let yt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(yt>>>26)|0,yt&=67108863,dt=Math.imul(y,C),lt=Math.imul(y,T),lt=lt+Math.imul(v,C)|0,bt=Math.imul(v,T),dt=dt+Math.imul(m,L)|0,lt=lt+Math.imul(m,K)|0,lt=lt+Math.imul(g,L)|0,bt=bt+Math.imul(g,K)|0,dt=dt+Math.imul(l,j)|0,lt=lt+Math.imul(l,F)|0,lt=lt+Math.imul(b,j)|0,bt=bt+Math.imul(b,F)|0,dt=dt+Math.imul(h,V)|0,lt=lt+Math.imul(h,G)|0,lt=lt+Math.imul(u,V)|0,bt=bt+Math.imul(u,G)|0,dt=dt+Math.imul(f,Y)|0,lt=lt+Math.imul(f,X)|0,lt=lt+Math.imul(a,Y)|0,bt=bt+Math.imul(a,X)|0;let vt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(vt>>>26)|0,vt&=67108863,dt=Math.imul(E,C),lt=Math.imul(E,T),lt=lt+Math.imul(M,C)|0,bt=Math.imul(M,T),dt=dt+Math.imul(y,L)|0,lt=lt+Math.imul(y,K)|0,lt=lt+Math.imul(v,L)|0,bt=bt+Math.imul(v,K)|0,dt=dt+Math.imul(m,j)|0,lt=lt+Math.imul(m,F)|0,lt=lt+Math.imul(g,j)|0,bt=bt+Math.imul(g,F)|0,dt=dt+Math.imul(l,V)|0,lt=lt+Math.imul(l,G)|0,lt=lt+Math.imul(b,V)|0,bt=bt+Math.imul(b,G)|0,dt=dt+Math.imul(h,Y)|0,lt=lt+Math.imul(h,X)|0,lt=lt+Math.imul(u,Y)|0,bt=bt+Math.imul(u,X)|0,dt=dt+Math.imul(f,$)|0,lt=lt+Math.imul(f,Q)|0,lt=lt+Math.imul(a,$)|0,bt=bt+Math.imul(a,Q)|0;let St=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(St>>>26)|0,St&=67108863,dt=Math.imul(I,C),lt=Math.imul(I,T),lt=lt+Math.imul(_,C)|0,bt=Math.imul(_,T),dt=dt+Math.imul(E,L)|0,lt=lt+Math.imul(E,K)|0,lt=lt+Math.imul(M,L)|0,bt=bt+Math.imul(M,K)|0,dt=dt+Math.imul(y,j)|0,lt=lt+Math.imul(y,F)|0,lt=lt+Math.imul(v,j)|0,bt=bt+Math.imul(v,F)|0,dt=dt+Math.imul(m,V)|0,lt=lt+Math.imul(m,G)|0,lt=lt+Math.imul(g,V)|0,bt=bt+Math.imul(g,G)|0,dt=dt+Math.imul(l,Y)|0,lt=lt+Math.imul(l,X)|0,lt=lt+Math.imul(b,Y)|0,bt=bt+Math.imul(b,X)|0,dt=dt+Math.imul(h,$)|0,lt=lt+Math.imul(h,Q)|0,lt=lt+Math.imul(u,$)|0,bt=bt+Math.imul(u,Q)|0,dt=dt+Math.imul(f,et)|0,lt=lt+Math.imul(f,rt)|0,lt=lt+Math.imul(a,et)|0,bt=bt+Math.imul(a,rt)|0;let Et=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(Et>>>26)|0,Et&=67108863,dt=Math.imul(B,C),lt=Math.imul(B,T),lt=lt+Math.imul(k,C)|0,bt=Math.imul(k,T),dt=dt+Math.imul(I,L)|0,lt=lt+Math.imul(I,K)|0,lt=lt+Math.imul(_,L)|0,bt=bt+Math.imul(_,K)|0,dt=dt+Math.imul(E,j)|0,lt=lt+Math.imul(E,F)|0,lt=lt+Math.imul(M,j)|0,bt=bt+Math.imul(M,F)|0,dt=dt+Math.imul(y,V)|0,lt=lt+Math.imul(y,G)|0,lt=lt+Math.imul(v,V)|0,bt=bt+Math.imul(v,G)|0,dt=dt+Math.imul(m,Y)|0,lt=lt+Math.imul(m,X)|0,lt=lt+Math.imul(g,Y)|0,bt=bt+Math.imul(g,X)|0,dt=dt+Math.imul(l,$)|0,lt=lt+Math.imul(l,Q)|0,lt=lt+Math.imul(b,$)|0,bt=bt+Math.imul(b,Q)|0,dt=dt+Math.imul(h,et)|0,lt=lt+Math.imul(h,rt)|0,lt=lt+Math.imul(u,et)|0,bt=bt+Math.imul(u,rt)|0,dt=dt+Math.imul(f,nt)|0,lt=lt+Math.imul(f,st)|0,lt=lt+Math.imul(a,nt)|0,bt=bt+Math.imul(a,st)|0;let Mt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,dt=Math.imul(q,C),lt=Math.imul(q,T),lt=lt+Math.imul(N,C)|0,bt=Math.imul(N,T),dt=dt+Math.imul(B,L)|0,lt=lt+Math.imul(B,K)|0,lt=lt+Math.imul(k,L)|0,bt=bt+Math.imul(k,K)|0,dt=dt+Math.imul(I,j)|0,lt=lt+Math.imul(I,F)|0,lt=lt+Math.imul(_,j)|0,bt=bt+Math.imul(_,F)|0,dt=dt+Math.imul(E,V)|0,lt=lt+Math.imul(E,G)|0,lt=lt+Math.imul(M,V)|0,bt=bt+Math.imul(M,G)|0,dt=dt+Math.imul(y,Y)|0,lt=lt+Math.imul(y,X)|0,lt=lt+Math.imul(v,Y)|0,bt=bt+Math.imul(v,X)|0,dt=dt+Math.imul(m,$)|0,lt=lt+Math.imul(m,Q)|0,lt=lt+Math.imul(g,$)|0,bt=bt+Math.imul(g,Q)|0,dt=dt+Math.imul(l,et)|0,lt=lt+Math.imul(l,rt)|0,lt=lt+Math.imul(b,et)|0,bt=bt+Math.imul(b,rt)|0,dt=dt+Math.imul(h,nt)|0,lt=lt+Math.imul(h,st)|0,lt=lt+Math.imul(u,nt)|0,bt=bt+Math.imul(u,st)|0,dt=dt+Math.imul(f,ft)|0,lt=lt+Math.imul(f,at)|0,lt=lt+Math.imul(a,ft)|0,bt=bt+Math.imul(a,at)|0;let At=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(At>>>26)|0,At&=67108863,dt=Math.imul(R,C),lt=Math.imul(R,T),lt=lt+Math.imul(O,C)|0,bt=Math.imul(O,T),dt=dt+Math.imul(q,L)|0,lt=lt+Math.imul(q,K)|0,lt=lt+Math.imul(N,L)|0,bt=bt+Math.imul(N,K)|0,dt=dt+Math.imul(B,j)|0,lt=lt+Math.imul(B,F)|0,lt=lt+Math.imul(k,j)|0,bt=bt+Math.imul(k,F)|0,dt=dt+Math.imul(I,V)|0,lt=lt+Math.imul(I,G)|0,lt=lt+Math.imul(_,V)|0,bt=bt+Math.imul(_,G)|0,dt=dt+Math.imul(E,Y)|0,lt=lt+Math.imul(E,X)|0,lt=lt+Math.imul(M,Y)|0,bt=bt+Math.imul(M,X)|0,dt=dt+Math.imul(y,$)|0,lt=lt+Math.imul(y,Q)|0,lt=lt+Math.imul(v,$)|0,bt=bt+Math.imul(v,Q)|0,dt=dt+Math.imul(m,et)|0,lt=lt+Math.imul(m,rt)|0,lt=lt+Math.imul(g,et)|0,bt=bt+Math.imul(g,rt)|0,dt=dt+Math.imul(l,nt)|0,lt=lt+Math.imul(l,st)|0,lt=lt+Math.imul(b,nt)|0,bt=bt+Math.imul(b,st)|0,dt=dt+Math.imul(h,ft)|0,lt=lt+Math.imul(h,at)|0,lt=lt+Math.imul(u,ft)|0,bt=bt+Math.imul(u,at)|0,dt=dt+Math.imul(f,ht)|0,lt=lt+Math.imul(f,ut)|0,lt=lt+Math.imul(a,ht)|0,bt=bt+Math.imul(a,ut)|0;let It=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(It>>>26)|0,It&=67108863,dt=Math.imul(R,L),lt=Math.imul(R,K),lt=lt+Math.imul(O,L)|0,bt=Math.imul(O,K),dt=dt+Math.imul(q,j)|0,lt=lt+Math.imul(q,F)|0,lt=lt+Math.imul(N,j)|0,bt=bt+Math.imul(N,F)|0,dt=dt+Math.imul(B,V)|0,lt=lt+Math.imul(B,G)|0,lt=lt+Math.imul(k,V)|0,bt=bt+Math.imul(k,G)|0,dt=dt+Math.imul(I,Y)|0,lt=lt+Math.imul(I,X)|0,lt=lt+Math.imul(_,Y)|0,bt=bt+Math.imul(_,X)|0,dt=dt+Math.imul(E,$)|0,lt=lt+Math.imul(E,Q)|0,lt=lt+Math.imul(M,$)|0,bt=bt+Math.imul(M,Q)|0,dt=dt+Math.imul(y,et)|0,lt=lt+Math.imul(y,rt)|0,lt=lt+Math.imul(v,et)|0,bt=bt+Math.imul(v,rt)|0,dt=dt+Math.imul(m,nt)|0,lt=lt+Math.imul(m,st)|0,lt=lt+Math.imul(g,nt)|0,bt=bt+Math.imul(g,st)|0,dt=dt+Math.imul(l,ft)|0,lt=lt+Math.imul(l,at)|0,lt=lt+Math.imul(b,ft)|0,bt=bt+Math.imul(b,at)|0,dt=dt+Math.imul(h,ht)|0,lt=lt+Math.imul(h,ut)|0,lt=lt+Math.imul(u,ht)|0,bt=bt+Math.imul(u,ut)|0;let _t=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(_t>>>26)|0,_t&=67108863,dt=Math.imul(R,j),lt=Math.imul(R,F),lt=lt+Math.imul(O,j)|0,bt=Math.imul(O,F),dt=dt+Math.imul(q,V)|0,lt=lt+Math.imul(q,G)|0,lt=lt+Math.imul(N,V)|0,bt=bt+Math.imul(N,G)|0,dt=dt+Math.imul(B,Y)|0,lt=lt+Math.imul(B,X)|0,lt=lt+Math.imul(k,Y)|0,bt=bt+Math.imul(k,X)|0,dt=dt+Math.imul(I,$)|0,lt=lt+Math.imul(I,Q)|0,lt=lt+Math.imul(_,$)|0,bt=bt+Math.imul(_,Q)|0,dt=dt+Math.imul(E,et)|0,lt=lt+Math.imul(E,rt)|0,lt=lt+Math.imul(M,et)|0,bt=bt+Math.imul(M,rt)|0,dt=dt+Math.imul(y,nt)|0,lt=lt+Math.imul(y,st)|0,lt=lt+Math.imul(v,nt)|0,bt=bt+Math.imul(v,st)|0,dt=dt+Math.imul(m,ft)|0,lt=lt+Math.imul(m,at)|0,lt=lt+Math.imul(g,ft)|0,bt=bt+Math.imul(g,at)|0,dt=dt+Math.imul(l,ht)|0,lt=lt+Math.imul(l,ut)|0,lt=lt+Math.imul(b,ht)|0,bt=bt+Math.imul(b,ut)|0;let xt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(xt>>>26)|0,xt&=67108863,dt=Math.imul(R,V),lt=Math.imul(R,G),lt=lt+Math.imul(O,V)|0,bt=Math.imul(O,G),dt=dt+Math.imul(q,Y)|0,lt=lt+Math.imul(q,X)|0,lt=lt+Math.imul(N,Y)|0,bt=bt+Math.imul(N,X)|0,dt=dt+Math.imul(B,$)|0,lt=lt+Math.imul(B,Q)|0,lt=lt+Math.imul(k,$)|0,bt=bt+Math.imul(k,Q)|0,dt=dt+Math.imul(I,et)|0,lt=lt+Math.imul(I,rt)|0,lt=lt+Math.imul(_,et)|0,bt=bt+Math.imul(_,rt)|0,dt=dt+Math.imul(E,nt)|0,lt=lt+Math.imul(E,st)|0,lt=lt+Math.imul(M,nt)|0,bt=bt+Math.imul(M,st)|0,dt=dt+Math.imul(y,ft)|0,lt=lt+Math.imul(y,at)|0,lt=lt+Math.imul(v,ft)|0,bt=bt+Math.imul(v,at)|0,dt=dt+Math.imul(m,ht)|0,lt=lt+Math.imul(m,ut)|0,lt=lt+Math.imul(g,ht)|0,bt=bt+Math.imul(g,ut)|0;let Bt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,dt=Math.imul(R,Y),lt=Math.imul(R,X),lt=lt+Math.imul(O,Y)|0,bt=Math.imul(O,X),dt=dt+Math.imul(q,$)|0,lt=lt+Math.imul(q,Q)|0,lt=lt+Math.imul(N,$)|0,bt=bt+Math.imul(N,Q)|0,dt=dt+Math.imul(B,et)|0,lt=lt+Math.imul(B,rt)|0,lt=lt+Math.imul(k,et)|0,bt=bt+Math.imul(k,rt)|0,dt=dt+Math.imul(I,nt)|0,lt=lt+Math.imul(I,st)|0,lt=lt+Math.imul(_,nt)|0,bt=bt+Math.imul(_,st)|0,dt=dt+Math.imul(E,ft)|0,lt=lt+Math.imul(E,at)|0,lt=lt+Math.imul(M,ft)|0,bt=bt+Math.imul(M,at)|0,dt=dt+Math.imul(y,ht)|0,lt=lt+Math.imul(y,ut)|0,lt=lt+Math.imul(v,ht)|0,bt=bt+Math.imul(v,ut)|0;let kt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(kt>>>26)|0,kt&=67108863,dt=Math.imul(R,$),lt=Math.imul(R,Q),lt=lt+Math.imul(O,$)|0,bt=Math.imul(O,Q),dt=dt+Math.imul(q,et)|0,lt=lt+Math.imul(q,rt)|0,lt=lt+Math.imul(N,et)|0,bt=bt+Math.imul(N,rt)|0,dt=dt+Math.imul(B,nt)|0,lt=lt+Math.imul(B,st)|0,lt=lt+Math.imul(k,nt)|0,bt=bt+Math.imul(k,st)|0,dt=dt+Math.imul(I,ft)|0,lt=lt+Math.imul(I,at)|0,lt=lt+Math.imul(_,ft)|0,bt=bt+Math.imul(_,at)|0,dt=dt+Math.imul(E,ht)|0,lt=lt+Math.imul(E,ut)|0,lt=lt+Math.imul(M,ht)|0,bt=bt+Math.imul(M,ut)|0;let zt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(zt>>>26)|0,zt&=67108863,dt=Math.imul(R,et),lt=Math.imul(R,rt),lt=lt+Math.imul(O,et)|0,bt=Math.imul(O,rt),dt=dt+Math.imul(q,nt)|0,lt=lt+Math.imul(q,st)|0,lt=lt+Math.imul(N,nt)|0,bt=bt+Math.imul(N,st)|0,dt=dt+Math.imul(B,ft)|0,lt=lt+Math.imul(B,at)|0,lt=lt+Math.imul(k,ft)|0,bt=bt+Math.imul(k,at)|0,dt=dt+Math.imul(I,ht)|0,lt=lt+Math.imul(I,ut)|0,lt=lt+Math.imul(_,ht)|0,bt=bt+Math.imul(_,ut)|0;let qt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(qt>>>26)|0,qt&=67108863,dt=Math.imul(R,nt),lt=Math.imul(R,st),lt=lt+Math.imul(O,nt)|0,bt=Math.imul(O,st),dt=dt+Math.imul(q,ft)|0,lt=lt+Math.imul(q,at)|0,lt=lt+Math.imul(N,ft)|0,bt=bt+Math.imul(N,at)|0,dt=dt+Math.imul(B,ht)|0,lt=lt+Math.imul(B,ut)|0,lt=lt+Math.imul(k,ht)|0,bt=bt+Math.imul(k,ut)|0;let Nt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,dt=Math.imul(R,ft),lt=Math.imul(R,at),lt=lt+Math.imul(O,ft)|0,bt=Math.imul(O,at),dt=dt+Math.imul(q,ht)|0,lt=lt+Math.imul(q,ut)|0,lt=lt+Math.imul(N,ht)|0,bt=bt+Math.imul(N,ut)|0;let Pt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(bt+(lt>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,dt=Math.imul(R,ht),lt=Math.imul(R,ut),lt=lt+Math.imul(O,ht)|0,bt=Math.imul(O,ut);let Rt=(pt+dt|0)+((8191&lt)<<13)|0;return pt=(bt+(lt>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,s[0]=mt,s[1]=gt,s[2]=wt,s[3]=yt,s[4]=vt,s[5]=St,s[6]=Et,s[7]=Mt,s[8]=At,s[9]=It,s[10]=_t,s[11]=xt,s[12]=Bt,s[13]=kt,s[14]=zt,s[15]=qt,s[16]=Nt,s[17]=Pt,s[18]=Rt,0!==pt&&(s[19]=pt,r.length+=1),r}Math.imul||(J=V),p.Red=x,t.exports=p}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * box.js - nacl secretbox for bcrypto (crypto_secretbox_xsalsa20poly1305)
 * Copyright (c) 2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009 The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Resources:
 *   https://nacl.cr.yp.to/secretbox.html
 *   https://github.com/golang/crypto/blob/master/nacl/box/box.go
 *   https://github.com/golang/crypto/blob/master/nacl/box/box_test.go
 *   https://github.com/golang/crypto/blob/master/nacl/box/example_test.go
 */
const i=r(75),n=r(26),s=r(5),o=r(79);e.native=n.native,e.seal=function(e,r,i=null){null==i&&(i=o.privateKeyGenerate());const f=o.publicKeyCreate(i),a=o.derive(r,i),c=n.derive(a),h=s.randomBytes(24),u=n.seal(e,c,h);return t.concat([f,h,u])},e.open=function(e,r){if(i(t.isBuffer(e)),e.length<56)throw new Error("Invalid secret box size.");const s=e.slice(0,32),f=e.slice(32,56),a=e.slice(56),c=o.derive(s,r),h=n.derive(c);return n.open(a,h,f)}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function o(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var r,f,a=o(t),c=1;c<arguments.length;c++){for(var h in r=Object(arguments[c]))n.call(r,h)&&(a[h]=r[h]);if(i){f=i(r);for(var u=0;u<f.length;u++)s.call(r,f[u])&&(a[f[u]]=r[f[u]])}}return a}},function(t,e,r){(function(t){var i=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),r={},i=0;i<e.length;i++)r[e[i]]=Object.getOwnPropertyDescriptor(t,e[i]);return r},n=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(f(arguments[r]));return e.join(" ")}r=1;for(var i=arguments,s=i.length,o=String(t).replace(n,(function(t){if("%%"===t)return"%";if(r>=s)return t;switch(t){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(t){return"[Circular]"}default:return t}})),a=i[r];r<s;a=i[++r])p(a)||!v(a)?o+=" "+a:o+=" "+f(a);return o},e.deprecate=function(r,i){if(void 0!==t&&!0===t.noDeprecation)return r;if(void 0===t)return function(){return e.deprecate(r,i).apply(this,arguments)};var n=!1;return function(){if(!n){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),n=!0}return r.apply(this,arguments)}};var s,o={};function f(t,r){var i={seen:[],stylize:c};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),b(r)?i.showHidden=r:r&&e._extend(i,r),w(i.showHidden)&&(i.showHidden=!1),w(i.depth)&&(i.depth=2),w(i.colors)&&(i.colors=!1),w(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=a),h(i,t,i.depth)}function a(t,e){var r=f.styles[e];return r?"["+f.colors[r][0]+"m"+t+"["+f.colors[r][1]+"m":t}function c(t,e){return t}function h(t,r,i){if(t.customInspect&&r&&M(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var n=r.inspect(i,t);return g(n)||(n=h(t,n,i)),n}var s=function(t,e){if(w(e))return t.stylize("undefined","undefined");if(g(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(m(e))return t.stylize(""+e,"number");if(b(e))return t.stylize(""+e,"boolean");if(p(e))return t.stylize("null","null")}(t,r);if(s)return s;var o=Object.keys(r),f=function(t){var e={};return t.forEach((function(t,r){e[t]=!0})),e}(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(r)),E(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return u(r);if(0===o.length){if(M(r)){var a=r.name?": "+r.name:"";return t.stylize("[Function"+a+"]","special")}if(y(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(S(r))return t.stylize(Date.prototype.toString.call(r),"date");if(E(r))return u(r)}var c,v="",A=!1,I=["{","}"];(l(r)&&(A=!0,I=["[","]"]),M(r))&&(v=" [Function"+(r.name?": "+r.name:"")+"]");return y(r)&&(v=" "+RegExp.prototype.toString.call(r)),S(r)&&(v=" "+Date.prototype.toUTCString.call(r)),E(r)&&(v=" "+u(r)),0!==o.length||A&&0!=r.length?i<0?y(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),c=A?function(t,e,r,i,n){for(var s=[],o=0,f=e.length;o<f;++o)B(e,String(o))?s.push(d(t,e,r,i,String(o),!0)):s.push("");return n.forEach((function(n){n.match(/^\d+$/)||s.push(d(t,e,r,i,n,!0))})),s}(t,r,i,f,o):o.map((function(e){return d(t,r,i,f,e,A)})),t.seen.pop(),function(t,e,r){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1];return r[0]+e+" "+t.join(", ")+" "+r[1]}(c,v,I)):I[0]+v+I[1]}function u(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,r,i,n,s){var o,f,a;if((a=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]}).get?f=a.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):a.set&&(f=t.stylize("[Setter]","special")),B(i,n)||(o="["+n+"]"),f||(t.seen.indexOf(a.value)<0?(f=p(r)?h(t,a.value,null):h(t,a.value,r-1)).indexOf("\n")>-1&&(f=s?f.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+f.split("\n").map((function(t){return"   "+t})).join("\n")):f=t.stylize("[Circular]","special")),w(o)){if(s&&n.match(/^\d+$/))return f;(o=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+f}function l(t){return Array.isArray(t)}function b(t){return"boolean"==typeof t}function p(t){return null===t}function m(t){return"number"==typeof t}function g(t){return"string"==typeof t}function w(t){return void 0===t}function y(t){return v(t)&&"[object RegExp]"===A(t)}function v(t){return"object"==typeof t&&null!==t}function S(t){return v(t)&&"[object Date]"===A(t)}function E(t){return v(t)&&("[object Error]"===A(t)||t instanceof Error)}function M(t){return"function"==typeof t}function A(t){return Object.prototype.toString.call(t)}function I(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(r){if(w(s)&&(s=t.env.NODE_DEBUG||""),r=r.toUpperCase(),!o[r])if(new RegExp("\\b"+r+"\\b","i").test(s)){var i=t.pid;o[r]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",r,i,t)}}else o[r]=function(){};return o[r]},e.inspect=f,f.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},f.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=l,e.isBoolean=b,e.isNull=p,e.isNullOrUndefined=function(t){return null==t},e.isNumber=m,e.isString=g,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=w,e.isRegExp=y,e.isObject=v,e.isDate=S,e.isError=E,e.isFunction=M,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=r(189);var _=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function x(){var t=new Date,e=[I(t.getHours()),I(t.getMinutes()),I(t.getSeconds())].join(":");return[t.getDate(),_[t.getMonth()],e].join(" ")}function B(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",x(),e.format.apply(e,arguments))},e.inherits=r(190),e._extend=function(t,e){if(!e||!v(e))return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t};var k="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function z(t,e){if(!t){var r=new Error("Promise was rejected with a falsy value");r.reason=t,t=r}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(k&&t[k]){var e;if("function"!=typeof(e=t[k]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,k,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,r,i=new Promise((function(t,i){e=t,r=i})),n=[],s=0;s<arguments.length;s++)n.push(arguments[s]);n.push((function(t,i){t?r(t):e(i)}));try{t.apply(this,n)}catch(t){r(t)}return i}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),k&&Object.defineProperty(e,k,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,i(t))},e.promisify.custom=k,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],i=0;i<arguments.length;i++)r.push(arguments[i]);var n=r.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return n.apply(s,arguments)};e.apply(this,r).then((function(e){t.nextTick(o,null,e)}),(function(e){t.nextTick(z,e,o)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),Object.defineProperties(r,i(e)),r}}).call(this,r(76))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){"use strict";(function(t){
/*!
 * secretbox.js - nacl secretbox for bcrypto
 * Copyright (c) 2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009 The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Resources:
 *   https://nacl.cr.yp.to/secretbox.html
 *   https://github.com/golang/crypto/tree/master/nacl
 *   https://github.com/golang/crypto/blob/master/nacl/secretbox/secretbox.go
 *   https://github.com/golang/crypto/blob/master/nacl/secretbox/secretbox_test.go
 *   https://github.com/golang/crypto/blob/master/nacl/secretbox/example_test.go
 *   https://github.com/golang/crypto/blob/master/nacl/box/box.go
 *   https://github.com/golang/crypto/blob/master/nacl/box/box_test.go
 *   https://github.com/golang/crypto/blob/master/nacl/box/example_test.go
 */
const i=r(1),n=r(77),s=r(78),o=t.alloc(16,0);e.native=0,e.seal=function(e,r,o){i(t.isBuffer(e)),i(t.isBuffer(r)),i(t.isBuffer(o)),i(32===r.length),i(24===o.length);const f=t.alloc(32,0),a=t.alloc(16+e.length),c=a.slice(16),h=new n,u=new s;return e.copy(a,16),h.init(r,o),h.encrypt(f),h.encrypt(c),u.init(f),u.update(c),u.final().copy(a,0),a},e.open=function(e,r,o){if(i(t.isBuffer(e)),i(t.isBuffer(r)),i(t.isBuffer(o)),i(32===r.length),i(24===o.length),e.length<16)throw new Error("Invalid secret box size.");const f=t.alloc(32,0),a=t.from(e),c=a.slice(0,16),h=a.slice(16),u=new n,d=new s;if(u.init(r,o),u.encrypt(f),d.init(f),d.update(h),!d.verify(c))throw new Error("Invalid secret box tag.");return u.encrypt(h),h},e.derive=function(e,r){const s=function(e,r){if(i(t.isBuffer(e)),null==r){if(32!==e.length)throw new RangeError("Invalid secret size for secret box.");return e}let n;if("function"==typeof r.digest)n=r.digest(e);else{if("function"!=typeof r)throw new Error("Invalid key derivation function.");n=r(e)}if(i(t.isBuffer(n)),n.length<32)throw new RangeError("Key is too small for secret box.");return n.slice(0,32)}(e,r);return n.derive(s,o)}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * salsa20.js - salsa20 for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources
 *   https://en.wikipedia.org/wiki/Salsa20
 *   https://cr.yp.to/snuffle.html
 *   https://cr.yp.to/snuffle/spec.pdf
 *   https://cr.yp.to/snuffle/812.pdf
 *   http://www.ecrypt.eu.org/stream/salsa20pf.html
 */
const i=r(1),n=0===new Int8Array(new Int16Array([1]).buffer)[0];class s{constructor(){this.state=new Uint32Array(16),this.stream=new Uint32Array(16),this.bytes=new Uint8Array(this.stream.buffer),this.pos=-1,n&&(this.bytes=e.alloc(64))}init(t,r,n){if(null==n&&(n=0),i(e.isBuffer(t)),i(e.isBuffer(r)),i(Number.isSafeInteger(n)),16!==t.length&&32!==t.length)throw new RangeError("Invalid key size.");if(r.length>=24&&(t=s.derive(t,r.slice(0,16)),r=r.slice(16)),this.state[0]=1634760805,this.state[1]=a(t,0),this.state[2]=a(t,4),this.state[3]=a(t,8),this.state[4]=a(t,12),this.state[5]=t.length<32?824206446:857760878,8===r.length)this.state[6]=a(r,0),this.state[7]=a(r,4),this.state[8]=n>>>0,this.state[9]=n/4294967296>>>0;else if(12===r.length)this.state[6]=a(r,0),this.state[7]=a(r,4),this.state[8]=a(r,8),this.state[9]=n>>>0;else{if(16!==r.length)throw new RangeError("Invalid nonce size.");this.state[6]=a(r,0),this.state[7]=a(r,4),this.state[8]=a(r,8),this.state[9]=a(r,12)}return this.state[10]=t.length<32?2036477238:2036477234,this.state[11]=a(t,16%t.length),this.state[12]=a(t,20%t.length),this.state[13]=a(t,24%t.length),this.state[14]=a(t,28%t.length),this.state[15]=1797285236,this.pos=0,this}encrypt(t){if(i(e.isBuffer(t)),-1===this.pos)throw new Error("Context is not initialized.");for(let e=0;e<t.length;e++)0==(63&this.pos)&&(this._block(),this.pos=0),t[e]^=this.bytes[this.pos++];return t}_block(){for(let t=0;t<16;t++)this.stream[t]=this.state[t];for(let t=0;t<10;t++)o(this.stream,0,4,8,12),o(this.stream,5,9,13,1),o(this.stream,10,14,2,6),o(this.stream,15,3,7,11),o(this.stream,0,1,2,3),o(this.stream,5,6,7,4),o(this.stream,10,11,8,9),o(this.stream,15,12,13,14);for(let t=0;t<16;t++)this.stream[t]+=this.state[t];if(n)for(let t=0;t<16;t++)c(this.bytes,this.stream[t],4*t);this.state[8]+=1,0===this.state[8]&&(this.state[9]+=1)}destroy(){for(let t=0;t<16;t++)this.state[t]=0,this.stream[t]=0;if(n)for(let t=0;t<64;t++)this.bytes[t]=0;return this.pos=-1,this}static derive(t,r){if(i(e.isBuffer(t)),i(e.isBuffer(r)),16!==t.length&&32!==t.length)throw new RangeError("Invalid key size.");if(16!==r.length)throw new RangeError("Invalid nonce size.");const n=new Uint32Array(16);n[0]=1634760805,n[1]=a(t,0),n[2]=a(t,4),n[3]=a(t,8),n[4]=a(t,12),n[5]=t.length<32?824206446:857760878,n[6]=a(r,0),n[7]=a(r,4),n[8]=a(r,8),n[9]=a(r,12),n[10]=t.length<32?2036477238:2036477234,n[11]=a(t,16%t.length),n[12]=a(t,20%t.length),n[13]=a(t,24%t.length),n[14]=a(t,28%t.length),n[15]=1797285236;for(let t=0;t<10;t++)o(n,0,4,8,12),o(n,5,9,13,1),o(n,10,14,2,6),o(n,15,3,7,11),o(n,0,1,2,3),o(n,5,6,7,4),o(n,10,11,8,9),o(n,15,12,13,14);const s=e.alloc(32);return c(s,n[0],0),c(s,n[5],4),c(s,n[10],8),c(s,n[15],12),c(s,n[6],16),c(s,n[7],20),c(s,n[8],24),c(s,n[9],28),s}}function o(t,e,r,i,n){t[r]^=f(t[e]+t[n],7),t[i]^=f(t[r]+t[e],9),t[n]^=f(t[i]+t[r],13),t[e]^=f(t[n]+t[i],18)}function f(t,e){return t<<e|t>>>32-e}function a(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]}function c(t,e,r){return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}s.native=0,t.exports=s}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t,i){
/*!
 * random.js - random number generator for bcrypto
 * Copyright (c) 2014-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://wiki.openssl.org/index.php/Random_Numbers
 *   https://csrc.nist.gov/projects/random-bit-generation/
 *   http://www.pcg-random.org/posts/bounded-rands.html
 *   https://developer.mozilla.org/en-US/docs/Web/API/Crypto/getRandomValues
 */
const n=r(1),s=t.crypto||t.msCrypto,o=s&&"function"==typeof s.getRandomValues,f=o?s.getRandomValues.bind(s):null,a=new Uint32Array(16);let c=0;function h(){return 0==(15&c)&&(u(a),c=0),a[c++]}function u(t){if(!o)throw new Error("Entropy source not available.");return f(t)}function d(t,e,r){if(n(i.isBuffer(t)),n(t.buffer instanceof ArrayBuffer),n(t.byteOffset>>>0===t.byteOffset),n(t.byteLength>>>0===t.byteLength),n(e>>>0===e),n(r>>>0===r),n(e+r<=t.byteLength),r>2**31-1)throw new RangeError('The value "size" is out of range.');const s=t.byteOffset+e,o=new Uint8Array(t.buffer,s,r);if(o.length>65536)for(let t=0;t<o.length;t+=65536){let e=t+65536;e>o.length&&(e=o.length),u(o.subarray(t,e))}else o.length>0&&u(o)}e.native=0,e.randomBytes=function(t){n(t>>>0===t);const e=i.alloc(t);return d(e,0,t),e},e.randomFill=function(t,e,r){return n(i.isBuffer(t)),null==e&&(e=0),n(e>>>0===e),null==r&&(r=t.length-e),n(r>>>0===r),n(e+r<=t.length),d(t,e,r),t},e.randomInt=h,e.randomRange=function(t,e){n(t>>>0===t),n(e>>>0===e),n(e>=t);const r=e-t;if(0===r)return t;const i=-r>>>0;let s,o;do{s=h(),o=s%r}while(s-o>i);return o+t}}).call(this,r(13),r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * x25519.js - x25519 for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Curve25519
 *   https://cr.yp.to/ecdh/curve25519-20060209.pdf
 *   https://tools.ietf.org/html/rfc7748#section-5
 */const i=r(80),n=r(81);t.exports=new i("X25519","ED25519",n)},function(t,e,r){"use strict";(function(t){
/*!
 * cipher.js - ciphers for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(1),n=r(70),s=r(47),o=r(196),f=r(73),a=r(197),c=r(198),{DES:h,EDE:u,EDE3:d}=r(199),l=r(200),b=r(201),p=r(202);class m{constructor(t,e){i("string"==typeof t),i("boolean"==typeof e),this.encrypt=e,this.ctx=null,this._init(t)}_init(t){const[e,r]=function(t){i("string"==typeof t),"RC2"===t.substring(0,3)&&(t="A"+t);if(t.length<5)return[t,"RAW"];const e=t.substring(t.length-3);if("-"!==t[t.length-4]||!y[e])return[t,"RAW"];return[t.substring(0,t.length-4),e]}(t),m=n.get(r,this.encrypt);switch(e){case"AES-128":case"AES-192":case"AES-256":{const t=0|e.slice(-3);this.ctx=new m(new s(t));break}case"ARC2":this.ctx=new m(new o);break;case"ARC2-GUTMANN":this.ctx=new m(new o(-1,0));break;case"ARC2-40":this.ctx=new m(new o(40));break;case"ARC2-64":this.ctx=new m(new o(64));break;case"ARC2-128":this.ctx=new m(new o(128));break;case"ARC2-128-GUTMANN":this.ctx=new m(new o(128,1024));break;case"BF":case"BLOWFISH":this.ctx=new m(new f);break;case"CAMELLIA-128":case"CAMELLIA-192":case"CAMELLIA-256":{const t=0|e.slice(-3);this.ctx=new m(new a(t));break}case"CAST5":this.ctx=new m(new c);break;case"DES":this.ctx=new m(new h);break;case"DES-EDE":this.ctx=new m(new u);break;case"DES-EDE3":this.ctx=new m(new d);break;case"IDEA":this.ctx=new m(new l);break;case"SERPENT-128":case"SERPENT-192":case"SERPENT-256":{const t=0|e.slice(-3);this.ctx=new m(new b(t));break}case"TWOFISH-128":case"TWOFISH-192":case"TWOFISH-256":{const t=0|e.slice(-3);this.ctx=new m(new p(t));break}default:throw new Error(`Unsupported cipher: ${t}.`)}}init(t,e){return this.ctx.init(t,e),this}update(t){return this.ctx.update(t)}crypt(t,e){return this.ctx.crypt(t,e)}final(){return this.ctx.final()}destroy(){return this.ctx.destroy(),this}setAutoPadding(t){return this.ctx.setAutoPadding(t),this}setAAD(t){return this.ctx.setAAD(t),this}setCCM(t,e,r){return this.ctx.setCCM(t,e,r),this}getAuthTag(){return this.ctx.getAuthTag()}setAuthTag(t){return this.ctx.setAuthTag(t),this}}class g extends m{constructor(t){super(t,!0)}}class w extends m{constructor(t){super(t,!1)}}const y={__proto__:null,ECB:!0,CBC:!0,CTS:!0,XTS:!0,CTR:!0,CFB:!0,OFB:!0,GCM:!0,CCM:!0,EAX:!0};e.native=0,e.Cipher=g,e.Decipher=w,e.encrypt=function(e,r,i,n){const s=new g(e);return s.init(r,i),t.concat([s.update(n),s.final()])},e.decrypt=function(e,r,i,n){const s=new w(e);return s.init(r,i),t.concat([s.update(n),s.final()])}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * arc2.js - ARC2 for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009, The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/RC2
 *   https://github.com/golang/crypto/blob/master/pkcs12/internal/rc2/rc2.go
 *   https://en.wikipedia.org/wiki/RC2
 *   https://www.ietf.org/rfc/rfc2268.txt
 *   http://people.csail.mit.edu/rivest/pubs/KRRR98.pdf
 */
const i=r(1),n=new Uint8Array([217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173]);function s(t,e){return t>>>16-e|t<<e}function o(t,e){return t[e++]+256*t[e]}function f(t,e,r){return t[r++]=e,t[r++]=e>>>8,r}t.exports=class{constructor(t=-1,e=-1){i(-1===t||t>>>0===t),i(-1===e||e>>>0===e),i(-1===t||40===t||64===t||128===t),i(-1===e||e<=1024),this.bits=t,this.ekb=e,this.k=new Uint16Array(64),this.r=new Uint16Array(4)}get blockSize(){return 8}init(t){i(e.isBuffer(t)),-1===this.bits?i(t.length>=1&&t.length<=128):i(8*t.length===this.bits);let r=this.ekb;-1===r&&(r=8*t.length);const s=e.alloc(128,0);for(let e=0;e<t.length;e++)s[e]=t[e];for(let e=t.length;e<128;e++)s[e]=n[s[e-t.length]+s[e-1]&255];if(s[0]=n[s[0]],r>0&&r<1024){const t=r+7>>>3;let e=128-t,i=n[s[e]&255>>(7&-r)];for(s[e]=i;e--;)i=n[i^s[e+t]],s[e]=i}for(let t=0;t<64;t++)this.k[t]=o(s,2*t);return this}encrypt(t,e,r,i){const n=this.r;n[0]=o(r,i+0),n[1]=o(r,i+2),n[2]=o(r,i+4),n[3]=o(r,i+6);let a=0;for(;a<=16;)n[0]+=this.k[a],n[0]+=n[3]&n[2],n[0]+=~n[3]&n[1],n[0]=s(n[0],1),a+=1,n[1]+=this.k[a],n[1]+=n[0]&n[3],n[1]+=~n[0]&n[2],n[1]=s(n[1],2),a+=1,n[2]+=this.k[a],n[2]+=n[1]&n[0],n[2]+=~n[1]&n[3],n[2]=s(n[2],3),a+=1,n[3]+=this.k[a],n[3]+=n[2]&n[1],n[3]+=~n[2]&n[0],n[3]=s(n[3],5),a+=1;for(n[0]+=this.k[63&n[3]],n[1]+=this.k[63&n[0]],n[2]+=this.k[63&n[1]],n[3]+=this.k[63&n[2]];a<=40;)n[0]+=this.k[a],n[0]+=n[3]&n[2],n[0]+=~n[3]&n[1],n[0]=s(n[0],1),a+=1,n[1]+=this.k[a],n[1]+=n[0]&n[3],n[1]+=~n[0]&n[2],n[1]=s(n[1],2),a+=1,n[2]+=this.k[a],n[2]+=n[1]&n[0],n[2]+=~n[1]&n[3],n[2]=s(n[2],3),a+=1,n[3]+=this.k[a],n[3]+=n[2]&n[1],n[3]+=~n[2]&n[0],n[3]=s(n[3],5),a+=1;for(n[0]+=this.k[63&n[3]],n[1]+=this.k[63&n[0]],n[2]+=this.k[63&n[1]],n[3]+=this.k[63&n[2]];a<=60;)n[0]+=this.k[a],n[0]+=n[3]&n[2],n[0]+=~n[3]&n[1],n[0]=s(n[0],1),a+=1,n[1]+=this.k[a],n[1]+=n[0]&n[3],n[1]+=~n[0]&n[2],n[1]=s(n[1],2),a+=1,n[2]+=this.k[a],n[2]+=n[1]&n[0],n[2]+=~n[1]&n[3],n[2]=s(n[2],3),a+=1,n[3]+=this.k[a],n[3]+=n[2]&n[1],n[3]+=~n[2]&n[0],n[3]=s(n[3],5),a+=1;f(t,n[0],e+0),f(t,n[1],e+2),f(t,n[2],e+4),f(t,n[3],e+6)}decrypt(t,e,r,i){const n=this.r;n[0]=o(r,i+0),n[1]=o(r,i+2),n[2]=o(r,i+4),n[3]=o(r,i+6);let a=63;for(;a>=44;)n[3]=s(n[3],11),n[3]-=this.k[a],n[3]-=n[2]&n[1],n[3]-=~n[2]&n[0],a-=1,n[2]=s(n[2],13),n[2]-=this.k[a],n[2]-=n[1]&n[0],n[2]-=~n[1]&n[3],a-=1,n[1]=s(n[1],14),n[1]-=this.k[a],n[1]-=n[0]&n[3],n[1]-=~n[0]&n[2],a-=1,n[0]=s(n[0],15),n[0]-=this.k[a],n[0]-=n[3]&n[2],n[0]-=~n[3]&n[1],a-=1;for(n[3]-=this.k[63&n[2]],n[2]-=this.k[63&n[1]],n[1]-=this.k[63&n[0]],n[0]-=this.k[63&n[3]];a>=20;)n[3]=s(n[3],11),n[3]-=this.k[a],n[3]-=n[2]&n[1],n[3]-=~n[2]&n[0],a-=1,n[2]=s(n[2],13),n[2]-=this.k[a],n[2]-=n[1]&n[0],n[2]-=~n[1]&n[3],a-=1,n[1]=s(n[1],14),n[1]-=this.k[a],n[1]-=n[0]&n[3],n[1]-=~n[0]&n[2],a-=1,n[0]=s(n[0],15),n[0]-=this.k[a],n[0]-=n[3]&n[2],n[0]-=~n[3]&n[1],a-=1;for(n[3]-=this.k[63&n[2]],n[2]-=this.k[63&n[1]],n[1]-=this.k[63&n[0]],n[0]-=this.k[63&n[3]];a>=0;)n[3]=s(n[3],11),n[3]-=this.k[a],n[3]-=n[2]&n[1],n[3]-=~n[2]&n[0],a-=1,n[2]=s(n[2],13),n[2]-=this.k[a],n[2]-=n[1]&n[0],n[2]-=~n[1]&n[3],a-=1,n[1]=s(n[1],14),n[1]-=this.k[a],n[1]-=n[0]&n[3],n[1]-=~n[0]&n[2],a-=1,n[0]=s(n[0],15),n[0]-=this.k[a],n[0]-=n[3]&n[2],n[0]-=~n[3]&n[1],a-=1;f(t,n[0],e+0),f(t,n[1],e+2),f(t,n[2],e+4),f(t,n[3],e+6)}destroy(){for(let t=0;t<64;t++)this.k[t]=0;for(let t=0;t<4;t++)this.r[t]=0;return this}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * camellia.js - camellia128/192/256 for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on aead/camellia:
 *   Copyright (c) 2016, Andreas Auernhammer (MIT License).
 *   https://github.com/aead/camellia
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Camellia_(cipher)
 *   https://tools.ietf.org/html/rfc3713
 *   https://github.com/aead/camellia/blob/master/camellia.go
 */
const i=r(1),n=new Uint32Array([2694735487,1003262091,3061508184,1286239154,3337565999,3914302142,1426019237,4057165596,283453434,3731369245,2958461122,3018244605]),s=new Uint32Array([1886416896,2189591040,741092352,3974949888,3014898432,656877312,3233857536,3857048832,3840205824,2240120064,1465341696,892679424,3941263872,202116096,2930683392,1094795520,589505280,4025478912,1802201856,2475922176,1162167552,421075200,2779096320,555819264,3991792896,235802112,1330597632,1313754624,488447232,1701143808,2459079168,3183328512,2256963072,3099113472,2947526400,2408550144,2088532992,3958106880,522133248,3469659648,1044266496,808464384,3705461760,1600085760,1583242752,3318072576,185273088,437918208,2795939328,3789676800,960051456,3402287616,3587560704,1195853568,1566399744,1027423488,3654932736,16843008,1515870720,3604403712,1364283648,1448498688,1819044864,1296911616,2341178112,218959104,2593823232,1717986816,4227595008,3435973632,2964369408,757935360,1953788928,303174144,724249344,538976256,4042321920,2981212416,2223277056,2576980224,3755990784,1280068608,3419130624,3267543552,875836416,2122219008,1987474944,84215040,1835887872,3082270464,2846468352,825307392,3520188672,387389184,67372032,3621246720,336860160,1482184704,976894464,1633771776,3739147776,454761216,286331136,471604224,842150400,252645120,2627509248,370546176,1397969664,404232192,4076007936,572662272,4278124032,1145324544,3486502656,2998055424,3284386560,3048584448,2054846976,2442236160,606348288,134744064,3907577856,2829625344,1616928768,4244438016,1768515840,1347440640,2863311360,3503345664,2694881280,2105376e3,2711724288,2307492096,1650614784,2543294208,1414812672,1532713728,505290240,2509608192,3772833792,4294967040,1684300800,3537031680,269488128,3301229568,0,1212696576,2745410304,4160222976,1970631936,3688618752,2324335104,50529024,3873891840,3671775744,151587072,1061109504,3722304768,2492765184,2273806080,1549556736,2206434048,33686016,3452816640,1246382592,2425393152,858993408,1936945920,1734829824,4143379968,4092850944,2644352256,2139062016,3217014528,3806519808,1381126656,2610666240,3638089728,640034304,3368601600,926365440,3334915584,993737472,2172748032,2526451200,1869573888,1263225600,320017152,3200171520,1667457792,774778368,3924420864,2038003968,2812782336,2358021120,2678038272,1852730880,3166485504,2391707136,690563328,4126536960,4193908992,3065427456,791621376,4261281024,3031741440,1499027712,2021160960,2560137216,101058048,1785358848,3890734848,1179010560,1903259904,3132799488,3570717696,623191296,2880154368,1111638528,2290649088,2728567296,2374864128,4210752e3,1920102912,117901056,3115956480,1431655680,4177065984,4008635904,2896997376,168430080,909522432,1229539584,707406336,1751672832,1010580480,943208448,4059164928,2762253312,1077952512,673720320,3553874688,2071689984,3149642496,3385444608,1128481536,3250700544,353703168,3823362816,2913840384,4109693952,2004317952,3351758592,2155905024,2661195264]),o=new Uint32Array([14737632,328965,5789784,14277081,6776679,5131854,8487297,13355979,13224393,723723,11447982,6974058,14013909,1579032,6118749,8553090,4605510,14671839,14079702,2565927,9079434,3289650,4934475,4342338,14408667,1842204,10395294,10263708,3815994,13290186,2434341,8092539,855309,7434609,6250335,2039583,16316664,14145495,4079166,10329501,8158332,6316128,12171705,12500670,12369084,9145227,1447446,3421236,5066061,12829635,7500402,9803157,11250603,9342606,12237498,8026746,11776947,131586,11842740,11382189,10658466,11316396,14211288,10132122,1513239,1710618,3487029,13421772,16250871,10066329,6381921,5921370,15263976,2368548,5658198,4210752,14803425,6513507,592137,3355443,12566463,10000536,9934743,8750469,6842472,16579836,15527148,657930,14342874,7303023,5460819,6447714,10724259,3026478,526344,11513775,2631720,11579568,7631988,12763842,12434877,3552822,2236962,3684408,6579300,1973790,3750201,2894892,10921638,3158064,15066597,4473924,16645629,8947848,10461087,6645093,8882055,7039851,16053492,2302755,4737096,1052688,13750737,5329233,12632256,16382457,13816530,10526880,5592405,10592673,4276545,16448250,4408131,1250067,12895428,3092271,11053224,11974326,3947580,2829099,12698049,16777215,13158600,10855845,2105376,9013641,0,9474192,4671303,15724527,15395562,12040119,1381653,394758,13487565,11908533,1184274,8289918,12303291,2697513,986895,12105912,460551,263172,10197915,9737364,2171169,6710886,15132390,13553358,15592941,15198183,3881787,16711422,8355711,12961221,10790052,3618615,11645361,5000268,9539985,7237230,9276813,7763574,197379,2960685,14606046,9868950,2500134,8224125,13027014,6052956,13882323,15921906,5197647,1644825,4144959,14474460,7960953,1907997,5395026,15461355,15987699,7171437,6184542,16514043,6908265,11711154,15790320,3223857,789516,13948116,13619151,9211020,14869218,7697781,11119017,4868682,5723991,8684676,1118481,4539717,1776411,16119285,15000804,921102,7566195,11184810,15856113,14540253,5855577,1315860,7105644,9605778,5526612,13684944,7895160,7368816,14935011,4802889,8421504,5263440,10987431,16185078,7829367,9671571,8816262,8618883,2763306,13092807,5987163,15329769,15658734,9408399,65793,4013373]),f=new Uint32Array([939538488,1090535745,369104406,1979741814,3640711641,2466288531,1610637408,4060148466,1912631922,3254829762,2868947883,2583730842,1962964341,100664838,1459640151,2684395680,2432733585,4144035831,3036722613,3372272073,2717950626,2348846220,3523269330,2415956112,4127258358,117442311,2801837991,654321447,2382401166,2986390194,1224755529,3724599006,1124090691,1543527516,3607156695,3338717127,1040203326,4110480885,2399178639,1728079719,520101663,402659352,1845522030,2936057775,788541231,3791708898,2231403909,218107149,1392530259,4026593520,2617285788,1694524773,3925928682,2734728099,2919280302,2650840734,3959483628,2147516544,754986285,1795189611,2818615464,721431339,905983542,2785060518,3305162181,2248181382,1291865421,855651123,4244700669,1711302246,1476417624,2516620950,973093434,150997257,2499843477,268439568,2013296760,3623934168,1107313218,3422604492,4009816047,637543974,3842041317,1627414881,436214298,1056980799,989870907,2181071490,3053500086,3674266587,3556824276,2550175896,3892373736,2332068747,33554946,3942706155,167774730,738208812,486546717,2952835248,1862299503,2365623693,2281736328,234884622,419436825,2264958855,1308642894,184552203,2835392937,201329676,2030074233,285217041,2130739071,570434082,3875596263,1493195097,3774931425,3657489114,1023425853,3355494600,301994514,67109892,1946186868,1409307732,805318704,2113961598,3019945140,671098920,1426085205,1744857192,1342197840,3187719870,3489714384,3288384708,822096177,3405827019,704653866,2902502829,251662095,3389049546,1879076976,4278255615,838873650,1761634665,134219784,1644192354,0,603989028,3506491857,4211145723,3120609978,3976261101,1157645637,2164294017,1929409395,1828744557,2214626436,2667618207,3993038574,1241533002,3271607235,771763758,3238052289,16777473,3858818790,620766501,1207978056,2566953369,3103832505,3003167667,2063629179,4177590777,3456159438,3204497343,3741376479,1895854449,687876393,3439381965,1811967084,318771987,1677747300,2600508315,1660969827,2634063261,3221274816,1258310475,3070277559,2768283045,2298513801,1593859935,2969612721,385881879,4093703412,3154164924,3540046803,1174423110,3472936911,922761015,1577082462,1191200583,2483066004,4194368250,4227923196,1526750043,2533398423,4261478142,1509972570,2885725356,1006648380,1275087948,50332419,889206069,4076925939,587211555,3087055032,1560304989,1778412138,2449511058,3573601749,553656609,1140868164,1358975313,3321939654,2097184125,956315961,2197848963,3691044060,2852170410,2080406652,1996519287,1442862678,83887365,452991771,2751505572,352326933,872428596,503324190,469769244,4160813304,1375752786,536879136,335549460,3909151209,3170942397,3707821533,3825263844,2701173153,3758153952,2315291274,4043370993,3590379222,2046851706,3137387451,3808486371,1073758272,1325420367]),a=new Uint32Array([1886388336,741081132,3014852787,3233808576,3840147684,1465319511,3941204202,2930639022,589496355,1802174571,1162149957,2779054245,3991732461,1330577487,488439837,2459041938,2256928902,2947481775,2088501372,522125343,1044250686,3705405660,1583218782,185270283,2795896998,960036921,3587506389,1566376029,3654877401,1515847770,1364262993,1819017324,2341142667,2593783962,4227531003,2964324528,1953759348,724238379,4042260720,2223243396,3755933919,3419078859,875823156,1987444854,1835860077,2846425257,3520135377,67371012,336855060,976879674,3739091166,286326801,842137650,2627469468,1397948499,4075946226,4278059262,3486449871,3284336835,2054815866,606339108,3907518696,1616904288,1768489065,2863268010,2694840480,2711683233,1650589794,1414791252,505282590,3772776672,1684275300,269484048,0,2745368739,1970602101,2324299914,3873833190,151584777,3722248413,2273771655,2206400643,3452764365,2425356432,1936916595,4143317238,2644312221,3216965823,1381105746,3638034648,3368550600,3334865094,2172715137,1869545583,320012307,1667432547,3924361449,2812739751,2677997727,3166437564,690552873,4193845497,791609391,3031695540,2021130360,101056518,3890675943,1903231089,3570663636,2880110763,2290614408,2374828173,1920073842,3115909305,4177002744,2896953516,909508662,707395626,1010565180,4059103473,1077936192,3553820883,3149594811,1128464451,353697813,2913796269,2004287607,2155872384,2189557890,3974889708,656867367,3856990437,2240086149,892665909,202113036,1094778945,4025417967,2475884691,421068825,555810849,235798542,1313734734,1701118053,3183280317,3099066552,2408513679,3958046955,3469607118,808452144,1600061535,3318022341,437911578,3789619425,3402236106,1195835463,1027407933,16842753,3604349142,1448476758,1296891981,218955789,1717960806,3435921612,757923885,303169554,538968096,2981167281,2576941209,1280049228,3267494082,2122186878,84213765,3082223799,825294897,387383319,3621191895,1482162264,1633747041,454754331,471597084,252641295,370540566,404226072,572653602,1145307204,2998010034,3048538293,2442199185,134742024,2829582504,4244373756,1347420240,3503292624,2105344125,2307457161,2543255703,1532690523,2509570197,4294902015,3536978130,3301179588,1212678216,4160159991,3688562907,50528259,3671720154,1061093439,2492727444,1549533276,33685506,1246363722,858980403,1734803559,4092788979,2139029631,3806462178,2610626715,640024614,926351415,993722427,2526412950,1263206475,3200123070,774766638,2037973113,2357985420,1852702830,2391670926,4126474485,3065381046,4261216509,1499005017,2560098456,1785331818,1178992710,3132752058,623181861,1111621698,2728525986,4210688250,117899271,1431634005,4008575214,168427530,1229520969,1751646312,943194168,2762211492,673710120,2071658619,3385393353,3250651329,3823304931,4109631732,3351707847,2661154974]);class c{constructor(){this.key=new Uint32Array(52),this.block=new Uint32Array(4)}get blockSize(){return 16}init(t){return i(e.isBuffer(t)),i(16===t.length),this.keySchedule(t),this}keySchedule(t){const e=this.block,r=this.key;return e[0]=m(t,0),e[1]=m(t,4),e[2]=m(t,8),e[3]=m(t,12),b(r,0,1,2,3,e,0,1,2,3),u(e,0,1,2,3,n[0],n[1]),u(e,2,3,0,1,n[2],n[3]),p(e,0,1,2,3,r,0,1,2,3),u(e,0,1,2,3,n[4],n[5]),u(e,2,3,0,1,n[6],n[7]),b(r,4,5,6,7,e,0,1,2,3),d(e,0,1,2,3,15),b(r,12,13,14,15,e,0,1,2,3),d(e,0,1,2,3,15),b(r,16,17,18,19,e,0,1,2,3),d(e,0,1,2,3,15),l(r,24,25,e,0,1),d(e,0,1,2,3,15),b(r,28,29,30,31,e,0,1,2,3),d(e,1,2,3,0,2),b(r,40,41,42,43,e,1,2,3,0),d(e,1,2,3,0,17),b(r,48,49,50,51,e,1,2,3,0),b(e,0,1,2,3,r,0,1,2,3),d(e,0,1,2,3,15),b(r,8,9,10,11,e,0,1,2,3),d(e,0,1,2,3,30),b(r,20,21,22,23,e,0,1,2,3),d(e,0,1,2,3,15),l(r,26,27,e,2,3),d(e,0,1,2,3,17),b(r,32,33,34,35,e,0,1,2,3),d(e,0,1,2,3,17),b(r,36,37,38,39,e,0,1,2,3),d(e,0,1,2,3,17),b(r,44,45,46,47,e,0,1,2,3),this}encrypt(t,e,r,i){const n=this.block,s=this.key;n[0]=m(r,i+0),n[1]=m(r,i+4),n[2]=m(r,i+8),n[3]=m(r,i+12),p(n,0,1,2,3,s,0,1,2,3),u(n,0,1,2,3,s[4],s[5]),u(n,2,3,0,1,s[6],s[7]),u(n,0,1,2,3,s[8],s[9]),u(n,2,3,0,1,s[10],s[11]),u(n,0,1,2,3,s[12],s[13]),u(n,2,3,0,1,s[14],s[15]);let o=n[0]&s[16];n[1]^=o<<1|o>>>31,n[2]^=n[3]|s[19],n[0]^=n[1]|s[17],o=n[2]&s[18],n[3]^=o<<1|o>>>31,u(n,0,1,2,3,s[20],s[21]),u(n,2,3,0,1,s[22],s[23]),u(n,0,1,2,3,s[24],s[25]),u(n,2,3,0,1,s[26],s[27]),u(n,0,1,2,3,s[28],s[29]),u(n,2,3,0,1,s[30],s[31]),o=n[0]&s[32],n[1]^=o<<1|o>>>31,n[2]^=n[3]|s[35],n[0]^=n[1]|s[33],o=n[2]&s[34],n[3]^=o<<1|o>>>31,u(n,0,1,2,3,s[36],s[37]),u(n,2,3,0,1,s[38],s[39]),u(n,0,1,2,3,s[40],s[41]),u(n,2,3,0,1,s[42],s[43]),u(n,0,1,2,3,s[44],s[45]),u(n,2,3,0,1,s[46],s[47]),p(n,2,3,0,1,s,48,49,50,51),g(t,n[2],e+0),g(t,n[3],e+4),g(t,n[0],e+8),g(t,n[1],e+12)}decrypt(t,e,r,i){const n=this.block,s=this.key;n[0]=m(r,i+0),n[1]=m(r,i+4),n[2]=m(r,i+8),n[3]=m(r,i+12),p(n,3,2,1,0,s,51,50,49,48),u(n,0,1,2,3,s[46],s[47]),u(n,2,3,0,1,s[44],s[45]),u(n,0,1,2,3,s[42],s[43]),u(n,2,3,0,1,s[40],s[41]),u(n,0,1,2,3,s[38],s[39]),u(n,2,3,0,1,s[36],s[37]);let o=n[0]&s[34];return n[1]^=o<<1|o>>>31,n[2]^=n[3]|s[33],n[0]^=n[1]|s[35],o=n[2]&s[32],n[3]^=o<<1|o>>>31,u(n,0,1,2,3,s[30],s[31]),u(n,2,3,0,1,s[28],s[29]),u(n,0,1,2,3,s[26],s[27]),u(n,2,3,0,1,s[24],s[25]),u(n,0,1,2,3,s[22],s[23]),u(n,2,3,0,1,s[20],s[21]),o=n[0]&s[18],n[1]^=o<<1|o>>>31,n[2]^=n[3]|s[17],n[0]^=n[1]|s[19],o=n[2]&s[16],n[3]^=o<<1|o>>>31,u(n,0,1,2,3,s[14],s[15]),u(n,2,3,0,1,s[12],s[13]),u(n,0,1,2,3,s[10],s[11]),u(n,2,3,0,1,s[8],s[9]),u(n,0,1,2,3,s[6],s[7]),u(n,2,3,0,1,s[4],s[5]),p(n,1,0,3,2,s,3,2,1,0),g(t,n[2],e+0),g(t,n[3],e+4),g(t,n[0],e+8),g(t,n[1],e+12),this}destroy(){for(let t=0;t<52;t++)this.key[t]=0;for(let t=0;t<4;t++)this.block[t]=0;return this}}class h{constructor(){this.key=new Uint32Array(68),this.block=new Uint32Array(4)}get blockSize(){return 16}init(t){return i(e.isBuffer(t)),i(24===t.length||32===t.length),this.keySchedule(t),this}keySchedule(t){const e=this.block,r=this.key;return r[0]=m(t,0),r[1]=m(t,4),r[2]=m(t,8),r[3]=m(t,12),r[8]=m(t,16),r[9]=m(t,20),24===t.length?(r[10]=~r[8],r[11]=~r[9]):(r[10]=m(t,24),r[11]=m(t,28)),e[0]=r[8]^r[0],e[1]=r[9]^r[1],e[2]=r[10]^r[2],e[3]=r[11]^r[3],u(e,0,1,2,3,n[0],n[1]),u(e,2,3,0,1,n[2],n[3]),p(e,0,1,2,3,r,0,1,2,3),u(e,0,1,2,3,n[4],n[5]),u(e,2,3,0,1,n[6],n[7]),b(r,12,13,14,15,e,0,1,2,3),p(e,0,1,2,3,r,8,9,10,11),u(e,0,1,2,3,n[8],n[9]),u(e,2,3,0,1,n[10],n[11]),b(r,4,5,6,7,e,0,1,2,3),d(e,0,1,2,3,30),b(r,20,21,22,23,e,0,1,2,3),d(e,0,1,2,3,30),b(r,40,41,42,43,e,0,1,2,3),d(e,1,2,3,0,19),b(r,64,65,66,67,e,1,2,3,0),b(e,0,1,2,3,r,8,9,10,11),d(e,0,1,2,3,15),b(r,8,9,10,11,e,0,1,2,3),d(e,0,1,2,3,15),b(r,16,17,18,19,e,0,1,2,3),d(e,0,1,2,3,30),b(r,36,37,38,39,e,0,1,2,3),d(e,1,2,3,0,2),b(r,52,53,54,55,e,1,2,3,0),b(e,0,1,2,3,r,12,13,14,15),d(e,0,1,2,3,15),b(r,12,13,14,15,e,0,1,2,3),d(e,0,1,2,3,30),b(r,28,29,30,31,e,0,1,2,3),b(r,48,49,50,51,e,1,2,3,0),d(e,1,2,3,0,17),b(r,56,57,58,59,e,1,2,3,0),b(e,0,1,2,3,r,0,1,2,3),d(e,1,2,3,0,13),b(r,24,25,26,27,e,1,2,3,0),d(e,1,2,3,0,15),b(r,32,33,34,35,e,1,2,3,0),d(e,1,2,3,0,17),b(r,44,45,46,47,e,1,2,3,0),d(e,2,3,0,1,2),b(r,60,61,62,63,e,2,3,0,1),this}encrypt(t,e,r,i){const n=this.block,s=this.key;n[0]=m(r,i+0),n[1]=m(r,i+4),n[2]=m(r,i+8),n[3]=m(r,i+12),p(n,0,1,2,3,s,0,1,2,3),u(n,0,1,2,3,s[4],s[5]),u(n,2,3,0,1,s[6],s[7]),u(n,0,1,2,3,s[8],s[9]),u(n,2,3,0,1,s[10],s[11]),u(n,0,1,2,3,s[12],s[13]),u(n,2,3,0,1,s[14],s[15]);let o=n[0]&s[16];return n[1]^=o<<1|o>>>31,n[2]^=n[3]|s[19],n[0]^=n[1]|s[17],o=n[2]&s[18],n[3]^=o<<1|o>>>31,u(n,0,1,2,3,s[20],s[21]),u(n,2,3,0,1,s[22],s[23]),u(n,0,1,2,3,s[24],s[25]),u(n,2,3,0,1,s[26],s[27]),u(n,0,1,2,3,s[28],s[29]),u(n,2,3,0,1,s[30],s[31]),o=n[0]&s[32],n[1]^=o<<1|o>>>31,n[2]^=n[3]|s[35],n[0]^=n[1]|s[33],o=n[2]&s[34],n[3]^=o<<1|o>>>31,u(n,0,1,2,3,s[36],s[37]),u(n,2,3,0,1,s[38],s[39]),u(n,0,1,2,3,s[40],s[41]),u(n,2,3,0,1,s[42],s[43]),u(n,0,1,2,3,s[44],s[45]),u(n,2,3,0,1,s[46],s[47]),o=n[0]&s[48],n[1]^=o<<1|o>>>31,n[2]^=n[3]|s[51],n[0]^=n[1]|s[49],o=n[2]&s[50],n[3]^=o<<1|o>>>31,u(n,0,1,2,3,s[52],s[53]),u(n,2,3,0,1,s[54],s[55]),u(n,0,1,2,3,s[56],s[57]),u(n,2,3,0,1,s[58],s[59]),u(n,0,1,2,3,s[60],s[61]),u(n,2,3,0,1,s[62],s[63]),p(n,2,3,0,1,s,64,65,66,67),g(t,n[2],e+0),g(t,n[3],e+4),g(t,n[0],e+8),g(t,n[1],e+12),this}decrypt(t,e,r,i){const n=this.block,s=this.key;n[0]=m(r,i+0),n[1]=m(r,i+4),n[2]=m(r,i+8),n[3]=m(r,i+12),p(n,3,2,1,0,s,67,66,65,64),u(n,0,1,2,3,s[62],s[63]),u(n,2,3,0,1,s[60],s[61]),u(n,0,1,2,3,s[58],s[59]),u(n,2,3,0,1,s[56],s[57]),u(n,0,1,2,3,s[54],s[55]),u(n,2,3,0,1,s[52],s[53]);let o=n[0]&s[50];return n[1]^=o<<1|o>>>31,n[2]^=n[3]|s[49],n[0]^=n[1]|s[51],o=n[2]&s[48],n[3]^=o<<1|o>>>31,u(n,0,1,2,3,s[46],s[47]),u(n,2,3,0,1,s[44],s[45]),u(n,0,1,2,3,s[42],s[43]),u(n,2,3,0,1,s[40],s[41]),u(n,0,1,2,3,s[38],s[39]),u(n,2,3,0,1,s[36],s[37]),o=n[0]&s[34],n[1]^=o<<1|o>>>31,n[2]^=n[3]|s[33],n[0]^=n[1]|s[35],o=n[2]&s[32],n[3]^=o<<1|o>>>31,u(n,0,1,2,3,s[30],s[31]),u(n,2,3,0,1,s[28],s[29]),u(n,0,1,2,3,s[26],s[27]),u(n,2,3,0,1,s[24],s[25]),u(n,0,1,2,3,s[22],s[23]),u(n,2,3,0,1,s[20],s[21]),o=n[0]&s[18],n[1]^=o<<1|o>>>31,n[2]^=n[3]|s[17],n[0]^=n[1]|s[19],o=n[2]&s[16],n[3]^=o<<1|o>>>31,u(n,0,1,2,3,s[14],s[15]),u(n,2,3,0,1,s[12],s[13]),u(n,0,1,2,3,s[10],s[11]),u(n,2,3,0,1,s[8],s[9]),u(n,0,1,2,3,s[6],s[7]),u(n,2,3,0,1,s[4],s[5]),p(n,1,0,3,2,s,3,2,1,0),g(t,n[2],e+0),g(t,n[3],e+4),g(t,n[0],e+8),g(t,n[1],e+12),this}destroy(){for(let t=0;t<68;t++)this.key[t]=0;for(let t=0;t<4;t++)this.block[t]=0;return this}}function u(t,e,r,i,n,c,h){let u;c^=t[e],h^=t[r],u=a[c>>>0&255]^f[c>>>8&255]^o[c>>>16&255]^s[c>>>24&255],t[n]^=u>>>8|u<<24,u^=s[h>>>0&255]^a[h>>>8&255]^f[h>>>16&255]^o[h>>>24&255],t[i]^=u,t[n]^=u}function d(t,e,r,i,n,s){const o=t[e]>>>32-s;t[e]=t[e]<<s|t[r]>>>32-s,t[r]=t[r]<<s|t[i]>>>32-s,t[i]=t[i]<<s|t[n]>>>32-s,t[n]=t[n]<<s|o}function l(t,e,r,i,n,s){t[e]=i[n],t[r]=i[s]}function b(t,e,r,i,n,s,o,f,a,c){t[e]=s[o],t[r]=s[f],t[i]=s[a],t[n]=s[c]}function p(t,e,r,i,n,s,o,f,a,c){t[e]^=s[o],t[r]^=s[f],t[i]^=s[a],t[n]^=s[c]}function m(t,e){return 16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function g(t,e,r){return t[r++]=e>>>24,t[r++]=e>>>16,t[r++]=e>>>8,t[r++]=e>>>0,r}t.exports=class{constructor(t){switch(i(t>>>0===t),this.bits=t,this.ctx=null,t){case 128:this.ctx=new c;break;case 192:case 256:this.ctx=new h;break;default:throw new Error("Invalid key size.")}}get blockSize(){return this.ctx.blockSize}init(t){return i(e.isBuffer(t)),i(t.length===this.bits>>>3),this.ctx.init(t),this}encrypt(t,e,r,i){return this.ctx.encrypt(t,e,r,i),this}decrypt(t,e,r,i){return this.ctx.decrypt(t,e,r,i),this}destroy(){return this.ctx.destroy(),this}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * cast5.js - CAST5 for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009, The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/CAST-128
 *   https://tools.ietf.org/html/rfc2144
 *   https://github.com/golang/crypto/blob/master/cast5/cast5.go
 */
const i=r(1),n=[new Uint32Array([821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063]),new Uint32Array([522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321]),new Uint32Array([2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027]),new Uint32Array([2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730]),new Uint32Array([2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860]),new Uint32Array([4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975]),new Uint32Array([2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875]),new Uint32Array([3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926])],s=[{a:[new Uint8Array([4,0,13,15,12,14,8]),new Uint8Array([5,2,16,18,17,19,10]),new Uint8Array([6,3,23,22,21,20,9]),new Uint8Array([7,1,26,25,27,24,11])],b:[new Uint8Array([24,25,23,22,18]),new Uint8Array([26,27,21,20,22]),new Uint8Array([28,29,19,18,25]),new Uint8Array([30,31,17,16,28])]},{a:[new Uint8Array([0,6,21,23,20,22,16]),new Uint8Array([1,4,0,2,1,3,18]),new Uint8Array([2,5,7,6,5,4,17]),new Uint8Array([3,7,10,9,11,8,19])],b:[new Uint8Array([3,2,12,13,8]),new Uint8Array([1,0,14,15,13]),new Uint8Array([7,6,8,9,3]),new Uint8Array([5,4,10,11,7])]},{a:[new Uint8Array([4,0,13,15,12,14,8]),new Uint8Array([5,2,16,18,17,19,10]),new Uint8Array([6,3,23,22,21,20,9]),new Uint8Array([7,1,26,25,27,24,11])],b:[new Uint8Array([19,18,28,29,25]),new Uint8Array([17,16,30,31,28]),new Uint8Array([23,22,24,25,18]),new Uint8Array([21,20,26,27,22])]},{a:[new Uint8Array([0,6,21,23,20,22,16]),new Uint8Array([1,4,0,2,1,3,18]),new Uint8Array([2,5,7,6,5,4,17]),new Uint8Array([3,7,10,9,11,8,19])],b:[new Uint8Array([8,9,7,6,3]),new Uint8Array([10,11,5,4,7]),new Uint8Array([12,13,3,2,8]),new Uint8Array([14,15,1,0,13])]}],o=new Uint8Array([6,7,4,5]);function f(t,e,r){const i=e+t,s=i<<r|i>>>32-r;return(n[0][s>>>24&255]^n[1][s>>>16&255])-n[2][s>>>8&255]+n[3][s>>>0&255]}function a(t,e,r){const i=e^t,s=i<<r|i>>>32-r;return n[0][s>>>24&255]-n[1][s>>>16&255]+n[2][s>>>8&255]^n[3][s>>>0&255]}function c(t,e,r){const i=e-t,s=i<<r|i>>>32-r;return(n[0][s>>>24&255]+n[1][s>>>16&255]^n[2][s>>>8&255])-n[3][s>>>0&255]}function h(t,e){return 16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function u(t,e,r){return t[r++]=e>>>24,t[r++]=e>>>16,t[r++]=e>>>8,t[r++]=e,r}t.exports=class{constructor(){this.masking=new Uint32Array(16),this.rotate=new Uint8Array(16)}get blockSize(){return 8}init(t){return i(e.isBuffer(t)),i(16===t.length),this.keySchedule(t),this}destroy(){for(let t=0;t<16;t++)this.masking[t]=0;for(let t=0;t<16;t++)this.rotate[t]=0;return this}keySchedule(t){const e=new Uint32Array(8),r=new Uint32Array(32);for(let r=0;r<4;r++)e[r]=h(t,4*r);let i,f=0;for(let t=0;t<2;t++)for(const t of s){for(let r=0;r<4;r++){const s=t.a[r];i=e[s[1]]^n[4][e[s[2]>>>2]>>>24-8*(3&s[2])&255]^n[5][e[s[3]>>>2]>>>24-8*(3&s[3])&255]^n[6][e[s[4]>>>2]>>>24-8*(3&s[4])&255]^n[7][e[s[5]>>>2]>>>24-8*(3&s[5])&255],i^=n[o[r]][e[s[6]>>>2]>>>24-8*(3&s[6])&255],e[s[0]]=i}for(let s=0;s<4;s++){const o=t.b[s];i=n[4][e[o[0]>>>2]>>>24-8*(3&o[0])&255]^n[5][e[o[1]>>>2]>>>24-8*(3&o[1])&255]^n[6][e[o[2]>>>2]>>>24-8*(3&o[2])&255]^n[7][e[o[3]>>>2]>>>24-8*(3&o[3])&255],i^=n[4+s][e[o[4]>>>2]>>>24-8*(3&o[4])&255],r[f]=i,f+=1}}for(let t=0;t<16;t++)this.masking[t]=r[t],this.rotate[t]=31&r[16+t];return this}encrypt(t,e,r,i){let n=h(r,i),s=h(r,i+4);return[n,s]=[s,n^f(s,this.masking[0],this.rotate[0])],[n,s]=[s,n^a(s,this.masking[1],this.rotate[1])],[n,s]=[s,n^c(s,this.masking[2],this.rotate[2])],[n,s]=[s,n^f(s,this.masking[3],this.rotate[3])],[n,s]=[s,n^a(s,this.masking[4],this.rotate[4])],[n,s]=[s,n^c(s,this.masking[5],this.rotate[5])],[n,s]=[s,n^f(s,this.masking[6],this.rotate[6])],[n,s]=[s,n^a(s,this.masking[7],this.rotate[7])],[n,s]=[s,n^c(s,this.masking[8],this.rotate[8])],[n,s]=[s,n^f(s,this.masking[9],this.rotate[9])],[n,s]=[s,n^a(s,this.masking[10],this.rotate[10])],[n,s]=[s,n^c(s,this.masking[11],this.rotate[11])],[n,s]=[s,n^f(s,this.masking[12],this.rotate[12])],[n,s]=[s,n^a(s,this.masking[13],this.rotate[13])],[n,s]=[s,n^c(s,this.masking[14],this.rotate[14])],[n,s]=[s,n^f(s,this.masking[15],this.rotate[15])],u(t,s,e),u(t,n,e+4),this}decrypt(t,e,r,i){let n=h(r,i),s=h(r,i+4);return[n,s]=[s,n^f(s,this.masking[15],this.rotate[15])],[n,s]=[s,n^c(s,this.masking[14],this.rotate[14])],[n,s]=[s,n^a(s,this.masking[13],this.rotate[13])],[n,s]=[s,n^f(s,this.masking[12],this.rotate[12])],[n,s]=[s,n^c(s,this.masking[11],this.rotate[11])],[n,s]=[s,n^a(s,this.masking[10],this.rotate[10])],[n,s]=[s,n^f(s,this.masking[9],this.rotate[9])],[n,s]=[s,n^c(s,this.masking[8],this.rotate[8])],[n,s]=[s,n^a(s,this.masking[7],this.rotate[7])],[n,s]=[s,n^f(s,this.masking[6],this.rotate[6])],[n,s]=[s,n^c(s,this.masking[5],this.rotate[5])],[n,s]=[s,n^a(s,this.masking[4],this.rotate[4])],[n,s]=[s,n^f(s,this.masking[3],this.rotate[3])],[n,s]=[s,n^c(s,this.masking[2],this.rotate[2])],[n,s]=[s,n^a(s,this.masking[1],this.rotate[1])],[n,s]=[s,n^f(s,this.masking[0],this.rotate[0])],u(t,s,e),u(t,n,e+4),this}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * des.js - DES for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/des.js:
 *   Copyright (c) 2015, Fedor Indutny (MIT License).
 *   https://github.com/indutny/des.js
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Data_Encryption_Standard
 *   https://github.com/indutny/des.js/tree/master/lib/des
 */
const i=r(1),n=new Uint8Array([14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24]),s=new Uint8Array([14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11]),o=new Uint8Array([16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7]),f=new Uint8Array([1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1]);class a{constructor(){this.block=new Uint32Array(2),this.keys=new Uint32Array(32)}get blockSize(){return 8}init(e){return i(t.isBuffer(e)),i(8===e.length),this.derive(e)}encrypt(t,e,r,i){return this.crypt(t,e,r,i,!0)}decrypt(t,e,r,i){return this.crypt(t,e,r,i,!1)}destroy(){for(let t=0;t<2;t++)this.block[t]=0;for(let t=0;t<32;t++)this.keys[t]=0;return this}derive(t){let e=p(t,0),r=p(t,4);!function(t,e,r,i){let n=0,s=0;for(let r=7;r>=5;r--){for(let t=0;t<=24;t+=8)n<<=1,n|=e>>t+r&1;for(let e=0;e<=24;e+=8)n<<=1,n|=t>>e+r&1}for(let t=0;t<=24;t+=8)n<<=1,n|=e>>t+4&1;for(let r=1;r<=3;r++){for(let t=0;t<=24;t+=8)s<<=1,s|=e>>t+r&1;for(let e=0;e<=24;e+=8)s<<=1,s|=t>>e+r&1}for(let e=0;e<=24;e+=8)s<<=1,s|=t>>e+4&1;r[i+0]=n>>>0,r[i+1]=s>>>0}(e,r,this.block,0),e=this.block[0],r=this.block[1];for(let t=0;t<32;t+=2){const i=f[t>>>1];e=h(e,i),r=h(r,i),u(e,r,this.keys,t)}return this}crypt(t,e,r,i,n){let s=p(r,i),o=p(r,i+4);return function(t,e,r,i){let n=0,s=0;for(let r=6;r>=0;r-=2){for(let t=0;t<=24;t+=8)n<<=1,n|=e>>>t+r&1;for(let e=0;e<=24;e+=8)n<<=1,n|=t>>>e+r&1}for(let r=6;r>=0;r-=2){for(let t=1;t<=25;t+=8)s<<=1,s|=e>>>t+r&1;for(let e=1;e<=25;e+=8)s<<=1,s|=t>>>e+r&1}r[i+0]=n>>>0,r[i+1]=s>>>0}(s,o,this.block,0),s=this.block[0],o=this.block[1],n?this.encipher(s,o,this.block,0):this.decipher(s,o,this.block,0),s=this.block[0],o=this.block[1],m(t,s,e),m(t,o,e+4),this}encipher(t,e,r,i){let n=t,s=e;for(let t=0;t<32;t+=2){let e=this.keys[t],r=this.keys[t+1];d(s,this.block,0),e^=this.block[0],r^=this.block[1];const i=s;s=(n^b(l(e,r)))>>>0,n=i}return c(s,n,r,i),this}decipher(t,e,r,i){let n=e,s=t;for(let t=30;t>=0;t-=2){let e=this.keys[t],r=this.keys[t+1];d(n,this.block,0),e^=this.block[0],r^=this.block[1];const i=n;n=(s^b(l(e,r)))>>>0,s=i}return c(n,s,r,i),this}}function c(t,e,r,i){let n=0,s=0;for(let r=0;r<4;r++)for(let i=24;i>=0;i-=8)n<<=1,n|=e>>>i+r&1,n<<=1,n|=t>>>i+r&1;for(let r=4;r<8;r++)for(let i=24;i>=0;i-=8)s<<=1,s|=e>>>i+r&1,s<<=1,s|=t>>>i+r&1;r[i+0]=n>>>0,r[i+1]=s>>>0}function h(t,e){return t<<e&268435455|t>>>28-e}function u(t,e,r,i){let s=0,o=0,f=0;for(;f<24;f++)s<<=1,s|=t>>>n[f]&1;for(;f<48;f++)o<<=1,o|=e>>>n[f]&1;r[i+0]=s>>>0,r[i+1]=o>>>0}function d(t,e,r){let i=0,n=0;i=(1&t)<<5|t>>>27;for(let e=23;e>=15;e-=4)i<<=6,i|=t>>>e&63;for(let e=11;e>=3;e-=4)n|=t>>>e&63,n<<=6;n|=(31&t)<<1|t>>>31,e[r+0]=i>>>0,e[r+1]=n>>>0}function l(t,e){let r=0;for(let e=0;e<4;e++){r=r<<4|s[64*e+(t>>>18-6*e&63)]}for(let t=0;t<4;t++){r=r<<4|s[256+64*t+(e>>>18-6*t&63)]}return r>>>0}function b(t){let e=0;for(let r=0;r<32;r++)e<<=1,e|=t>>>o[r]&1;return e>>>0}function p(t,e){return 16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function m(t,e,r){return t[r++]=e>>>24,t[r++]=e>>>16,t[r++]=e>>>8,t[r++]=e,r}e.DES=a,e.EDE=class{constructor(){this.x=new a,this.y=new a}get blockSize(){return 8}init(e){i(t.isBuffer(e)),i(16===e.length);const r=e.slice(0,8),n=e.slice(8,16);return this.x.init(r),this.y.init(n),this}encrypt(t,e,r,i){return this.x.encrypt(t,e,r,i),this.y.decrypt(t,e,t,e),this.x.encrypt(t,e,t,e),this}decrypt(t,e,r,i){return this.x.decrypt(t,e,r,i),this.y.encrypt(t,e,t,e),this.x.decrypt(t,e,t,e),this}destroy(){return this.x.destroy(),this.y.destroy(),this}},e.EDE3=class{constructor(){this.x=new a,this.y=new a,this.z=new a}get blockSize(){return 8}init(e){i(t.isBuffer(e)),i(24===e.length);const r=e.slice(0,8),n=e.slice(8,16),s=e.slice(16,24);return this.x.init(r),this.y.init(n),this.z.init(s),this}encrypt(t,e,r,i){return this.x.encrypt(t,e,r,i),this.y.decrypt(t,e,t,e),this.z.encrypt(t,e,t,e),this}decrypt(t,e,r,i){return this.z.decrypt(t,e,r,i),this.y.encrypt(t,e,t,e),this.x.decrypt(t,e,t,e),this}destroy(){return this.x.destroy(),this.y.destroy(),this.z.destroy(),this}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * idea.js - IDEA for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on dgryski/go-idea:
 *   Copyright (c) 2013-2017, Damian Gryski. All rights reserved.
 *   https://github.com/dgryski/go-idea
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/International_Data_Encryption_Algorithm
 *   https://github.com/dgryski/go-idea/blob/master/idea.go
 */
const i=r(1),n=e.alloc(16,0);function s(t){if((t&=65535)<=1)return t;let e=65537/t&65535,r=65537%t;if(1===r)return 1-e&65535;let i=1,n=0;for(;1!==r;){if(n=t/r&65535,i+=n*e,i&=65535,1===(t%=r))return i;n=r/t&65535,r%=t,e+=n*i,e&=65535}return 1-e&65535}function o(t,e){if(t&=65535,0===(e&=65535))return 1-t&65535;if(0===t)return 1-e&65535;const r=t*e>>>0;return(t=65535&r)<(e=r>>>16)?t-e+1&65535:t-e&65535}function f(t,e){return 256*t[e++]+t[e]}function a(t,e,r){return t[r++]=e>>>8,t[r++]=e,r}t.exports=class{constructor(){this.key=n,this.encryptKey=null,this.decryptKey=null}get blockSize(){return 8}init(t){return i(e.isBuffer(t)),i(16===t.length),this.destroy(),this.key=e.from(t),this}getEncryptKey(){return this.encryptKey||(this.encryptKey=this.expandKey(this.key)),this.encryptKey}getDecryptKey(){return this.decryptKey||(this.decryptKey=this.invertKey(this.getEncryptKey())),this.decryptKey}encrypt(t,e,r,i){const n=this.getEncryptKey();return this.crypt(t,e,r,i,n)}decrypt(t,e,r,i){const n=this.getDecryptKey();return this.crypt(t,e,r,i,n)}destroy(){for(let t=0;t<16;t++)this.key[t]=0;if(this.encryptKey)for(let t=0;t<52;t++)this.encryptKey[t]=0;if(this.decryptKey)for(let t=0;t<52;t++)this.decryptKey[t]=0;return this.key=n,this.encryptKey=null,this.decryptKey=null,this}expandKey(t){const e=new Uint16Array(52);let r=0,i=0,n=0;for(;i<8;i++)e[i]=f(t,2*i);for(;i<52;i++)n+=1,e[r+(n+7)]=e[r+(n+0&7)]<<9|e[r+(n+1&7)]>>>7,r+=8&n,n&=7;return e}invertKey(t){const e=new Uint16Array(52);let r,i,n,o=51,f=0;r=s(t[f++]),i=-t[f++],n=-t[f++],e[o--]=s(t[f++]),e[o--]=n,e[o--]=i,e[o--]=r;for(let a=0;a<7;a++)r=t[f++],e[o--]=t[f++],e[o--]=r,r=s(t[f++]),i=-t[f++],n=-t[f++],e[o--]=s(t[f++]),e[o--]=i,e[o--]=n,e[o--]=r;return r=t[f++],e[o--]=t[f++],e[o--]=r,r=s(t[f++]),i=-t[f++],n=-t[f++],e[o--]=s(t[f++]),e[o--]=n,e[o--]=i,e[o--]=r,e}crypt(t,e,r,i,n){let s=f(r,i+0),c=f(r,i+2),h=f(r,i+4),u=f(r,i+6),d=0,l=0,b=0;for(let t=7;t>=0;t--)s=o(s,n[b++]),c+=n[b++],h+=n[b++],u=o(u,n[b++]),l=h,h^=s,h=o(h,n[b++]),d=c,c^=u,c+=h,c=o(c,n[b++]),h+=c,s^=c,u^=h,c^=l,h^=d;s=o(s,n[b++]),h+=n[b++],c+=n[b++],u=o(u,n[b++]),a(t,s,e+0),a(t,h,e+2),a(t,c,e+4),a(t,u,e+6)}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * serpent.js - serpent128/192/256 for bcrypto
 * Copyright (c) 2020, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on aead/serpent:
 *   Copyright (c) 2016, Andreas Auernhammer (MIT License).
 *   https://github.com/aead/serpent
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Serpent_(cipher)
 *   https://www.cl.cam.ac.uk/~rja14/serpent.html
 *   https://github.com/aead/serpent
 */
const i=r(1);function n(t,e,r,i,n,s){t[0]^=e[r],t[1]^=e[i],t[2]^=e[n],t[3]^=e[s]}function s(t,e,r,i,n){let s=t[e]<<13|t[e]>>>19,o=t[i]<<3|t[i]>>>29;const f=t[r]^s^o,a=t[n]^o^s<<3;t[r]=f<<1|f>>>31,t[n]=a<<7|a>>>25,s^=t[r]^t[n],o^=t[n]^t[r]<<7,t[e]=s<<5|s>>>27,t[i]=o<<22|o>>>10}function o(t,e,r,i,n){let s=t[i]>>>22|t[i]<<10,o=t[e]>>>5|t[e]<<27;s^=t[n]^t[r]<<7,o^=t[r]^t[n];const f=t[n]>>>7|t[n]<<25,a=t[r]>>>1|t[r]<<31;t[n]=f^s^o<<3,t[r]=a^o^s,t[i]=s>>>3|s<<29,t[e]=o>>>13|o<<19}function f(t,e,r,i,n){const s=t[e]^t[n],o=t[i]^s,f=t[r]^o;t[n]=t[e]&t[n]^f;const a=t[e]^t[r]&s;t[i]=f^(t[i]|a);const c=t[n]&(o^a);t[r]=~o^c,t[e]=c^~a}function a(t,e,r,i,n){const s=~t[e],o=t[e]^t[r],f=t[n]^(s|o),a=t[i]^f;t[i]=o^a;const c=s^t[n]&o;t[r]=f^t[i]&c,t[n]=t[e]&f^(a|t[r]),t[e]=t[n]^a^c}function c(t,e,r,i,n){const s=t[r]^~t[e],o=t[i]^(t[e]|s);t[i]=t[n]^o;const f=t[r]^(t[n]|s),a=s^t[i];t[n]=a^o&f;const c=o^f;t[r]=t[n]^c,t[e]=o^a&c}function h(t,e,r,i,n){const s=t[r]^t[n],o=t[e]^t[r]&s,f=s^o;t[n]=t[i]^f;const a=t[r]^s&o,c=t[n]|a;t[r]=o^c;const h=~t[r],u=t[n]^a;t[e]=h^u,t[i]=f^(h|u)}function u(t,e,r,i,n){const s=t[e],o=t[n],f=~s,a=t[r]^o,c=t[i]&f;t[e]=a^c;const h=t[i]^f,u=t[i]^t[e],d=t[r]&u;t[n]=h^d,t[i]=s^(o|d)&(t[e]|h),t[r]=a^t[n]^t[i]^(o|f)}function d(t,e,r,i,n){const s=t[e],o=t[n],f=t[r]^o,a=~f,c=s^t[i],h=t[i]^f,u=t[r]&h;t[e]=c^u;const d=c|o^(s|a);t[n]=f^d;const l=~h,b=t[e]|t[n];t[r]=l^b,t[i]=o&l^c^b}function l(t,e,r,i,n){const s=t[r],o=t[n],f=t[e]^t[r],a=t[e]&t[i],c=t[e]|t[n],h=t[i]^t[n],u=a|f&c;t[i]=h^u;const d=u^(t[r]^c),l=h&d;t[e]=f^l;const b=t[i]&t[e];t[r]=d^b,t[n]=h^b^(s|o)}function b(t,e,r,i,n){const s=t[e]|t[r],o=t[r]^t[i],f=t[r]&o,a=t[e]^f,c=t[i]^a,h=t[n]|a;t[e]=o^h;const u=o|h,d=t[n]^u;t[i]=c^d;const l=s^d,b=t[e]&l;t[n]=a^b,t[r]=t[n]^t[e]^l}function p(t,e,r,i,n){const s=t[e],o=s^t[n],f=t[n]&o,a=t[i]^f,c=t[r]|a;t[n]=o^c;const h=~t[r],u=o|h;t[e]=a^u;const d=s&t[e],l=o^h,b=c&l;t[i]=d^b,t[r]=s^a^l&t[i]}function m(t,e,r,i,n){const s=t[n],o=t[i]|s,f=t[e]&o,a=t[r]^f,c=t[e]&a,h=t[i]^c;t[r]=s^h;const u=~t[e],d=h&t[r];t[n]=a^d;const l=s^(t[r]|u);t[e]=t[n]^l,t[i]=a&l^t[r]^u}function g(t,e,r,i,n){const s=t[r],o=~t[e],f=t[e]^s,a=t[e]^t[n],c=t[i]^o,h=f|a;t[e]=c^h;const u=t[n]&t[e],d=f^t[e];t[r]=u^d;const l=f|u,b=a^(o|t[e]);t[i]=l^b,t[n]=s^u^t[r]&b}function w(t,e,r,i,n){const s=t[e],o=t[r],f=t[n],a=~t[i],c=f^o&a,h=s&c,u=o^a;t[n]=h^u;const d=o|t[n],l=s&d;t[r]=c^l;const b=s|f,p=a^d;t[e]=b^p,t[i]=o&b^(h|s^t[i])}function y(t,e,r,i,n){const s=~t[e],o=t[e]^t[n],f=t[r]^o,a=s|o,c=t[i]^a;t[r]=t[r]^c;const h=o|t[r],u=t[n]^h,d=c&u;t[i]=f^d;const l=c^u;t[e]=t[i]^l,t[n]=~c^f&l}function v(t,e,r,i,n){const s=t[r],o=t[n],f=~t[e],a=t[e]^s,c=t[i]^a,h=o^(t[i]|f);t[r]=c^h;const u=a^c&h,d=s|u;t[n]=h^d;const l=s|t[n];t[e]=u^l,t[i]=o&f^c^l}function S(t,e,r,i,n){const s=t[r]^t[i],o=t[i]&s,f=t[n]^o,a=t[e]^f,c=a&(t[n]|s);t[r]=t[r]^c;const h=f|t[r],u=t[e]&a;t[n]=s^u;const d=a^h,l=t[n]&d;t[i]=f^l,t[e]=~d^t[n]&t[i]}function E(t,e,r,i,n){const s=t[e],o=t[n],f=t[i]|s&t[r],a=o&(s|t[r]);t[n]=f^a;const c=~o,h=t[r]^a,u=h|t[n]^c;t[r]=s^u,t[e]=t[i]^h^(o|t[r]),t[i]=f^t[r]^t[e]^s&t[n]}function M(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e++]}function A(t,e,r){return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}t.exports=class{constructor(t){i(t>>>0===t),i(128===t||192===t||256===t),this.bits=t,this.subkeys=new Uint32Array(132),this.block=new Uint32Array(4)}get blockSize(){return 16}init(t){return i(e.isBuffer(t)),i(8*t.length===this.bits),this.keySchedule(t),this}keySchedule(t){const e=this.subkeys,r=new Uint32Array(16);let i=0;for(let e=0;e<t.length;e+=4)r[i++]=M(t,e);for(i<8&&(r[i++]=1);i<16;)r[i++]=0;for(let t=8;t<16;t++){const i=r[t-8]^r[t-5]^r[t-3]^r[t-1]^2654435769^t-8;r[t]=i<<11|i>>>21,e[t-8]=r[t]}for(let t=8;t<132;t++){const r=e[t-8]^e[t-5]^e[t-3]^e[t-1]^2654435769^t;e[t]=r<<11|r>>>21}return l(e,0,1,2,3),u(e,4,5,6,7),c(e,8,9,10,11),f(e,12,13,14,15),S(e,16,17,18,19),y(e,20,21,22,23),g(e,24,25,26,27),p(e,28,29,30,31),l(e,32,33,34,35),u(e,36,37,38,39),c(e,40,41,42,43),f(e,44,45,46,47),S(e,48,49,50,51),y(e,52,53,54,55),g(e,56,57,58,59),p(e,60,61,62,63),l(e,64,65,66,67),u(e,68,69,70,71),c(e,72,73,74,75),f(e,76,77,78,79),S(e,80,81,82,83),y(e,84,85,86,87),g(e,88,89,90,91),p(e,92,93,94,95),l(e,96,97,98,99),u(e,100,101,102,103),c(e,104,105,106,107),f(e,108,109,110,111),S(e,112,113,114,115),y(e,116,117,118,119),g(e,120,121,122,123),p(e,124,125,126,127),l(e,128,129,130,131),this}encrypt(t,e,r,i){const o=this.subkeys,a=this.block;return a[0]=M(r,i+0),a[1]=M(r,i+4),a[2]=M(r,i+8),a[3]=M(r,i+12),n(a,o,0,1,2,3),f(a,0,1,2,3),s(a,0,1,2,3),n(a,o,4,5,6,7),c(a,0,1,2,3),s(a,0,1,2,3),n(a,o,8,9,10,11),u(a,0,1,2,3),s(a,0,1,2,3),n(a,o,12,13,14,15),l(a,0,1,2,3),s(a,0,1,2,3),n(a,o,16,17,18,19),p(a,0,1,2,3),s(a,0,1,2,3),n(a,o,20,21,22,23),g(a,0,1,2,3),s(a,0,1,2,3),n(a,o,24,25,26,27),y(a,0,1,2,3),s(a,0,1,2,3),n(a,o,28,29,30,31),S(a,0,1,2,3),s(a,0,1,2,3),n(a,o,32,33,34,35),f(a,0,1,2,3),s(a,0,1,2,3),n(a,o,36,37,38,39),c(a,0,1,2,3),s(a,0,1,2,3),n(a,o,40,41,42,43),u(a,0,1,2,3),s(a,0,1,2,3),n(a,o,44,45,46,47),l(a,0,1,2,3),s(a,0,1,2,3),n(a,o,48,49,50,51),p(a,0,1,2,3),s(a,0,1,2,3),n(a,o,52,53,54,55),g(a,0,1,2,3),s(a,0,1,2,3),n(a,o,56,57,58,59),y(a,0,1,2,3),s(a,0,1,2,3),n(a,o,60,61,62,63),S(a,0,1,2,3),s(a,0,1,2,3),n(a,o,64,65,66,67),f(a,0,1,2,3),s(a,0,1,2,3),n(a,o,68,69,70,71),c(a,0,1,2,3),s(a,0,1,2,3),n(a,o,72,73,74,75),u(a,0,1,2,3),s(a,0,1,2,3),n(a,o,76,77,78,79),l(a,0,1,2,3),s(a,0,1,2,3),n(a,o,80,81,82,83),p(a,0,1,2,3),s(a,0,1,2,3),n(a,o,84,85,86,87),g(a,0,1,2,3),s(a,0,1,2,3),n(a,o,88,89,90,91),y(a,0,1,2,3),s(a,0,1,2,3),n(a,o,92,93,94,95),S(a,0,1,2,3),s(a,0,1,2,3),n(a,o,96,97,98,99),f(a,0,1,2,3),s(a,0,1,2,3),n(a,o,100,101,102,103),c(a,0,1,2,3),s(a,0,1,2,3),n(a,o,104,105,106,107),u(a,0,1,2,3),s(a,0,1,2,3),n(a,o,108,109,110,111),l(a,0,1,2,3),s(a,0,1,2,3),n(a,o,112,113,114,115),p(a,0,1,2,3),s(a,0,1,2,3),n(a,o,116,117,118,119),g(a,0,1,2,3),s(a,0,1,2,3),n(a,o,120,121,122,123),y(a,0,1,2,3),s(a,0,1,2,3),n(a,o,124,125,126,127),S(a,0,1,2,3),a[0]^=o[128],a[1]^=o[129],a[2]^=o[130],a[3]^=o[131],A(t,a[0],e+0),A(t,a[1],e+4),A(t,a[2],e+8),A(t,a[3],e+12),this}decrypt(t,e,r,i){const s=this.subkeys,f=this.block;return f[0]=M(r,i+0),f[1]=M(r,i+4),f[2]=M(r,i+8),f[3]=M(r,i+12),f[0]^=s[128],f[1]^=s[129],f[2]^=s[130],f[3]^=s[131],E(f,0,1,2,3),n(f,s,124,125,126,127),o(f,0,1,2,3),v(f,0,1,2,3),n(f,s,120,121,122,123),o(f,0,1,2,3),w(f,0,1,2,3),n(f,s,116,117,118,119),o(f,0,1,2,3),m(f,0,1,2,3),n(f,s,112,113,114,115),o(f,0,1,2,3),b(f,0,1,2,3),n(f,s,108,109,110,111),o(f,0,1,2,3),d(f,0,1,2,3),n(f,s,104,105,106,107),o(f,0,1,2,3),h(f,0,1,2,3),n(f,s,100,101,102,103),o(f,0,1,2,3),a(f,0,1,2,3),n(f,s,96,97,98,99),o(f,0,1,2,3),E(f,0,1,2,3),n(f,s,92,93,94,95),o(f,0,1,2,3),v(f,0,1,2,3),n(f,s,88,89,90,91),o(f,0,1,2,3),w(f,0,1,2,3),n(f,s,84,85,86,87),o(f,0,1,2,3),m(f,0,1,2,3),n(f,s,80,81,82,83),o(f,0,1,2,3),b(f,0,1,2,3),n(f,s,76,77,78,79),o(f,0,1,2,3),d(f,0,1,2,3),n(f,s,72,73,74,75),o(f,0,1,2,3),h(f,0,1,2,3),n(f,s,68,69,70,71),o(f,0,1,2,3),a(f,0,1,2,3),n(f,s,64,65,66,67),o(f,0,1,2,3),E(f,0,1,2,3),n(f,s,60,61,62,63),o(f,0,1,2,3),v(f,0,1,2,3),n(f,s,56,57,58,59),o(f,0,1,2,3),w(f,0,1,2,3),n(f,s,52,53,54,55),o(f,0,1,2,3),m(f,0,1,2,3),n(f,s,48,49,50,51),o(f,0,1,2,3),b(f,0,1,2,3),n(f,s,44,45,46,47),o(f,0,1,2,3),d(f,0,1,2,3),n(f,s,40,41,42,43),o(f,0,1,2,3),h(f,0,1,2,3),n(f,s,36,37,38,39),o(f,0,1,2,3),a(f,0,1,2,3),n(f,s,32,33,34,35),o(f,0,1,2,3),E(f,0,1,2,3),n(f,s,28,29,30,31),o(f,0,1,2,3),v(f,0,1,2,3),n(f,s,24,25,26,27),o(f,0,1,2,3),w(f,0,1,2,3),n(f,s,20,21,22,23),o(f,0,1,2,3),m(f,0,1,2,3),n(f,s,16,17,18,19),o(f,0,1,2,3),b(f,0,1,2,3),n(f,s,12,13,14,15),o(f,0,1,2,3),d(f,0,1,2,3),n(f,s,8,9,10,11),o(f,0,1,2,3),h(f,0,1,2,3),n(f,s,4,5,6,7),o(f,0,1,2,3),a(f,0,1,2,3),f[0]^=s[0],f[1]^=s[1],f[2]^=s[2],f[3]^=s[3],A(t,f[0],e+0),A(t,f[1],e+4),A(t,f[2],e+8),A(t,f[3],e+12),this}destroy(){for(let t=0;t<132;t++)this.subkeys[t]=0;for(let t=0;t<4;t++)this.block[t]=0;return this}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * twofish.js - twofish for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009, The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Twofish
 *   https://www.schneier.com/academic/twofish/
 *   https://github.com/golang/crypto/blob/master/twofish/twofish.go
 */
const i=r(1),n=[new Uint8Array([1,164,85,135,90,88,219,158]),new Uint8Array([164,86,130,243,30,198,104,229]),new Uint8Array([2,161,252,193,71,174,61,25]),new Uint8Array([164,85,135,90,88,219,158,3])],s=new Uint8Array([169,103,179,232,4,253,163,118,154,146,128,120,228,221,209,56,13,198,53,152,24,247,236,108,67,117,55,38,250,19,148,72,242,208,139,48,132,84,223,35,25,91,61,89,243,174,162,130,99,1,131,46,217,81,155,124,166,235,165,190,22,12,227,97,192,140,58,245,115,44,37,11,187,78,137,107,83,106,180,241,225,230,189,69,226,244,182,102,204,149,3,86,212,28,30,215,251,195,142,181,233,207,191,186,234,119,57,175,51,201,98,113,129,121,9,173,36,205,249,216,229,197,185,77,68,8,134,231,161,29,170,237,6,112,178,210,65,123,160,17,49,194,39,144,32,246,96,255,150,92,177,171,158,156,82,27,95,147,10,239,145,133,73,238,45,79,143,59,71,135,109,70,214,62,105,100,42,206,203,47,252,151,5,122,172,127,213,26,75,14,167,90,40,20,63,41,136,60,76,2,184,218,176,23,85,31,138,125,87,199,141,116,183,196,159,114,126,21,34,18,88,7,153,52,110,80,222,104,101,188,219,248,200,168,43,64,220,254,50,164,202,16,33,240,211,93,15,0,111,157,54,66,74,94,193,224]),o=new Uint8Array([117,243,198,244,219,123,251,200,74,211,230,107,69,125,232,75,214,50,216,253,55,113,241,225,48,15,248,27,135,250,6,63,94,186,174,91,138,0,188,157,109,193,177,14,128,93,210,213,160,132,7,20,181,144,44,163,178,115,76,84,146,116,54,81,56,176,189,90,252,96,98,150,108,66,247,16,124,40,39,140,19,149,156,199,36,70,59,112,202,227,133,203,17,208,147,184,166,131,32,255,159,119,195,204,3,111,8,191,64,231,43,226,121,12,170,130,65,58,234,185,228,154,164,151,126,218,122,23,102,148,161,29,61,240,222,179,11,114,167,28,239,209,83,62,143,51,38,95,236,118,42,73,129,136,238,33,196,26,235,217,197,57,153,205,173,49,139,1,24,35,221,31,78,45,249,72,79,242,101,142,120,92,88,25,141,229,152,87,103,127,5,100,175,99,182,254,245,183,60,165,206,233,104,68,224,77,67,105,41,46,172,21,89,168,10,158,110,71,223,52,53,106,207,220,34,201,192,155,137,212,237,171,18,162,13,82,187,2,47,169,215,97,30,180,80,4,246,194,22,37,134,86,85,9,190,145]);function f(t,e,r){const i=new Uint32Array([0,255&e]),n=new Uint32Array([0,r>>>0]);let s=0;for(let e=0;e<7;e++)s^=i[1&t],t>>>=1,i[1]=n[i[1]>>>7]^i[1]<<1;return s^=i[1&t],255&s}function a(t,e){const r=255&t,i=f(t,91,361),n=f(t,239,361);switch(e){case 0:return r|i<<8|n<<16|n<<24;case 1:return n|n<<8|i<<16|r<<24;case 2:return i|n<<8|r<<16|n<<24;case 3:return i|r<<8|n<<16|i<<24}throw new Error("unreachable")}function c(t,e,r){const i=new Uint8Array(4);for(let e=0;e<4;e++)i[e]=t[e];switch(e.length>>>3){case 4:i[0]=o[i[0]]^e[4*(6+r)+0],i[1]=s[i[1]]^e[4*(6+r)+1],i[2]=s[i[2]]^e[4*(6+r)+2],i[3]=o[i[3]]^e[4*(6+r)+3];case 3:i[0]=o[i[0]]^e[4*(4+r)+0],i[1]=o[i[1]]^e[4*(4+r)+1],i[2]=s[i[2]]^e[4*(4+r)+2],i[3]=s[i[3]]^e[4*(4+r)+3];case 2:i[0]=o[s[s[i[0]]^e[4*(2+r)+0]]^e[4*(0+r)+0]],i[1]=s[s[o[i[1]]^e[4*(2+r)+1]]^e[4*(0+r)+1]],i[2]=o[o[s[i[2]]^e[4*(2+r)+2]]^e[4*(0+r)+2]],i[3]=s[o[o[i[3]]^e[4*(2+r)+3]]^e[4*(0+r)+3]];break;default:throw new Error("Invalid key size.")}let n=0;for(let t=0;t<4;t++)n^=a(i[t],t);return n>>>0}function h(t,e){return t<<(31&e)|t>>>32-(31&e)}function u(t,e){return t>>>(31&e)|t<<32-(31&e)}function d(t){for(let e=0;e<t.length;e++)t[e]=0}function l(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e++]}function b(t,e,r){return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}t.exports=class{constructor(t=256){i(t>>>0===t),i(128===t||192===t||256===t),this.bits=t,this.S=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.k=new Uint32Array(40)}get blockSize(){return 16}init(t){i(e.isBuffer(t));const r=t.length;if(16!==r&&24!==r&&32!==r)throw new Error("Invalid key size.");if(r!==this.bits>>>3)throw new Error("Invalid key size.");const u=r>>>3,d=new Uint8Array(16);for(let e=0;e<u;e++)for(let r=0;r<4;r++)for(let i=0;i<8;i++)d[4*e+r]^=f(t[8*e+i],n[r][i],333);const l=new Uint8Array(4);for(let e=0;e<20;e++){for(let t=0;t<4;t++)l[t]=2*e;const r=c(l,t,0);for(let t=0;t<4;t++)l[t]=2*e+1;const i=h(c(l,t,1),8);this.k[2*e+0]=r+i,this.k[2*e+1]=h(2*i+r,9)}switch(u){case 2:for(let t=0;t<256;t++)this.S[0][t]=a(o[s[s[t]^d[0]]^d[4]],0),this.S[1][t]=a(s[s[o[t]^d[1]]^d[5]],1),this.S[2][t]=a(o[o[s[t]^d[2]]^d[6]],2),this.S[3][t]=a(s[o[o[t]^d[3]]^d[7]],3);break;case 3:for(let t=0;t<256;t++)this.S[0][t]=a(o[s[s[o[t]^d[0]]^d[4]]^d[8]],0),this.S[1][t]=a(s[s[o[o[t]^d[1]]^d[5]]^d[9]],1),this.S[2][t]=a(o[o[s[s[t]^d[2]]^d[6]]^d[10]],2),this.S[3][t]=a(s[o[o[s[t]^d[3]]^d[7]]^d[11]],3);break;case 4:for(let t=0;t<256;t++)this.S[0][t]=a(o[s[s[o[o[t]^d[0]]^d[4]]^d[8]]^d[12]],0),this.S[1][t]=a(s[s[o[o[s[t]^d[1]]^d[5]]^d[9]]^d[13]],1),this.S[2][t]=a(o[o[s[s[s[t]^d[2]]^d[6]]^d[10]]^d[14]],2),this.S[3][t]=a(s[o[o[s[o[t]^d[3]]^d[7]]^d[11]]^d[15]],3);break;default:throw new Error("unreachable")}return this}encrypt(t,e,r,i){const n=this.k,s=this.S[0],o=this.S[1],f=this.S[2],a=this.S[3];let c,d,p=l(r,i+0),m=l(r,i+4),g=l(r,i+8),w=l(r,i+12);p^=this.k[0],m^=this.k[1],g^=this.k[2],w^=this.k[3];for(let t=0;t<8;t++){const e=8+4*t;d=o[m>>>0&255]^f[m>>>8&255]^a[m>>>16&255]^s[m>>>24&255],c=s[p>>>0&255]^o[p>>>8&255]^f[p>>>16&255]^a[p>>>24&255],c+=d,g=u(g^c+n[e+0],1),w=h(w,1)^d+c+n[e+1],d=o[w>>>0&255]^f[w>>>8&255]^a[w>>>16&255]^s[w>>>24&255],c=s[g>>>0&255]^o[g>>>8&255]^f[g>>>16&255]^a[g>>>24&255],c+=d,p=u(p^c+n[e+2],1),m=h(m,1)^d+c+n[e+3]}const y=g^this.k[4],v=w^this.k[5],S=p^this.k[6],E=m^this.k[7];return b(t,y,e+0),b(t,v,e+4),b(t,S,e+8),b(t,E,e+12),this}decrypt(t,e,r,i){const n=this.k,s=this.S[0],o=this.S[1],f=this.S[2],a=this.S[3],c=l(r,i+0),d=l(r,i+4),p=l(r,i+8),m=l(r,i+12);let g,w,y=p^this.k[6],v=m^this.k[7],S=c^this.k[4],E=d^this.k[5];for(let t=8;t>0;t--){const e=4+4*t;w=o[E>>>0&255]^f[E>>>8&255]^a[E>>>16&255]^s[E>>>24&255],g=s[S>>>0&255]^o[S>>>8&255]^f[S>>>16&255]^a[S>>>24&255],g+=w,y=h(y,1)^g+n[e+2],v=u(v^w+g+n[e+3],1),w=o[v>>>0&255]^f[v>>>8&255]^a[v>>>16&255]^s[v>>>24&255],g=s[y>>>0&255]^o[y>>>8&255]^f[y>>>16&255]^a[y>>>24&255],g+=w,S=h(S,1)^g+n[e+0],E=u(E^w+g+n[e+1],1)}return y^=this.k[0],v^=this.k[1],S^=this.k[2],E^=this.k[3],b(t,y,e+0),b(t,v,e+4),b(t,S,e+8),b(t,E,e+12),this}destroy(){return d(this.S[0]),d(this.S[1]),d(this.S[2]),d(this.S[3]),d(this.k),this}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * cleanse.js - cleanse for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(204)},function(t,e,r){"use strict";(function(e){
/*!
 * cleanse.js - memzero for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(1),n=r(5);function s(t){i(e.isBuffer(t)),n.randomFill(t,0,t.length)}s.native=0,t.exports=s}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * cshake128.js - CSHAKE128 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(35);class n extends i{constructor(){super()}init(t,e){return super.init(128,t,e)}static hash(){return new n}static hmac(t,e,r){return super.hmac(128,t,e,r)}static digest(t,e,r,i){return super.digest(t,128,e,r,i)}static root(t,e,r,i,n){return super.root(t,e,128,r,i,n)}static multi(t,e,r,i,n,s){return super.multi(t,e,r,128,i,n,s)}static mac(t,e,r,i,n){return super.mac(t,e,128,r,i,n)}}n.native=i.native,n.id="CSHAKE128",n.size=16,n.bits=128,n.blockSize=168,n.zero=e.alloc(16,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * cshake256.js - CSHAKE256 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(35);class n extends i{constructor(){super()}init(t,e){return super.init(256,t,e)}static hash(){return new n}static hmac(t,e,r){return super.hmac(256,t,e,r)}static digest(t,e,r,i){return super.digest(t,256,e,r,i)}static root(t,e,r,i,n){return super.root(t,e,256,r,i,n)}static multi(t,e,r,i,n,s){return super.multi(t,e,r,256,i,n,s)}static mac(t,e,r,i,n){return super.mac(t,e,256,r,i,n)}}n.native=i.native,n.id="CSHAKE256",n.size=32,n.bits=256,n.blockSize=136,n.zero=e.alloc(32,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * ctr-drbg.js - ctr-drbg for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(208)},function(t,e,r){"use strict";(function(e){
/*!
 * ctr-drbg.js - ctr-drbg implementation for bcrypto
 * Copyright (c) 2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on google/boringssl:
 *   https://github.com/google/boringssl
 *
 * Resources:
 *   https://csrc.nist.gov/publications/detail/sp/800-90a/archive/2012-01-23
 *   https://github.com/google/boringssl/blob/master/crypto/fipsmodule/rand/ctrdrbg.c
 *   https://github.com/google/boringssl/blob/master/crypto/fipsmodule/rand/internal.h
 *   https://github.com/openssl/openssl/blob/master/crypto/rand/drbg_lib.c
 *   https://github.com/cryptocoinjs/drbg.js/blob/master/ctr.js
 *   https://github.com/netroby/jdk9-dev/blob/master/jdk/src/java.base/share/classes/sun/security/provider/CtrDrbg.java
 */
const i=r(1),n=r(47);class s{constructor(t,r,n,s,f){i(t>>>0===t),i("boolean"==typeof r),this.bits=t,this.ctr=new o(t),this.keySize=t>>>3,this.blkSize=16,this.entSize=this.keySize+this.blkSize,this.slab=e.alloc(this.entSize),this.K=this.slab.slice(0,this.keySize),this.V=this.slab.slice(this.keySize),this.derivation=r,this.rounds=0,n&&this.init(n,s,f)}init(t,r,n){let s;if(null==r&&(r=e.alloc(0)),null==n&&(n=e.alloc(0)),i(e.isBuffer(t)),i(e.isBuffer(r)),i(e.isBuffer(n)),this.derivation)s=this.derive(t,r,n);else{if(t.length+r.length>this.entSize)throw new Error("Entropy is too long.");if(n.length>this.entSize)throw new Error("Personalization string is too long.");s=e.alloc(this.entSize,0),t.copy(s,0),r.copy(s,t.length);for(let t=0;t<n.length;t++)s[t]^=n[t]}return this.slab.fill(0),this.ctr.init(this.K,this.V),this.update(s),this.rounds=1,this}reseed(t,r){if(null==r&&(r=e.alloc(0)),i(e.isBuffer(t)),i(e.isBuffer(r)),0===this.rounds)throw new Error("DRBG not initialized.");let n;if(this.derivation)n=this.derive(t,r);else{if(r.length>this.entSize)throw new Error("Additional data is too long.");n=e.alloc(this.entSize,0),t.copy(n,0);for(let t=0;t<r.length;t++)n[t]^=r[t]}return this.update(n),this.rounds=1,this}generate(t,r){if(i(t>>>0===t),i(null==r||e.isBuffer(r)),0===this.rounds)throw new Error("DRBG not initialized.");if(this.rounds>281474976710656)throw new Error("Reseed is required.");if(t>65536)throw new Error("Requested length is too long.");r&&r.length>0&&(this.derivation&&(r=this.derive(r)),this.update(r));const n=Math.ceil(t/this.blkSize),s=e.alloc(n*this.blkSize);for(let t=0;t<n;t++)this.ctr.encrypt(s,t*this.blkSize);return this.update(r),this.rounds+=1,s.slice(0,t)}randomBytes(t){return this.generate(t)}update(t){if(null==t&&(t=e.alloc(0)),i(e.isBuffer(t)),t.length>this.entSize)throw new Error("Seed is too long.");this.slab.fill(0);for(let t=0;t<this.entSize;t+=this.blkSize)this.ctr.encrypt(this.slab,t);for(let e=0;e<t.length;e++)this.slab[e]^=t[e];return this.ctr.init(this.K,this.V),this}serialize(...t){const r=this.entSize;let n=0;for(const e of t)n+=e.length;let s=this.blkSize+4+4+n+1;s%this.blkSize&&(s+=this.blkSize-s%this.blkSize),i(s%this.blkSize==0);const o=e.alloc(s,0);let a=this.blkSize;a=f(o,n,a),a=f(o,r,a);for(const e of t)a+=e.copy(o,a);return o[a++]=128,i(a===this.blkSize+4+4+n+1),o}derive(...t){const r=this.serialize(...t),i=r.length/this.blkSize,s=e.alloc(this.keySize),o=Math.ceil(this.entSize/this.blkSize),a=e.alloc(o*this.blkSize),c=e.alloc(o*this.blkSize),h=e.alloc(this.blkSize);for(let t=0;t<s.length;t++)s[t]=t;const u=new n(this.bits).init(s);for(let t=0;t<o;t++){h.fill(0),f(r,t,0);for(let t=0;t<i;t++){for(let e=0;e<h.length;e++)h[e]^=r[t*this.blkSize+e];u.encrypt(h,0,h,0)}h.copy(a,t*this.blkSize)}const d=a.slice(0,this.keySize),l=a.slice(this.keySize,this.entSize);u.init(d);for(let t=0;t<o;t++)u.encrypt(l,0,l,0),l.copy(c,t*this.blkSize);return c.slice(0,this.entSize)}}s.native=0;class o{constructor(t){this.ctx=new n(t),this.ctr=e.alloc(16)}init(t,e){return this.ctx.init(t),e.copy(this.ctr,0),this}increment(){for(let t=this.ctr.length-1;t>=0&&(this.ctr[t]+=1,0===this.ctr[t]);t--);}encrypt(t,e){return this.increment(),this.ctx.encrypt(t,e,this.ctr,0),this}}function f(t,e,r){return t[r++]=e>>>24,t[r++]=e>>>16,t[r++]=e>>>8,t[r++]=e,r}t.exports=s}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * dsa.js - DSA for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009, The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * References:
 *
 *   [FIPS186] Federal Information Processing Standards Publication
 *     National Institute of Standards and Technology
 *     http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf
 *
 *   [DSA] Digital Signature Algorithm (wikipedia)
 *     https://en.wikipedia.org/wiki/Digital_Signature_Algorithm
 *
 *   [RFC6979] Deterministic Usage of the Digital Signature
 *             Algorithm (DSA) and Elliptic Curve Digital
 *             Signature Algorithm (ECDSA)
 *     T. Pornin
 *     https://tools.ietf.org/html/rfc6979
 */
const i=r(1),n=r(6),s=r(5),o=r(48),f=r(11),{isProbablePrime:a}=r(85),c=r(49);class h{constructor(){this.p=new n(0),this.q=new n(0),this.g=new n(0)}bits(){return this.p.bitLength()}size(){return this.q.byteLength()}isSane(){if(this.p.sign()<0||this.q.sign()<0)return!1;const t=this.p.bitLength(),e=this.q.bitLength();return!(t<512||t>1e4)&&((160===e||224===e||256===e)&&(!(this.g.cmpn(2)<0||this.g.cmp(this.p.subn(1))>=0)&&(!!this.p.isOdd()&&!!this.q.isOdd())))}verify(){return 0===this.g.powm(this.q,this.p).cmpn(1)}generate(t,e){if(i(t>>>0===t),i(e>>>0===e),!(1024===t&&160===e||2048===t&&224===e||2048===t&&256===e||3072===t&&256===e))throw new Error("Invalid parameter sizes.");if(t<512||t>1e4||0!=(7&e))throw new Error("Invalid parameter sizes.");let r=null,o=null;t:for(;;)if(r=n.randomBits(s,e),r.setn(e-1,1),r.setn(0,1),a(r,64))for(let e=0;e<4*t;e++){o=n.randomBits(s,t),o.setn(t-1,1),o.setn(0,1),o.isub(o.mod(r).isubn(1));const e=o.bitLength();if(!(e<t||e>1e4)&&a(o,64))break t}const f=new n(2),c=o.subn(1).div(r);for(;;){const t=f.powm(c,o);if(0!==t.cmpn(1))return this.p=o,this.q=r,this.g=t,this;f.iaddn(1)}}toParams(){const t=new h;return t.p=this.p,t.q=this.q,t.g=this.g,t}encode(){let e=0;e+=c.sizeInt(this.p),e+=c.sizeInt(this.q),e+=c.sizeInt(this.g);const r=t.alloc(c.sizeSeq(e));let n=0;return n=c.writeSeq(r,n,e),n=c.writeInt(r,n,this.p),n=c.writeInt(r,n,this.q),n=c.writeInt(r,n,this.g),i(n===r.length),r}decode(e){i(t.isBuffer(e));let r=0;if(r=c.readSeq(e,r),[this.p,r]=c.readInt(e,r),[this.q,r]=c.readInt(e,r),[this.g,r]=c.readInt(e,r),r!==e.length)throw new Error("Trailing bytes.");return this}static generate(t,e){return(new h).generate(t,e)}static decode(t){return(new h).decode(t)}}class u extends h{constructor(){super(),this.y=new n(0)}isSane(){return!!super.isSane()&&!(this.y.cmpn(2)<0||this.y.cmp(this.p.subn(1))>=0)}verify(){return!!super.verify()&&0===this.y.powm(this.q,this.p).cmpn(1)}encode(){let e=0;e+=c.sizeInt(this.y),e+=c.sizeInt(this.p),e+=c.sizeInt(this.q),e+=c.sizeInt(this.g);const r=t.alloc(c.sizeSeq(e));let n=0;return n=c.writeSeq(r,n,e),n=c.writeInt(r,n,this.y),n=c.writeInt(r,n,this.p),n=c.writeInt(r,n,this.q),n=c.writeInt(r,n,this.g),i(n===r.length),r}decode(e){i(t.isBuffer(e));let r=0;if(r=c.readSeq(e,r),[this.y,r]=c.readInt(e,r),[this.p,r]=c.readInt(e,r),[this.q,r]=c.readInt(e,r),[this.g,r]=c.readInt(e,r),r!==e.length)throw new Error("Trailing bytes.");return this}static decode(t){return(new u).decode(t)}}class d extends u{constructor(){super(),this.x=new n(0)}isSane(){return!!super.isSane()&&!(this.x.sign()<=0||this.x.cmp(this.q)>=0)}isSaneCompute(){const t=new h;return t.p=this.p,t.q=this.q,t.g=this.g,!!t.isSane()&&!(this.x.sign()<=0||this.x.cmp(this.q)>=0)}verify(){if(!super.verify())return!1;const t=this.g.powm(this.x,this.p);return this.y.eq(t)}toPublic(){const t=new u;return t.p=this.p,t.q=this.q,t.g=this.g,t.y=this.y,t}encode(){let e=0;e+=c.sizeVersion(0),e+=c.sizeInt(this.p),e+=c.sizeInt(this.q),e+=c.sizeInt(this.g),e+=c.sizeInt(this.y),e+=c.sizeInt(this.x);const r=t.alloc(c.sizeSeq(e));let n=0;return n=c.writeSeq(r,n,e),n=c.writeVersion(r,n,0),n=c.writeInt(r,n,this.p),n=c.writeInt(r,n,this.q),n=c.writeInt(r,n,this.g),n=c.writeInt(r,n,this.y),n=c.writeInt(r,n,this.x),i(n===r.length),r}decode(e){i(t.isBuffer(e));let r=0;if(r=c.readSeq(e,r),r=c.readVersion(e,r,0),[this.p,r]=c.readInt(e,r),[this.q,r]=c.readInt(e,r),[this.g,r]=c.readInt(e,r),[this.y,r]=c.readInt(e,r),[this.x,r]=c.readInt(e,r),r!==e.length)throw new Error("Trailing bytes.");return this}static decode(t){return(new d).decode(t)}}class l{constructor(){this.r=new n(0),this.s=new n(0)}encode(){const e=c.sizeInt(this.r)+c.sizeInt(this.s),r=t.alloc(c.sizeSeq(e));let n=0;return n=c.writeSeq(r,n,e),n=c.writeInt(r,n,this.r),n=c.writeInt(r,n,this.s),i(n===r.length),r}decode(e){i(t.isBuffer(e));let r=0;if(r=c.readSeq(e,r),[this.r,r]=c.readInt(e,r),[this.s,r]=c.readInt(e,r),r!==e.length)throw new Error("Trailing bytes.");return this}encodeRS(e){return i(e>>0===e),t.concat([this.r.encode("be",e),this.s.encode("be",e)])}decodeRS(e,r){return i(t.isBuffer(e)),null==r&&(r=e.length>>>1),i(r>>0===r),i(e.length===2*r),this.r=n.decode(e.slice(0,r)),this.s=n.decode(e.slice(r,2*r)),this}static decode(t){return(new l).decode(t)}static decodeRS(t,e){return(new l).decodeRS(t,e)}}function b(t){if(null==t&&(t=2048),i(t>>>0===t),t<512||t>1e4)throw new RangeError('"bits" ranges from 512 to 10000.');const e=t,r=t<2048?160:256;return h.generate(e,r).encode()}async function p(t){return b(t)}function m(t){const e=h.decode(t);if(!e.isSane())throw new Error("Invalid DSA parameters.");const{p:r,q:i,g:o}=e,f=n.random(s,1,i),a=o.powm(f,r),c=new d;return c.p=r,c.q=i,c.g=o,c.x=f,c.y=a,c.encode()}function g(e,r){if(i(t.isBuffer(e)),i(r instanceof d),!r.isSane())throw new Error("Invalid DSA private key.");const{p:a,q:c,g:h,x:u}=r,b=c.byteLength(),p=v(e,c),m=u.encode("be",b),g=p.encode("be",b),w=new o(f,m,g);for(;;){const t=y(w.generate(b),c);if(t.isZero()||t.cmp(c)>=0)continue;const e=S(h,t,a,c).mod(c);if(e.isZero())continue;const r=n.random(s,1,c),i=t.mul(r).fermat(c),o=u.mul(r).imod(c),f=p.mul(r).imod(c),d=e.mul(o).iadd(f).imod(c).mul(i).imod(c);if(d.isZero())continue;const m=new l;return m.r=e,m.s=d,m}}function w(t,e,r){const{r:i,s:n}=e,{p:s,q:o,g:f,y:a}=r;if(!r.isSane())return!1;if(i.isZero()||i.cmp(o)>=0)return!1;if(n.isZero()||n.cmp(o)>=0)return!1;const c=v(t,o),h=n.invert(o),u=c.mul(h).imod(o),d=i.mul(h).imod(o),l=f.powm(u,s),b=a.powm(d,s);return l.mul(b).imod(s).imod(o).eq(i)}function y(e,r){i(t.isBuffer(e)),i(r instanceof n);const s=r.bitLength(),o=s+7>>>3;e.length>o&&(e=e.slice(0,o));const f=n.decode(e),a=8*e.length-s;return a>0&&f.iushrn(a),f}function v(t,e){return y(t,e).imod(e)}function S(t,e,r,o){i(t instanceof n),i(e instanceof n),i(r instanceof n),i(o instanceof n);const f=t.toRed(n.mont(r)),a=n.random(s,1,o),c=e.sub(a).imod(o),h=f.redPow(c),u=f.redPow(a);return h.redMul(u).fromRed()}e.native=0,e.paramsCreate=function(e){let r;i(t.isBuffer(e));try{r=d.decode(e)}catch(t){r=u.decode(e)}const n=r.toParams();if(!n.isSane())throw new Error("Invalid DSA key.");return n.encode()},e.paramsGenerate=b,e.paramsGenerateAsync=p,e.paramsBits=function(t){const e=h.decode(t);if(!e.isSane())throw new Error("Invalid DSA params.");return e.bits()},e.paramsScalarBits=function(t){const e=h.decode(t);if(!e.isSane())throw new Error("Invalid DSA params.");return e.q.bitLength()},e.paramsVerify=function(e){let r;i(t.isBuffer(e));try{r=h.decode(e)}catch(t){return!1}return!!r.isSane()&&r.verify()},e.paramsImport=function(t){i(t&&"object"==typeof t);const e=new h;if(null!=t.p&&(e.p=n.decode(t.p)),null!=t.q&&(e.q=n.decode(t.q)),null!=t.g&&(e.g=n.decode(t.g)),!e.isSane())throw new Error("Invalid DSA parameters.");return e.encode()},e.paramsExport=function(t){const e=h.decode(t);if(!e.isSane())throw new Error("Invalid DSA parameters.");return{p:e.p.encode(),q:e.q.encode(),g:e.g.encode()}},e.privateKeyCreate=m,e.privateKeyGenerate=function(t){return m(b(t))},e.privateKeyGenerateAsync=async function(t){return m(await p(t))},e.privateKeyBits=function(t){const e=d.decode(t);if(!e.isSane())throw new Error("Invalid DSA private key.");return e.bits()},e.privateKeyScalarBits=function(t){const e=d.decode(t);if(!e.isSane())throw new Error("Invalid DSA private key.");return e.q.bitLength()},e.privateKeyVerify=function(e){let r;i(t.isBuffer(e));try{r=d.decode(e)}catch(t){return!1}return!!r.isSane()&&r.verify()},e.privateKeyImport=function(t){i(t&&"object"==typeof t);const e=new d;if(null!=t.p&&(e.p=n.decode(t.p)),null!=t.q&&(e.q=n.decode(t.q)),null!=t.g&&(e.g=n.decode(t.g)),null!=t.y&&(e.y=n.decode(t.y)),null!=t.x&&(e.x=n.decode(t.x)),e.y.isZero()){if(!e.isSaneCompute())throw new Error("Invalid DSA private key.");e.y=e.g.powm(e.x,e.p)}else if(!e.isSane())throw new Error("Invalid DSA private key.");return e.encode()},e.privateKeyExport=function(t){const e=d.decode(t);if(!e.isSane())throw new Error("Invalid RSA private key.");return{p:e.p.encode(),q:e.q.encode(),g:e.g.encode(),y:e.y.encode(),x:e.x.encode()}},e.publicKeyCreate=function(t){const e=d.decode(t);if(!e.isSane())throw new Error("Invalid DSA private key.");return e.toPublic().encode()},e.publicKeyBits=function(t){const e=u.decode(t);if(!e.isSane())throw new Error("Invalid DSA public key.");return e.bits()},e.publicKeyScalarBits=function(t){const e=u.decode(t);if(!e.isSane())throw new Error("Invalid DSA public key.");return e.q.bitLength()},e.publicKeyVerify=function(t){let e;try{e=u.decode(t)}catch(t){return!1}return!!e.isSane()&&e.verify()},e.publicKeyImport=function(t){i(t&&"object"==typeof t);const e=new u;if(null!=t.p&&(e.p=n.decode(t.p)),null!=t.q&&(e.q=n.decode(t.q)),null!=t.g&&(e.g=n.decode(t.g)),null!=t.y&&(e.y=n.decode(t.y)),!e.isSane())throw new Error("Invalid DSA public key.");return e.encode()},e.publicKeyExport=function(t){const e=u.decode(t);if(!e.isSane())throw new Error("Invalid DSA public key.");return{p:e.p.encode(),q:e.q.encode(),g:e.g.encode(),y:e.y.encode()}},e.signatureImport=function(t,e){return l.decode(t).encodeRS(e)},e.signatureExport=function(t,e){return l.decodeRS(t,e).encode()},e.sign=function(t,e){const r=d.decode(e);return g(t,r).encodeRS(r.size())},e.signDER=function(t,e){return g(t,d.decode(e)).encode()},e.verify=function(e,r,n){let s,o;i(t.isBuffer(e)),i(t.isBuffer(r)),i(t.isBuffer(n));try{s=u.decode(n)}catch(t){return!1}try{o=l.decodeRS(r,s.size())}catch(t){return!1}try{return w(e,o,s)}catch(t){return!1}},e.verifyDER=function(e,r,n){let s,o;i(t.isBuffer(e)),i(t.isBuffer(r)),i(t.isBuffer(n));try{s=u.decode(n)}catch(t){return!1}try{o=l.decode(r)}catch(t){return!1}try{return w(e,o,s)}catch(t){return!1}},e.derive=function(t,e){const r=u.decode(t),i=d.decode(e);if(!r.isSane())throw new Error("Invalid DSA public key.");if(!i.isSane())throw new Error("Invalid DSA private key.");const{p:n,q:s,g:o,x:f}=i,{y:a}=r;if(!r.p.eq(n)||!r.q.eq(s)||!r.g.eq(o))throw new Error("Incompatible DSA parameters.");if(!r.verify())throw new Error("Invalid DSA public key.");return S(a,f,n,s).encode("be",n.byteLength())}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * hmac-drbg.js - hmac-drbg implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/hmac-drbg:
 *   Copyright Fedor Indutny, 2017.
 *   https://github.com/indutny/hmac-drbg
 *
 * Resources:
 *   https://tools.ietf.org/html/rfc6979
 *   https://csrc.nist.gov/publications/detail/sp/800-90a/archive/2012-01-23
 *   https://github.com/indutny/hmac-drbg/blob/master/lib/hmac-drbg.js
 */
const i=r(1),n=e.from([0]),s=e.from([1]);class o{constructor(t,r,n,s){i(t&&"string"==typeof t.id),this.hash=t,this.minEntropy="SHA1"===t.id?10:24,this.K=e.alloc(t.size),this.V=e.alloc(t.size),this.rounds=0,r&&this.init(r,n,s)}init(t,r,n){null==r&&(r=e.alloc(0)),null==n&&(n=e.alloc(0)),i(e.isBuffer(t)),i(e.isBuffer(r)),i(e.isBuffer(n));for(let t=0;t<this.V.length;t++)this.K[t]=0,this.V[t]=1;const s=e.concat([t,r,n]);if(s.length<this.minEntropy)throw new Error("Not enough entropy.");return this.update(s),this.rounds=1,this}reseed(t,r){if(null==r&&(r=e.alloc(0)),i(e.isBuffer(t)),i(e.isBuffer(r)),0===this.rounds)throw new Error("DRBG not initialized.");const n=e.concat([t,r]);if(n.length<this.minEntropy)throw new Error("Not enough entropy.");return this.update(n),this.rounds=1,this}generate(t,r){if(i(t>>>0===t),i(null==r||e.isBuffer(r)),0===this.rounds)throw new Error("DRBG not initialized.");if(this.rounds>281474976710656)throw new Error("Reseed is required.");r&&r.length>0&&this.update(r);const n=Math.ceil(t/this.hash.size),s=e.alloc(n*this.hash.size);for(let t=0;t<n;t++)this.V=this.mac(this.V),this.V.copy(s,t*this.hash.size);return this.update(r),this.rounds+=1,s.slice(0,t)}randomBytes(t){return this.generate(t)}mac(t){return this.hash.mac(t,this.K)}hmac(){return this.hash.hmac().init(this.K)}update(t){i(null==t||e.isBuffer(t));const r=this.hmac();if(r.update(this.V),r.update(n),t&&r.update(t),this.K=r.final(),this.V=this.mac(this.V),t&&t.length>0){const e=this.hmac();e.update(this.V),e.update(s),e.update(t),this.K=e.final(),this.V=this.mac(this.V)}return this}}o.native=0,t.exports=o}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * dsaies.js - dsaies for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Integrated_Encryption_Scheme
 *   https://nacl.cr.yp.to/secretbox.html
 */
const i=r(1),n=r(84),s=r(5),o=r(26),{padLeft:f}=r(37);e.encrypt=function(e,r,a,c=null){if(i(null!=e),i(t.isBuffer(r)),i(t.isBuffer(a)),i(null==c||t.isBuffer(c)),null==c){const t=n.paramsCreate(a);c=n.privateKeyCreate(t)}const h=n.publicKeyBits(a)+7>>>3,{y:u}=n.privateKeyExport(c),d=n.derive(a,c),l=o.derive(d,e),b=s.randomBytes(24),p=f(u,h),m=o.seal(r,l,b);return t.concat([p,b,m])},e.decrypt=function(e,r,s){i(null!=e),i(t.isBuffer(r)),i(t.isBuffer(s));const f=n.privateKeyBits(s)+7>>>3;if(r.length<f+24)throw new Error("Invalid ciphertext.");const{p:a,q:c,g:h}=n.privateKeyExport(s),u=r.slice(0,f),d=n.publicKeyImport({p:a,q:c,g:h,y:u}),l=r.slice(f,f+24),b=r.slice(f+24),p=n.derive(d,s),m=o.derive(p,e);return o.open(b,m,l)}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * eb2k.js - EVP_BytesToKey for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on crypto-browserify/EVP_BytesToKey:
 *   Copyright (c) 2017, crypto-browserify contributors
 *   https://github.com/crypto-browserify/EVP_BytesToKey
 *
 * Resources:
 *   https://github.com/openssl/openssl/blob/2e9d61e/crypto/evp/evp_key.c
 *   https://github.com/crypto-browserify/EVP_BytesToKey/blob/master/index.js
 *   https://github.com/openssl/openssl/blob/master/crypto/evp/evp_key.c
 */
const i=r(1);e.native=0,e.derive=function(e,r,n,s,o){if("string"==typeof r&&(r=t.from(r,"utf8")),"string"==typeof n&&(n=t.from(n,"utf8")),null==n&&(n=t.alloc(0)),null==o&&(o=0),i(e&&"string"==typeof e.id),i(t.isBuffer(r)),i(t.isBuffer(n)),i(s>>>0===s),i(o>>>0===o),n.length>8&&(n=n.slice(0,8)),0!==n.length&&8!==n.length)throw new RangeError("Salt must be at least 8 bytes.");const f=t.alloc(s),a=t.alloc(o);let c=t.alloc(0),h=0,u=0;for(;h<s||u<o;){let t=0;if(c=e.multi(c,r,n),h<s){const e=Math.min(s-h,c.length-t);c.copy(f,h,t,t+e),h+=e,t+=e}if(u<o){const e=Math.min(o-u,c.length-t);c.copy(a,u,t,t+e),u+=e,t+=e}}return[f,a]}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * ecies.js - ecies for javascript (crypto_secretbox_xsalsa20poly1305)
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Integrated_Encryption_Scheme
 *   https://nacl.cr.yp.to/secretbox.html
 */
const i=r(1),n=r(26),s=r(5);e.encrypt=function(e,r,o,f,a=null){i(e&&"string"==typeof e.id),null==a&&(a=e.privateKeyGenerate());const c=e.publicKeyCreate(a),h=e.derive(f,a),u=n.derive(h,r),d=s.randomBytes(24),l=n.seal(o,u,d);return t.concat([c,d,l])},e.decrypt=function(e,r,s,o){i(e&&"string"==typeof e.id),i(t.isBuffer(s));const f="ecdsa"===e.type?1+e.size:e.size;if(s.length<f+24)throw new Error("Invalid ciphertext.");const a=s.slice(0,f),c=s.slice(f,f+24),h=s.slice(f+24),u=e.derive(a,o),d=n.derive(u,r);return n.open(h,d,c)}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * ed25519.js - ed25519 for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/EdDSA#Ed25519
 *   https://ed25519.cr.yp.to/ed25519-20110926.pdf
 *   https://tools.ietf.org/html/rfc8032#section-5.1
 */const i=r(88),n=r(23),s=r(81);t.exports=new i("ED25519","X25519",null,n,s)},function(t,e,r){"use strict";
/*!
 * ed448.js - ed448 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(216)},function(t,e,r){"use strict";
/*!
 * ed448.js - ed448 for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://eprint.iacr.org/2015/625.pdf
 *   https://tools.ietf.org/html/rfc8032#section-5.2
 */const i=r(88),n=r(38);t.exports=new i("ED448","X448","MONT448",n)},function(t,e,r){"use strict";
/*!
 * index.js - encoding for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */e.asn1=r(14),e.base16=r(220),e.base32=r(222),e.base58=r(224),e.base64=r(40),e.bech32=r(227),e.cash32=r(229),e.lines=r(93),e.openssl=r(94),e.pem=r(9),e.pemcrypt=r(95),e.pkcs1=r(97),e.pkcs3=r(231),e.pkcs5=r(232),e.pkcs8=r(233),e.rfc3279=r(234),e.sec1=r(99),e.util=r(37),e.x509=r(98)},function(t,e,r){"use strict";(function(e){
/*!
 * struct.js - struct object for bcoin
 * Copyright (c) 2018, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */
const i=r(20),n=r(90),s=r(91),o=r(92),{custom:f}=r(89);t.exports=class{constructor(){}inject(t){return i(t instanceof this.constructor,"obj","struct"),this.decode(t.encode())}clone(){return(new this.constructor).inject(this)}getSize(t){return-1}write(t,e){return t}read(t,e){return this}toString(){return Object.prototype.toString.call(this)}fromString(t,e){return this}getJSON(){return this}fromJSON(t,e){return this}fromOptions(t,e){return this}from(t,e){return this.fromOptions(t,e)}format(){return this.getJSON()}encode(t){const e=this.getSize(t),r=-1===e?new s:new o(e);return this.write(r,t),r.render()}decode(t,e){const r=new n(t);return this.read(r,e),this}toHex(t){return this.encode(t).toString("hex")}fromHex(t,r){i("string"==typeof t,"str","string");const n=t.length>>>1,s=e.from(t,"hex");if(s.length!==n)throw new Error("Invalid hex string.");return this.decode(s,r)}toBase64(t){return this.encode(t).toString("base64")}fromBase64(t,r){i("string"==typeof t,"str","string");const n=e.from(t,"base64");if(t.length>(4*n.length/3+3&-4)>>>0)throw new Error("Invalid base64 string.");return this.decode(n,r)}toJSON(){return this.getJSON()}[f](){return this.format()}static read(t,e){return(new this).read(t,e)}static decode(t,e){return(new this).decode(t,e)}static fromHex(t,e){return(new this).fromHex(t,e)}static fromBase64(t,e){return(new this).fromBase64(t,e)}static fromString(t,e){return(new this).fromString(t,e)}static fromJSON(t,e){return(new this).fromJSON(t,e)}static fromOptions(t,e){return(new this).fromOptions(t,e)}static from(t,e){return(new this).from(t,e)}toWriter(t,e){return this.write(t,e)}fromReader(t,e){return this.read(t,e)}toRaw(t){return this.encode(t)}fromRaw(t,e){return this.decode(t,e)}static fromReader(t,e){return this.read(t,e)}static fromRaw(t,e){return this.decode(t,e)}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * objects.js - OIDs encoding for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009, The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Resources:
 *   https://www.ietf.org/rfc/rfc2459.txt
 *   https://tools.ietf.org/html/rfc3279
 *   http://oid-info.com/get/1.2.840.10040.4
 *   http://oid-info.com/get/1.2.840.113549.1.1
 *   http://oid-info.com/get/1.2.840.10045.4.3
 *   https://tools.ietf.org/html/draft-jivsov-openpgp-sha3-01
 *   https://github.com/golang/go/blob/master/src/crypto/x509/x509.go
 *   https://github.com/golang/go/blob/master/src/crypto/x509/pkix/pkix.go
 *   https://tools.ietf.org/html/draft-josefsson-pkix-eddsa-01
 *   https://tools.ietf.org/html/rfc5480
 *   https://tools.ietf.org/html/draft-josefsson-pkix-newcurves-00
 *   https://tools.ietf.org/id/draft-ietf-curdle-pkix-06.html
 *   https://tools.ietf.org/html/rfc7693
 */const i={COUNTRY:"2.5.4.6",ORGANIZATION:"2.5.4.10",ORGANIZATIONALUNIT:"2.5.4.11",COMMONNAME:"2.5.4.3",SERIALNUMBER:"2.5.4.5",LOCALITY:"2.5.4.7",PROVINCE:"2.5.4.8",STREETADDRESS:"2.5.4.9",POSTALCODE:"2.5.4.17"},n={[i.COUNTRY]:"COUNTRY",[i.ORGANIZATION]:"ORGANIZATION",[i.ORGANIZATIONALUNIT]:"ORGANIZATIONALUNIT",[i.COMMONNAME]:"COMMONNAME",[i.SERIALNUMBER]:"SERIALNUMBER",[i.LOCALITY]:"LOCALITY",[i.PROVINCE]:"PROVINCE",[i.STREETADDRESS]:"STREETADDRESS",[i.POSTALCODE]:"POSTALCODE"},s={DH:"1.2.840.113549.1.3.1",DSA:"1.2.840.10040.4.1",DSA_ALT:"1.2.840.10040.4.2",RSA:"1.2.840.113549.1.1.1",ECDSA:"1.2.840.10045.2.1",EDDSA:"1.3.6.1.4.1.11591.4.12.1"},o={[s.DH]:"DH",[s.DSA]:"DSA",[s.DSA_ALT]:"DSA",[s.RSA]:"RSA",[s.ECDSA]:"ECDSA",[s.EDDSA]:"EDDSA"},f={BLAKE2B160:"1.3.6.1.4.1.1722.12.2.1.5",BLAKE2B256:"1.3.6.1.4.1.1722.12.2.1.8",BLAKE2B384:"1.3.6.1.4.1.1722.12.2.1.12",BLAKE2B512:"1.3.6.1.4.1.1722.12.2.1.16",BLAKE2S128:"1.3.6.1.4.1.1722.12.2.2.4",BLAKE2S160:"1.3.6.1.4.1.1722.12.2.2.5",BLAKE2S224:"1.3.6.1.4.1.1722.12.2.2.7",BLAKE2S256:"1.3.6.1.4.1.1722.12.2.2.8",GOST94:"1.2.643.2.2.20",MD2:"1.2.840.113549.2.2",MD4:"1.2.840.113549.2.4",MD5:"1.2.840.113549.2.5",MDC2:"1.3.14.3.2.19",RIPEMD160:"1.0.10118.3.0.49",RIPEMD160_ALT:"1.3.36.3.2.1",SHA1:"1.3.14.3.2.26",SHA224:"2.16.840.1.101.3.4.2.4",SHA256:"2.16.840.1.101.3.4.2.1",SHA384:"2.16.840.1.101.3.4.2.2",SHA512:"2.16.840.1.101.3.4.2.3",SHA3_224:"2.16.840.1.101.3.4.2.7",SHA3_256:"2.16.840.1.101.3.4.2.8",SHA3_384:"2.16.840.1.101.3.4.2.9",SHA3_512:"2.16.840.1.101.3.4.2.10",SHAKE128:"2.16.840.1.101.3.4.2.11",SHAKE256:"2.16.840.1.101.3.4.2.12",SM3:"1.0.10118.3.0.65",WHIRLPOOL:"1.0.10118.3.0.55"},a={[f.BLAKE2B160]:"BLAKE2B160",[f.BLAKE2B256]:"BLAKE2B256",[f.BLAKE2B384]:"BLAKE2B384",[f.BLAKE2B512]:"BLAKE2B512",[f.BLAKE2S128]:"BLAKE2S128",[f.BLAKE2S160]:"BLAKE2S160",[f.BLAKE2S224]:"BLAKE2S224",[f.BLAKE2S256]:"BLAKE2S256",[f.GOST94]:"GOST94",[f.MD2]:"MD2",[f.MD4]:"MD4",[f.MD5]:"MD5",[f.MDC2]:"MDC2",[f.RIPEMD160]:"RIPEMD160",[f.RIPEMD160_ALT]:"RIPEMD160",[f.SHA1]:"SHA1",[f.SHA224]:"SHA224",[f.SHA256]:"SHA256",[f.SHA384]:"SHA384",[f.SHA512]:"SHA512",[f.SHA3_224]:"SHA3_224",[f.SHA3_256]:"SHA3_256",[f.SHA3_384]:"SHA3_384",[f.SHA3_512]:"SHA3_512",[f.SHAKE128]:"SHAKE128",[f.SHAKE256]:"SHAKE256",[f.SM3]:"SM3",[f.WHIRLPOOL]:"WHIRLPOOL"},c={P192:"1.2.840.10045.3.1.1",P224:"1.3.132.0.33",P256:"1.2.840.10045.3.1.7",P384:"1.3.132.0.34",P521:"1.3.132.0.35",BRAINPOOLP256:"1.3.36.3.3.2.8.1.1.7",BRAINPOOLP384:"1.3.36.3.3.2.8.1.1.11",BRAINPOOLP512:"1.3.36.3.3.2.8.1.1.13",SECP192K1:"1.3.132.0.31",SECP224K1:"1.3.132.0.32",SECP256K1:"1.3.132.0.10",FRP256V1:"1.2.250.1.223.101.256.1",X25519:"1.3.101.110",X25519_ALT:"1.3.6.1.4.1.11591.7",ED25519:"1.3.101.112",X448:"1.3.101.111",X448_ALT:"1.3.6.1.4.1.11591.8",ED448:"1.3.101.113",ED1174:"1.3.6.1.4.1.9509.5.2.6",ED41417:"1.3.6.1.4.1.9509.5.2.5",CURVE383187:"1.3.6.1.4.1.9509.5.1.4",M221:"1.3.6.1.4.1.9509.5.1.1",E222:"1.3.6.1.4.1.9509.5.2.1",M383:"1.3.6.1.4.1.9509.5.1.2",E382:"1.3.6.1.4.1.9509.5.2.2",M511:"1.3.6.1.4.1.9509.5.1.3",E521:"1.3.6.1.4.1.9509.5.2.4"},h={[c.P192]:"P192",[c.P224]:"P224",[c.P256]:"P256",[c.P384]:"P384",[c.P521]:"P521",[c.BRAINPOOLP256]:"BRAINPOOLP256",[c.BRAINPOOLP384]:"BRAINPOOLP384",[c.BRAINPOOLP512]:"BRAINPOOLP512",[c.SECP192K1]:"SECP192K1",[c.SECP224K1]:"SECP224K1",[c.SECP256K1]:"SECP256K1",[c.FRP256V1]:"FRP256V1",[c.X25519]:"X25519",[c.X25519_ALT]:"X25519",[c.ED25519]:"ED25519",[c.X448]:"X448",[c.X448_ALT]:"X448",[c.ED448]:"ED448",[c.ED1174]:"ED1174",[c.ED41417]:"ED41417",[c.CURVE383187]:"CURVE383187",[c.M221]:"M221",[c.E222]:"E222",[c.M383]:"M383",[c.E382]:"E382",[c.M511]:"M511",[c.E521]:"E521"},u={DSASHA1:"1.2.840.10040.4.3",RSAMD2:"1.2.840.113549.1.1.2",RSAMD4:"1.2.840.113549.1.1.3",RSAMD5:"1.2.840.113549.1.1.4",RSASHA1:"1.2.840.113549.1.1.5",RSASHA1_MS:"1.3.14.3.2.29",RSAPSS:"1.2.840.113549.1.1.10",RSASHA256:"1.2.840.113549.1.1.11",RSASHA384:"1.2.840.113549.1.1.12",RSASHA512:"1.2.840.113549.1.1.13",RSASHA224:"1.2.840.113549.1.1.14",MGF1:"1.2.840.113549.1.1.8",RSASHA3_256:"2.16.840.1.101.3.4.2.8",RSASHA3_384:"2.16.840.1.101.3.4.2.9",RSASHA3_512:"2.16.840.1.101.3.4.2.10",ECDSASHA1:"1.2.840.10045.4.1",ECDSASHA224:"1.2.840.10045.4.3.1",ECDSASHA256:"1.2.840.10045.4.3.2",ECDSASHA384:"1.2.840.10045.4.3.3",ECDSASHA512:"1.2.840.10045.4.3.4",EDDSA:"1.3.6.1.4.1.11591.4.12.2"},d={[u.DSASHA1]:"DSASHA1",[u.RSAMD2]:"RSAMD2",[u.RSAMD4]:"RSAMD4",[u.RSAMD5]:"RSAMD5",[u.RSASHA1]:"RSASHA1",[u.RSASHA1_MS]:"RSASHA1",[u.RSAPSS]:"RSAPSS",[u.RSASHA256]:"RSASHA256",[u.RSASHA384]:"RSASHA384",[u.RSASHA512]:"RSASHA512",[u.MGF1]:"MGF1",[u.RSASHA3_256]:"RSASHA3_256",[u.RSASHA3_384]:"RSASHA3_384",[u.RSASHA3_512]:"RSASHA3_512",[u.ECDSASHA1]:"ECDSASHA1",[u.ECDSASHA224]:"ECDSASHA224",[u.ECDSASHA384]:"ECDSASHA384",[u.ECDSASHA512]:"ECDSASHA512",[u.EDDSA]:"EDDSA"},l={[u.DSASHA1]:f.SHA1,[u.RSAMD2]:f.MD2,[u.RSAMD4]:f.MD4,[u.RSAMD5]:f.MD5,[u.RSASHA1]:f.SHA1,[u.RSASHA1_MS]:f.SHA1,[u.RSAPSS]:null,[u.RSASHA256]:f.SHA256,[u.RSASHA384]:f.SHA384,[u.RSASHA512]:f.SHA512,[u.MGF1]:null,[u.RSASHA3_256]:f.SHA3_256,[u.RSASHA3_384]:f.SHA3_384,[u.RSASHA3_512]:f.SHA3_512,[u.ECDSASHA1]:f.SHA1,[u.ECDSASHA224]:f.SHA224,[u.ECDSASHA384]:f.SHA384,[u.ECDSASHA512]:f.SHA512,[u.EDDSA]:null};e.NONE="0.0",e.attrs=i,e.attrsByVal=n,e.keyAlgs=s,e.keyAlgsByVal=o,e.hashes=f,e.hashesByVal=a,e.curves=c,e.curvesByVal=h,e.sigAlgs=u,e.sigAlgsByVal=d,e.sigToHash=l},function(t,e,r){"use strict";
/*!
 * base16.js - base16 for bcrypto
 * Copyright (c) 2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(221)},function(t,e,r){"use strict";(function(t){
/*!
 * base16.js - base16 for javascript
 * Copyright (c) 2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://tools.ietf.org/html/rfc4648
 */
const i=r(1),n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];function s(e,r){i(t.isBuffer(e));let n=e.length,s=r<0?n-1:0,o="";for(;n--;)o+="0123456789abcdef"[e[s]>>4],o+="0123456789abcdef"[15&e[s]],s+=r;return o}function o(e,r){i("string"==typeof e);let s=e.length,o=r<0?s-2:0,f=0,a=0;if(1&s)throw new Error("Invalid hex string.");s>>>=1,r*=2;const c=t.alloc(s);for(;s--;){const t=e.charCodeAt(o+0),i=e.charCodeAt(o+1),s=n[127&t],h=n[127&i];a|=t|i|s|h,c[f++]=s<<4|h,o+=r}if(4294967168&a)throw new Error("Invalid hex string.");return c}function f(t){if(i("string"==typeof t),1&t.length)return!1;for(let e=0;e<t.length;e++){const r=t.charCodeAt(e);if(65408&r)return!1;if(-1===n[r])return!1}return!0}e.native=0,e.encode=function(t){return s(t,1)},e.decode=function(t){return o(t,1)},e.test=function(t){return f(t)},e.encodeLE=function(t){return s(t,-1)},e.decodeLE=function(t){return o(t,-1)},e.testLE=function(t){return f(t)}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * base32.js - base32 for bcrypto
 * Copyright (c) 2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(223)},function(t,e,r){"use strict";(function(t){
/*!
 * base32.js - base32 for bcrypto
 * Copyright (c) 2014-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on bitcoin/bitcoin:
 *   Copyright (c) 2009-2019, The Bitcoin Core Developers (MIT License).
 *   Copyright (c) 2009-2019, The Bitcoin Developers (MIT License).
 *   https://github.com/bitcoin/bitcoin
 *
 * Resources:
 *   https://tools.ietf.org/html/rfc4648
 *   https://github.com/bitcoin/bitcoin/blob/11d486d/src/utilstrencodings.cpp#L230
 */
const i=r(1),n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1],s=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,-1,-1,-1,-1,-1,-1,-1,-1,-1],o=[0,6,4,3,1];function f(e,r,n){i(t.isBuffer(e)),i("boolean"==typeof n);let s="",f=0,a=0;for(let t=0;t<e.length;t++){const i=e[t];switch(f){case 0:s+=r[i>>>3],a=(7&i)<<2,f=1;break;case 1:s+=r[a|i>>>6],s+=r[i>>>1&31],a=(1&i)<<4,f=2;break;case 2:s+=r[a|i>>>4],a=(15&i)<<1,f=3;break;case 3:s+=r[a|i>>>7],s+=r[i>>>2&31],a=(3&i)<<3,f=4;break;case 4:s+=r[a|i>>>5],s+=r[31&i],f=0}}if(f>0&&(s+=r[a],n))for(let t=0;t<o[f];t++)s+="=";return s}function a(e,r,n){i("string"==typeof e),i("boolean"==typeof n);const s=function(t){let e=t.length;for(let r=0;r<6&&e>0;r++)"="===t[e-1]&&(e-=1);let r=5*(e>>>3);switch(7&e){case 7:r+=1;case 6:case 5:r+=1;case 4:r+=1;case 3:case 2:r+=1}return r}(e),o=t.alloc(s);let f=0,a=0,c=0,h=0;for(;h<e.length;h++){const t=e.charCodeAt(h);if(65408&t)throw new Error("Invalid base32 string.");const i=r[t];if(-1===i)break;switch(f){case 0:a=i,f=1;break;case 1:o[c++]=a<<3|i>>>2,a=3&i,f=2;break;case 2:a=a<<5|i,f=3;break;case 3:o[c++]=a<<1|i>>>4,a=15&i,f=4;break;case 4:o[c++]=a<<4|i>>>1,a=1&i,f=5;break;case 5:a=a<<5|i,f=6;break;case 6:o[c++]=a<<2|i>>>3,a=7&i,f=7;break;case 7:o[c++]=a<<5|i,a=0,f=0}}if(1===f||3===f||6===f)throw new Error("Invalid base32 string.");if(a>0)throw new Error("Invalid base32 string.");if(e.length!==h+(7&-f)*n)throw new Error("Invalid base32 string.");for(;h<e.length;h++){if(61!==e.charCodeAt(h))throw new Error("Invalid base32 string.")}return i(c===s),o}function c(t,e,r){i("string"==typeof t),i("boolean"==typeof r);let n=0;for(;n<t.length;n++){const r=t.charCodeAt(n);if(65408&r)return!1;if(-1===e[r])break}const s=7&n;switch(s){case 1:return!1;case 2:if(3&e[t.charCodeAt(n-1)])return!1;break;case 3:return!1;case 4:if(15&e[t.charCodeAt(n-1)])return!1;break;case 5:if(1&e[t.charCodeAt(n-1)])return!1;break;case 6:return!1;case 7:if(7&e[t.charCodeAt(n-1)])return!1}if(t.length!==n+(7&-s)*r)return!1;for(;n<t.length;n++){if(61!==t.charCodeAt(n))return!1}return!0}e.native=0,e.encode=function(t,e=!1){return f(t,"abcdefghijklmnopqrstuvwxyz234567",e)},e.decode=function(t,e=!1){return a(t,n,e)},e.test=function(t,e=!1){return c(t,n,e)},e.encodeHex=function(t,e=!1){return f(t,"0123456789abcdefghijklmnopqrstuv",e)},e.decodeHex=function(t,e=!1){return a(t,s,e)},e.testHex=function(t,e=!1){return c(t,s,e)}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * base58.js - base58 for bcrypto
 * Copyright (c) 2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(225)},function(t,e,r){"use strict";(function(t){
/*!
 * base58.js - base58 for bcrypto
 * Copyright (c) 2014-2015, Fedor Indutny (MIT License)
 * Copyright (c) 2014-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on bitcoin/bitcoin:
 *   Copyright (c) 2009-2019, The Bitcoin Core Developers (MIT License).
 *   Copyright (c) 2009-2019, The Bitcoin Developers (MIT License).
 *   https://github.com/bitcoin/bitcoin
 *
 * Resources:
 *   https://github.com/bitcoin/bitcoin/blob/master/src/base58.cpp
 */
const i=r(1),n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,-1,-1,-1,-1,-1,-1,-1,9,10,11,12,13,14,15,16,-1,17,18,19,20,21,-1,22,23,24,25,26,27,28,29,30,31,32,-1,-1,-1,-1,-1,-1,33,34,35,36,37,38,39,40,41,42,43,-1,44,45,46,47,48,49,50,51,52,53,54,55,56,57,-1,-1,-1,-1,-1],s=t.alloc(128);e.native=0,e.encode=function(e){i(t.isBuffer(e));let r=0,n=0;for(;n<e.length&&0===e[n];n++)r+=1;const o=1+(138*(e.length-r)/100|0),f=o<=128?s.fill(0):t.alloc(o);let a=0;for(;n<e.length;n++){let t=e[n],r=0;for(let e=o-1;e>=0&&!(0===t&&r>=a);e--,r++)t+=256*f[e],f[e]=t%58,t=t/58|0;i(0===t),a=r}for(n=o-a;n<o&&0===f[n];)n+=1;let c="";for(let t=0;t<r;t++)c+="1";for(;n<o;)c+="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"[f[n++]];return c},e.decode=function(e){i("string"==typeof e);let r=0,o=0;for(;o<e.length&&"1"===e[o];o++)r+=1;const f=1+(733*e.length/1e3|0),a=f<=128?s.fill(0):t.alloc(f);let c=0;for(;o<e.length;o++){const t=e.charCodeAt(o);if(65408&t)throw new Error("Invalid base58 string.");const r=n[t];if(-1===r)throw new Error("Invalid base58 string.");let s=r,h=0;for(let t=f-1;t>=0&&!(0===s&&h>=c);t--,h++)s+=58*a[t],a[t]=s,s>>>=8;i(0===s),c=h}o=f-c;const h=t.alloc(r+(f-o));let u;for(u=0;u<r;u++)h[u]=0;for(;o<f;)h[u++]=a[o++];return h},e.test=function(t){i("string"==typeof t);for(let e=0;e<t.length;e++){const r=t.charCodeAt(e);if(65408&r)return!1;if(-1===n[r])return!1}return!0}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * base64.js - base64 for javascript
 * Copyright (c) 2019-2020, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://tools.ietf.org/html/rfc4648
 */
const i=r(1),n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],s=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,63,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];function o(e,r,n){i(t.isBuffer(e));let s=e.length,o="",f=0;for(;s>=3;){const t=e[f++],i=e[f++],n=e[f++];o+=r[t>>2],o+=r[(3&t)<<4|i>>4],o+=r[(15&i)<<2|n>>6],o+=r[63&n],s-=3}switch(s){case 1:{const t=e[f++];o+=r[t>>2],o+=r[(3&t)<<4],n&&(o+="==");break}case 2:{const t=e[f++],i=e[f++];o+=r[t>>2],o+=r[(3&t)<<4|i>>4],o+=r[(15&i)<<2],n&&(o+="=");break}}return o}function f(e,r,n){i("string"==typeof e);const s=t.alloc(n);let o=e.length,f=0,a=0;if(o>0&&"="===e[o-1]&&(o-=1),o>0&&"="===e[o-1]&&(o-=1),1==(3&o))throw new Error("Invalid base64 string.");for(;o>=4;){const t=e.charCodeAt(f++),i=e.charCodeAt(f++),n=e.charCodeAt(f++),c=e.charCodeAt(f++);if(65408&(t|i|n|c))throw new Error("Invalid base64 string.");const h=r[t],u=r[i],d=r[n],l=r[c];if((h|u|d|l)<0)throw new Error("Invalid base64 string.");s[a++]=h<<2|u>>4,s[a++]=u<<4|d>>2,s[a++]=d<<6|l>>0,o-=4}switch(o){case 1:throw new Error("Invalid base64 string.");case 2:{const t=e.charCodeAt(f++),i=e.charCodeAt(f++);if(65408&(t|i))throw new Error("Invalid base64 string.");const n=r[t],o=r[i];if((n|o)<0)throw new Error("Invalid base64 string.");if(s[a++]=n<<2|o>>4,15&o)throw new Error("Invalid base64 string.");break}case 3:{const t=e.charCodeAt(f++),i=e.charCodeAt(f++),n=e.charCodeAt(f++);if(65408&(t|i|n))throw new Error("Invalid base64 string.");const o=r[t],c=r[i],h=r[n];if((o|c|h)<0)throw new Error("Invalid base64 string.");if(s[a++]=o<<2|c>>4,s[a++]=c<<4|h>>2,3&h)throw new Error("Invalid base64 string.");break}}return i(a===n),s}function a(t,e){i("string"==typeof t);let r=t.length;if(r>0&&"="===t[r-1]&&(r-=1),r>0&&"="===t[r-1]&&(r-=1),1==(3&r))return!1;for(let i=0;i<r;i++){const r=t.charCodeAt(i);if(65408&r)return!1;if(-1===e[r])return!1}switch(3&r){case 1:return!1;case 2:return 0==(15&e[t.charCodeAt(r-1)]);case 3:return 0==(3&e[t.charCodeAt(r-1)])}return!0}function c(t){i("string"==typeof t);let e=t.length;e>0&&"="===t[e-1]&&(e-=1),e>0&&"="===t[e-1]&&(e-=1);let r=3*(e>>>2);const n=3&e;return n&&(r+=n-1),r}function h(t,e){switch(i("string"==typeof t),e%3){case 0:return 0===t.length||(1===t.length?"="!==t[0]:"="!==t[t.length-2]&&"="!==t[t.length-1]);case 1:return t.length>=4&&"="===t[t.length-2]&&"="===t[t.length-1];case 2:return t.length>=4&&"="!==t[t.length-2]&&"="===t[t.length-1];default:throw new Error("unreachable")}}e.native=0,e.encode=function(t){return o(t,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",!0)},e.decode=function(t){const e=c(t);if(!h(t,e))throw new Error("Invalid base64 padding.");return f(t,n,e)},e.test=function(t){return!!h(t,c(t))&&a(t,n)},e.encodeURL=function(t){return o(t,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",!1)},e.decodeURL=function(t){const e=c(t);if(!h(t,0))throw new Error("Invalid base64 padding.");return f(t,s,e)},e.testURL=function(t){return!!h(t,0)&&a(t,s)}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * bech32.js - bech32 for bcrypto
 * Copyright (c) 2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(228)},function(t,e,r){"use strict";(function(t){
/*!
 * bech32.js - bech32 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on sipa/bech32:
 *   Copyright (c) 2017, Pieter Wuille (MIT License).
 *   https://github.com/sipa/bech32
 *
 * Resources:
 *   https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki
 *   https://github.com/sipa/bech32/blob/master/ref/c/segwit_addr.c
 *   https://github.com/bitcoin/bitcoin/blob/master/src/bech32.cpp
 */
const i=r(1),n=t.alloc(65),s="qpzry9x8gf2tvdw0s3jn54khce6mua7l",o=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,15,-1,10,17,21,20,26,30,7,5,-1,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1];function f(t){const e=t>>>25;return(33554431&t)<<5^996825010&-(e>>0&1)^642813549&-(e>>1&1)^513874426&-(e>>2&1)^1027748829&-(e>>3&1)^705979059&-(e>>4&1)}function a(e,r){if(i("string"==typeof e),i(t.isBuffer(r)),0===e.length||e.length>83)throw new Error("Invalid bech32 human-readable part.");if(e.length+1+r.length+6>90)throw new Error("Invalid bech32 data length.");let n,o="",a=1;for(n=0;n<e.length;n++){const t=e.charCodeAt(n);if(t<33||t>126)throw new Error("Invalid bech32 character.");if(t>=65&&t<=90)throw new Error("Invalid bech32 character.");a=f(a)^t>>5}a=f(a);for(let t=0;t<e.length;t++){const r=e.charCodeAt(t);a=f(a)^31&r,o+=e[t]}o+="1";for(let t=0;t<r.length;t++){const e=r[t];if(e>>5)throw new Error("Invalid bech32 value.");a=f(a)^e,o+=s[e]}for(let t=0;t<6;t++)a=f(a);a^=1;for(let t=0;t<6;t++)o+=s[a>>>5*(5-t)&31];return o}function c(e){if(i("string"==typeof e),e.length<8||e.length>90)throw new Error("Invalid bech32 string length.");let r=!1,n=!1,s=0;for(let t=0;t<e.length;t++){const i=e.charCodeAt(t);if(i<33||i>126)throw new Error("Invalid bech32 character.");i>=97&&i<=122?r=!0:i>=65&&i<=90?n=!0:49===i&&(s=t)}if(0===s)throw new Error("Invalid bech32 human-readable part.");const a=e.length-(s+1);if(a<6)throw new Error("Invalid bech32 data length.");if(r&&n)throw new Error("Invalid bech32 casing.");let c=1,h="";for(let t=0;t<s;t++){let r=e.charCodeAt(t);r>=65&&r<=90&&(r+=32),c=f(c)^r>>5,h+=String.fromCharCode(r)}c=f(c);for(let t=0;t<s;t++)c=f(c)^31&e.charCodeAt(t);const u=t.alloc(a-6);let d=0;for(let t=s+1;t<e.length;t++){const r=o[e.charCodeAt(t)];if(-1===r)throw new Error("Invalid bech32 character.");c=f(c)^r,t<e.length-6&&(u[d++]=r)}if(1!==c)throw new Error("Invalid bech32 checksum.");return i(d===u.length),[h,u]}function h(e,r,n,s,o,f,a){i(t.isBuffer(e)),i(r>>>0===r),i(n>>>0===n),i(t.isBuffer(s)),i(o>>>0===o),i(f>>>0===f),i("boolean"==typeof a),i(n>=1&&n<=8),i(f>=1&&f<=8);const c=(1<<n)-1;let h=0,u=0,d=o,l=r;for(;d<s.length;d++)for(h=h<<f|s[d],u+=f;u>=n;)u-=n,e[l++]=h>>>u&c;const b=n-u;if(a)u&&(e[l++]=h<<b&c);else if(h<<b&c||u>=f)throw new Error("Invalid bits.");return i(l<=e.length),e.slice(0,l)}function u(t){const[e,r]=c(t);if(0===r.length||r.length>65)throw new Error("Invalid bech32 data length.");const i=r[0];if(i>31)throw new Error("Invalid bech32 version.");const n=h(r,0,8,r,1,5,!1);if(n.length<2||n.length>40)throw new Error("Invalid bech32 data length.");return[e,i,n]}e.native=0,e.serialize=a,e.deserialize=c,e.is=function(t){i("string"==typeof t);try{return c(t),!0}catch(t){return!1}},e.convertBits=function(e,r,n,s){i(t.isBuffer(e));const o=function(t,e,r,n){return i(t>>>0===t),i(e>>>0===e),i(r>>>0===r),i("boolean"==typeof n),i(e>=1&&e<=8),i(r>=1&&r<=8),(t*e+(r-1)*(0|n))/r>>>0}(e.length,r,n,s);return h(t.alloc(o),0,n,e,0,r,s)},e.encode=function(e,r,s){if(i("string"==typeof e),i(r>>>0===r),i(t.isBuffer(s)),r>31)throw new Error("Invalid bech32 version.");if(s.length<2||s.length>40)throw new Error("Invalid bech32 data length.");const o=n;return o[0]=r,a(e,h(o,1,5,s,0,8,!0))},e.decode=u,e.test=function(t){i("string"==typeof t);try{return u(t),!0}catch(t){return!1}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * cash32.js - cashaddr for bcrypto
 * Copyright (c) 2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(230)},function(t,e,r){"use strict";(function(t){
/*!
 * cash32.js - cashaddr for bcrypto
 * Copyright (c) 2018-2020, The Bcoin Developers (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on Bitcoin-ABC/bitcoin-abc:
 *   Copyright (c) 2009-2019, The Bitcoin Developers (MIT License).
 *   Copyright (c) 2009-2017, The Bitcoin Core Developers (MIT License).
 *   https://github.com/Bitcoin-ABC/bitcoin-abc
 *
 * Parts of this software are based on sipa/bech32:
 *   Copyright (c) 2017, Pieter Wuille (MIT License).
 *   https://github.com/sipa/bech32
 *
 * Resources:
 *   https://github.com/bitcoincashorg/bitcoincash.org/blob/master/spec/cashaddr.md
 *   https://github.com/Bitcoin-ABC/bitcoin-abc/blob/master/src/cashaddr.cpp
 *   https://github.com/Bitcoin-ABC/bitcoin-abc/blob/master/src/cashaddrenc.cpp
 *   https://github.com/Bitcoin-ABC/bitcoin-abc/blob/master/src/util/strencodings.h
 */
const i=r(1),n=t.alloc(104),s="qpzry9x8gf2tvdw0s3jn54khce6mua7l",o=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,15,-1,10,17,21,20,26,30,7,5,-1,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1];function f(t,e){const r=t[1]>>>3;t[0]&=4294967295,t[1]&=7,t[1]<<=5,t[1]|=t[0]>>>27,t[0]<<=5,r>>>0&1&&(t[0]^=4072443489,t[1]^=152),r>>>1&1&&(t[0]^=3077413346,t[1]^=121),r>>>2&1&&(t[0]^=1046459332,t[1]^=243),r>>>3&1&&(t[0]^=783016616,t[1]^=174),r>>>4&1&&(t[0]^=1329849456,t[1]^=30),t[0]^=e}function a(e,r){if(i("string"==typeof e),i(t.isBuffer(r)),0===e.length||e.length>83)throw new Error("Invalid cash32 prefix.");if(r.length>104)throw new Error("Invalid cash32 data.");const n=[1,0];let o="";for(let t=0;t<e.length;t++){const r=e.charCodeAt(t);if(r<97||r>122)throw new Error("Invalid cash32 prefix.");f(n,31&r),o+=String.fromCharCode(r)}f(n,0),o+=":";for(let t=0;t<r.length;t++){const e=r[t];if(e>>5)throw new Error("Invalid cash32 value.");f(n,e),o+=s[e]}for(let t=0;t<8;t++)f(n,0);n[0]^=1,o+=s[n[1]>>>3&31],o+=s[31&(n[0]>>>30|n[1]<<2)];for(let t=2;t<8;t++)o+=s[n[0]>>>5*(7-t)&31];return o}function c(e,r){if(i("string"==typeof e),i("string"==typeof r),e.length<8||e.length>196)throw new Error("Invalid cash32 string.");let n=!1,s=!1,a=!1,c=0;for(let t=0;t<e.length;t++){const r=e.charCodeAt(t);if(r>=97&&r<=122)n=!0;else if(r>=65&&r<=90)s=!0;else if(r>=48&&r<=57)a=!0;else{if(58!==r)throw new Error("Invalid cash32 string.");if(a||0===t||0!==c)throw new Error("Invalid cash32 prefix.");c=t}}if(n&&s)throw new Error("Invalid cash32 casing.");const h=[1,0];let u,d="";if(0===c){if(0===r.length||r.length>83)throw new Error("Invalid cash32 prefix.");for(let t=0;t<r.length;t++){const e=r.charCodeAt(t);if(e<97||e>122)throw new Error("Invalid cash32 prefix.");f(h,31&e)}d=r,u=e.length}else{if(c>83)throw new Error("Invalid cash32 prefix.");for(let t=0;t<c;t++){const r=32|e.charCodeAt(t);f(h,31&r),d+=String.fromCharCode(r)}u=e.length-(c+1)}if(u<8||u>112)throw new Error("Invalid cash32 data.");f(h,0);const l=t.alloc(u-8);let b=0;for(let t=e.length-u;t<e.length;t++){const r=o[e.charCodeAt(t)];if(-1===r)throw new Error("Invalid cash32 character.");f(h,r),t<e.length-8&&(l[b++]=r)}if(1!==h[0]||0!==h[1])throw new Error("Invalid cash32 checksum.");return i(b===l.length),[d,l]}function h(e,r,n,s,o,f,a){i(t.isBuffer(e)),i(r>>>0===r),i(n>>>0===n),i(t.isBuffer(s)),i(o>>>0===o),i(f>>>0===f),i("boolean"==typeof a),i(n>=1&&n<=8),i(f>=1&&f<=8);const c=(1<<n)-1,h=(1<<f+n-1)-1;let u=0,d=0,l=o,b=r;for(;l<s.length;l++)for(u=(u<<f|s[l])&h,d+=f;d>=n;)d-=n,e[b++]=u>>>d&c;const p=n-d;if(a)d&&(e[b++]=u<<p&c);else if(d>=f||u<<p&c)throw new Error("Invalid bits.");return i(b<=e.length),e.slice(0,b)}function u(t,e="bitcoincash"){const[r,i]=c(t,e);if(r!==e)throw new Error("Invalid cash32 prefix.");if(0===i.length||i.length>104)throw new Error("Invalid cash32 data.");const n=h(i,0,8,i,0,5,!1);if(0===n.length||n.length>65)throw new Error("Invalid cash32 data.");const s=n[0]>>3&31,o=n.slice(1);let f=20+4*(3&n[0]);if(4&n[0]&&(f*=2),s>15)throw new Error("Invalid cash32 type.");if(f!==o.length)throw new Error("Invalid cash32 data length.");return[s,o]}e.native=0,e.serialize=a,e.deserialize=c,e.is=function(t,e){i("string"==typeof t),i("string"==typeof e);try{return c(t,e),!0}catch(t){return!1}},e.convertBits=function(e,r,n,s){i(t.isBuffer(e));const o=function(t,e,r,n){return i(t>>>0===t),i(e>>>0===e),i(r>>>0===r),i("boolean"==typeof n),i(e>=1&&e<=8),i(r>=1&&r<=8),(t*e+(r-1)*(0|n))/r>>>0}(e.length,r,n,s);return h(t.alloc(o),0,n,e,0,r,s)},e.encode=function(e,r,s){if(i("string"==typeof e),i(r>>>0===r),i(t.isBuffer(s)),r>15)throw new Error("Invalid cash32 type.");const o=function(t){switch(i(t>>>0===t),t){case 20:return 0;case 24:return 1;case 28:return 2;case 32:return 3;case 40:return 4;case 48:return 5;case 56:return 6;case 64:return 7;default:throw new Error("Non-standard length.")}}(s.length),f=t.alloc(s.length+1);return f[0]=r<<3|o,s.copy(f,1),a(e,h(n,0,5,f,0,8,!0))},e.decode=u,e.test=function(t,e="bitcoincash"){i("string"==typeof t),i("string"==typeof e);try{return u(t,e),!0}catch(t){return!1}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * pkcs3.js - PKCS3 encoding for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://www.teletrust.de/fileadmin/files/oid/oid_pkcs-3v1-4.pdf
 */const i=r(14),n=r(9);class s extends i.Sequence{constructor(t,e){super(),this.p=new i.Unsigned(t),this.g=new i.Unsigned(e)}getBodySize(){let t=0;return t+=this.p.getSize(),t+=this.g.getSize(),t}writeBody(t){return this.p.write(t),this.g.write(t),t}readBody(t){return this.p.read(t),this.g.read(t),this}clean(){return this.p.clean()&&this.g.clean()}toPEM(){return n.toPEM(this.encode(),"DH PARAMETERS")}fromPEM(t){const e=n.fromPEM(t,"DH PARAMETERS");return this.decode(e)}format(){return{type:this.constructor.name,p:this.p,g:this.g}}}e.DHParams=s},function(t,e,r){"use strict";(function(e){
/*!
 * pkcs5.js - PKCS5 padding for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/PKCS
 *   https://tools.ietf.org/html/rfc2898
 *   https://tools.ietf.org/html/rfc8018
 */
const i=r(1),n={pad(t,r){i(e.isBuffer(t)),i(r>>>0===r),i(r>0&&r<256);const n=r-t.length%r,s=e.alloc(t.length+n);t.copy(s,0);for(let e=t.length;e<s.length;e++)s[e]=n;return s},unpad(t,r){if(i(e.isBuffer(t)),i(r>>>0===r),i(r>0&&r<256),t.length<r||t.length%r!=0)throw new Error("Invalid block.");let n=t[t.length-1],s=1;s&=n-1>>>31^1,s&=n-r-1>>>31,n&=-s;const o=r-n;for(let e=0;e<r;e++){s&=e-o>>>31|(t[e]^n)-1>>>31}if(!s)throw new Error("Invalid padding.");return t.slice(0,o)}};t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * pkcs8.js - PKCS8 encoding for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009 The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/PKCS_8
 *   https://tools.ietf.org/html/rfc5208
 *   https://tools.ietf.org/html/rfc5958
 *   https://github.com/golang/go/blob/master/src/crypto/x509/pkcs8.go
 */const i=r(14),n=r(9),s=r(98);class o extends i.Sequence{constructor(t,e,r){super(),this.algorithm=new s.AlgorithmIdentifier(t,e),this.publicKey=new i.BitString(r)}getBodySize(){let t=0;return t+=this.algorithm.getSize(),t+=this.publicKey.getSize(),t}writeBody(t){return this.algorithm.write(t),this.publicKey.write(t),t}readBody(t){return this.algorithm.read(t),this.publicKey.read(t),this}clean(){return this.algorithm.clean()&&this.publicKey.clean()}toPEM(){return n.toPEM(this.encode(),"PUBLIC KEY")}fromPEM(t){const e=n.fromPEM(t,"PUBLIC KEY");return this.decode(e)}format(){return{type:this.constructor.name,algorithm:this.algorithm,publicKey:this.publicKey}}}class f extends i.Sequence{constructor(t,e,r,n){super(),this.version=new i.Unsigned(t),this.algorithm=new s.AlgorithmIdentifier(e,r),this.privateKey=new i.OctString(n)}get isRaw(){return!0}getBodySize(){let t=0;return t+=this.version.getSize(),t+=this.algorithm.getSize(),t+=this.privateKey.getSize(),t}writeBody(t){return this.version.write(t),this.algorithm.write(t),this.privateKey.write(t),t}readBody(t){return this.version.read(t),this.algorithm.read(t),this.privateKey.read(t),this}clean(){return this.version.clean()&&this.algorithm.clean()&&this.privateKey.clean()}toPEM(){return n.toPEM(this.encode(),"PRIVATE KEY")}fromPEM(t){const e=n.fromPEM(t,"PRIVATE KEY");return this.decode(e)}format(){return{type:this.constructor.name,version:this.version,algorithm:this.algorithm,privateKey:this.privateKey}}}class a extends i.Sequence{constructor(t,e,r){super(),this.algorithm=new s.AlgorithmIdentifier(t,e),this.data=new i.OctString(r)}getBodySize(){let t=0;return t+=this.algorithm.getSize(),t+=this.data.getSize(),t}writeBody(t){return this.algorithm.write(t),this.data.write(t),t}readBody(t){return this.algorithm.read(t),this.data.read(t),this}clean(){return this.algorithm.clean()&&this.data.clean()}toPEM(){return n.toPEM(this.encode(),"ENCRYPTED PRIVATE KEY")}fromPEM(t){const e=n.fromPEM(t,"ENCRYPTED PRIVATE KEY");return this.decode(e)}format(){return{type:this.constructor.name,algorithm:this.algorithm,data:this.data}}}e.PublicKeyInfo=o,e.PrivateKeyInfo=f,e.EncryptedPrivateKeyInfo=a},function(t,e,r){"use strict";
/*!
 * rfc3279.js - rfc3279 encoding for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://tools.ietf.org/html/rfc3279
 *   https://tools.ietf.org/html/rfc5912
 */const i=r(14),n=r(9);class s extends i.Sequence{constructor(t,e,r){super(),this.p=new i.Unsigned(t),this.q=new i.Unsigned(e),this.g=new i.Unsigned(r)}getBodySize(){let t=0;return t+=this.p.getSize(),t+=this.q.getSize(),t+=this.g.getSize(),t}writeBody(t){return this.p.write(t),this.q.write(t),this.g.write(t),t}readBody(t){return this.p.read(t),this.q.read(t),this.g.read(t),this}clean(){return this.p.clean()&&this.q.clean()&&this.g.clean()}toPEM(){return n.toPEM(this.encode(),"DSA PARAMETERS")}fromPEM(t){const e=n.fromPEM(t,"DSA PARAMETERS");return this.decode(e)}format(){return{type:this.constructor.name,p:this.p,q:this.q,g:this.g}}}class o extends i.Unsigned{constructor(t){super(t)}get y(){return this.value}set y(t){this.value=t}toPEM(){return n.toPEM(this.encode(),"DSA PUBLIC KEY")}fromPEM(t){const e=n.fromPEM(t,"DSA PUBLIC KEY");return this.decode(e)}}class f extends i.Sequence{constructor(t,e){super(),this.r=new i.Unsigned(t),this.s=new i.Unsigned(e)}getBodySize(){let t=0;return t+=this.r.getSize(),t+=this.s.getSize(),t}writeBody(t){return this.r.write(t),this.s.write(t),t}readBody(t){return this.r.read(t),this.s.read(t),this}clean(){return this.r.clean()&&this.s.clean()}toPEM(){return n.toPEM(this.encode(),"DSA SIGNATURE")}fromPEM(t){const e=n.fromPEM(t,"DSA SIGNATURE");return this.decode(e)}format(){return{type:this.constructor.name,r:this.r,s:this.s}}}e.DSAParams=s,e.DSAPublicKey=o,e.DSASignature=f},function(t,e,r){"use strict";
/*!
 * gost94.js - gost94 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(236)},function(t,e,r){"use strict";(function(e){
/*!
 * gost94.js - GOST94 implementation for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on RustCrypto/hashes:
 *   Copyright (c) 2016-2018, The RustCrypto Authors (MIT License).
 *   https://github.com/RustCrypto/hashes
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/GOST_(hash_function)
 *   https://tools.ietf.org/html/rfc4357
 *   https://tools.ietf.org/html/rfc5831
 *   https://github.com/RustCrypto/hashes/blob/master/gost94/src/gost94.rs
 */
const i=r(1),n=r(3),s=e.alloc(32,0),o=e.alloc(32,0),f=e.from([0,255,0,255,0,255,0,255,255,0,255,0,255,0,255,0,0,255,255,0,255,0,0,255,255,0,0,0,255,255,0,255]),a=[e.from([10,4,5,6,8,1,3,7,13,12,14,0,9,2,11,15]),e.from([5,15,4,0,2,13,11,9,1,7,6,3,12,14,10,8]),e.from([7,15,12,14,9,4,1,0,3,11,5,2,6,10,8,13]),e.from([4,10,7,12,0,15,2,8,14,1,6,5,13,11,9,3]),e.from([7,6,4,11,9,12,2,10,1,8,0,14,15,13,3,5]),e.from([7,6,2,4,13,9,15,0,10,1,5,11,8,14,12,3]),e.from([13,14,4,1,7,0,5,10,3,12,8,15,6,2,9,11]),e.from([1,3,10,9,5,11,4,15,8,6,7,14,13,0,2,12])],c=[e.from([4,10,9,2,13,8,0,14,6,11,1,12,7,15,5,3]),e.from([14,11,4,12,6,13,15,10,2,3,8,1,0,7,5,9]),e.from([5,8,1,13,10,3,4,2,14,15,12,7,6,0,9,11]),e.from([7,13,10,1,0,8,9,15,14,4,6,12,11,2,5,3]),e.from([6,12,7,1,5,15,13,8,4,10,9,14,0,3,11,2]),e.from([4,11,10,0,7,2,1,13,3,6,8,5,9,12,15,14]),e.from([13,11,4,1,3,15,5,9,0,10,14,7,6,8,2,12]),e.from([1,15,13,0,5,7,10,4,9,2,3,14,6,11,8,12])],h=[e.from([12,4,6,2,10,5,11,9,14,8,13,7,0,3,15,1]),e.from([6,8,2,3,9,10,5,12,1,14,4,7,11,13,0,15]),e.from([11,3,5,8,2,15,10,13,14,1,7,4,12,9,6,0]),e.from([12,8,2,1,13,4,15,6,7,0,10,5,3,14,9,11]),e.from([7,15,5,10,8,1,6,13,0,9,3,14,11,4,2,12]),e.from([5,13,15,6,9,2,12,10,11,7,8,1,4,3,14,0]),e.from([8,14,2,5,6,9,1,12,15,4,11,0,13,10,3,7]),e.from([1,7,14,13,0,5,8,3,4,15,10,6,9,12,11,2])];class u{constructor(){this.S=a,this.state=e.alloc(32),this.sigma=e.alloc(32),this.block=e.alloc(32),this.size=-1}init(t){return null==t&&(t=a),i(Array.isArray(t)&&8===t.length),this.S=t,this.state.fill(0),this.sigma.fill(0),this.size=0,this}update(t){return i(e.isBuffer(t)),this._update(t,t.length),this}final(){return this._final(e.alloc(32))}_update(t,e){i(-1!==this.size,"Context is not initialized.");let r=31&this.size,n=0;if(this.size+=e,r>0){let i=32-r;if(i>e&&(i=e),t.copy(this.block,r,n,n+i),r+=i,e-=i,n+=i,r<32)return;this._transform(this.block,0)}for(;e>=32;)this._transform(t,n),n+=32,e-=32;e>0&&t.copy(this.block,0,n,n+e)}_final(t){i(-1!==this.size,"Context is not initialized.");const e=8*this.size,r=31&this.size;0!==r&&this._update(s,32-r);const n=e*(1/4294967296)>>>0;return v(o,e>>>0,0),v(o,n,4),this._f(o),this._f(this.sigma),this.state.copy(t,0),this.state.fill(0),this.sigma.fill(0),this.block.fill(0),o.fill(0,0,8),this.size=-1,t}_transform(t,e){const r=t.slice(e,e+32);this._f(r),this._sum(r)}_shuffle(t,r){const i=e.alloc(32);r.copy(i,0);for(let t=0;t<12;t++)w(i);p(i,t),w(i),p(this.state,i);for(let t=0;t<61;t++)w(this.state)}_f(t){const r=e.alloc(32);let i,n,s;this.state.copy(r,0),i=g(b(this.state,t)),l(r,0,i,this.S),n=m(this.state),s=m(m(t)),i=g(b(n,s)),l(r,8,i,this.S),n=m(n),p(n,f),s=m(m(s)),i=g(b(n,s)),l(r,16,i,this.S),n=m(n),s=m(m(s)),i=g(b(n,s)),l(r,24,i,this.S),this._shuffle(t,r)}_sum(t){let e=0;for(let r=0;r<32;r++)e+=this.sigma[r]+t[r],this.sigma[r]=e,e>>>=8}static hash(){return new u}static hmac(t){return new n(u,32,[t])}static digest(t,e){return u.ctx.init(e).update(t).final()}static root(t,r,n){return i(e.isBuffer(t)&&32===t.length),i(e.isBuffer(r)&&32===r.length),u.ctx.init(n).update(t).update(r).final()}static multi(t,e,r,i){const{ctx:n}=u;return n.init(i),n.update(t),n.update(e),r&&n.update(r),n.final()}static mac(t,e,r){return u.hmac(r).init(e).update(t).final()}}function d(t,e,r){return(i=function(t,e){let r=0;for(let i=0;i<8;i++){const n=4*i,s=(t&15<<n)>>>n;r+=e[i][s]<<n}return r>>>0}(t+e>>>0,r))<<(n=11)|i>>>32-n;var i,n}function l(t,e,r,i){const n=new Uint32Array(8);let s=y(t,e+0),o=y(t,e+4);for(let t=0;t<8;t++)n[t]=y(r,4*t);for(let t=0;t<3;t++)for(let t=0;t<8;t++){const e=o^d(s,n[t],i);o=s,s=e}for(let t=7;t>=0;t--){const e=o^d(s,n[t],i);o=s,s=e}v(t,o,e+0),v(t,s,e+4)}function b(t,r){const i=e.alloc(32);for(let e=0;e<32;e++)i[e]=t[e]^r[e];return i}function p(t,e){for(let r=0;r<32;r++)t[r]^=e[r]}function m(t){const r=e.alloc(32);t.copy(r,0,8,32);for(let e=0;e<8;e++)r[24+e]=t[e]^t[e+8];return r}function g(t){const r=e.alloc(32);for(let e=0;e<4;e++)for(let i=0;i<8;i++)r[e+4*i]=t[8*e+i];return r}function w(t){const r=e.alloc(32);t.copy(r,0,2,32),t.copy(r,30,0,2),r[30]^=t[2],r[31]^=t[3],r[30]^=t[4],r[31]^=t[5],r[30]^=t[6],r[31]^=t[7],r[30]^=t[24],r[31]^=t[25],r[30]^=t[30],r[31]^=t[31],r.copy(t,0)}function y(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]}function v(t,e,r){return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}u.native=0,u.id="GOST94",u.size=32,u.bits=256,u.blockSize=32,u.zero=e.alloc(32,0),u.ctx=new u,u.CRYPTOPRO=a,u.TEST=c,u.S2015=h,t.exports=u}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * hash160.js - hash160 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(238)},function(t,e,r){"use strict";(function(e){
/*!
 * hash160.js - Hash160 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://github.com/bitcoin/bitcoin/blob/master/src/hash.h
 */
const i=r(1),n=r(36),s=r(100),o=r(3),f=new s;class a{constructor(){this.ctx=new n}init(){return this.ctx.init(),this}update(t){return this.ctx.update(t),this}final(){const t=e.alloc(32);return this.ctx._final(t),f.init(),f.update(t),f._final(t),t.slice(0,20)}static hash(){return new a}static hmac(){return new o(a,64)}static digest(t){return a.ctx.init().update(t).final()}static root(t,r){return i(e.isBuffer(t)&&20===t.length),i(e.isBuffer(r)&&20===r.length),a.ctx.init().update(t).update(r).final()}static multi(t,e,r){const{ctx:i}=a;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return a.hmac().init(e).update(t).final()}}a.native=0,a.id="HASH160",a.size=20,a.bits=160,a.blockSize=64,a.zero=e.alloc(20,0),a.ctx=new a,t.exports=a}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * hash256.js - hash256 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(240)},function(t,e,r){"use strict";(function(e){
/*!
 * hash256.js - Hash256 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://github.com/bitcoin/bitcoin/blob/master/src/hash.h
 */
const i=r(1),n=r(36),s=r(3);class o{constructor(){this.ctx=new n}init(){return this.ctx.init(),this}update(t){return this.ctx.update(t),this}final(){const t=e.alloc(32);return this.ctx._final(t),this.ctx.init(),this.ctx.update(t),this.ctx._final(t),t}static hash(){return new o}static hmac(){return new s(o,64)}static digest(t){return o.ctx.init().update(t).final()}static root(t,r){return i(e.isBuffer(t)&&32===t.length),i(e.isBuffer(r)&&32===r.length),o.ctx.init().update(t).update(r).final()}static multi(t,e,r){const{ctx:i}=o;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return o.hmac().init(e).update(t).final()}}o.native=0,o.id="HASH256",o.size=32,o.bits=256,o.blockSize=64,o.zero=e.alloc(32,0),o.ctx=new o,t.exports=o}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * hash-drbg.js - hash-drbg for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(242)},function(t,e,r){"use strict";(function(e){
/*!
 * hash-drbg.js - hash-drbg implementation for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on cryptocoinjs/drbg.js:
 *   Copyright (c) 2016 Kirill Fomichev
 *   https://github.com/cryptocoinjs/drbg.js
 *
 * Resources:
 *   https://csrc.nist.gov/publications/detail/sp/800-90a/archive/2012-01-23
 *   https://github.com/cryptocoinjs/drbg.js/blob/master/hash.js
 */
const i=r(1),n=e.from([1]),s=e.from([2]),o=e.from([3]);class f{constructor(t,r,n,s){i(t&&"string"==typeof t.id),this.hash=t,this.minEntropy="SHA1"===t.id?10:24,this.seedLen=t.size<=32?55:111,this.V=e.alloc(this.seedLen),this.C=e.alloc(this.seedLen),this.len=e.alloc(8),this.rounds=0,r&&this.init(r,n,s)}init(t,r,n){null==r&&(r=e.alloc(0)),null==n&&(n=e.alloc(0)),i(e.isBuffer(t)),i(e.isBuffer(r)),i(e.isBuffer(n));const s=e.concat([t,r,n]);if(s.length<this.minEntropy)throw new Error("Not enough entropy.");return this.V=this.derive(s,this.seedLen,255),this.C=this.derive(this.V,this.seedLen,0),this.rounds=1,this}reseed(t,r){if(null==r&&(r=e.alloc(0)),i(e.isBuffer(t)),i(e.isBuffer(r)),0===this.rounds)throw new Error("DRBG not initialized.");const n=e.concat([this.V,t,r]);if(n.length<this.minEntropy)throw new Error("Not enough entropy.");return this.V=this.derive(n,this.seedLen,1),this.C=this.derive(this.V,this.seedLen,0),this.rounds=1,this}generate(t,r){if(i(t>>>0===t),i(null==r||e.isBuffer(r)),0===this.rounds)throw new Error("DRBG not initialized.");if(this.rounds>281474976710656)throw new Error("Reseed is required.");r&&r.length>0&&this.sum(this.V,this.hash.multi(s,this.V,r));const o=e.from(this.V),f=Math.ceil(t/this.hash.size),a=e.alloc(f*this.hash.size);for(let t=0;t<f;t++)this.hash.digest(o).copy(a,t*this.hash.size),this.sum(o,n);return this.update(),this.rounds+=1,a.slice(0,t)}randomBytes(t){return this.generate(t)}update(){const t=this.hash.multi(o,this.V),e=this.rounds/4294967296>>>0,r=this.rounds>>>0;return this.len[0]=e>>>24,this.len[1]=e>>>16,this.len[2]=e>>>8,this.len[3]=e,this.len[4]=r>>>24,this.len[5]=r>>>16,this.len[6]=r>>>8,this.len[7]=r,this.sum(this.V,t,this.C,this.len),this}derive(t,r,n){i(e.isBuffer(t)),i(r>>>0===r),i((255&n)===n);const s=255!==n|0,o=e.alloc(5+s+t.length);o[0]=1,o[1]=r>>>21,o[2]=r>>>13,o[3]=r>>>5,o[4]=(31&r)<<3,s&&(o[5]=n),t.copy(o,5+s);const f=Math.ceil(r/this.hash.size),a=e.alloc(f*this.hash.size);for(let t=0;t<f;t++)this.hash.digest(o).copy(a,t*this.hash.size),o[0]+=1;return a.slice(0,r)}sum(t,...e){for(const r of e){let e=r.length-1,i=t.length-1,n=0;for(;e>=0;)n+=r[e]+t[i],t[i]=255&n,n>>>=8,e-=1,i-=1;for(;n>0&&i>=0;)n+=t[i],t[i]=255&n,n>>>=8,i-=1}return t}}f.native=0,t.exports=f}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * hkdf.js - hkdf for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(244)},function(t,e,r){"use strict";(function(t){
/*!
 * hkdf.js - hkdf for bcrypto
 * Copyright (c) 2014-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/HKDF
 *   https://tools.ietf.org/html/rfc5869
 */
const i=r(1);function n(e,r,n){return i(e&&"string"==typeof e.id),null==r&&(r=t.alloc(0)),null==n&&(n=t.alloc(e.size,0)),e.mac(r,n)}function s(e,r,n,s){if(null==n&&(n=t.alloc(0)),i(e&&"string"==typeof e.id),i(t.isBuffer(r)),i(t.isBuffer(n)),i(s>>>0===s),r.length!==e.size)throw new RangeError("Invalid PRK length.");const o=Math.ceil(s/e.size);if(o>255)throw new RangeError("Invalid output length.");const f=t.alloc(o*e.size),a=t.from([0]),c=e.hmac();let h=t.alloc(0),u=0;for(let t=0;t<o;t++)a[0]+=1,c.init(r),c.update(h),c.update(n),c.update(a),h=c.final(),u+=h.copy(f,u);return f.slice(0,s)}e.native=0,e.extract=n,e.expand=s,e.derive=function(t,e,r,i,o){return s(t,n(t,e,r),i,o)}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * keccak224.js - Keccak-224 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(17);class n extends i{constructor(){super()}init(){return super.init(224)}final(){return super.final(1,null)}static hash(){return new n}static hmac(){return super.hmac(224,1,null)}static digest(t){return super.digest(t,224,1,null)}static root(t,e){return super.root(t,e,224,1,null)}static multi(t,e,r){return super.multi(t,e,r,224,1,null)}static mac(t,e){return super.mac(t,e,224,1,null)}}n.native=i.native,n.id="KECCAK224",n.size=28,n.bits=224,n.blockSize=144,n.zero=e.alloc(28,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * keccak256.js - Keccak-256 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(17);class n extends i{constructor(){super()}init(){return super.init(256)}final(){return super.final(1,null)}static hash(){return new n}static hmac(){return super.hmac(256,1,null)}static digest(t){return super.digest(t,256,1,null)}static root(t,e){return super.root(t,e,256,1,null)}static multi(t,e,r){return super.multi(t,e,r,256,1,null)}static mac(t,e){return super.mac(t,e,256,1,null)}}n.native=i.native,n.id="KECCAK256",n.size=32,n.bits=256,n.blockSize=136,n.zero=e.alloc(32,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * keccak384.js - Keccak-384 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(17);class n extends i{constructor(){super()}init(){return super.init(384)}final(){return super.final(1,null)}static hash(){return new n}static hmac(){return super.hmac(384,1,null)}static digest(t){return super.digest(t,384,1,null)}static root(t,e){return super.root(t,e,384,1,null)}static multi(t,e,r){return super.multi(t,e,r,384,1,null)}static mac(t,e){return super.mac(t,e,384,1,null)}}n.native=i.native,n.id="KECCAK384",n.size=48,n.bits=384,n.blockSize=104,n.zero=e.alloc(48,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * keccak512.js - Keccak-512 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(17);class n extends i{constructor(){super()}init(){return super.init(512)}final(){return super.final(1,null)}static hash(){return new n}static hmac(){return super.hmac(512,1,null)}static digest(t){return super.digest(t,512,1,null)}static root(t,e){return super.root(t,e,512,1,null)}static multi(t,e,r){return super.multi(t,e,r,512,1,null)}static mac(t,e){return super.mac(t,e,512,1,null)}}n.native=i.native,n.id="KECCAK512",n.size=32,n.bits=512,n.blockSize=72,n.zero=e.alloc(32,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * kmac128.js - KMAC128 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(54);class n extends i{constructor(){super()}init(t,e){return super.init(128,t,e)}static hash(){return new n}static hmac(t,e,r){return super.hmac(128,t,e,r)}static digest(t,e,r,i){return super.digest(t,128,e,r,i)}static root(t,e,r,i,n){return super.root(t,e,128,r,i,n)}static multi(t,e,r,i,n,s){return super.multi(t,e,r,128,i,n,s)}static mac(t,e,r,i,n){return super.mac(t,e,128,r,i,n)}}n.native=i.native,n.id="KMAC128",n.size=16,n.bits=128,n.blockSize=168,n.zero=e.alloc(16,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * kmac256.js - KMAC256 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(54);class n extends i{constructor(){super()}init(t,e){return super.init(256,t,e)}static hash(){return new n}static hmac(t,e,r){return super.hmac(256,t,e,r)}static digest(t,e,r,i){return super.digest(t,256,e,r,i)}static root(t,e,r,i,n){return super.root(t,e,256,r,i,n)}static multi(t,e,r,i,n,s){return super.multi(t,e,r,256,i,n,s)}static mac(t,e,r,i,n){return super.mac(t,e,256,r,i,n)}}n.native=i.native,n.id="KMAC256",n.size=32,n.bits=256,n.blockSize=136,n.zero=e.alloc(32,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * md2.js - md2 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(252)},function(t,e,r){"use strict";(function(e){
/*!
 * md2.js - MD2 implementation for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on RustCrypto/hashes:
 *   Copyright (c) 2016-2018, The RustCrypto Authors (MIT License).
 *   https://github.com/RustCrypto/hashes
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/MD2_(hash_function)
 *   https://tools.ietf.org/html/rfc1319
 *   https://github.com/RustCrypto/hashes/blob/master/md2/src/lib.rs
 */
const i=r(1),n=r(3),s=new Uint8Array([41,46,67,201,162,216,124,1,61,54,84,161,236,240,6,19,98,167,5,243,192,199,115,140,152,147,43,217,188,76,130,202,30,155,87,60,253,212,224,22,103,66,111,24,138,23,229,18,190,78,196,214,218,158,222,73,160,251,245,142,187,47,238,122,169,104,121,145,21,178,7,63,148,194,16,137,11,34,95,33,128,127,93,154,90,144,50,39,53,62,204,231,191,247,151,3,255,25,48,179,72,165,181,209,215,94,146,42,172,86,170,198,79,184,56,210,150,164,125,182,118,252,107,226,156,116,4,241,69,157,112,89,100,113,135,32,134,91,207,101,230,45,168,2,27,96,37,173,174,176,185,246,28,70,97,105,52,64,126,15,85,71,163,35,221,81,175,58,195,92,249,206,186,197,234,38,44,83,13,110,133,40,132,9,211,223,205,244,65,129,77,82,106,220,55,200,108,193,171,250,36,225,123,8,12,189,177,74,120,136,149,139,227,99,232,109,233,203,213,254,59,0,29,57,242,239,183,14,102,88,208,228,166,119,114,248,235,117,75,10,49,68,80,180,143,237,31,26,219,153,141,51,159,17,131,20]);class o{constructor(){this.state=e.alloc(48),this.checksum=e.alloc(16),this.block=e.alloc(16),this.size=-1}init(){return this.state.fill(0),this.checksum.fill(0),this.size=0,this}update(t){return i(e.isBuffer(t)),this._update(t,t.length),this}final(){return this._final(e.alloc(16))}_update(t,e){i(-1!==this.size,"Context is not initialized.");let r=15&this.size,n=0;if(this.size+=e,r>0){let i=16-r;if(i>e&&(i=e),t.copy(this.block,r,n,n+i),r+=i,e-=i,n+=i,r<16)return;this._transform(this.block,0)}for(;e>=16;)this._transform(t,n),n+=16,e-=16;e>0&&t.copy(this.block,0,n,n+e)}_final(t){i(-1!==this.size,"Context is not initialized.");const r=16-(15&this.size),n=e.alloc(r);for(let t=0;t<n.length;t++)n[t]=r;return this._update(n,r),this._update(this.checksum,16),this.state.copy(t,0,0,16),this.state.fill(0),this.checksum.fill(0),this.block.fill(0),this.size=-1,t}_transform(t,e){for(let r=0;r<16;r++)this.state[16+r]=t[e+r],this.state[32+r]=this.state[16+r]^this.state[r];let r=0;for(let t=0;t<18;t++){for(let t=0;t<48;t++)this.state[t]^=s[r],r=this.state[t];r=r+t&255}let i=this.checksum[15];for(let r=0;r<16;r++)this.checksum[r]^=s[t[e+r]^i],i=this.checksum[r]}static hash(){return new o}static hmac(){return new n(o,16)}static digest(t){return o.ctx.init().update(t).final()}static root(t,r){return i(e.isBuffer(t)&&16===t.length),i(e.isBuffer(r)&&16===r.length),o.ctx.init().update(t).update(r).final()}static multi(t,e,r){const{ctx:i}=o;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return o.hmac().init(e).update(t).final()}}o.native=0,o.id="MD2",o.size=16,o.bits=128,o.blockSize=16,o.zero=e.alloc(16,0),o.ctx=new o,t.exports=o}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * md4.js - md4 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(254)},function(t,e,r){"use strict";(function(e){
/*!
 * md4.js - MD4 implementation for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on RustCrypto/hashes:
 *   Copyright (c) 2016-2018, The RustCrypto Authors (MIT License).
 *   https://github.com/RustCrypto/hashes
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/MD4
 *   https://tools.ietf.org/html/rfc1320
 *   https://github.com/RustCrypto/hashes/blob/master/md4/src/lib.rs
 */
const i=r(1),n=r(3),s=e.alloc(8,0),o=e.alloc(64,0);o[0]=128;const f=new Uint32Array([1732584193,4023233417,2562383102,271733878]);class a{constructor(){this.state=new Uint32Array(4),this.msg=new Uint32Array(16),this.block=e.alloc(64),this.size=-1}init(){return this.state[0]=f[0],this.state[1]=f[1],this.state[2]=f[2],this.state[3]=f[3],this.size=0,this}update(t){return i(e.isBuffer(t)),this._update(t,t.length),this}final(){return this._final(e.alloc(16))}_update(t,e){i(-1!==this.size,"Context is not initialized.");let r=63&this.size,n=0;if(this.size+=e,r>0){let i=64-r;if(i>e&&(i=e),t.copy(this.block,r,n,n+i),r+=i,e-=i,n+=i,r<64)return;this._transform(this.block,0)}for(;e>=64;)this._transform(t,n),n+=64,e-=64;e>0&&t.copy(this.block,0,n,n+e)}_final(t){i(-1!==this.size,"Context is not initialized.");const e=63&this.size,r=8*this.size;l(s,r>>>0,0),l(s,r*(1/4294967296)>>>0,4),this._update(o,1+(119-e&63)),this._update(s,8);for(let e=0;e<4;e++)l(t,this.state[e],4*e),this.state[e]=0;for(let t=0;t<16;t++)this.msg[t]=0;for(let t=0;t<64;t++)this.block[t]=0;return this.size=-1,t}_transform(t,e){const r=this.msg;let i=this.state[0],n=this.state[1],s=this.state[2],o=this.state[3];for(let i=0;i<16;i++)r[i]=(a=e+4*i,(f=t)[a++]+256*f[a++]+65536*f[a++]+16777216*f[a]);var f,a;for(const t of[0,4,8,12])i=c(i,n,s,o,r[t],3),o=c(o,i,n,s,r[t+1],7),s=c(s,o,i,n,r[t+2],11),n=c(n,s,o,i,r[t+3],19);for(let t=0;t<4;t++)i=h(i,n,s,o,r[t],3),o=h(o,i,n,s,r[t+4],5),s=h(s,o,i,n,r[t+8],9),n=h(n,s,o,i,r[t+12],13);for(const t of[0,2,1,3])i=u(i,n,s,o,r[t],3),o=u(o,i,n,s,r[t+8],9),s=u(s,o,i,n,r[t+4],11),n=u(n,s,o,i,r[t+12],15);this.state[0]+=i,this.state[1]+=n,this.state[2]+=s,this.state[3]+=o}static hash(){return new a}static hmac(){return new n(a,64)}static digest(t){return a.ctx.init().update(t).final()}static root(t,r){return i(e.isBuffer(t)&&16===t.length),i(e.isBuffer(r)&&16===r.length),a.ctx.init().update(t).update(r).final()}static multi(t,e,r){const{ctx:i}=a;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return a.hmac().init(e).update(t).final()}}function c(t,e,r,i,n,s){return d(t+((o=e)&r|~o&i)+n,s);var o}function h(t,e,r,i,n,s){return d(t+((o=e)&(f=r)|o&(a=i)|f&a)+n+1518500249,s);var o,f,a}function u(t,e,r,i,n,s){return d(t+(e^r^i)+n+1859775393,s)}function d(t,e){return t<<e|t>>>32-e}function l(t,e,r){return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}a.native=0,a.id="MD4",a.size=16,a.bits=128,a.blockSize=64,a.zero=e.alloc(16,0),a.ctx=new a,t.exports=a}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * md5sha1.js - md5sha1 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(256)},function(t,e,r){"use strict";(function(e){
/*!
 * md5sha1.js - MD5-SHA1 implementation for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(1),n=r(96),s=r(101),o=r(3);class f{constructor(){this.md5=new n,this.sha1=new s}init(){return this.md5.init(),this.sha1.init(),this}update(t){return this.md5.update(t),this.sha1.update(t),this}final(){const t=e.alloc(36);return this.md5.final().copy(t,0),this.sha1.final().copy(t,16),t}static hash(){return new f}static hmac(){return new o(f,64)}static digest(t){return f.ctx.init().update(t).final()}static root(t,r){return i(e.isBuffer(t)&&36===t.length),i(e.isBuffer(r)&&36===r.length),f.ctx.init().update(t).update(r).final()}static multi(t,e,r){const{ctx:i}=f;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return f.hmac().init(e).update(t).final()}}f.native=0,f.id="MD5SHA1",f.size=36,f.bits=288,f.blockSize=64,f.zero=e.alloc(36,0),f.ctx=new f,t.exports=f}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * merkle.js - merkle trees for bcrypto
 * Copyright (c) 2014-2015, Fedor Indutny (MIT License)
 * Copyright (c) 2014-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on bitcoin/bitcoin:
 *   Copyright (c) 2009-2019, The Bitcoin Core Developers (MIT License).
 *   Copyright (c) 2009-2019, The Bitcoin Developers (MIT License).
 *   https://github.com/bitcoin/bitcoin
 */
const i=r(1);function n(t,e){i(t&&"function"==typeof t.root),i(Array.isArray(e));const r=new Array(e.length);for(let t=0;t<e.length;t++)r[t]=e[t];let n=r.length,s=!1,o=0;if(0===n)return r.push(t.zero),[r,s];for(;n>1;){for(let e=0;e<n;e+=2){const i=Math.min(e+1,n-1),f=r[o+e],a=r[o+i];i===e+1&&i+1===n&&f.equals(a)&&(s=!0);const c=t.root(f,a);r.push(c)}o+=n,n=n+1>>>1}return[r,s]}e.createTree=n,e.createRoot=function(t,e){i(t&&"function"==typeof t.root),i(Array.isArray(e));const[r,s]=n(t,e);return[r[r.length-1],s]},e.createBranch=function(t,e,r){i(t&&"function"==typeof t.root),i(e>>>0===e),i(Array.isArray(r)),i(e<r.length);let s=r.length;const[o]=n(t,r),f=[];let a=0;for(;s>1;){const t=Math.min(1^e,s-1);f.push(o[a+t]),e>>>=1,a+=s,s=s+1>>>1}return f},e.deriveRoot=function(e,r,n,s){i(e&&"function"==typeof e.root),i(t.isBuffer(r)),i(Array.isArray(n)),i(s>>>0===s);let o=r;for(const t of n){if(1&s&&t.equals(o))return e.zero;o=1&s?e.root(t,o):e.root(o,t),s>>>=1}return o}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * mrkl.js - merkle trees for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(1),n=t.alloc(0),s=t.from([1]),o=t.from([0]);function f(t,e){i(t&&"function"==typeof t.multi),i(Array.isArray(e));const r=[],n=a(t);for(const i of e){const e=c(t,i);r.push(e)}let s=r.length,o=0;if(0===s)return r.push(n),r;for(;s>1;){for(let e=0;e<s;e+=2){const i=e+1,f=r[o+e];let a;a=i<s?r[o+i]:n;const c=h(t,f,a);r.push(c)}o+=s,s=s+1>>>1}return r}function a(t){return t.digest(n)}function c(t,e){return t.multi(o,e)}function h(t,e,r){return i(null!=r),t.multi(s,e,r)}e.createTree=f,e.createRoot=function(t,e){const r=f(t,e);return r[r.length-1]},e.createBranch=function(t,e,r){i(e>>>0===e);const n=f(t,r),s=a(t),o=[];let c=r.length,h=0;for(i(e<r.length);c>1;){const t=1^e;t<c?o.push(n[h+t]):o.push(s),e>>>=1,h+=c,c=c+1>>>1}return o},e.deriveRoot=function(e,r,n,s){i(e&&"function"==typeof e.multi),i(t.isBuffer(r)),i(Array.isArray(n)),i(s>>>0===s);let o=c(e,r);for(const t of n)o=1&s?h(e,t,o):h(e,o,t),s>>>=1;return o},e.hashEmpty=a,e.hashLeaf=c,e.hashInternal=h}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * murmur3.js - murmur3 hash for bcrypto
 * Copyright (c) 2014-2015, Fedor Indutny (MIT License)
 * Copyright (c) 2014-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(260)},function(t,e,r){"use strict";(function(t){
/*!
 * murmur3.js - murmur3 hash for bcrypto
 * Copyright (c) 2014-2015, Fedor Indutny (MIT License)
 * Copyright (c) 2014-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/MurmurHash
 *   https://github.com/aappleby/smhasher
 */
const i=r(1);function n(e,r){i(t.isBuffer(e)),i("number"==typeof r);const n=e.length-(3&e.length),a=3432918353,c=461845907;let h=0|r;for(let t=0;t<n;t+=4){let r=f(e,t);r=s(r,a),r=o(r,15),r=s(r,c),h^=r,h=o(h,13),h=s(h,5)+3864292196|0}let u=0;switch(3&e.length){case 3:u^=e[n+2]<<16;case 2:u^=e[n+1]<<8;case 1:u^=e[n+0],u=s(u,a),u=o(u,15),u=s(u,c),h^=u}return h^=e.length,h^=h>>>16,h=s(h,2246822507),h^=h>>>13,h=s(h,3266489909),h^=h>>>16,h>>>0}function s(t,e){const r=65535&t,i=65535&e,n=r*i;return(t>>>16)*i+(e>>>16)*r+(n>>>16)<<16|65535&n}function o(t,e){return t<<e|t>>>32-e}function f(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]}e.native=0,e.sum=n,e.tweak=function(t,e,r){return i("number"==typeof e),i("number"==typeof r),n(t,s(e,4221880213)+(0|r))}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * p192.js - p192 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(262)},function(t,e,r){"use strict";
/*!
 * p192.js - ECDSA-P192 for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */const i=r(21),n=r(11);t.exports=new i("P192",n,n)},function(t,e,r){"use strict";(function(e){
/*!
 * schnorr-legacy.js - bip-schnorr for bcrypto
 * Copyright (c) 2019-2020, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on sipa/bip-schnorr:
 *   Copyright (c) 2018-2019, Pieter Wuille (2-clause BSD License).
 *   https://github.com/sipa/bips/blob/d194620/bip-schnorr/reference.py
 *
 * Parts of this software are based on ElementsProject/secp256k1-zkp:
 *   Copyright (c) 2013, Pieter Wuille.
 *   https://github.com/ElementsProject/secp256k1-zkp
 *
 * Resources:
 *   https://github.com/sipa/bips/blob/d194620/bip-schnorr.mediawiki
 *   https://github.com/sipa/bips/blob/d194620/bip-schnorr/reference.py
 *   https://github.com/sipa/bips/blob/d194620/bip-schnorr/test-vectors.csv
 *   https://github.com/ElementsProject/secp256k1-zkp/tree/11af701/src/modules/schnorrsig
 *   https://github.com/bitcoincashorg/bitcoincash.org/blob/master/spec/2019-05-15-schnorr.md
 *
 * References:
 *
 *   [SCHNORR] Schnorr Signatures for secp256k1
 *     Pieter Wuille
 *     https://github.com/sipa/bips/blob/d194620/bip-schnorr.mediawiki
 *
 *   [CASH] Schnorr Signature specification
 *     Mark B. Lundeberg
 *     https://github.com/bitcoincashorg/bitcoincash.org/blob/master/spec/2019-05-15-schnorr.md
 */
const i=r(1),n=r(50),s=r(6);t.exports=class{constructor(t,e){this.curve=t,this.hash=e,this.rng=new n(this.curve,this.encode.bind(this))}check(){if(3!==this.curve.p.andln(3))throw new Error(`Schnorr is not supported for ${this.curve.id}.`)}encode(t){i(e.isBuffer(t));const{fieldSize:r}=this.curve;if(t.length===1+r)return t;if(t.length!==1+2*r)throw new Error("Invalid point.");const n=e.alloc(1+r);return n[0]=2|1&t[t.length-1],t.copy(n,1,1,1+r),n}hashInt(...t){const e=new this.hash;e.init();for(const r of t)e.update(r);let r=e.final(this.curve.scalarSize);r.length>this.curve.scalarSize&&(r=r.slice(0,this.curve.scalarSize));const i=s.decode(r,this.curve.endian);return i.iumaskn(this.curve.scalarBits),i.imod(this.curve.n)}hashNonce(t,e){return this.hashInt(t,e)}hashChallenge(t,e,r){return this.hashInt(t,this.encode(e),r)}sign(t,r){return i(e.isBuffer(t)),this.check(),this._sign(t,r)}_sign(t,r){const{n:i}=this.curve,n=this.curve.g,s=this.curve.decodeScalar(r);if(s.isZero()||s.cmp(i)>=0)throw new Error("Invalid private key.");const o=n.mulBlind(s),f=this.hashNonce(r,t);if(f.isZero())throw new Error("Signing failed (k' = 0).");const a=n.mulBlind(f);a.isSquare()||f.ineg().imod(i);const c=a.encodeX(),h=o.encode(),u=this.hashChallenge(c,h,t),d=f.add(u.mul(s)).imod(i);return e.concat([c,this.curve.encodeScalar(d)])}verify(t,r,n){if(i(e.isBuffer(t)),i(e.isBuffer(r)),i(e.isBuffer(n)),this.check(),r.length!==this.curve.fieldSize+this.curve.scalarSize)return!1;try{return this._verify(t,r,n)}catch(t){return!1}}_verify(t,e,r){const{p:i,n:n}=this.curve,s=this.curve.g,o=e.slice(0,this.curve.fieldSize),f=e.slice(this.curve.fieldSize),a=this.curve.decodeField(o),c=this.curve.decodeScalar(f),h=this.curve.decodePoint(r);if(a.cmp(i)>=0||c.cmp(n)>=0)return!1;const u=this.hashChallenge(o,r,t),d=s.jmulAdd(c,h,u.ineg().imod(n));return!!d.isSquare()&&!!d.eqX(a)}verifyBatch(t){i(Array.isArray(t)),this.check();for(const r of t){i(Array.isArray(r)&&3===r.length);const[t,n,s]=r;if(i(e.isBuffer(t)),i(e.isBuffer(n)),i(e.isBuffer(s)),n.length!==this.curve.fieldSize+this.curve.scalarSize)return!1}try{return this._verifyBatch(t)}catch(t){return!1}}_verifyBatch(t){const{n:e}=this.curve,r=this.curve.g,i=new Array(1+2*t.length),n=new Array(1+2*t.length),o=new s(0);this.rng.init(t),i[0]=r,n[0]=o;for(let r=0;r<t.length;r++){const[s,f,a]=t[r],c=f.slice(0,this.curve.fieldSize),h=f.slice(this.curve.fieldSize),u=this.curve.decodeSquare(c),d=this.curve.decodeScalar(h),l=this.curve.decodePoint(a);if(d.cmp(e)>=0)return!1;const b=this.hashChallenge(c,a,s),p=this.rng.generate(r),m=b.mul(p).imod(e);o.iadd(d.mul(p)).imod(e),i[1+2*r+0]=u,n[1+2*r+0]=p,i[1+2*r+1]=l,n[1+2*r+1]=m}return o.ineg().imod(e),this.curve.jmulAll(i,n).isInfinity()}}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * p224.js - p224 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(265)},function(t,e,r){"use strict";
/*!
 * p224.js - ECDSA-P224 for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */const i=r(21),n=r(11);t.exports=new i("P224",n,n)},function(t,e,r){"use strict";
/*!
 * p256.js - ECDSA-P256 for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */const i=r(21),n=r(11);t.exports=new i("P256",n,n)},function(t,e,r){"use strict";
/*!
 * p384.js - ECDSA-P384 for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */const i=r(21),n=r(55);t.exports=new i("P384",n,n)},function(t,e,r){"use strict";(function(e){
/*!
 * sha384.js - SHA384 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/hash.js:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/hash.js
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/SHA-2
 *   https://tools.ietf.org/html/rfc4634
 *   https://github.com/indutny/hash.js/blob/master/lib/hash/sha/384.js
 */
const i=r(1),n=r(72),s=r(3);class o extends n{constructor(){super()}init(){return this.state[0]=3418070365,this.state[1]=3238371032,this.state[2]=1654270250,this.state[3]=914150663,this.state[4]=2438529370,this.state[5]=812702999,this.state[6]=355462360,this.state[7]=4144912697,this.state[8]=1731405415,this.state[9]=4290775857,this.state[10]=2394180231,this.state[11]=1750603025,this.state[12]=3675008525,this.state[13]=1694076839,this.state[14]=1203062813,this.state[15]=3204075428,this.size=0,this}final(){return super.final().slice(0,48)}static hash(){return new o}static hmac(){return new s(o,128)}static digest(t){return o.ctx.init().update(t).final()}static root(t,r){return i(e.isBuffer(t)&&48===t.length),i(e.isBuffer(r)&&48===r.length),o.ctx.init().update(t).update(r).final()}static multi(t,e,r){const{ctx:i}=o;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return o.hmac().init(e).update(t).final()}}o.native=0,o.id="SHA384",o.size=48,o.bits=384,o.blockSize=128,o.zero=e.alloc(48,0),o.ctx=new o,t.exports=o}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * p521.js - ECDSA-P521 for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */const i=r(21),n=r(23),s=r(38);t.exports=new i("P521",n,s)},function(t,e,r){"use strict";(function(t,i){
/*!
 * pbkdf2.js - pbkdf2 for bcrypto
 * Copyright (c) 2014-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/PBKDF2
 *   https://tools.ietf.org/html/rfc2898
 *   https://tools.ietf.org/html/rfc2898#section-5.2
 *   https://tools.ietf.org/html/rfc6070
 *   https://www.emc.com/collateral/white-papers/h11302-pkcs5v2-1-password-based-cryptography-standard-wp.pdf
 *   http://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-132.pdf
 */
const n=r(1),s=(t.crypto||t.msCrypto||{}).subtle||{};function o(t,e,r,s,o){"string"==typeof e&&(e=i.from(e,"utf8")),"string"==typeof r&&(r=i.from(r,"utf8")),null==r&&(r=i.alloc(0)),n(t&&"string"==typeof t.id),n(i.isBuffer(e)),n(i.isBuffer(r)),n(s>>>0===s),n(o>>>0===o);const f=t.size,a=Math.ceil(o/f),c=i.alloc(a*f),h=i.alloc(r.length+4);r.copy(h,0),e.length>t.blockSize&&(e=t.digest(e),n(e.length<=t.blockSize));for(let i=0;i<a;i++){const n=i+1;h[r.length+0]=n>>>24,h[r.length+1]=n>>>16,h[r.length+2]=n>>>8,h[r.length+3]=n;const o=t.mac(h,e);let a=o;for(let r=1;r<s;r++){a=t.mac(a,e);for(let t=0;t<f;t++)o[t]^=a[t]}o.copy(c,i*f)}return c.slice(0,o)}e.native=0,e.derive=o,e.deriveAsync=async function(t,e,r,f,a){"string"==typeof e&&(e=i.from(e,"utf8")),"string"==typeof r&&(r=i.from(r,"utf8")),null==r&&(r=i.alloc(0)),n(t&&"string"==typeof t.id),n(i.isBuffer(e)),n(i.isBuffer(r)),n(f>>>0===f),n(a>>>0===a);const c=function(t){switch(t.id){case"SHA1":return"SHA-1";case"SHA256":return"SHA-256";case"SHA384":return"SHA-384";case"SHA512":return"SHA-512";default:return null}}(t);if(!s.importKey||!s.deriveBits||!c)return o(t,e,r,f,a);const h={name:"PBKDF2",salt:r,iterations:f,hash:c},u=await s.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]),d=await s.deriveBits(h,u,8*a);return i.from(d)}}).call(this,r(13),r(0).Buffer)},function(t,e,r){"use strict";(function(t){
/*!
 * pgp.js - PGP for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/crypto:
 *   Copyright (c) 2009 The Go Authors. All rights reserved.
 *   https://github.com/golang/crypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Pretty_Good_Privacy#OpenPGP
 *   https://tools.ietf.org/html/rfc4880
 *   https://github.com/golang/crypto/tree/master/openpgp
 *   https://github.com/gpg/gnupg/blob/master/common/openpgpdefs.h
 *   https://github.com/gpg/gnupg/blob/master/g10/parse-packet.c
 */
const i=r(1),n=r(52),{PEMBlock:s}=r(9),{countLeft:o}=r(37),f=r(34),a=r(53),c=r(106),h=r(107),u=r(108),d=r(11),l=r(55),b=r(23),p=r(273),m={NONE:0,PUBKEY_ENC:1,SIGNATURE:2,SYMKEY_ENC:3,ONEPASS_SIG:4,PRIVATE_KEY:5,PUBLIC_KEY:6,PRIVATE_SUBKEY:7,COMPRESSED:8,ENCRYPTED:9,MARKER:10,PLAINTEXT:11,RING_TRUST:12,USER_ID:13,PUBLIC_SUBKEY:14,OLD_COMMENT:16,ATTRIBUTE:17,ENCRYPTED_MDC:18,MDC:19,ENCRYPTED_AEAD:20},g={0:"NONE",1:"PUBKEY_ENC",2:"SIGNATURE",3:"SYMKEY_ENC",4:"ONEPASS_SIG",5:"PRIVATE_KEY",6:"PUBLIC_KEY",7:"PRIVATE_SUBKEY",8:"COMPRESSED",9:"ENCRYPTED",10:"MARKER",11:"PLAINTEXT",12:"RING_TRUST",13:"USER_ID",14:"PUBLIC_SUBKEY",16:"OLD_COMMENT",17:"ATTRIBUTE",18:"ENCRYPTED_MDC",19:"MDC",20:"ENCRYPTED_AEAD"},w={RSA:1,RSA_ENCRYPT_ONLY:2,RSA_SIGN_ONLY:3,ELGAMAL:16,DSA:17,ECDH:18,ECDSA:19,ELGAMAL_LEGACY:20,EDDSA:22},y={1:"RSA",2:"RSA_ENCRYPT_ONLY",3:"RSA_SIGN_ONLY",16:"ELGAMAL",17:"DSA",18:"ECDH",19:"ECDSA",20:"ELGAMAL_LEGACY",22:"EDDSA"},v={NONE:0,IDEA:1,DES3:2,CAST5:3,BLOWFISH:4,AES128:7,AES192:8,AES256:9,TWOFISH:10,CAMELLIA128:11,CAMELLIA192:12,CAMELLIA256:13},S={0:"NONE",1:"IDEA",2:"DES3",3:"CAST5",4:"BLOWFISH",7:"AES128",8:"AES192",9:"AES256",10:"TWOFISH",11:"CAMELLIA128",12:"CAMELLIA192",13:"CAMELLIA256"},E={1:"MD5",2:"SHA1",3:"RIPEMD160",8:"SHA256",9:"SHA384",10:"SHA512",11:"SHA224"},M={1:a,2:c,3:h,8:d,9:l,10:b,11:u},A={NONE:0,P256:1,P384:2,P521:3,SECP256K1:4,X25519:5,BRAINPOOLP256:6,BRAINPOOLP384:7,BRAINPOOLP512:8,ED25519:9},I={0:"NONE",1:"P256",2:"P384",3:"P521",4:"SECP256K1",5:"X25519",6:"BRAINPOOLP256",7:"BRAINPOOLP384",8:"BRAINPOOLP512",9:"ED25519"},_={P256:t.from("2a8648ce3d030107","hex"),P384:t.from("2b81040022","hex"),P521:t.from("2b81040023","hex"),SECP256K1:t.from("2b8104000a","hex"),X25519:t.from("2b060104019755010501","hex"),BRAINPOOLP256:t.from("2b2403030208010107","hex"),BRAINPOOLP384:t.from("2b240303020801010b","hex"),BRAINPOOLP512:t.from("2b240303020801010d","hex"),ED25519:t.from("2b06010401da470f01","hex")},x=t.alloc(0);class B extends n.Struct{constructor(){super(),this.packets=[]}getSize(){let t=0;for(const e of this.packets)t+=e.getSize();return t}write(t){for(const e of this.packets)e.write(t);return t}read(t){for(;t.left();){const e=k.read(t);this.packets.push(e)}return this}toString(t="PGP MESSAGE"){i("string"==typeof t);const e=new s;return e.type=t,e.data=this.encode(),e.toString(!0)}fromString(t){const e=s.fromString(t,!0);if("PGP "!==e.type.substring(0,4))throw new Error("PEM type mismatch.");return this.decode(e.data)}format(){return{packets:this.packets}}}class k extends n.Struct{constructor(){super(),this.type=0,this.body=new q}getSize(){const t=this.body.getSize();let e=0;return e+=1,e+=t<192?1:t<8384?2:5,e+=t,e}write(t){let e=this.body.getSize();return t.writeU8(192|this.type),e<192?t.writeU8(e):e<8384?(e-=192,t.writeU8(192+(e>>>8)),t.writeU8(255&e)):(t.writeU8(255),t.writeU32BE(e)),this.body.write(t),t}read(t){const e=t.readU8();if(0==(128&e))throw new Error("Hi bit unset in PGP packet header.");let r=0,i=null;if(0==(64&e)){const n=(63&e)>>>2;let s=0;switch(1<<(3&e)){case 1:s=t.readU8();break;case 2:s=t.readU16BE();break;case 4:s=t.readU32BE();break;case 8:s=t.left()}r=n,i=t.readChild(s)}else{const n=63&e,s=t.readU8();let o=0;if(s<192)o=s;else if(s<224)o=256*(s-192),o+=t.readU8()+192;else{if(s<255)throw new Error("Cannot handle PGP partial length.");o=t.readU32BE()}r=n,i=t.readChild(o)}switch(this.type=r,this.type){case m.PUBKEY_ENC:case m.SIGNATURE:case m.SYMKEY_ENC:case m.ONEPASS_SIG:this.body=q.read(i);break;case m.PRIVATE_KEY:this.body=P.read(i);break;case m.PUBLIC_KEY:this.body=N.read(i);break;case m.PRIVATE_SUBKEY:this.body=P.read(i);break;case m.COMPRESSED:case m.ENCRYPTED:case m.MARKER:case m.PLAINTEXT:case m.RING_TRUST:this.body=q.read(i);break;case m.USER_ID:this.body=C.read(i);break;case m.PUBLIC_SUBKEY:case m.OLD_COMMENT:this.body=N.read(i);break;case m.ATTRIBUTE:case m.ENCRYPTED_MDC:case m.MDC:case m.ENCRYPTED_AEAD:default:this.body=q.read(i)}return this}format(){return{type:g[this.type]||"UNKNOWN",body:this.body}}}class z extends n.Struct{constructor(){super()}}class q extends z{constructor(){super(),this.data=x}getSize(){return this.data.length}write(t){return t.writeBytes(this.data),t}read(t){return this.data=t.readBytes(t.left()),this}format(){return{data:this.data.toString("hex")}}}class N extends z{constructor(){super(),this.version=4,this.algorithm=0,this.expires=0,this.timestamp=0,this.n=new T,this.e=new T,this.p=new T,this.g=new T,this.y=new T,this.p,this.q=new T,this.g,this.y,this.oid=x,this.point=new T,this.kdfHash=0,this.kdfAlg=0,this.oid,this.point,this.data=x}get curve(){return this.oid.equals(_.P256)?A.P256:this.oid.equals(_.P384)?A.P384:this.oid.equals(_.P521)?A.P521:this.oid.equals(_.SECP256K1)?A.SECP256K1:this.oid.equals(_.X25519)?A.X25519:this.oid.equals(_.BRAINPOOLP256)?A.BRAINPOOLP256:this.oid.equals(_.BRAINPOOLP384)?A.BRAINPOOLP384:this.oid.equals(_.BRAINPOOLP512)?A.BRAINPOOLP512:this.oid.equals(_.ED25519)?A.ED25519:0}set curve(t){switch(t){case A.P256:this.oid=_.P256;break;case A.P384:this.oid=_.P384;break;case A.P521:this.oid=_.P521;break;case A.SECP256K1:this.oid=_.SECP256K1;break;case A.X25519:this.oid=_.X25519;break;case A.BRAINPOOLP256:this.oid=_.BRAINPOOLP256;break;case A.BRAINPOOLP384:this.oid=_.BRAINPOOLP384;break;case A.BRAINPOOLP512:this.oid=_.BRAINPOOLP512;break;case A.ED25519:this.oid=_.ED25519}}isRSA(){switch(this.algorithm){case w.RSA:case w.RSA_ENCRYPT_ONLY:case w.RSA_SIGN_ONLY:return!0}return!1}isElgamal(){switch(this.algorithm){case w.ELGAMAL:case w.ELGAMAL_LEGACY:return!0}return!1}getSize(){let t=0;switch(t+=1,this.version){case 2:case 3:t+=4,t+=2,t+=1;break;case 4:t+=4,t+=1;break;default:throw new Error("Unknown PGP key version.")}switch(this.algorithm){case w.RSA:case w.RSA_ENCRYPT_ONLY:case w.RSA_SIGN_ONLY:t+=this.n.getSize(),t+=this.e.getSize();break;case w.ELGAMAL:case w.ELGAMAL_LEGACY:t+=this.p.getSize(),t+=this.g.getSize(),t+=this.y.getSize();break;case w.DSA:t+=this.p.getSize(),t+=this.q.getSize(),t+=this.g.getSize(),t+=this.y.getSize();break;case w.ECDH:t+=1,t+=this.oid.length,t+=this.point.getSize(),t+=4;break;case w.ECDSA:case w.EDDSA:t+=1,t+=this.oid.length,t+=this.point.getSize();break;default:t+=this.data.length}return t}write(t){switch(t.writeU8(this.version),this.version){case 2:case 3:if(!this.isRSA())throw new Error("Unknown PGP key algorithm.");t.writeU32BE(this.timestamp),t.writeU16BE(this.expires),t.writeU8(this.algorithm);break;case 4:t.writeU32BE(this.timestamp),t.writeU8(this.algorithm);break;default:throw new Error("Unknown PGP key version.")}switch(this.algorithm){case w.RSA:case w.RSA_ENCRYPT_ONLY:case w.RSA_SIGN_ONLY:this.n.write(t),this.e.write(t);break;case w.ELGAMAL:case w.ELGAMAL_LEGACY:this.p.write(t),this.g.write(t),this.y.write(t);break;case w.DSA:this.p.write(t),this.q.write(t),this.g.write(t),this.y.write(t);break;case w.ECDH:t.writeU8(this.oid.length),t.writeBytes(this.oid),this.point.write(t),t.writeU8(3),t.writeU8(1),t.writeU8(this.kdfHash),t.writeU8(this.kdfAlg);break;case w.ECDSA:case w.EDDSA:t.writeU8(this.oid.length),t.writeBytes(this.oid),this.point.write(t);break;default:t.writeBytes(this.data)}return t}read(t){switch(this.version=t.readU8(),this.version){case 2:case 3:if(this.timestamp=t.readU32BE(),this.expires=t.readU16BE(),this.algorithm=t.readU8(),!this.isRSA()){if(3!==this.version||!this.isElgamal())throw new Error("Unknown PGP key algorithm.");this.expires=0,this.version=4}break;case 4:this.timestamp=t.readU32BE(),this.algorithm=t.readU8();break;default:throw new Error("Unknown PGP key version.")}switch(this.algorithm){case w.RSA:case w.RSA_ENCRYPT_ONLY:case w.RSA_SIGN_ONLY:this.n.read(t),this.e.read(t);break;case w.ELGAMAL:case w.ELGAMAL_LEGACY:this.p.read(t),this.g.read(t),this.y.read(t);break;case w.DSA:this.p.read(t),this.q.read(t),this.g.read(t),this.y.read(t);break;case w.ECDH:{this.oid=t.readBytes(t.readU8()),this.point.read(t);const e=t.readU8();if(e<3||e>t.left())throw new Error("Invalid ECDH params.");if(1!==t.readU8())throw new Error("Invalid ECDH reserved byte.");this.kdfHash=t.readU8(),this.kdfAlg=t.readU8();break}case w.ECDSA:case w.EDDSA:this.oid=t.readBytes(t.readU8()),this.point.read(t);break;default:this.data=t.readBytes(t.left())}return this}fingerprint(){switch(this.version){case 2:case 3:{if(!this.isRSA())throw new Error("Unknown PGP key algorithm.");const t=n.concat(this.n.data,this.e.data);return a.digest(t)}case 4:{const t=this.getSize(),e=n.write(3+t);return e.writeU8(153),e.writeU16BE(t),this.write(e),c.digest(e.render())}default:throw new Error("Unknown PGP key version.")}}id(){switch(this.version){case 2:case 3:if(!this.isRSA())throw new Error("Unknown PGP key algorithm.");if(this.n.data.length<8)throw new Error("Unknown PGP key algorithm.");return this.n.data.slice(this.n.data.length-8);case 4:return this.fingerprint().slice(12,20);default:throw new Error("Unknown PGP key version.")}}long(){return this.id()}short(){return this.id().slice(4,8)}matches(t){switch("string"==typeof t&&(t=D(t)),t.length){case 4:return this.short().equals(t);case 8:return this.long().equals(t);case 16:case 20:return this.fingerprint().equals(t);default:return!1}}keyHash(){let t=6;4!==this.version&&(t+=2);const e=this.encode().slice(t-1);return e[0]=this.algorithm,d.digest(e)}format(){const t=y[this.algorithm]||"UNKNOWN",e=this.version,r=this.timestamp,i=this.expires;switch(this.algorithm){case w.RSA:case w.RSA_ENCRYPT_ONLY:case w.RSA_SIGN_ONLY:return{version:e,algorithm:t,timestamp:r,expires:i,n:this.n.data.toString("hex"),e:this.e.data.toString("hex")};case w.ELGAMAL:case w.ELGAMAL_LEGACY:return{version:e,algorithm:t,timestamp:r,expires:i,p:this.p.data.toString("hex"),g:this.g.data.toString("hex"),y:this.y.data.toString("hex")};case w.DSA:return{version:e,algorithm:t,timestamp:r,expires:i,p:this.p.data.toString("hex"),q:this.q.data.toString("hex"),g:this.g.data.toString("hex"),y:this.y.data.toString("hex")};case w.ECDH:return{version:e,algorithm:t,timestamp:r,expires:i,curve:I[this.curve]||"UNKNOWN",point:this.point.data.toString("hex"),kdfHash:this.kdfHash,kdfAlg:this.kdfAlg};case w.ECDSA:case w.EDDSA:return{version:e,algorithm:t,timestamp:r,expires:i,curve:I[this.curve]||"UNKNOWN",point:this.point.data.toString("hex")};default:return{version:e,algorithm:t,timestamp:r,expires:i,data:this.data.toString("hex")}}}}class P extends z{constructor(){super(),this.key=new N,this.params=new R,this.data=x}secret(t){let e=this.data;if(this.params.encrypted){if(null==t)throw new Error("Key requires a passphrase.");e=this.params.decrypt(e,t)}return U.decode(e,this.key.algorithm)}getSize(){let t=0;return t+=this.key.getSize(),t+=this.params.getSize(),t+=this.data.length,t}write(t){return this.key.write(t),this.params.write(t),t.writeBytes(this.data),t}read(t){return this.key.read(t),this.params.read(t),this.data=t.readBytes(t.left()),this}format(){let t=null,e=null;return this.params.encrypted?(t=this.params,e=this.data.toString("hex")):(t=null,e=this.secret()),{key:this.key,params:t,data:e}}}class R extends n.Struct{constructor(){super(),this.encrypted=!1,this.checksum=!1,this.cipher=0,this.s2k=new O,this.iv=x}blockSize(){switch(this.cipher){case v.IDEA:case v.DES3:case v.CAST5:case v.BLOWFISH:return 8;case v.AES128:case v.AES192:case v.AES256:case v.TWOFISH:case v.CAMELLIA128:case v.CAMELLIA192:case v.CAMELLIA256:return 16;default:throw new Error("Unknown cipher type.")}}keySize(){switch(this.cipher){case v.IDEA:return 16;case v.DES3:return 24;case v.CAST5:case v.BLOWFISH:case v.AES128:return 16;case v.AES192:return 24;case v.AES256:case v.TWOFISH:return 32;case v.CAMELLIA128:return 16;case v.CAMELLIA192:return 24;case v.CAMELLIA256:return 32;default:throw new Error("Unknown cipher type.")}}algName(){switch(this.cipher){case v.IDEA:return"IDEA-CFB";case v.DES3:return"DES-EDE3-CFB";case v.CAST5:return"CAST5-CFB";case v.BLOWFISH:return"BF-CFB";case v.AES128:return"AES-128-CFB";case v.AES192:return"AES-192-CFB";case v.AES256:return"AES-256-CFB";case v.TWOFISH:return"TWOFISH-256-CFB";case v.CAMELLIA128:return"CAMELLIA-128-CFB";case v.CAMELLIA192:return"CAMELLIA-192-CFB";case v.CAMELLIA256:return"CAMELLIA-256-CFB";default:throw new Error("Unknown cipher type.")}}derive(t){if(!this.encrypted)throw new Error("Cannot derive passphrase.");return this.s2k.derive(t,this.keySize())}encipher(e,r){i(t.isBuffer(e));const s=this.algName(),o=this.checksum?20:2,a=t.alloc(e.length+o);if(e.copy(a,0),this.checksum)c.digest(e).copy(a,e.length);else{let t=0;for(let r=0;r<e.length;r++)t+=e[r],t&=65535;n.writeU16BE(a,t,e.length)}return f.encrypt(s,r,this.iv,a)}decipher(t,e){const r=this.algName(),i=f.decrypt(r,e,this.iv,t);if(this.checksum){if(i.length<20)throw new Error("Truncated data.");const t=i.slice(0,-20),e=i.slice(-20);if(!c.digest(t).equals(e))throw new Error("Invalid checksum.");return t}if(i.length<2)throw new Error("Truncated data.");const s=i.slice(0,-2),o=n.readU16BE(i,i.length-2);let a=0;for(let t=0;t<s.length;t++)a+=s[t],a&=65535;if(a!==o)throw new Error("Invalid checksum.");return s}encrypt(t,e){const r=this.derive(e);return this.encipher(t,r)}decrypt(t,e){const r=this.derive(e);return this.decipher(t,r)}getSize(){let t=0;return this.encrypted?(t+=1,t+=1,t+=this.s2k.getSize(),t+=this.iv.length):t+=1,t}write(t){return this.encrypted?(i(this.iv.length===this.blockSize()),t.writeU8(this.checksum?254:255),t.writeU8(this.cipher),this.s2k.write(t),t.writeBytes(this.iv)):t.writeU8(0),t}read(t){const e=t.readU8();switch(e){case 0:break;case 254:case 255:this.encrypted=!0,this.checksum=254===e,this.cipher=t.readU8(),this.s2k.read(t),this.iv=t.readBytes(this.blockSize());break;default:throw new Error("Unknown S2K type.")}return this}format(){return{encrypted:this.encrypted,checksum:this.checksum,cipher:S[this.cipher]||"UNKNOWN",s2k:this.s2k,iv:this.iv.toString("hex")}}}class O extends n.Struct{constructor(){super(),this.mode=0,this.hash=0,this.count=0,this.salt=x,this.serial=x}derive(e,r){i("string"==typeof e),i(r>>>0===r);const{salt:n,count:s}=this,o=t.from(e,"binary"),f=M[this.hash];if(!f)throw new Error("Unknown hash.");switch(this.mode){case 0:return p.deriveSimple(f,o,r);case 1:return p.deriveSalted(f,o,n,r);case 3:return p.deriveIterated(f,o,n,s,r);default:throw new Error("Unknown S2K mode.")}}getSize(){let t=2;switch(this.mode){case 0:break;case 1:t+=8;break;case 3:t+=8,t+=1;break;case 1001:t+=3,t+=1;break;case 1002:t+=3,t+=1,t+=1,t+=this.serial.length;break;default:throw new Error("Unknown S2K function.")}return t}write(t){switch(t.writeU8(this.mode>255?101:this.mode),t.writeU8(this.hash),this.mode){case 0:break;case 1:t.writeBytes(this.salt);break;case 3:t.writeBytes(this.salt),t.writeU8(function(t){if(i(t>>>0===t),t<1024||t>65011712)throw new RangeError("Invalid iteration count.");for(let e=0;e<256;e++){if(L(e)>=t)return e}return 255}(this.count));break;case 1001:t.writeString("GNU","binary"),t.writeU8(1);break;case 1002:t.writeString("GNU","binary"),t.writeU8(2),t.writeU8(this.serial.length),t.writeBytes(this.serial);break;default:throw new Error("Unknown S2K function.")}return t}read(t){switch(this.mode=t.readU8(),this.hash=t.readU8(),this.mode){case 0:break;case 1:this.salt=t.readBytes(8);break;case 3:this.salt=t.readBytes(8),this.count=L(t.readU8());break;case 101:if("GNU"!==t.readString(3,"binary"))throw new Error("Unknown S2K function.");switch(this.mode=1e3+t.readU8(),this.mode){case 1001:break;case 1002:this.serial=t.readBytes(Math.min(t.readU8(),16));break;default:throw new Error("Unknown S2K function.")}break;default:throw new Error("Unknown S2K function.")}return this}format(){return{mode:this.mode,hash:E[this.hash]||"UNKNOWN",count:this.count,salt:this.salt.toString("hex"),serial:this.serial.toString("hex")}}}class U extends n.Struct{constructor(){super(),this.d=new T,this.q=new T,this.p=new T,this.qi=new T,this.x=new T,this.x,this.d}getSize(t){i((255&t)===t);let e=0;switch(t){case w.RSA:case w.RSA_ENCRYPT_ONLY:case w.RSA_SIGN_ONLY:e+=this.d.getSize(),e+=this.q.getSize(),e+=this.p.getSize(),e+=this.qi.getSize();break;case w.ELGAMAL:case w.ELGAMAL_LEGACY:case w.DSA:e+=this.x.getSize();break;case w.ECDSA:case w.EDDSA:e+=this.d.getSize();break;default:throw new Error("Unknown key type.")}return e}write(t,e){switch(i((255&e)===e),e){case w.RSA:case w.RSA_ENCRYPT_ONLY:case w.RSA_SIGN_ONLY:this.d.write(t),this.q.write(t),this.p.write(t),this.qi.write(t);break;case w.ELGAMAL:case w.ELGAMAL_LEGACY:case w.DSA:this.x.write(t);break;case w.ECDSA:case w.EDDSA:this.d.write(t);break;default:throw new Error("Unknown key type.")}return t}read(t,e){switch(i((255&e)===e),e){case w.RSA:case w.RSA_ENCRYPT_ONLY:case w.RSA_SIGN_ONLY:this.d.read(t),this.q.read(t),this.p.read(t),this.qi.read(t);break;case w.ELGAMAL:case w.ELGAMAL_LEGACY:case w.DSA:this.x.read(t);break;case w.ECDSA:case w.EDDSA:this.d.read(t);break;default:throw new Error("Unknown key type.")}return this}format(){return this.p.data.length>0?{d:this.d.data.toString("hex"),q:this.q.data.toString("hex"),p:this.p.data.toString("hex"),qi:this.qi.data.toString("hex")}:this.x.data.length>0?{x:this.x.data.toString("hex")}:this.d.data.length>0?{d:this.d.data.toString("hex")}:{d:this.d.data.toString("hex"),q:this.q.data.toString("hex"),p:this.p.data.toString("hex"),qi:this.qi.data.toString("hex"),x:this.x.data.toString("hex")}}}class C extends z{constructor(){super(),this.id=""}getSize(){return t.byteLength(this.id,"utf8")}write(t){return t.writeString(this.id,"utf8"),t}read(t){return this.id=t.readString(t.left(),"utf8"),this}format(){return{id:this.id}}}class T extends n.Struct{constructor(t){super(),this.bits=0,this.data=x,null!=t&&this.fromOptions(t)}get(){return this.data}set(t){return this.fromOptions(t)}fromOptions(e){return i(t.isBuffer(e)),this.bits=o(e),this.data=e,this}getSize(){return 2+this.data.length}write(t){return t.writeU16BE(this.bits),t.writeBytes(this.data),t}read(t){if(0===t.left())return this;const e=t.readU16BE(),r=e+7>>>3,i=Math.min(r,t.left()),n=t.readBytes(i);return this.bits=e,this.data=n,this}}function D(e){if(i("string"==typeof e),(e=e.replace(/[\t ]/g,"")).length>=2&&48===e.charCodeAt(0)&&120==(32|e.charCodeAt(1))&&(e=e.substring(2)),e.length>40)throw new Error("Invalid PGP key id/fingerprint.");const r=t.from(e,"hex");if(r.length!==e.length>>>1)throw new Error("Invalid PGP key id/fingerprint.");switch(r.length){case 4:case 8:case 16:case 20:break;default:throw new Error("Invalid PGP key id/fingerprint.")}return r}function L(t){return i((255&t)===t),16+(15&t)<<6+(t>>>4)}e.packetTypes=m,e.packetTypesByVal=g,e.sigTypes={BINARY:0,TEXT:1,GENERIC_CERT:16,PERSONA_CERT:17,CASUAL_CERT:18,POSITIVE_CERT:19,SUBKEY_BINDING:24,PRIMARY_KEY_BINDING:25,DIRECT_SIGNATURE:31,KEY_REVOCATION:32,SUBKEY_REVOCATION:40},e.sigTypesByVal={0:"BINARY",1:"TEXT",16:"GENERIC_CERT",17:"PERSONA_CERT",18:"CASUAL_CERT",19:"POSITIVE_CERT",24:"SUBKEY_BINDING",25:"PRIMARY_KEY_BINDING",31:"DIRECT_SIGNATURE",32:"KEY_REVOCATION",40:"SUBKEY_REVOCATION"},e.keyTypes=w,e.keyTypesByVal=y,e.cipherTypes=v,e.cipherTypesByVal=S,e.hashTypes={MD5:1,SHA1:2,RIPEMD160:3,SHA256:8,SHA384:9,SHA512:10,SHA224:11},e.hashTypesByVal=E,e.compressTypes={NONE:0,ZIP:1,ZLIB:2,BZIP2:3},e.compressTypesByVal={0:"NONE",1:"ZIP",2:"ZLIB",3:"BZIP2"},e.curveTypes=A,e.curveTypesByVal=I,e.oids=_,e.PGPMessage=B,e.PGPPacket=k,e.PGPBody=z,e.PGPUnknown=q,e.PGPPublicKey=N,e.PGPPrivateKey=P,e.CipherParams=R,e.S2K=O,e.SecretKey=U,e.PGPUserID=C,e.MPI=T,e.encodeID=function(e){switch(i(t.isBuffer(e)),e.length){case 4:case 8:case 16:case 20:break;default:throw new Error("Invalid PGP key id/fingerprint.")}return"0x"+e.toString("hex").toUpperCase()},e.decodeID=D}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * sha224.js - SHA224 implementation for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/hash.js:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/hash.js
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/SHA-2
 *   https://tools.ietf.org/html/rfc4634
 *   https://github.com/indutny/hash.js/blob/master/lib/hash/sha/224.js
 */
const i=r(1),n=r(36),s=r(3);class o extends n{constructor(){super()}init(){return this.state[0]=3238371032,this.state[1]=914150663,this.state[2]=812702999,this.state[3]=4144912697,this.state[4]=4290775857,this.state[5]=1750603025,this.state[6]=1694076839,this.state[7]=3204075428,this.size=0,this}final(){return super.final().slice(0,28)}static hash(){return new o}static hmac(){return new s(o,64)}static digest(t){return o.ctx.init().update(t).final()}static root(t,r){return i(e.isBuffer(t)&&28===t.length),i(e.isBuffer(r)&&28===r.length),o.ctx.init().update(t).update(r).final()}static multi(t,e,r){const{ctx:i}=o;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return o.hmac().init(e).update(t).final()}}o.native=0,o.id="SHA224",o.size=28,o.bits=224,o.blockSize=64,o.zero=e.alloc(28,0),o.ctx=new o,t.exports=o}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * pgpdf.js - pgpdf for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(274)},function(t,e,r){"use strict";(function(t){
/*!
 * pgpdf.js - PGP derivation functions for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/crypto:
 *   Copyright (c) 2009 The Go Authors. All rights reserved.
 *   https://github.com/golang/crypto
 *
 * Resources:
 *   https://github.com/golang/crypto/tree/master/openpgp
 */
const i=r(1),n=t.alloc(0),s=t.alloc(1,0);function o(e,r,n,o){i(e&&"string"==typeof e.id),i(t.isBuffer(r)),i(t.isBuffer(n)),i(o>>>0===o);const f=new e,a=t.alloc(o);let c=0,h=0;for(;h<o;){f.init();for(let t=0;t<c;t++)f.update(s);f.update(n),f.update(r),h+=f.final().copy(a,h),c+=1}return a}e.native=0,e.deriveSimple=function(t,e,r){return o(t,e,n,r)},e.deriveSalted=o,e.deriveIterated=function(e,r,n,o,f){i(e&&"string"==typeof e.id),i(t.isBuffer(r)),i(t.isBuffer(n)),i(o>>>0===o),i(f>>>0===f);const a=new e,c=t.alloc(f),h=n.length+r.length;o<h&&(o=h);let u=0,d=0;for(;d<f;){a.init();for(let t=0;t<u;t++)a.update(s);let t=0;for(;t<o;){if(t+h>o){const e=o-t;e<n.length?a.update(n.slice(0,e)):(a.update(n),a.update(r.slice(0,e-n.length)));break}a.update(n),a.update(r),t+=h}d+=a.final().copy(c,d),u+=1}return c}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(t,i){
/*!
 * rsa.js - RSA for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009 The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Parts of this software are based on indutny/miller-rabin:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/miller-rabin
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/RSA_(cryptosystem)
 *   https://tools.ietf.org/html/rfc3447
 *   https://tools.ietf.org/html/rfc8017
 *   https://github.com/openssl/openssl/blob/master/crypto/rsa/rsa_ossl.c
 *   https://github.com/openssl/openssl/blob/master/crypto/rsa/rsa_sign.c
 *   https://github.com/openssl/openssl/blob/master/crypto/rsa/rsa_oaep.c
 *   https://github.com/openssl/openssl/blob/master/crypto/rsa/rsa_pss.c
 *   https://github.com/openssl/openssl/blob/master/crypto/rsa/rsa_pk1.c
 *   https://github.com/golang/go/blob/master/src/crypto/rsa/rsa.go
 *   https://github.com/golang/go/blob/master/src/crypto/rsa/pkcs1v15.go
 *   https://github.com/golang/go/blob/master/src/crypto/rsa/pss.go
 *   https://github.com/golang/go/blob/master/src/crypto/subtle/constant_time.go
 *   https://github.com/ARMmbed/mbed-crypto/blob/master/library/rsa.c
 *
 * References:
 *
 *   [RFC8017] PKCS #1: RSA Cryptography Specifications Version 2.2
 *     K. Moriarty, B. Kaliski, J. Jonsson, A. Rusch
 *     https://tools.ietf.org/html/rfc8017
 *
 *   [FIPS186] Federal Information Processing Standards Publication 186-4
 *     National Institute of Standards and Technology
 *     https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf
 */
const n=r(1),s=r(6),o=r(5),{randomPrime:f}=r(85),a=r(40),c=r(49),h=r(110),{safeEqual:u,safeEqualByte:d,safeSelect:l,safeLTE:b}=h,p=t.alloc(8,0),m=t.alloc(0),g={__proto__:null,BLAKE2B160:t.from("3027300f060b2b060104018d3a0c02010505000414","hex"),BLAKE2B256:t.from("3033300f060b2b060104018d3a0c02010805000420","hex"),BLAKE2B384:t.from("3043300f060b2b060104018d3a0c02010c05000430","hex"),BLAKE2B512:t.from("3053300f060b2b060104018d3a0c02011005000440","hex"),BLAKE2S128:t.from("3023300f060b2b060104018d3a0c02020405000410","hex"),BLAKE2S160:t.from("3027300f060b2b060104018d3a0c02020505000414","hex"),BLAKE2S224:t.from("302f300f060b2b060104018d3a0c0202070500041c","hex"),BLAKE2S256:t.from("3033300f060b2b060104018d3a0c02020805000420","hex"),GOST94:t.from("302e300a06062a850302021405000420","hex"),HASH160:t.from([20]),HASH256:t.from([32]),KECCAK224:t.from([28]),KECCAK256:t.from([32]),KECCAK384:t.from([48]),KECCAK512:t.from([64]),MD2:t.from("3020300c06082a864886f70d020205000410","hex"),MD4:t.from("3020300c06082a864886f70d020405000410","hex"),MD5:t.from("3020300c06082a864886f70d020505000410","hex"),MD5SHA1:t.from([36]),RIPEMD160:t.from("3022300a060628cf0603003105000414","hex"),SHA1:t.from("3021300906052b0e03021a05000414","hex"),SHA224:t.from("302d300d06096086480165030402040500041c","hex"),SHA256:t.from("3031300d060960864801650304020105000420","hex"),SHA384:t.from("3041300d060960864801650304020205000430","hex"),SHA512:t.from("3051300d060960864801650304020305000440","hex"),SHA3_224:t.from("302d300d06096086480165030402070500041c","hex"),SHA3_256:t.from("3031300d060960864801650304020805000420","hex"),SHA3_384:t.from("3041300d060960864801650304020905000430","hex"),SHA3_512:t.from("3051300d060960864801650304020a05000440","hex"),SHAKE128:t.from("3021300d060960864801650304020b05000410","hex"),SHAKE256:t.from("3031300d060960864801650304020c05000420","hex"),WHIRLPOOL:t.from("304e300a060628cf0603003705000440","hex")};class w{constructor(){this.n=new s(0),this.e=new s(0)}bits(){return this.n.bitLength()}size(){return this.n.byteLength()}isSane(){return this.n.sign()>0&&this.e.sign()>0&&this.n.bitLength()<=16384&&this.e.bitLength()<=33}verify(){return!!this.isSane()&&(!(this.n.bitLength()<512||!this.n.isOdd())&&!(this.e.cmpn(3)<0||!this.e.isOdd()))}encrypt(e){n(t.isBuffer(e));const{n:r,e:i}=this,o=s.decode(e);if(o.cmp(r)>=0)throw new Error("Invalid RSA message size.");return o.powm(i,r).encode("be",r.byteLength())}encode(){const e=c.sizeInt(this.n)+c.sizeInt(this.e),r=t.alloc(c.sizeSeq(e));let i=0;return i=c.writeSeq(r,i,e),i=c.writeInt(r,i,this.n),i=c.writeInt(r,i,this.e),n(i===r.length),r}decode(t){let e=0;if(e=c.readSeq(t,e),[this.n,e]=c.readInt(t,e),[this.e,e]=c.readInt(t,e),e!==t.length)throw new Error("Trailing bytes.");return this}static decode(t){return(new w).decode(t)}}class y extends w{constructor(){super(),this.d=new s(0),this.p=new s(0),this.q=new s(0),this.dp=new s(0),this.dq=new s(0),this.qi=new s(0)}isSane(){return this.n.sign()>0&&this.e.sign()>0&&this.d.sign()>0&&this.p.sign()>0&&this.q.sign()>0&&this.dp.sign()>0&&this.dq.sign()>0&&this.qi.sign()>0&&this.n.bitLength()<=16384&&this.e.bitLength()<=33&&this.d.bitLength()<=16384&&this.p.bitLength()<=16384&&this.q.bitLength()<=16384&&this.dp.bitLength()<=16384&&this.dq.bitLength()<=16384&&this.qi.bitLength()<=16384}verify(){if(!this.isSane())return!1;if(this.n.bitLength()<512||!this.n.isOdd())return!1;if(this.e.cmpn(3)<0||!this.e.isOdd())return!1;if(this.p.cmpn(3)<0||!this.p.isOdd())return!1;if(this.q.cmpn(3)<0||!this.q.isOdd())return!1;const t=this.p.subn(1),e=this.q.subn(1),r=t.mul(e);if(this.d.cmpn(2)<0||this.d.cmp(r)>=0)return!1;if(0===this.dp.sign()||this.dp.cmp(t)>=0)return!1;if(0===this.dq.sign()||this.dq.cmp(e)>=0)return!1;if(this.qi.cmpn(2)<0||this.qi.cmp(this.p)>=0)return!1;if(0===this.p.cmp(this.q))return!1;if(0!==this.p.mul(this.q).cmp(this.n))return!1;const i=r.div(t.gcd(e));return 0===this.e.mul(this.d).imod(i).cmpn(1)&&(0===this.d.mod(t).cmp(this.dp)&&(0===this.d.mod(e).cmp(this.dq)&&0===this.q.mul(this.qi).imod(this.p).cmpn(1)))}decrypt(e){n(t.isBuffer(e));const{n:r,e:i,p:f,q:a,dp:c,dq:h,qi:u}=this,d=s.decode(e);if(d.cmp(r)>=0)throw new Error("Invalid RSA message size.");let l,b;for(;;){const t=s.random(o,1,r);try{b=t.invert(r)}catch(i){continue}l=t.powm(i,r);break}d.imul(l).imod(r);const p=d.powm(c,f,!0),m=d.powm(h,a,!0),g=p.sub(m).mul(u).imod(f).mul(a).iadd(m).imod(r);if(0!==g.powm(i,r).cmp(d))throw new Error("Invalid RSA private key.");return g.imul(b).imod(r),g.encode("be",r.byteLength())}generate(t,e){n(t>>>0===t),n(Number.isSafeInteger(e)&&e>=0),n(t>=64),n(e>=3&&0!=(1&e));const r=new s(e);for(;;){const e=f((t>>>1)+(1&t)),i=f(t>>>1);if(0===e.cmp(i))continue;if(e.cmp(i)<0&&e.swap(i),e.sub(i).bitLength()<=(t>>>1)-99)continue;const n=e.mul(i);if(n.bitLength()!==t)continue;const s=e.subn(1),o=i.subn(1),a=s.mul(o);if(0!==r.gcd(a).cmpn(1))continue;const c=a.div(s.gcd(o)),h=r.invert(c);if(h.bitLength()<=t+1>>>1)continue;const u=h.mod(s),d=h.mod(o),l=i.invert(e);return this.n=n,this.e=r,this.d=h,this.p=e,this.q=i,this.dp=u,this.dq=d,this.qi=l,this}}async _generateSubtle(t,e){n(t>>>0===t),n(Number.isSafeInteger(e)&&e>=0),n(t>=64),n(e>=3&&0!=(1&e));const r=i.crypto||i.msCrypto;if(!r)throw new Error("Crypto API not available.");const{subtle:o}=r;if(!o||!o.generateKey||!o.exportKey)throw new Error("Subtle API not available.");const f=new s(e),c={name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:f.toArrayLike(Uint8Array,"be",8),hash:{name:"SHA-256"}},h=await o.generateKey(c,!0,["sign"]),u=await o.exportKey("jwk",h.privateKey),d=s.decode(a.decodeURL(u.p)),l=s.decode(a.decodeURL(u.q));return this.fromPQE(d,l,f)}async generateAsync(t,e){try{return await this._generateSubtle(t,e)}catch(r){return this.generate(t,e)}}fromPQE(t,e,r){if(n(t instanceof s),n(e instanceof s),n(r instanceof s),t.cmp(e)<0&&([t,e]=[e,t]),0===t.cmp(e))throw new Error("Invalid RSA private key.");if(t.cmpn(3)<0||t.bitLength()>16384)throw new Error("Invalid RSA private key.");if(e.cmpn(3)<0||e.bitLength()>16384)throw new Error("Invalid RSA private key.");if(r.cmpn(3)<0||r.bitLength()>33)throw new Error("Invalid RSA private key.");if(!t.isOdd()||!e.isOdd()||!r.isOdd())throw new Error("Invalid RSA private key.");const i=t.mul(e);if(n(i.isOdd()),i.bitLength()<512||i.bitLength()>16384)throw new Error("Invalid RSA private key.");const o=t.subn(1),f=e.subn(1),a=o.lcm(f),c=r.invert(a),h=c.mod(o),u=c.mod(f),d=e.invert(t);return this.n=i,this.e=r,this.d=c,this.p=t,this.q=e,this.dp=h,this.dq=u,this.qi=d,this}fromPQD(t,e,r){if(n(t instanceof s),n(e instanceof s),n(r instanceof s),t.cmpn(3)<0||t.bitLength()>16384)throw new Error("Invalid RSA private key.");if(e.cmpn(3)<0||e.bitLength()>16384)throw new Error("Invalid RSA private key.");if(!t.isOdd()||!e.isOdd())throw new Error("Invalid RSA private key.");const i=t.subn(1),o=e.subn(1),f=i.mul(o);if(r.cmpn(2)<0||r.cmp(f)>=0)throw new Error("Invalid RSA private key.");const a=f.div(i.gcd(o)),c=r.invert(a);return this.fromPQE(t,e,c)}fromNED(t,e,r){if(n(t instanceof s),n(e instanceof s),n(r instanceof s),t.sign()<0)throw new Error("Invalid RSA private key.");if(t.bitLength()<512||t.bitLength()>16384)throw new Error("Invalid RSA private key.");if(e.cmpn(3)<0||e.bitLength()>33)throw new Error("Invalid RSA private key.");if(r.cmpn(2)<0||r.bitLength()>16384)throw new Error("Invalid RSA private key.");if(!t.isOdd()||!e.isOdd())throw new Error("Invalid RSA private key.");const i=e.mul(r).isubn(1),f=t.subn(1),a=i.zeroBits(),c=i.ushrn(a);for(let r=0;r<64;r++){let r=s.random(o,2,f).powm(c,t);if(0!==r.cmpn(1)&&0!==r.cmp(f))for(let i=1;i<a;i++){const i=r.sqr().imod(t);if(0===i.cmpn(1)){const i=t.gcd(r.subn(1)),n=t.gcd(r.addn(1));return this.fromPQE(i,n,e)}if(0===i.cmp(f))break;r=i}}throw new Error("Invalid RSA private key.")}toPublic(){const t=new w;return t.n=this.n,t.e=this.e,t}encode(){let e=0;e+=c.sizeVersion(0),e+=c.sizeInt(this.n),e+=c.sizeInt(this.e),e+=c.sizeInt(this.d),e+=c.sizeInt(this.p),e+=c.sizeInt(this.q),e+=c.sizeInt(this.dp),e+=c.sizeInt(this.dq),e+=c.sizeInt(this.qi);const r=t.alloc(c.sizeSeq(e));let i=0;return i=c.writeSeq(r,i,e),i=c.writeVersion(r,i,0),i=c.writeInt(r,i,this.n),i=c.writeInt(r,i,this.e),i=c.writeInt(r,i,this.d),i=c.writeInt(r,i,this.p),i=c.writeInt(r,i,this.q),i=c.writeInt(r,i,this.dp),i=c.writeInt(r,i,this.dq),i=c.writeInt(r,i,this.qi),n(i===r.length),r}decode(t){let e=0;if(e=c.readSeq(t,e),e=c.readVersion(t,e,0),[this.n,e]=c.readInt(t,e),[this.e,e]=c.readInt(t,e),[this.d,e]=c.readInt(t,e),[this.p,e]=c.readInt(t,e),[this.q,e]=c.readInt(t,e),[this.dp,e]=c.readInt(t,e),[this.dq,e]=c.readInt(t,e),[this.qi,e]=c.readInt(t,e),e!==t.length)throw new Error("Trailing bytes.");return this}static generate(t,e){return(new y).generate(t,e)}static async generateAsync(t,e){return(new y).generateAsync(t,e)}static fromPQE(t,e,r){return(new y).fromPQE(t,e,r)}static fromPQD(t,e,r){return(new y).fromPQD(t,e,r)}static fromNED(t,e,r){return(new y).fromNED(t,e,r)}static decode(t){return(new y).decode(t)}}function v(e,r){if(n(null==e||"string"==typeof e),n(t.isBuffer(r)),null==e)return[m,r.length];const i=g[e];return null==i?[null,0]:1===i.length?[m,i[0]]:[i,i[i.length-1]]}function S(e,r,i){n(e&&"string"==typeof e.id),n(t.isBuffer(r)),n(t.isBuffer(i));const s=t.alloc(4,0);let o=0;for(;o<r.length;){const t=e.multi(i,s);let n=0;for(;o<r.length&&n<t.length;)r[o++]^=t[n++];for(n=3;n>=0&&(s[n]+=1,0===s[n]);n--);}}e.native=0,e.SALT_LENGTH_AUTO=0,e.SALT_LENGTH_HASH=-1,e.privateKeyGenerate=function(t,e){if(null==t&&(t=2048),null==e&&(e=65537),n(t>>>0===t),n(Number.isSafeInteger(e)&&e>=0),t<512||t>16384)throw new RangeError('"bits" ranges from 512 to 16384.');if(e<3||e>2**33-1)throw new RangeError('"exponent" ranges from 3 to 8589934591.');if(1===e||0==(1&e))throw new RangeError('"exponent" must be odd.');return y.generate(t,e).encode()},e.privateKeyGenerateAsync=async function(t,e){if(null==t&&(t=2048),null==e&&(e=65537),n(t>>>0===t),n(Number.isSafeInteger(e)&&e>=0),t<512||t>16384)throw new RangeError('"bits" ranges from 512 to 16384.');if(e<3||e>2**33-1)throw new RangeError('"exponent" ranges from 3 to 8589934591.');if(1===e||0==(1&e))throw new RangeError('"exponent" must be odd.');return(await y.generateAsync(t,e)).encode()},e.privateKeyBits=function(t){const e=y.decode(t);if(!e.verify())throw new Error("Invalid RSA private key.");return e.bits()},e.privateKeyVerify=function(e){let r;n(t.isBuffer(e));try{r=y.decode(e)}catch(t){return!1}return r.verify()},e.privateKeyImport=function(t){n(t&&"object"==typeof t);let e=new y;return null!=t.n&&(e.n=s.decode(t.n)),null!=t.e&&(e.e=s.decode(t.e)),null!=t.d&&(e.d=s.decode(t.d)),null!=t.p&&(e.p=s.decode(t.p)),null!=t.q&&(e.q=s.decode(t.q)),null!=t.dp&&(e.dp=s.decode(t.dp)),null!=t.dq&&(e.dq=s.decode(t.dq)),null!=t.qi&&(e.qi=s.decode(t.qi)),e.verify()||(e=e.p.isZero()||e.q.isZero()?y.fromNED(e.n,e.e,e.d):e.e.isZero()?y.fromPQD(e.p,e.q,e.d):y.fromPQE(e.p,e.q,e.e)),e.encode()},e.privateKeyExport=function(t){const e=y.decode(t);if(!e.verify())throw new Error("Invalid RSA private key.");return{n:e.n.encode(),e:e.e.encode(),d:e.d.encode(),p:e.p.encode(),q:e.q.encode(),dp:e.dp.encode(),dq:e.dq.encode(),qi:e.qi.encode()}},e.publicKeyCreate=function(t){const e=y.decode(t);if(!e.verify())throw new Error("Invalid RSA private key.");return e.toPublic().encode()},e.publicKeyBits=function(t){const e=w.decode(t);if(!e.verify())throw new Error("Invalid RSA public key.");return e.bits()},e.publicKeyVerify=function(e){let r;n(t.isBuffer(e));try{r=w.decode(e)}catch(t){return!1}return r.verify()},e.publicKeyImport=function(t){n(t&&"object"==typeof t);const e=new w;if(null!=t.n&&(e.n=s.decode(t.n)),null!=t.e&&(e.e=s.decode(t.e)),!e.verify())throw new Error("Invalid RSA public key.");return e.encode()},e.publicKeyExport=function(t){const e=w.decode(t);if(!e.verify())throw new Error("Invalid RSA public key.");return{n:e.n.encode(),e:e.e.encode()}},e.sign=function(e,r,i){e&&"string"==typeof e.id&&(e=e.id),n(null==e||"string"==typeof e),n(t.isBuffer(r));const[s,o]=v(e,r);if(!s)throw new Error("Unknown RSA hash function.");if(r.length!==o)throw new Error("Invalid RSA message size.");const f=y.decode(i);if(!f.verify())throw new Error("Invalid RSA private key.");const a=s.length+o,c=f.size();if(c<a+11)throw new Error("Invalid RSA message size.");const h=t.alloc(c);h[0]=0,h[1]=1;for(let t=2;t<c-a-1;t++)h[t]=255;return h[c-a-1]=0,s.copy(h,c-a),r.copy(h,c-o),f.decrypt(h)},e.verify=function(e,r,i,s){e&&"string"==typeof e.id&&(e=e.id),n(null==e||"string"==typeof e),n(t.isBuffer(r)),n(t.isBuffer(i)),n(t.isBuffer(s));try{return function(t,e,r,i){const[n,s]=v(t,e);if(!n)return!1;if(e.length!==s)return!1;const o=w.decode(i);if(!o.verify())return!1;const f=o.size();if(r.length!==f)return!1;const a=n.length+s;if(f<a+11)return!1;const c=o.encrypt(r);let h=1;h&=d(c[0],0),h&=d(c[1],1);for(let t=2;t<f-a-1;t++)h&=d(c[t],255);return h&=d(c[f-a-1],0),h&=u(c.slice(f-a,f-s),n),h&=u(c.slice(f-s,f),e),1===h}(e,r,i,s)}catch(t){return!1}},e.encrypt=function(e,r){n(t.isBuffer(e));const i=w.decode(r);if(!i.verify())throw new Error("Invalid RSA public key.");const s=i.size();if(e.length>s-11)throw new Error("Invalid RSA message size.");const f=t.alloc(s),a=e.length,c=s-a-3;f[0]=0,f[1]=2,o.randomFill(f,2,c);for(let t=2;t<2+c;t++)for(;0===f[t];)o.randomFill(f,t,1);return f[s-a-1]=0,e.copy(f,s-a),i.encrypt(f)},e.decrypt=function(e,r){n(t.isBuffer(e));const i=y.decode(r);if(!i.verify())throw new Error("Invalid RSA private key.");const s=i.size();if(s<11)throw new Error("Invalid RSA private key.");if(e.length!==s)throw new Error("Invalid RSA message size.");const o=i.decrypt(e),f=d(o[0],0),a=d(o[1],2);let c=0,h=1;for(let t=2;t<o.length;t++){const e=d(o[t],0);c=l(c,t,h&e),h=l(h,0,e)}const u=f&a&(1^h)&b(10,c),p=l(0,c+1,u);if(0===u)throw new Error("Invalid RSA ciphertext.");return o.slice(p)},e.signPSS=function(e,r,i,s){if(null==s&&(s=-1),n(e&&"string"==typeof e.id),n(t.isBuffer(r)),n((0|s)===s),r.length!==e.size)throw new Error("Invalid RSA message size.");const f=y.decode(i);if(!f.verify())throw new Error("Invalid RSA private key.");const a=f.bits(),c=a+7>>>3;if(0===s?s=(a+6>>>3)-2-e.size:-1===s&&(s=e.size),s<0||s>c)throw new Error("Invalid PSS salt length.");const h=function(e,r,i,s){n(e&&"string"==typeof e.id),n(t.isBuffer(r)),n(i>>>0===i),n(t.isBuffer(s));const o=e.size,f=s.length,a=i+7>>>3;if(r.length!==o)throw new Error("Invalid RSA message size.");if(a<o+f+2)throw new Error("Message too long.");const c=t.alloc(a),h=c.slice(0,a-o-1),u=c.slice(a-o-1,a-1),d=e.multi(p,r,s),l=255>>>8*a-i;return h.fill(0,0,a-f-o-2),h[a-f-o-2]=1,s.copy(h,a-f-o-1),d.copy(u,0),c[a-1]=188,S(e,h,u),h[0]&=l,c}(e,r,a-1,o.randomBytes(s));return f.decrypt(h)},e.verifyPSS=function(e,r,i,s,o){null==o&&(o=-1),n(e&&"string"==typeof e.id),n(t.isBuffer(r)),n(t.isBuffer(i)),n(t.isBuffer(s)),n((0|o)===o);try{return function(e,r,i,s,o){if(r.length!==e.size)return!1;const f=w.decode(s);if(!f.verify())return!1;const a=f.bits(),c=a+7>>>3;if(i.length!==c)return!1;0===o?o=0:-1===o&&(o=e.size);if(o<0||o>c)return!1;let h=f.encrypt(i);if(0==(a-1&7)){if(0!==h[0])return!1;h=h.slice(1)}return function(e,r,i,s,o){n(e&&"string"==typeof e.id),n(t.isBuffer(r)),n(t.isBuffer(i)),n(s>>>0===s),n(o>>>0===o);const f=e.size,a=s+7>>>3;if(r.length!==f)return!1;if(a<f+o+2)return!1;if(188!==i[a-1])return!1;const c=i.slice(0,a-f-1),h=i.slice(a-f-1,a-1),u=255>>>8*a-s;if(i[0]&~u)return!1;if(S(e,c,h),c[0]&=u,0===o){o=-1;for(let t=0;t<c.length;t++)if(0!==c[t]){if(1===c[t]){o=c.length-(t+1);break}return!1}if(-1===o)return!1}else{const t=c.length-o-1;for(let e=0;e<t;e++)if(0!==c[e])return!1;if(1!==c[t])return!1}const d=c.slice(c.length-o);return e.multi(p,r,d).equals(h)}(e,r,h,a-1,o)}(e,r,i,s,o)}catch(t){return!1}},e.encryptOAEP=function(e,r,i,s){null==s&&(s=m),n(e&&"string"==typeof e.id),n(t.isBuffer(r)),n(t.isBuffer(s));const f=w.decode(i);if(!f.verify())throw new Error("Invalid RSA public key.");const a=f.size(),c=r.length,h=e.size;if(c>a-2*h-2)throw new Error("Invalid RSA message size.");const u=t.alloc(a),d=e.digest(s),l=u.slice(1,1+h),b=u.slice(1+h),p=b.length;return u[0]=0,o.randomFill(l,0,l.length),d.copy(b,0),b.fill(0,h,p-c-1),b[p-c-1]=1,r.copy(b,p-c),S(e,b,l),S(e,l,b),f.encrypt(u)},e.decryptOAEP=function(e,r,i,s){null==s&&(s=m),n(e&&"string"==typeof e.id),n(t.isBuffer(r)),n(t.isBuffer(s));const o=y.decode(i);if(!o.verify())throw new Error("Invalid RSA private key.");const f=o.size(),a=r.length,c=e.size;if(f<2*c+2)throw new Error("Invalid RSA private key size.");if(a!==f)throw new Error("Invalid RSA message size.");const h=o.decrypt(r),b=e.digest(s),p=d(h[0],0),g=h.slice(1,c+1),w=h.slice(c+1);S(e,g,w),S(e,w,g);const v=w.slice(0,c),E=u(v,b),M=w.slice(c);let A=1,I=0,_=0;for(let t=0;t<M.length;t++){const e=d(M[t],0),r=d(M[t],1);I=l(I,t,A&r),A=l(A,0,r),_=l(_,1,A&(1^e))}if(0===(p&E&(1^_)&(1^A)))throw new Error("Invalid RSA ciphertext.");return M.slice(I+1)},e.veil=function(e,r,i){n(t.isBuffer(e)),n(r>>>0===r);const f=w.decode(i);if(!f.verify())throw new Error("Invalid RSA public key.");if(e.length!==f.size())throw new Error("Invalid RSA ciphertext.");if(r<f.bits())throw new Error("Cannot make ciphertext smaller.");const a=r+7>>>3,c=s.decode(e);if(c.cmp(f.n)>=0)throw new Error("Invalid RSA ciphertext.");const h=s.shift(1,r),u=h.sub(c).iadd(f.n).isubn(1).div(f.n);n(u.sign()>0);let d=h;for(;d.cmp(h)>=0;){const t=s.random(o,0,u);d=c.add(t.mul(f.n))}return n(0===d.mod(f.n).cmp(c)),n(d.bitLength()<=r),d.encode("be",a)},e.unveil=function(e,r,i){n(t.isBuffer(e)),n(r>>>0===r);const o=w.decode(i);if(!o.verify())throw new Error("Invalid RSA public key.");const f=o.size();if(e.length<f)throw new Error("Invalid RSA ciphertext.");const a=s.decode(e);if(0!==r&&a.bitLength()>r)throw new Error("Invalid RSA ciphertext.");return a.imod(o.n).encode("be",f)}}).call(this,r(0).Buffer,r(13))},function(t,e,r){"use strict";(function(t){
/*!
 * rsaies.js - rsaies for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(1),n=r(109),s=r(5),o=r(26);e.encrypt=function(e,r,f,a=null,c=null){i(e&&"string"==typeof e.id),i(t.isBuffer(r));const h=s.randomBytes(32);let u=n.encryptOAEP(e,h,f,c);null!=a&&(u=n.veil(u,a,f));const d=s.randomBytes(24),l=o.seal(r,h,d);return t.concat([u,d,l])},e.decrypt=function(e,r,s,f=null,a=null){i(e&&"string"==typeof e.id),i(t.isBuffer(r)),i(t.isBuffer(s)),null==f&&(f=n.privateKeyBits(s)),i(f>>>0===f);const c=f+7>>>3;if(r.length<c+24)throw new Error("Invalid ciphertext.");const h=n.publicKeyCreate(s),u=n.unveil(r.slice(0,c),f,h),d=n.decryptOAEP(e,u,s,a),l=r.slice(c,c+24),b=r.slice(c+24);return o.open(b,d,l)}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * schnorr.js - schnorr for bcrypto
 * Copyright (c) 2020, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(278)},function(t,e,r){"use strict";(function(e){
/*!
 * schnorr.js - bip340 for bcrypto
 * Copyright (c) 2019-2020, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on bips/bip-0340:
 *   Copyright (c) 2018-2020, Pieter Wuille (2-clause BSD License).
 *   https://github.com/bitcoin/bips/blob/master/bip-0340/reference.py
 *
 * Parts of this software are based on bitcoin-core/secp256k1:
 *   Copyright (c) 2013, Pieter Wuille.
 *   https://github.com/bitcoin-core/secp256k1
 *
 * Resources:
 *   https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki
 *   https://github.com/bitcoin/bips/blob/master/bip-0340/reference.py
 *   https://github.com/bitcoin/bips/blob/master/bip-0340/test-vectors.csv
 *
 * References:
 *
 *   [BIP340] Schnorr Signatures for secp256k1
 *     Pieter Wuille, Jonas Nick, Tim Ruffing
 *     https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki
 */
const i=r(1),n=r(50),s=r(6),o=r(5),f=r(11),a=r(38),c=r(33),h=r(111);function u(t,r){const i=e.from(r,"binary");let n;return n=t.size!==t.blockSize/2?a.digest(i,t.blockSize/2):t.digest(i),e.concat([n,n])}t.exports=new class{constructor(t,e,r){i("string"==typeof t),i(e),this.id=t,this.type="schnorr",this.hash=e,this.native=0,this._pre=r||null,this._curve=null,this._rng=null,this._auxTag=null,this._nonceTag=null,this._challengeTag=null}get curve(){return this._curve||(this._curve=c.curve(this.id,this._pre),this._curve.precompute(o),this._pre=null),this._curve}get rng(){return this._rng||(this._rng=new n(this.curve)),this._rng}get size(){return this.curve.fieldSize}get bits(){return this.curve.fieldBits}hashInt(...t){const e=new this.hash;e.init();for(const r of t)e.update(r);let r=e.final(this.curve.scalarSize);r.length>this.curve.scalarSize&&(r=r.slice(0,this.curve.scalarSize));const i=s.decode(r,this.curve.endian);return i.iumaskn(this.curve.scalarBits),i.imod(this.curve.n)}hashAux(t,r){i(e.isBuffer(t)),i(e.isBuffer(r)),i(t.length===this.curve.scalarSize),i(32===r.length),this._auxTag||(this._auxTag=u(this.hash,"BIP0340/aux"));const n=new this.hash;n.init(),n.update(this._auxTag),n.update(r);const s=n.final(this.curve.scalarSize),o=e.alloc(this.curve.scalarSize);for(let e=0;e<this.curve.scalarSize;e++)o[e]=t[e]^s[e];return o}hashNonce(t,e,r,i){return this._nonceTag||(this._nonceTag=u(this.hash,"BIP0340/nonce")),null==i?this.hashInt(this._nonceTag,t,e,r):this.hashInt(this._nonceTag,this.hashAux(t,i),e,r)}hashChallenge(t,e,r){return this._challengeTag||(this._challengeTag=u(this.hash,"BIP0340/challenge")),this.hashInt(this._challengeTag,t,e,r)}privateKeyGenerate(){const t=this.curve.randomScalar(o);return this.curve.encodeScalar(t)}privateKeyVerify(t){let r;i(e.isBuffer(t));try{r=this.curve.decodeScalar(t)}catch(t){return!1}return!r.isZero()&&r.cmp(this.curve.n)<0}privateKeyExport(t){const e=this.curve.decodeScalar(t);if(e.isZero()||e.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");let r=this.curve.g.mul(e);return r.isEven()||(e.ineg().imod(this.curve.n),r=r.neg()),{d:this.curve.encodeScalar(e),x:this.curve.encodeField(r.x.fromRed()),y:this.curve.encodeField(r.y.fromRed())}}privateKeyImport(t){i(t&&"object"==typeof t);const e=s.decode(t.d,this.curve.endian);if(e.isZero()||e.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");return this.curve.encodeScalar(e)}privateKeyTweakAdd(t,e){const r=this.curve.decodeScalar(e);if(r.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");const i=this.curve.decodeScalar(t);if(i.isZero()||i.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");this.curve.g.mul(i).isEven()||i.ineg().imod(this.curve.n);const n=i.add(r).imod(this.curve.n);if(n.isZero())throw new Error("Invalid private key.");return this.curve.encodeScalar(n)}privateKeyTweakMul(t,e){const r=this.curve.decodeScalar(e);if(r.isZero()||r.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");const i=this.curve.decodeScalar(t);if(i.isZero()||i.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const n=i.mul(r).imod(this.curve.n);if(n.isZero())throw new Error("Invalid private key.");return this.curve.encodeScalar(n)}privateKeyInvert(t){const e=this.curve.decodeScalar(t);if(e.isZero()||e.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const r=e.invert(this.curve.n);return this.curve.encodeScalar(r)}publicKeyCreate(t){const e=this.curve.decodeScalar(t);if(e.isZero()||e.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");return this.curve.g.mulBlind(e).encodeX()}publicKeyFromUniform(t){const e=this.curve.decodeUniform(t);return this.curve.pointFromUniform(e).encodeX()}publicKeyToUniform(t,e=o.randomInt()){const r=this.curve.decodeEven(t),i=this.curve.pointToUniform(r,e);return this.curve.encodeUniform(i,e>>>8)}publicKeyFromHash(t){return this.curve.pointFromHash(t).encodeX()}publicKeyToHash(t){const e=this.curve.decodeEven(t);return this.curve.pointToHash(e,0,o)}publicKeyVerify(t){i(e.isBuffer(t));try{this.curve.decodeEven(t)}catch(t){return!1}return!0}publicKeyExport(t){const{x:e,y:r}=this.curve.decodeEven(t);return{x:this.curve.encodeField(e.fromRed()),y:this.curve.encodeField(r.fromRed())}}publicKeyImport(t){i(t&&"object"==typeof t);const e=s.decode(t.x,this.curve.endian);if(e.cmp(this.curve.p)>=0)throw new Error("Invalid point.");if(null!=t.y){const r=s.decode(t.y,this.curve.endian);if(r.cmp(this.curve.p)>=0)throw new Error("Invalid point.");const i=this.curve.point(e,r);if(!i.validate())throw new Error("Invalid point.");return i.encodeX()}return this.curve.pointFromX(e).encodeX()}publicKeyTweakAdd(t,e){const r=this.curve.decodeScalar(e);if(r.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");const i=this.curve.decodeEven(t);return this.curve.g.jmul(r).add(i).encodeX()}publicKeyTweakMul(t,e){const r=this.curve.decodeScalar(e);if(r.isZero()||r.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");return this.curve.decodeEven(t).mul(r).encodeX()}publicKeyTweakSum(t,e){const r=this.curve.decodeScalar(e);if(r.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");const i=this.curve.decodeEven(t),n=this.curve.g.jmul(r).add(i);return[n.encodeX(),n.isOdd()]}publicKeyTweakCheck(t,r,n,s){let o,f;i(e.isBuffer(t)),i(e.isBuffer(r)),i(e.isBuffer(n)),i("boolean"==typeof s);try{[o,f]=this.publicKeyTweakSum(t,r)}catch(t){return!1}return o.equals(n)&&f===s}publicKeyCombine(t){i(Array.isArray(t));let e=this.curve.jpoint();for(const r of t){const t=this.curve.decodeEven(r);e=e.add(t)}return e.encodeX()}sign(t,r,n=o.randomBytes(32)){return i(e.isBuffer(t)),null!=n&&(i(e.isBuffer(n)),i(32===n.length)),this._sign(t,r,n)}_sign(t,r,i){const{n:n}=this.curve,s=this.curve.g,o=this.curve.decodeScalar(r);if(o.isZero()||o.cmp(n)>=0)throw new Error("Invalid private key.");const f=s.mulBlind(o);f.isEven()||o.ineg().imod(n);const a=this.curve.encodeScalar(o),c=f.encodeX(),h=this.hashNonce(a,c,t,i);if(h.isZero())throw new Error("Signing failed (k' = 0).");const u=s.mulBlind(h);u.isEven()||h.ineg().imod(n);const d=u.encodeX(),l=this.hashChallenge(d,c,t),b=h.add(l.mul(o)).imod(n);return e.concat([d,this.curve.encodeScalar(b)])}verify(t,r,n){if(i(e.isBuffer(t)),i(e.isBuffer(r)),i(e.isBuffer(n)),r.length!==this.curve.fieldSize+this.curve.scalarSize)return!1;if(n.length!==this.curve.fieldSize)return!1;try{return this._verify(t,r,n)}catch(t){return!1}}_verify(t,e,r){const{p:i,n:n}=this.curve,s=this.curve.g,o=e.slice(0,this.curve.fieldSize),f=e.slice(this.curve.fieldSize),a=this.curve.decodeField(o),c=this.curve.decodeScalar(f),h=this.curve.decodeEven(r);if(a.cmp(i)>=0||c.cmp(n)>=0)return!1;const u=this.hashChallenge(o,r,t),d=s.mulAdd(c,h,u.ineg().imod(n));return!!d.isEven()&&!!d.eqX(a)}verifyBatch(t){i(Array.isArray(t));for(const r of t){i(Array.isArray(r)&&3===r.length);const[t,n,s]=r;if(i(e.isBuffer(t)),i(e.isBuffer(n)),i(e.isBuffer(s)),n.length!==this.curve.fieldSize+this.curve.scalarSize)return!1;if(s.length!==this.curve.fieldSize)return!1}try{return this._verifyBatch(t)}catch(t){return!1}}_verifyBatch(t){const{n:e}=this.curve,r=this.curve.g,i=new Array(1+2*t.length),n=new Array(1+2*t.length),o=new s(0);this.rng.init(t),i[0]=r,n[0]=o;for(let r=0;r<t.length;r++){const[s,f,a]=t[r],c=f.slice(0,this.curve.fieldSize),h=f.slice(this.curve.fieldSize),u=this.curve.decodeEven(c),d=this.curve.decodeScalar(h),l=this.curve.decodeEven(a);if(d.cmp(e)>=0)return!1;const b=this.hashChallenge(c,a,s),p=this.rng.generate(r),m=b.mul(p).imod(e);o.iadd(d.mul(p)).imod(e),i[1+2*r+0]=u,n[1+2*r+0]=p,i[1+2*r+1]=l,n[1+2*r+1]=m}return o.ineg().imod(e),this.curve.jmulAll(i,n).isInfinity()}derive(t,e){const r=this.curve.decodeEven(t),i=this.curve.decodeScalar(e);if(i.isZero()||i.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");return r.mulConst(i,o).encodeX()}}("SECP256K1",f,h)}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * scrypt.js - scrypt for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(280)},function(t,e,r){"use strict";(function(t,i){
/*!
 * scrypt.js - scrypt for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on Tarsnap/scrypt:
 *   Copyright (c) 2005-2016, Colin Percival. All rights reserved.
 *   Copyright (c) 2005-2016, Tarsnap Backup Inc. All rights reserved.
 *   Copyright (c) 2014, Sean Kelly. All rights reserved.
 *   https://github.com/Tarsnap/scrypt
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Scrypt
 *   http://www.tarsnap.com/scrypt.html
 *   http://www.tarsnap.com/scrypt/scrypt.pdf
 *   https://github.com/Tarsnap/scrypt/blob/master/lib/crypto/crypto_scrypt-ref.c
 */
const n=r(1),s=r(105),o=r(11),f=t.alloc(64),a=new Uint32Array(16),c=new Uint32Array(16);function h(t){const e=a,r=c;for(let r=0;r<16;r++)e[r]=v(t,4*r);for(let t=0;t<16;t++)r[t]=e[t];for(let t=0;t<8;t+=2)r[4]^=u(r[0]+r[12],7),r[8]^=u(r[4]+r[0],9),r[12]^=u(r[8]+r[4],13),r[0]^=u(r[12]+r[8],18),r[9]^=u(r[5]+r[1],7),r[13]^=u(r[9]+r[5],9),r[1]^=u(r[13]+r[9],13),r[5]^=u(r[1]+r[13],18),r[14]^=u(r[10]+r[6],7),r[2]^=u(r[14]+r[10],9),r[6]^=u(r[2]+r[14],13),r[10]^=u(r[6]+r[2],18),r[3]^=u(r[15]+r[11],7),r[7]^=u(r[3]+r[15],9),r[11]^=u(r[7]+r[3],13),r[15]^=u(r[11]+r[7],18),r[1]^=u(r[0]+r[3],7),r[2]^=u(r[1]+r[0],9),r[3]^=u(r[2]+r[1],13),r[0]^=u(r[3]+r[2],18),r[6]^=u(r[5]+r[4],7),r[7]^=u(r[6]+r[5],9),r[4]^=u(r[7]+r[6],13),r[5]^=u(r[4]+r[7],18),r[11]^=u(r[10]+r[9],7),r[8]^=u(r[11]+r[10],9),r[9]^=u(r[8]+r[11],13),r[10]^=u(r[9]+r[8],18),r[12]^=u(r[15]+r[14],7),r[13]^=u(r[12]+r[15],9),r[14]^=u(r[13]+r[12],13),r[15]^=u(r[14]+r[13],18);for(let t=0;t<16;t++)e[t]+=r[t];for(let r=0;r<16;r++)S(t,e[r],4*r)}function u(t,e){return t<<e|t>>>32-e}function d(t,e,r,i){const n=f;m(n,t,0,64*(2*i-1),64);for(let s=0;s<2*i;s++)g(n,t,0,64*s,64),h(n),m(e,n,r+64*s,0,64);for(let n=0;n<i;n++)m(t,e,64*n,r+2*n*64,64);for(let n=0;n<i;n++)m(t,e,64*(n+i),r+64*(2*n+1),64)}function l(t,e){return v(t,64*(2*e-1))}function b(t,e,r,i,n,s){const o=s,f=s;m(o,t,0,e,128*r);for(let t=0;t<i;t++)m(n,o,t*(128*r),0,128*r),d(o,f,128*r,r);for(let t=0;t<i;t++){g(o,n,0,(l(o,r)&i-1)*(128*r),128*r),d(o,f,128*r,r)}m(t,o,e,0,128*r)}async function p(t,e,r,i,n,s){const o=s,f=s;m(o,t,0,e,128*r);for(let t=0;t<i;t++)m(n,o,t*(128*r),0,128*r),d(o,f,128*r,r),await w();for(let t=0;t<i;t++){g(o,n,0,(l(o,r)&i-1)*(128*r),128*r),d(o,f,128*r,r),await w()}m(t,o,e,0,128*r)}function m(t,e,r,i,n){e.copy(t,r,i,i+n)}function g(t,e,r,i,n){for(let s=0;s<n;s++)t[r+s]^=e[i+s]}function w(){return new Promise(t=>i(t))}function y(){for(let t=0;t<64;t++)f[t]=0;for(let t=0;t<16;t++)a[t]=0,c[t]=0}function v(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]}function S(t,e,r){return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}e.native=0,e.derive=function(e,r,i,f,a,c){if("string"==typeof e&&(e=t.from(e,"utf8")),"string"==typeof r&&(r=t.from(r,"utf8")),null==r&&(r=t.alloc(0)),n(t.isBuffer(e)),n(t.isBuffer(r)),n(i>>>0===i),n(f>>>0===f),n(a>>>0===a),n(c>>>0===c),f*a>=1<<30)throw new Error("EFBIG");if(0!=(i&i-1)||0===i)throw new Error("EINVAL");if(i>4294967295)throw new Error("EINVAL");const h=t.alloc(256*f),u=t.alloc(128*f*i),d=s.derive(o,e,r,1,128*a*f);for(let t=0;t<a;t++)b(d,128*t*f,f,i,u,h);return y(),s.derive(o,e,d,1,c)},e.deriveAsync=async function(e,r,i,f,a,c){if("string"==typeof e&&(e=t.from(e,"utf8")),"string"==typeof r&&(r=t.from(r,"utf8")),null==r&&(r=t.alloc(0)),n(t.isBuffer(e)),n(t.isBuffer(r)),n(i>>>0===i),n(f>>>0===f),n(a>>>0===a),n(c>>>0===c),f*a>=1<<30)throw new Error("EFBIG");if(0!=(i&i-1)||0===i)throw new Error("EINVAL");if(i>4294967295)throw new Error("EINVAL");const h=t.alloc(256*f),u=t.alloc(128*f*i),d=await s.deriveAsync(o,e,r,1,128*a*f);for(let t=0;t<a;t++)await p(d,128*t*f,f,i,u,h);return y(),s.deriveAsync(o,e,d,1,c)}}).call(this,r(0).Buffer,r(281).setImmediate)},function(t,e,r){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function s(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new s(n.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new s(n.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},r(282),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,r(13))},function(t,e,r){(function(t,e){!function(t,r){"use strict";if(!t.setImmediate){var i,n,s,o,f,a=1,c={},h=!1,u=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick((function(){b(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,r=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=r,e}}()?t.MessageChannel?((s=new MessageChannel).port1.onmessage=function(t){b(t.data)},i=function(t){s.port2.postMessage(t)}):u&&"onreadystatechange"in u.createElement("script")?(n=u.documentElement,i=function(t){var e=u.createElement("script");e.onreadystatechange=function(){b(t),e.onreadystatechange=null,n.removeChild(e),e=null},n.appendChild(e)}):i=function(t){setTimeout(b,0,t)}:(o="setImmediate$"+Math.random()+"$",f=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&b(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",f,!1):t.attachEvent("onmessage",f),i=function(e){t.postMessage(o+e,"*")}),d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),r=0;r<e.length;r++)e[r]=arguments[r+1];var n={callback:t,args:e};return c[a]=n,i(a),a++},d.clearImmediate=l}function l(t){delete c[t]}function b(t){if(h)setTimeout(b,0,t);else{var e=c[t];if(e){h=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(void 0,r)}}(e)}finally{l(t),h=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,r(13),r(76))},function(t,e,r){"use strict";
/*!
 * secp256k1.js - secp256k1 for bcrypto
 * Copyright (c) 2014-2015, Fedor Indutny (MIT License)
 * Copyright (c) 2014-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(284)},function(t,e,r){"use strict";
/*!
 * secp256k1.js - secp256k1 for bcrypto
 * Copyright (c) 2014-2015, Fedor Indutny (MIT License)
 * Copyright (c) 2014-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */const i=r(21),n=r(11),s=r(111);t.exports=new i("SECP256K1",n,n,s)},function(t,e,r){"use strict";(function(t){
/*!
 * ssh.js - SSH keys for javascript
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://github.com/openssh/openssh-portable/blob/master/cipher.c
 *   https://github.com/openssh/openssh-portable/blob/master/PROTOCOL.key
 */
const i=r(1),n=r(52),s=r(40),{padLeft:o,padRight:f}=r(37),a=r(71),c=r(34),h=r(5),u=r(94),{PEMBlock:d}=r(9),l=r(95),b=r(97),p=r(99),m=r(102),g=r(103),w=r(104),y=r(87),v=r(6),S={DSA:"ssh-dss",RSA:"ssh-rsa",P256:"ecdsa-sha2-nistp256",P384:"ecdsa-sha2-nistp384",P521:"ecdsa-sha2-nistp521",ED25519:"ssh-ed25519"},E={[S.DSA]:"DSA",[S.RSA]:"RSA",[S.P256]:"P256",[S.P384]:"P384",[S.P521]:"P521",[S.ED25519]:"ED25519"},M={[S.P256]:"nistp256",[S.P384]:"nistp384",[S.P521]:"nistp521"},A={"3des-cbc":["DES-EDE3-CBC",24,8],"aes128-cbc":["AES-128-CBC",16,16],"aes192-cbc":["AES-192-CBC",24,16],"aes256-cbc":["AES-256-CBC",32,16],"rijndael-cbc@lysator.liu.se":["AES-256-CBC",32,16],"aes128-ctr":["AES-128-CTR",16,16],"aes192-ctr":["AES-192-CTR",24,16],"aes256-ctr":["AES-256-CTR",32,16]},I=t.alloc(0),_=t.alloc(32,0);class x extends n.Struct{constructor(){super(),this.type=S.ED25519,this.p=I,this.q=I,this.g=I,this.y=I,this.n=I,this.e=I,this.point=_,this.comment=""}getCurve(){if(!M.hasOwnProperty(this.type))throw new Error("No curve available.");return M[this.type]}getSize(){let t=0;switch(t+=U(this.type),this.type){case S.DSA:t+=T(this.p),t+=T(this.q),t+=T(this.g),t+=T(this.y);break;case S.RSA:t+=T(this.e),t+=T(this.n);break;case S.P256:case S.P384:case S.P521:t+=T(this.getCurve()),t+=T(this.point);break;case S.ED25519:t+=T(this.point);break;default:throw new i.AssertionError("Invalid key.")}return t}write(t){switch(C(t,this.type),this.type){case S.DSA:D(t,this.p),D(t,this.q),D(t,this.g),D(t,this.y);break;case S.RSA:D(t,this.e),D(t,this.n);break;case S.P256:case S.P384:case S.P521:C(t,this.getCurve()),D(t,this.point);break;case S.ED25519:D(t,this.point);break;default:throw new i.AssertionError("Invalid key.")}return t}read(t){switch(this.type=P(t),this.type){case S.DSA:this.p=R(t),this.q=R(t),this.g=R(t),this.y=R(t);break;case S.RSA:this.e=R(t),this.n=R(t);break;case S.P256:case S.P384:case S.P521:if(P(t)!==this.getCurve())throw new Error("Invalid curve prefix.");this.point=R(t);break;case S.ED25519:this.point=R(t);break;default:throw new Error("Invalid key type.")}return this}toString(){const t=this.encode();let e=this.comment;return e.length>0&&(e=" "+e),`${this.type} ${s.encode(t)}${e}`}fromString(t){i("string"==typeof t);const e=t.split(" ",3);if(e.length<2)throw new Error("Invalid SSH key text.");const[r,n]=e;if(!E.hasOwnProperty(r))throw new Error(`Unknown SSH public key type: ${r}.`);const o=s.decode(n);if(this.decode(o),this.type!==r)throw new Error("Key type mismatch.");return e.length>2&&(this.comment=e[2].trim()),this}format(){switch(this.type){case S.DSA:return{type:this.type,p:this.p.toString("hex"),q:this.q.toString("hex"),g:this.g.toString("hex"),y:this.y.toString("hex"),comment:this.comment};case S.RSA:return{type:this.type,n:this.n.toString("hex"),e:this.e.toString("hex"),comment:this.comment};case S.P256:case S.P384:case S.P521:case S.ED25519:return{type:this.type,point:this.point.toString("hex"),comment:this.comment};default:return this}}}class B extends n.Struct{constructor(){super(),this.type=S.ED25519,this.p=I,this.q=I,this.g=I,this.y=I,this.x=I,this.n=I,this.e=I,this.d=I,this.p=I,this.q=I,this.dp=I,this.dq=I,this.qi=I,this.key=_,this.comment="",this.modern=!1}getCurve(){if(!M.hasOwnProperty(this.type))throw new Error("No curve available.");return M[this.type]}encodeSSH(t){i(null==t||"string"==typeof t);const e=new k,r=new x,s=new z,o=n.write(8192);switch(o.writeString("openssh-key-v1"),o.writeU8(0),null!=t?(e.name="bcrypt",e.salt=h.randomBytes(16),e.rounds=16,C(o,"aes256-ctr")):C(o,"none"),e.write(o),L(o,1),r.type=this.type,D(o,r.encode()),s.type=this.type,this.type){case S.DSA:s.p=this.p,s.q=this.q,s.g=this.g,s.y=this.y,s.x=this.x;break;case S.RSA:s.n=this.n,s.e=this.e,s.d=this.d,s.p=this.p,s.q=this.q,s.qi=this.qi;break;case S.P256:s.point=m.publicKeyCreate(this.key,!1),s.key=this.key;break;case S.P384:s.point=g.publicKeyCreate(this.key,!1),s.key=this.key;break;case S.P521:s.point=w.publicKeyCreate(this.key,!1),s.key=this.key;break;case S.ED25519:s.point=y.publicKeyCreate(this.key),s.key=this.key;break;default:throw new i.AssertionError("Invalid key.")}s.comment=this.comment;let f=s.encode(null!=t);return null!=t&&(f=function(t,e,r,i,n){const[s,o,f]=q(e,r,i,n);return c.encrypt(s,o,f,t)}(f,"aes256-ctr",t,e.salt,e.rounds)),D(o,f),o.slice()}decodeSSH(t,e){const r=n.read(t);if("openssh-key-v1"!==r.readString(14,"binary")||0!==r.readU8())throw new Error("Invalid magic prefix for SSH key.");const s=P(r),o=k.read(r);if(1!==O(r))throw new Error("Too many SSH keys.");const f=R(r),a=x.decode(f);let c=R(r);if("none"!==s){if(null==e)throw new Error("Cannot decrypt without passphrase.");if("bcrypt"!==o.name)throw new Error("Invalid KDF.");c=N(c,s,e,o.salt,o.rounds)}const h=z.decode(c);if(h.type!==a.type)throw new Error("Public/private mismatch.");switch(this.type=a.type,this.type){case S.DSA:this.p=h.p,this.q=h.q,this.g=h.g,this.y=h.y,this.x=h.x;break;case S.RSA:this.n=h.n,this.e=h.e,this.d=h.d,this.p=h.p,this.q=h.q,this.qi=h.qi;break;case S.P256:case S.P384:case S.P521:case S.ED25519:this.key=h.key;break;default:throw new i.AssertionError("Invalid key.")}if(this.type===S.RSA){const t=v.decode(this.p),e=v.decode(this.q),r=v.decode(this.d),i=r.mod(t.subn(1)),n=r.mod(e.subn(1));this.dp=i.encode(),this.dq=n.encode()}return this.comment=h.comment,this.modern=!0,this}encode(t){if(this.modern||this.type===S.ED25519)return this.encodeSSH(t);switch(this.type){case S.DSA:return new u.DSAPrivateKey(0,this.p,this.q,this.g,this.y,this.x).encode();case S.RSA:return new b.RSAPrivateKey(0,this.n,this.e,this.d,this.p,this.q,this.dp,this.dq,this.qi).encode();case S.P256:case S.P384:case S.P521:{let t=null,e=null;switch(this.type){case S.P256:t="P256",e=m.publicKeyCreate(this.key,!1);break;case S.P384:t="P384",e=g.publicKeyCreate(this.key,!1);break;case S.P521:t="P521",e=w.publicKeyCreate(this.key,!1)}return new p.ECPrivateKey(1,this.key,t,e).encode()}default:throw new i.AssertionError("Invalid key.")}}toString(t){const e=new d;if(this.modern||this.type===S.ED25519)return e.type="OPENSSH PRIVATE KEY",e.data=this.encode(t),e.toString();switch(this.type){case S.DSA:e.type="DSA PRIVATE KEY";break;case S.RSA:e.type="RSA PRIVATE KEY";break;case S.P256:case S.P384:case S.P521:e.type="EC PRIVATE KEY";break;default:throw new i.AssertionError("Invalid key.")}return e.data=this.encode(null),null!=t&&l.encrypt(e,"AES-128-CBC",t),e.toString()}fromString(t,e){const r=d.fromString(t);if(r.isEncrypted()){if(null==e)throw new Error("Private key requires a passphrase.");l.decrypt(r,e)}switch(r.type){case"DSA PRIVATE KEY":{const t=u.DSAPrivateKey.decode(r.data);return this.type=S.DSA,this.p=t.p.value,this.q=t.q.value,this.g=t.g.value,this.y=t.y.value,this.x=t.x.value,this}case"RSA PRIVATE KEY":{const t=b.RSAPrivateKey.decode(r.data);return this.type=S.RSA,this.n=t.n.value,this.e=t.e.value,this.d=t.d.value,this.p=t.p.value,this.q=t.q.value,this.dp=t.dp.value,this.dq=t.dq.value,this.qi=t.qi.value,this}case"EC PRIVATE KEY":{const t=p.ECPrivateKey.decode(r.data),e=t.namedCurveOID.getCurveName();if(!e)throw new Error(`Unknown curve: ${t.namedCurveOID.toString()}.`);let i=null,n=0;switch(e){case"P256":i=S.P256,n=32;break;case"P384":i=S.P384,n=48;break;case"P521":i=S.P521,n=66;break;case"ED25519":i=S.ED25519,n=32;break;default:throw new Error(`Unsupported curve: ${e}.`)}return this.type=i,this.key="ED25519"===e?f(t.privateKey.value,n):o(t.privateKey.value,n),this}case"OPENSSH PRIVATE KEY":return this.decodeSSH(r.data,e);default:throw new Error(`Unknown private key type: ${r.type}.`)}}format(){switch(this.type){case S.DSA:return{type:this.type,p:this.p.toString("hex"),q:this.q.toString("hex"),g:this.g.toString("hex"),y:this.y.toString("hex"),x:this.x.toString("hex"),comment:this.comment,modern:this.modern};case S.RSA:return{type:this.type,n:this.n.toString("hex"),e:this.q.toString("hex"),d:this.d.toString("hex"),p:this.p.toString("hex"),q:this.q.toString("hex"),dp:this.dp.toString("hex"),dq:this.dq.toString("hex"),qi:this.qi.toString("hex"),comment:this.comment,modern:this.modern};case S.P256:case S.P384:case S.P521:case S.ED25519:return{type:this.type,key:this.key.toString("hex"),comment:this.comment,modern:this.modern};default:return this}}}class k extends n.Struct{constructor(){super(),this.name="none",this.salt=I,this.rounds=0}getBodySize(){let t=0;switch(this.name){case"none":break;case"bcrypt":t+=T(this.salt),t+=(this.rounds,4);break;default:throw new Error(`Unknown KDF: ${this.name}.`)}return t}getSize(){let t=0;return t+=U(this.name),t+=4,t+=this.getBodySize(),t}write(t){switch(C(t,this.name),L(t,this.getBodySize()),this.name){case"none":break;case"bcrypt":D(t,this.salt),L(t,this.rounds);break;default:throw new Error(`Unknown KDF: ${this.name}.`)}return t}read(t){this.name=P(t);const e=function(t){return t.readChild(t.readU32BE())}(t);switch(this.name){case"none":break;case"bcrypt":this.salt=R(e),this.rounds=O(e);break;default:throw new Error(`Unknown KDF: ${this.name}.`)}return this}}class z extends n.Struct{constructor(){super(),this.type=S.ED25519,this.p=I,this.q=I,this.g=I,this.y=I,this.x=I,this.n=I,this.e=I,this.d=I,this.p=I,this.q=I,this.qi=I,this.point=_,this.key=_,this.comment=""}getSize(t){let e=0;switch(e+=4,e+=4,e+=U(this.type),this.type){case S.DSA:e+=T(this.p),e+=T(this.q),e+=T(this.g),e+=T(this.y),e+=T(this.x);break;case S.RSA:e+=T(this.n),e+=T(this.e),e+=T(this.d),e+=T(this.qi),e+=T(this.p),e+=T(this.q);break;case S.P256:case S.P384:case S.P521:e+=U(M[this.type]),e+=T(this.point),e+=T(this.key);break;case S.ED25519:e+=T(this.point),e+=4,e+=this.key.length,e+=this.point.length;break;default:throw new Error("Invalid key.")}return e+=U(this.comment),e+=8-(7&e),e}write(t,e){const r=t.offset;let i=0;switch(e&&(i=4294967296*Math.random()>>>0),L(t,i),L(t,i),C(t,this.type),this.type){case S.DSA:D(t,this.p),D(t,this.q),D(t,this.g),D(t,this.y),D(t,this.x);break;case S.RSA:D(t,this.n),D(t,this.e),D(t,this.d),D(t,this.qi),D(t,this.p),D(t,this.q);break;case S.P256:case S.P384:case S.P521:C(t,M[this.type]),D(t,this.point),D(t,this.key);break;case S.ED25519:D(t,this.point),D(t,n.concat(this.key,this.point));break;default:throw new Error("Invalid key.")}C(t,this.comment);let s=t.offset-r,o=1;for(;7&s;)t.writeU8(o),s+=1,o+=1;return t}read(t){if(0!=(7&t.left()))throw new Error("Invalid padding.");if(O(t)!=O(t))throw new Error("Decryption failed.");switch(this.type=P(t),this.type){case S.DSA:this.p=R(t),this.q=R(t),this.g=R(t),this.y=R(t),this.x=R(t);break;case S.RSA:this.n=R(t),this.e=R(t),this.d=R(t),this.qi=R(t),this.p=R(t),this.q=R(t);break;case S.P256:case S.P384:case S.P521:if(P(t)!==M[this.type])throw new Error("Invalid curve.");this.point=R(t),this.key=R(t),this.type===S.P256?this.key=o(this.key,32):this.type===S.P384?this.key=o(this.key,48):this.key=o(this.key,66);break;case S.ED25519:{const e=R(t),r=R(t);if(64!==r.length)throw new Error("Invalid key pair.");const i=r.slice(0,32),n=r.slice(32,64);if(!e.equals(n))throw new Error("Public key mismatch.");this.point=e,this.key=i;break}default:throw new Error("Invalid key.")}this.comment=P(t);const e=t.readBytes(t.left(),!0);for(let t=0;t<e.length;t++)if(e[t]!==t+1)throw new Error("Invalid padding.");return this}}function q(e,r,n,s){if(i("string"==typeof e),i("string"==typeof r),i(t.isBuffer(n)),i(s>>>0===s),!A.hasOwnProperty(e))throw new Error(`Unknown cipher: ${e}.`);const[o,f,c]=A[e],h=f+c,u=a.pbkdf(r,n,s,h);return[o,u.slice(0,f),u.slice(f,f+c)]}function N(t,e,r,i,n){const[s,o,f]=q(e,r,i,n);return c.decrypt(s,o,f,t)}function P(t){return t.readString(t.readU32BE(),"binary")}function R(t){return t.readBytes(t.readU32BE())}function O(t){return t.readU32BE()}function U(t){return 4+t.length}function C(t,e){return t.writeU32BE(e.length),t.writeString(e,"binary"),t}function T(t){return 4+t.length}function D(t,e){return t.writeU32BE(e.length),t.writeBytes(e),t}function L(t,e){return t.writeU32BE(e),t}e.keyTypes=S,e.keyTypesByVal=E,e.SSHPublicKey=x,e.SSHPrivateKey=B,e.KDFOptions=k,e.RawPrivateKey=z}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * sha3.js - SHA3 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/SHA-3
 *   https://keccak.team/specifications.html
 *   https://csrc.nist.gov/projects/hash-functions/sha-3-project/sha-3-standardization
 *   http://dx.doi.org/10.6028/NIST.FIPS.202
 */
const i=r(83);class n extends i{constructor(){super()}final(){return super.final(6,null)}static hash(){return new n}static hmac(t){return super.hmac(t,6,null)}static digest(t,e){return super.digest(t,e,6,null)}static root(t,e,r){return super.root(t,e,r,6,null)}static multi(t,e,r,i){return super.multi(t,e,r,i,6,null)}static mac(t,e,r){return super.mac(t,e,r,6,null)}}n.native=0,n.id="SHA3_256",n.size=32,n.bits=256,n.blockSize=136,n.zero=e.alloc(32,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * sha3-224.js - sha3-224 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(28);class n extends i{constructor(){super()}init(){return super.init(224)}static hash(){return new n}static hmac(){return super.hmac(224)}static digest(t){return super.digest(t,224)}static root(t,e){return super.root(t,e,224)}static multi(t,e,r){return super.multi(t,e,r,224)}static mac(t,e){return super.mac(t,e,224)}}n.native=i.native,n.id="SHA3_224",n.size=28,n.bits=224,n.blockSize=144,n.zero=e.alloc(28,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * sha3-256.js - sha3-256 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(28);class n extends i{constructor(){super()}init(){return super.init(256)}static hash(){return new n}static hmac(){return super.hmac(256)}static digest(t){return super.digest(t,256)}static root(t,e){return super.root(t,e,256)}static multi(t,e,r){return super.multi(t,e,r,256)}static mac(t,e){return super.mac(t,e,256)}}n.native=i.native,n.id="SHA3_256",n.size=32,n.bits=256,n.blockSize=136,n.zero=e.alloc(32,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * sha3-384.js - sha3-384 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(28);class n extends i{constructor(){super()}init(){return super.init(384)}static hash(){return new n}static hmac(){return super.hmac(384)}static digest(t){return super.digest(t,384)}static root(t,e){return super.root(t,e,384)}static multi(t,e,r){return super.multi(t,e,r,384)}static mac(t,e){return super.mac(t,e,384)}}n.native=i.native,n.id="SHA3_384",n.size=48,n.bits=384,n.blockSize=104,n.zero=e.alloc(48,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * sha3-512.js - sha3-512 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(28);class n extends i{constructor(){super()}init(){return super.init(512)}static hash(){return new n}static hmac(){return super.hmac(512)}static digest(t){return super.digest(t,512)}static root(t,e){return super.root(t,e,512)}static multi(t,e,r){return super.multi(t,e,r,512)}static mac(t,e){return super.mac(t,e,512)}}n.native=i.native,n.id="SHA3_512",n.size=64,n.bits=512,n.blockSize=72,n.zero=e.alloc(64,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";(function(e){
/*!
 * shake128.js - SHAKE128 implementation for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
const i=r(51);class n extends i{constructor(){super()}init(){return super.init(128)}static hash(){return new n}static hmac(t){return super.hmac(128,t)}static digest(t,e){return super.digest(t,128,e)}static root(t,e,r){return super.root(t,e,128,r)}static multi(t,e,r,i){return super.multi(t,e,r,128,i)}static mac(t,e,r){return super.mac(t,e,128,r)}}n.native=i.native,n.id="SHAKE128",n.size=16,n.bits=128,n.blockSize=168,n.zero=e.alloc(16,0),n.ctx=new n,t.exports=n}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * siphash.js - siphash for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(293)},function(t,e,r){"use strict";(function(t){
/*!
 * siphash.js - siphash for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on bitcoin/bitcoin:
 *   Copyright (c) 2009-2019, The Bitcoin Core Developers (MIT License).
 *   Copyright (c) 2009-2019, The Bitcoin Developers (MIT License).
 *   https://github.com/bitcoin/bitcoin
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/SipHash
 *   https://131002.net/siphash/
 *   https://131002.net/siphash/siphash.pdf
 *   https://github.com/bitcoin/bitcoin/blob/master/src/crypto/siphash.cpp
 */
const i=r(1),n=1/4294967296;function s(e,r){i(t.isBuffer(e)),i(t.isBuffer(r)&&r.length>=16);const n=e.length>>>3,s=new a(1936682341,1886610805),o=new a(1685025377,1852075885),f=new a(1819895653,1852142177),h=new a(1952801890,2037671283),u=new a(e.length<<24,0),d=new a(0,255),l=a.decode(r,0),b=a.decode(r,8),p=s.ixor(l),m=o.ixor(b),g=f.ixor(l),w=h.ixor(b);let y=0;for(let t=0;t<n;t++){const t=a.decode(e,y);w.ixor(t),c(p,m,g,w),c(p,m,g,w),p.ixor(t),y+=8}switch(7&e.length){case 7:u.hi|=e[y+6]<<16;case 6:u.hi|=e[y+5]<<8;case 5:u.hi|=e[y+4];case 4:u.lo|=e[y+3]<<24;case 3:u.lo|=e[y+2]<<16;case 2:u.lo|=e[y+1]<<8;case 1:u.lo|=e[y]}return w.ixor(u),c(p,m,g,w),c(p,m,g,w),p.ixor(u),g.ixor(d),c(p,m,g,w),c(p,m,g,w),c(p,m,g,w),c(p,m,g,w),p.ixor(m),p.ixor(g),p.ixor(w),[p.hi,p.lo]}function o(e,r,n){i("number"==typeof e),i("number"==typeof r),i(t.isBuffer(n)&&n.length>=16);const s=new a(1936682341,1886610805),o=new a(1685025377,1852075885),f=new a(1819895653,1852142177),h=new a(1952801890,2037671283),u=new a(e,r),d=new a(0,255),l=a.decode(n,0),b=a.decode(n,8),p=s.ixor(l),m=o.ixor(b),g=f.ixor(l),w=h.ixor(b);return w.ixor(u),c(p,m,g,w),c(p,m,g,w),p.ixor(u),g.ixor(d),c(p,m,g,w),c(p,m,g,w),c(p,m,g,w),c(p,m,g,w),p.ixor(m),p.ixor(g),p.ixor(w),[p.hi,p.lo]}function f(e,r,n){i("number"==typeof e),i("number"==typeof r),i(t.isBuffer(n)&&n.length>=32);const s=new a(e,r),o=new a(0,255),f=a.decode(n,0),h=a.decode(n,8),u=a.decode(n,16),d=a.decode(n,24);return d.ixor(s),c(f,h,u,d),c(f,h,u,d),f.ixor(s),u.ixor(o),c(f,h,u,d),c(f,h,u,d),c(f,h,u,d),c(f,h,u,d),f.ixor(h),f.ixor(u),f.ixor(d),[f.hi,f.lo]}class a{constructor(t,e){this.hi=0|t,this.lo=0|e}isum(t,e){const r=this,i=r.lo+e|0,n=i>>31,s=r.lo>>31,o=e>>31,f=1&(s&o|~n&(s^o)),a=(r.hi+t|0)+f;return r.hi=0|a,r.lo=i,r}iadd(t){return this.isum(t.hi,t.lo)}ixor(t){return this.hi^=t.hi,this.lo^=t.lo,this}irotl(t){let e=this.hi,r=this.lo,i=this.hi,n=this.lo;return t<32?(e<<=t,e|=r>>>32-t,r<<=t):(e=r<<t-32,r=0),(t=64-t)<32?(n>>>=t,n|=i<<32-t,i>>>=t):(n=i>>>t-32,i=0),this.hi=e|i,this.lo=r|n,this}static mul(t,e){const r=t>>>16,i=65535&t,n=e>>>16,s=65535&e;let o=0,f=0,c=0,h=0;h+=i*s,c+=h>>>16,h&=65535,c+=r*s,f+=c>>>16,c&=65535,c+=i*n,f+=c>>>16,c&=65535,o+=f>>>16,f&=65535,f+=r*n,o+=f>>>16,f&=65535,o+=f>>>16,o&=65535;return new a(o<<16|f,c<<16|h)}static decode(t,e){const r=h(t,e),i=h(t,e+4);return new a(i,r)}}function c(t,e,r,i){t.iadd(e),e.irotl(13),e.ixor(t),t.irotl(32),r.iadd(i),i.irotl(16),i.ixor(r),t.iadd(i),i.irotl(21),i.ixor(t),r.iadd(e),e.irotl(17),e.ixor(r),r.irotl(32)}function h(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]}e.native=0,e.siphash=function(t,e){return s(t,e)},e.siphash32=function(t,e){return o(0,t,e)[1]},e.siphash64=function(t,e,r){return o(t,e,r)},e.siphash32k256=function(t,e){return f(0,t,e)[1]},e.siphash64k256=function(t,e,r){return f(t,e,r)},e.sipmod=function(t,e,r,i){const[o,f]=s(t,e);return function(t,e,r,i){const s=a.mul(t,r),o=a.mul(t,i),f=a.mul(r,e),c=a.mul(e,i),h=(o.lo>>>0)+(f.lo>>>0)+(c.hi>>>0),u=(o.hi>>>0)+(f.hi>>>0)+(h*n>>>0),{hi:d,lo:l}=s.isum(u*n|0,0|u);return[d,l]}(o,f,r,i)}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * whirlpool.js - whirlpool for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(295)},function(t,e,r){"use strict";(function(e){
/*!
 * whirlpool.js - Whirlpool implementation for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on RustCrypto/hashes:
 *   Copyright (c) 2016-2018, The RustCrypto Authors (MIT License).
 *   https://github.com/RustCrypto/hashes
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Whirlpool_(hash_function)
 *   https://www.iso.org/standard/39876.html
 *   https://github.com/jzelinskie/whirlpool/blob/master/whirlpool.go
 *   https://github.com/RustCrypto/hashes/blob/master/whirlpool/src/consts.rs
 *   https://github.com/RustCrypto/hashes/blob/master/whirlpool/src/lib.rs
 *   https://github.com/RustCrypto/hashes/blob/master/whirlpool/src/utils.rs
 */
const i=r(1),n=r(3),s=e.alloc(32,0),o=e.alloc(64,0);o[0]=128;const f=new Uint32Array([0,0,404997864,2276983119,916902645,2037354834,1622973326,2735504181,501274562,776732247,360134629,2683325146,1489578250,2980080517,3176993012,3409839463,3827777931,2810025432,4226710630,3709290398,3391995655,2908390195]),a=new Uint32Array([404250648,3229102296,589532195,95372838,3334881222,2130284984,3907553256,326094331,2273781383,1285624779,3099122360,2841799953,16843777,134545929,1330585935,1114545677,909563958,2918083739,2795938470,1493455359,3537006546,3736975628,4126536693,4211537678,2038036857,4018205334,1869586799,1607392816,2442231441,4243537773,1381127506,2852627704,1616944480,670941255,3166489276,2306237749,2610648731,2899127095,2391671438,76284298,2745415331,1897225170,202125324,1614551148,2071720315,4287297156,892720181,3051448960,488469533,3899210485,3772819424,1397218739,3621223383,4138513185,3267506114,1592629660,774813742,1838570563,1263219019,1652201001,4278116350,2736906589,1465336151,2182524629,353719317,2822843069,2004337015,2679566056,926407735,2783669906,3857036261,2069288862,2678015647,2363040531,4042319856,3541564707,1246377290,1786745888,3671740378,2660608324,1482194264,4196774050,3385394121,113938383,690594857,1435325052,168437770,1344410714,2981232305,3780083536,2694888096,1763335625,1802219883,2145048084,2240097925,1554716633,3183333053,2171823932,1566402909,3526670991,269500432,2152734864,4109694964,4077122823,3419081675,381717469,1044314174,3989208275,84218885,672205357,1734836583,535219832,3840194532,1934874007,656907303,633032194,1094785345,844661363,2341148299,748489639,2812782247,1359041526,2105403773,3482647218,2509598357,3707451209,3638052824,2392829270,4227582971,2335239024,4008615918,594657741,2088562044,3348232379,1717994854,400804977,3722269661,2794366843,387406871,3091934895,1195835719,38178373,2661171870,2229018906,3402239946,516262356,757969965,1972984408,3217016511,2440651566,117906439,941297215,2913832621,19089324,1515877722,3928994992,2206414467,1823808495,859032627,2248107702,1667469667,1072875100,33687554,269091858,2863305386,959990163,1903286641,2947080926,3368552392,248483270,421094425,3363648209,1229535561,1919980091,3654894553,2258284383,4076007410,3273521457,3823348707,1263066024,1532719451,3794450105,2290621064,881987004,2593804954,2764581182,640063526,767446027,842188850,2381997247,2964388528,3913973081,3924394985,459984882,252656655,2016616055,3587535829,3869685555,2155887232,1958354420,3200172734,2575065383,3452769229,652117995,875876404,3185862793,1212693832,2054524978,4294958079,2871321428,2054878586,4153406605,2425387664,4108991844,1600086367,3258891933,539000864,497041469,1751694696,1742065679,437938202,3497145546,2930672302,422330807,3031755444,3378410877,1414810964,2585372878,2475914899,3974445951,572688418,229262383,1684311396,132761699,4059161585,3675455274,1936970099,3215124172,303187986,2421826690,1077943616,979206266,134750216,1076367432,3284347843,1458084757,3974928364,863749599,3688582107,2526063437,2711731873,1629446080,2374831757,478349201,1027470397,4123622088,2543281815,3438359387,0,0,3486456783,919897081,724282411,1166497390,1987495286,2545151201,2189570690,1689262566,3604381654,4272533800,454781979,3631691459,3048599221,3243997044,2947516079,287916990,1785378154,2011157533,1347444048,3121455338,1162152261,307006039,4092849139,3407412024,808501296,2649776301,4025457647,729072580,1061157951,3854794458,1431652693,2451352263,2728571554,2031114715,3941240810,57002473,1701153125,267176554,3132805818,3110627587,791657519,1704156746,3233818560,1323801998,3739115486,3196166496,471625756,3765188860,4261270525,3140413254,1296902477,1382324767,2459071122,3839900022,1970653557,2411522810,101062662,807275574,2324304522,613943726,2998071986,4181752139,3873882086,1666830725,235812878,1882594430,522157087,4167253735,1650627938,938984533,3570694100,4003706170,2829621928,691162497,2526438038,3304337746,4193895417,2604330850,3318035397,1727436707,623219749,900811280,1499035993,4062229163,2223254148,1420694992,1920128370,3081233605,960095289,3588059884,1280060748,1516345366,1583244638,3392912532,2021195128,3884314783,943251512,3721949413,2357987980,344327576,3520160721,3333603095,2779098789,1091262436,3806506978,1129175457,1633786209,804831822,3014915763,4047862594,555844641,363151924,2627488412,2497062152,505313310,4033232110,1128468803,575833697,3351722951,1996264369,4244428796,3005998415,67375108,538183716,1364285777,2986910435,2576965273,3167170341,1835903341,1338300962,218969101,1748572773,4210741242,2201348473,3755957215,3062145897,2122245502,3617324201,606375972,1035225113,993782843,3319232254,2880149163,826100634,3469615054,1053917680,286344209,2287280793,2408515215,210305923,1313744206,1248566276,3082282679,3511776102,3958082539,190893024,1010626620,4258035905,2172731009,2092900349,2492754580,3573429568,4160224247,3943494428,3115966137,2707910424,320031763,2556372619,741126188,2107398225,3553848275,3602430725,3890723815,1801245580,1852745070,1472977977,3301193668,1861457322,50531331,403637787,1448494422,2316545244,1145310532,441026654,2139087231,3751739040,2846465705,557272968,707438634,1300386919,3149649595,2976738058,3250660289,1189257095,1397969235,2718082801,3705427932,2928387442,185281547,1478956627,2644332189,2631083777,1819061612,1203886123,825345073,2515886756,1953811828,2277107955,4143382518,3809079573,1178993990,172198988,2896988844,153503141,2307464841,1016532917,336875540,2688821428,3789661153,1531109306,370563094,2957913254,976939066,3453121783,1768536425,1875956230,151593993,1210913345,1886444912,2813190359,3065438902,3646189935,3503318992,3468147998,3991770093,998164438,3435927500,786138594,1111627074,710378600,2560121496,3032624428,2762255012,1225676269,673751080,1569214581,1549561180,3660691590,4177053688,2470440299,2256937606,1151603138]),c=new Uint32Array([3625457760,415266864,639837068,587575110,3100034623,3330210193,4226345095,3893587917,3414656806,2269946131,297318618,3098108525,151060740,17302786,223301409,1329753758,2604021464,917368428,4289111714,2790851665,215143023,3537812921,251000307,4126869239,2524543481,2045739250,812609441,1868549854,1838256510,2449272639,4166144597,1386874788,1197498525,1613233600,901561546,3163125349,932944726,2611793195,2324598274,2382662657,3533939638,2742097243,1812728880,207633432,2222685169,2080344822,2150970836,901112170,4112326004,501770554,3017859239,3763554269,567793531,3623267507,2630009391,3261001113,1127100088,778933852,692800305,1264745110,1576992479,4272103905,3579270977,1468143278,3172275540,363348266,3900143553,2006955758,2453092316,933620590,2665866675,3850065623,329228102,2676807971,602992871,4040366077,541739573,1248493460,1155193423,3667826089,2723698813,1492788656,3486107907,3372665487,2083072420,693472594,1510607400,173023764,1353822718,2984333183,3382747322,2691242589,342584241,1803541206,3649406254,2237442839,1019067854,3179377511,2405260649,1574057146,2416971840,276844576,133494007,4109566965,3721120523,3407265931,3544071928,1055770236,755303700,86511882,2020042625,1730143950,2548360375,3832763349,36120476,656784206,1933656345,1093818498,2810940182,2334956811,4138182566,2807103827,2994568681,2110756090,1234539886,2514287415,1457051719,3633225645,1895562187,4220203243,3454987935,3995300289,3145497837,2093453816,1902536325,1712841676,2078137683,3718680231,2937526108,397953838,1162299137,1191331470,446602818,2659507233,3570059791,3391014281,1479355828,762681690,784318406,3213982051,1057425180,121117454,2897063310,2902532935,2958711413,1525297076,4018373430,2204939547,3056808908,864419686,1550017425,1665135302,302121480,34605572,2477435538,2855876681,3731976665,1907337442,3335047175,3356413837,3508083044,432569650,994658617,1232236690,1608112451,3649477295,838005487,4072873465,2833507243,3813361883,3109772145,1541548726,3163064346,2285146637,1050319442,2594490409,187049624,640532044,3207738056,848165476,1504751866,2968078973,4075415939,3910888143,1997475644,259535646,869651827,3588662967,4102062138,2155133469,666812098,3197729889,3956133139,3441876615,2301899984,884860008,843597885,1215985040,1426063323,4289406179,2373614325,2063044596,1687195770,2431969853,2640273249,1606565566,1025515648,538812480,258500797,1751635408,3390708328,449868340,3081678466,2920885313,2108994794,3033095797,3461633101,1419385256,2140377974,2481775931,790766216,571320900,1667523725,1678240200,720499171,4057666303,3430118353,1941938918,2182222408,311450148,2051031069,1077566848,1208485920,138422288,2512634667,3277252763,3756846231,3962796997,1306254155,3684077739,3231818174,2707496799,2441973006,2367456007,3359456756,1039518074,1536661350,2546790707,0,0,4191145755,3476477059,1848322988,725976918,3782637253,1989653484,3867312690,2187636761,685168255,3607013809,3273333612,467171126,1958065646,3049347959,3199184774,2937137475,493513397,1786240980,3931131997,1354370464,1464157449,1158827146,955511787,4090173691,2905616576,815657056,3304058779,4012602563,3661578236,1072022398,3344258377,1435638954,3684868786,2725843033,3924486799,3926091209,1785030025,1695542474,62569170,3132713065,1244606396,795186014,2394996775,3226396573,1625218655,3737026977,4229700720,484469816,1191050707,4256902887,525159721,1297245338,1989317234,2464473145,4202001865,1972354282,906364440,103816716,2928314898,2317654025,1270002418,3002679417,2246502079,3865270737,2114850360,242234908,3877576572,536372030,1432511125,1647835076,987026551,3572409269,2175314074,2821272141,1385600610,2529489969,1660549571,4187699951,2747647283,3311859351,270869908,624275786,2874759545,1509040306,3498345514,2220142101,3312612053,1924638692,3963173348,970317170,374098989,1280991640,2489212517,1590311868,2675472637,2028439024,3845667040,954062960,2559347722,2350155269,399626595,3519460031,3836061102,2772503383,2716000943,3796061657,1315004825,1630533826,1119073270,3018933627,874586500,555066690,144481354,2626999845,3994951288,519071292,1631798033,1126322822,2982659899,3346463891,1341979863,4239600613,604242960,69211144,3813757273,1370622114,630823262,2579285807,577596841,1833944282,1695354164,224934170,2046491343,4202903017,1776279387,3753280675,2843639525,2128059388,421799056,608023624,4265294828,1002821494,2594941846,2872130891,4040085023,3460223361,2568032580,294147362,2207223558,2399963395,72240677,1313500060,1723316198,3083948403,3773557643,3943391435,3241950448,1023265912,4253122878,2172436255,1083479146,2496986677,486012923,4159376627,414824926,3114362735,2333283148,328752934,1361849520,746429528,97768299,3554064571,2364008379,3882573011,963538597,1851247580,2865022007,3295605653,453182220,51908358,3696645701,1451889580,1581532173,1142573448,2692710369,2145361662,2292820382,2837526351,1730816680,709722708,180075478,3148967275,2277622051,3242648223,4048769873,1403126438,1927076951,3702426533,1393232684,190326550,27106638,2644300583,728525997,1816642008,2754687428,831911266,4084495565,1955052008,368506623,4142074353,1279673861,1175077772,2779557002,2886280773,3045689630,2302449423,3021214800,346047528,3135365539,3780854495,2786465368,380653100,4147788520,986567284,107571641,1768935634,1091111204,155725074,3614470365,1890037216,1874245346,3067696241,517001319,3503208381,3605917075,3980099271,3805072407,3425622917,1749172757,1110071172,748197978,2561983021,3986990250,2756251221,1965566112,677218384,2254199917,1557803448,1811478727,4170399725,3263596066,2252645393]),h=new Uint32Array([819468312,1612234872,1176904483,2351105455,2444805830,1069973241,3455838440,2280133487,332105607,646401185,1829877944,3669535074,34144513,67176453,2651672399,558842478,1822111286,3627462126,1375708838,2728810756,3104625362,1876090557,4144952821,4092984070,4069947769,4185517952,3727716207,2708430798,1064145297,2123496687,2767737426,1431480839,3225903200,2640324605,1698020540,3401353590,725064603,1453042893,25857678,42861708,1540531107,3064164629,409734156,806117436,4135877499,4051435402,1786787125,3560289761,989142301,1948117097,3719553248,2816496455,3005339607,2077750956,2577187522,801267437,1547906606,3090050454,2519288651,827023994,3781033726,3758007073,2933217111,1096253974,717034773,1410705473,4008212343,3245842358,1855076151,3694634475,3617514981,3018160982,588488607,1184861401,4246991088,3891319575,2485144138,894069375,2839861978,1339727509,2963429464,2102983205,2412759497,63506122,1383868713,2754172301,341445130,671764514,2135994801,4273070415,1573494944,3131074842,3591662443,2976612314,400131461,780491947,1732033981,3468525939,3129957725,1767756340,546312208,1074823248,4110939380,4160025347,2346568651,197859008,2094218814,4164873670,170722565,335882257,3463997287,2171019238,3583501540,3085202259,1308763943,2619811259,2188591425,423703128,195529611,378219677,1408673703,2795983105,4206001533,3917336468,927569301,1855315195,2908149976,1205374623,3950050299,3422260016,3251498734,2683183985,4173036668,3984377745,3429983846,2238060515,2809912797,1407035022,783226647,1545058379,2386904903,21430854,555392670,1117684956,2312424138,264904389,1515728173,3022878105,1664008127,3334443385,239011591,470235163,1202498989,2393702691,3031456346,1968892463,468681603,914582709,1723216691,3425928703,3327943523,2439200754,68289026,134352906,1234414250,2460629304,3806228849,3648106408,2378614984,130551503,852564249,1679411325,2453358921,961114736,2942294489,1138329242,4180800242,4025664285,3685278691,2883799880,3065600859,1901847082,230459528,445133970,691968666,1385866440,1275799078,2552638910,1690251826,3358756346,2103029936,4205898058,3488803305,2213092202,511119119,1007646771,3073627605,1943398054,502562944,981497018,1629994686,3267271036,2280377805,332211934,1753822260,3493117412,2419214408,1028160117,3813998591,3690965796,4102912634,4118476687,1030000784,2056320234,3197984607,1633665598,1077747744,2149588384,3490670696,3177736149,885660186,1746587762,1102556846,2192447788,1971172532,3937716574,2832094292,1297390105,998216595,1989405925,1143939618,2283933098,3361956964,2372143081,4281004529,3824278290,3872158579,3514023842,612504082,1209176154,2155495488,490748509,273156104,537411624,2610283459,734222056,3319786732,2548839291,2874006491,1272682128,1606459809,3198247199,126979469,244128899,2059943229,4097701321,861640599,1721224433,0,0,2214186959,466564820,1450060587,2888516999,3974198902,3312883635,434537090,847406256,2972243670,2144796329,918756123,1813764215,2004137397,4004888923,1136570287,2259620137,3558697578,3043653599,2699710544,1565571597,2320975173,155521612,4214813683,3958623e3,1621962800,3224411632,3284463599,2616142708,2128232255,4232046019,2865190229,1230344732,1507566242,2996992272,3387550442,2414478181,3395970405,2305101804,1761852090,3535452520,1581920047,3157222803,2643378368,666914535,2707480286,1608433281,956046364,1880940652,3880189437,3556621102,2585742669,692933220,964072082,1922229472,3942282613,3379924924,204867078,403058718,162433674,311043224,2035004082,4071815488,3515213542,3219546969,478023182,940470326,1055334175,2082469987,3293930082,2506242039,3040531668,2010443427,1300342952,2594711858,827496086,1654047988,4016241145,3287915322,2544092613,868574966,1242572069,2485466545,2997573977,2035937824,365986948,713315502,3838145138,3581065127,1928083769,3828995549,2551598156,759978593,3163840094,1700710971,4036982904,4252559237,1894070328,3761823192,93883532,176952454,3206009297,1674692274,1474602405,2930065675,3651265250,2950841165,3259916641,2573283320,2067968947,4138987845,1110712609,2216760741,621321372,1251775702,1022238238,2015293542,2254521155,289612370,2477901767,1002927868,3847224572,3623662379,136578052,268705812,2732806481,1498526216,790993305,1587133639,3659689325,2842513348,442830093,873293881,3917085434,3489301301,2741624799,1541387908,4238966398,3850295195,1209607204,2418294196,1996372795,3963340247,1268427691,2527801661,2180042446,533610193,580456721,1141999701,58953615,110038153,2617527886,625887851,1936111543,3870806353,3420515307,2347436896,2025929788,4030528972,536707457,1048673471,893424788,1788138750,4078761975,4227328780,1863891385,3736707431,646648595,1276352607,1481714732,2955705756,3137721299,1809045176,3549226983,3152505692,3694751342,2775472075,2510996676,935620339,102433539,201529359,2900121174,1163299347,2287879236,222566985,4271931263,3783253918,1334356393,2661884215,1416047146,2821344642,1795865531,3602624877,2676474305,599869154,2800833363,1364435458,2775768284,1474080395,374541067,738940967,654417309,1318952147,3626724460,2909554625,1654927665,3291583989,3908269172,3446966201,4044748534,4294370057,2353808966,88476227,1168485548,2326530342,263555465,512310423,682890260,1343529028,3753566689,2749455170,749082134,1477881934,1962359354,3896167890,3523635561,3110694864,306252041,604588077,3772215408,3715147693,1903146678,3803634004,3172913360,1741737655,3352751597,2481798014,2246233292,399257307,2221425218,356657751,757897368,1519957186,1441637540,2862893326,1349855272,2686999944,3095813212,1834801713,3983276280,3354956607,297961094,579224740]),u=new Uint32Array([2016466968,408950976,2940610083,596386565,4187076806,3326068350,1875770344,3901220883,2702429063,2267449164,1651315128,3101341865,84019457,17039624,1855851855,1327583042,4000095030,920139437,72482726,2795677273,3183021266,3530543838,116854517,4126406139,2163381881,2046392815,3470667887,1872850783,4013911441,2440991228,128251986,1381323434,4257236832,1620926503,1986344380,3167403145,3442161563,2606144428,2348911246,2382532100,358339235,2746655601,1008233484,204475488,2331411579,2079423487,3781853237,903099829,1765471517,494149096,1205711840,3769098323,2897420759,3615217654,3986267330,3257909854,2522628910,783822445,2056661323,1261521762,568417790,4276092579,380556631,1463900034,1093319957,357832104,3069110391,2009167775,3949892151,937179045,1456971493,3853772155,3642954655,2672205708,402465776,4041732307,2140414026,1245006442,2510898394,3662666398,632332888,1484609786,3398422473,3372468486,2370993193,698624341,571759114,170396240,1333743793,2986258913,442354080,2696585321,3671463019,1806789503,2870466949,2234418524,1936145597,3184442753,884641629,1567186386,1344311312,272633984,66390004,4109890803,3230391755,3406547734,3330069310,1056456429,285879557,85198120,3872290919,1736533791,1406506980,3837256819,3142451751,664545061,1484944193,1092174130,2634786699,2333510444,22279847,2812716881,2499457661,2112454095,4214704533,2507052508,2678937304,3628587150,820736251,4224449419,1908526574,4003458595,2448997244,2095938759,3821826406,1720018455,2393340893,3713260966,1261350679,391911352,1183728967,1191266050,3693157022,2655166084,3314144458,3390032414,2572834861,766782837,2036543167,3217473425,453918471,119277368,591899821,2911808769,800370778,1517640426,3038506883,2201387884,4284921395,869020549,4073086051,1670472511,168038914,34079248,944346026,2861738553,2833440369,1910075823,3482175176,3355953166,2100482329,425990600,1888631625,1228491122,2595184601,3645102470,502870514,4075811523,1222355171,3819692875,716618075,1534155746,2450373768,2283440180,3358146202,2589104804,3192654630,647505453,4200906546,851980941,1249728944,2969219305,1792013033,3917736219,857634575,255594360,2797024213,3581138406,3122525312,2151317620,2086741950,3200433817,3733449677,3440626982,3832056116,886060221,1972384328,1211975802,618878207,4292607915,2415168890,2062908151,3929891984,2423951604,1052679519,1600217026,2688564512,545267741,3587182440,1757243495,1916062234,443030224,742504366,2927799833,1584758196,3035280585,430493268,1414354074,3845881747,2474021868,2856595234,579346957,3922223972,1686987783,318712561,4058247643,2733034611,1943106495,1512342034,306713232,1568700992,1075658810,672155656,136316992,3902510531,3274425174,2076565484,3969379379,2427145691,3679181718,526368929,2713624929,2198311309,2366541084,3380267069,1039416821,4046674839,2540083148,0,0,3565418959,3474706230,2270588459,732703557,3018645878,1992652439,2954487426,2184348260,2846959830,3598702334,2000077595,460069848,1534555317,3052320193,692305583,2944839441,3755220330,1790274167,228649552,1348292794,1284134725,1158235410,419117299,4092326859,4032867632,817901725,1958986991,4019973931,3279870527,1073496037,480954197,1430869394,274324386,2729615993,1707731434,3935300099,3972688485,1703503119,1751712698,3134372537,2472430127,800862053,3885862592,3223830606,2174836958,3730824894,1815673884,477109472,786908925,4258528699,1687822157,1294552402,3761862290,2456982244,3169516149,1976137103,504116742,102237744,2550771338,2316470820,1081691058,3002249977,1506903526,3871336035,907836942,238554736,1665066783,528228344,4156839266,1653957175,2746563284,3564623086,843940264,2828707881,4096873110,2523043524,988766969,4190370203,4137132997,3308504422,2974421029,630465845,548580185,1501125106,2920665220,2217378900,2816787826,1926591159,3715296313,971258325,1637357132,1278037082,1002214494,1583701706,2247139192,2029877479,3631277368,954218717,2248513676,2349501460,2998867921,3512979910,190309541,2779686209,1306108386,3803177539,4173483617,1637441839,1165705907,3019289585,2772579361,562307349,3592751260,2622135444,1715269150,511188720,1384538435,1125204770,4237537735,3342583670,736448508,4242013363,336077828,68158496,144892753,1364808114,3341755801,2573113788,3302629997,1839820111,958031117,221515112,904493562,4207934083,2225301983,3747340214,2617026942,2128969431,3024623908,613426237,3614899771,1005337541,1028364971,2878778161,3514953934,3458190910,1428330769,289673608,2298708879,2399571724,1805386830,1311067722,1366517431,3085350865,1623974123,3951815435,3430465852,1022377213,3206544769,2168357244,4264902804,2490012884,217259255,4160485355,1735334073,3118381473,1596361491,323752856,2623033644,749743229,3099264467,3547059158,1557368039,3887851371,3420207470,1856335447,4086672068,3291989102,252058371,51118872,330095702,1447384714,1233673796,1141720090,2667487359,2145484767,927959209,2845747489,2186569514,715663949,1835731643,3151412145,3802105793,3240345926,44495187,1397838754,2342875868,3696745646,655774475,187435864,3542548893,2639175068,3252169580,1823304775,4116882481,834941333,3119051636,1959621767,166794742,4143970019,1133268038,1174750730,642098604,2894769161,2534389129,2300479804,1143518228,340792480,1121958625,3785613659,1311548950,374871728,3530880826,988297933,3503425129,1773758831,756171017,153356616,2917193584,1893560487,1416720310,3068311257,3082624720,3496464590,2127025901,3985894715,3682984652,3424111662,1468295234,1108689450,3257740440,2556074164,240512420,2762646601,2286974248,681584733,834176604,1550671066,1072524280,4173854867,2752627334,2250409540]),d=new Uint32Array([3229102296,404250648,95372838,589532195,2130284984,3334881222,326094331,3907553256,1285624779,2273781383,2841799953,3099122360,134545929,16843777,1114545677,1330585935,2918083739,909563958,1493455359,2795938470,3736975628,3537006546,4211537678,4126536693,4018205334,2038036857,1607392816,1869586799,4243537773,2442231441,2852627704,1381127506,670941255,1616944480,2306237749,3166489276,2899127095,2610648731,76284298,2391671438,1897225170,2745415331,1614551148,202125324,4287297156,2071720315,3051448960,892720181,3899210485,488469533,1397218739,3772819424,4138513185,3621223383,1592629660,3267506114,1838570563,774813742,1652201001,1263219019,2736906589,4278116350,2182524629,1465336151,2822843069,353719317,2679566056,2004337015,2783669906,926407735,2069288862,3857036261,2363040531,2678015647,3541564707,4042319856,1786745888,1246377290,2660608324,3671740378,4196774050,1482194264,113938383,3385394121,1435325052,690594857,1344410714,168437770,3780083536,2981232305,1763335625,2694888096,2145048084,1802219883,1554716633,2240097925,2171823932,3183333053,3526670991,1566402909,2152734864,269500432,4077122823,4109694964,381717469,3419081675,3989208275,1044314174,672205357,84218885,535219832,1734836583,1934874007,3840194532,633032194,656907303,844661363,1094785345,748489639,2341148299,1359041526,2812782247,3482647218,2105403773,3707451209,2509598357,2392829270,3638052824,2335239024,4227582971,594657741,4008615918,3348232379,2088562044,400804977,1717994854,2794366843,3722269661,3091934895,387406871,38178373,1195835719,2229018906,2661171870,516262356,3402239946,1972984408,757969965,2440651566,3217016511,941297215,117906439,19089324,2913832621,3928994992,1515877722,1823808495,2206414467,2248107702,859032627,1072875100,1667469667,269091858,33687554,959990163,2863305386,2947080926,1903286641,248483270,3368552392,3363648209,421094425,1919980091,1229535561,2258284383,3654894553,3273521457,4076007410,1263066024,3823348707,3794450105,1532719451,881987004,2290621064,2764581182,2593804954,767446027,640063526,2381997247,842188850,3913973081,2964388528,459984882,3924394985,2016616055,252656655,3869685555,3587535829,1958354420,2155887232,2575065383,3200172734,652117995,3452769229,3185862793,875876404,2054524978,1212693832,2871321428,4294958079,4153406605,2054878586,4108991844,2425387664,3258891933,1600086367,497041469,539000864,1742065679,1751694696,3497145546,437938202,422330807,2930672302,3378410877,3031755444,2585372878,1414810964,3974445951,2475914899,229262383,572688418,132761699,1684311396,3675455274,4059161585,3215124172,1936970099,2421826690,303187986,979206266,1077943616,1076367432,134750216,1458084757,3284347843,863749599,3974928364,2526063437,3688582107,1629446080,2711731873,478349201,2374831757,4123622088,1027470397,3438359387,2543281815,0,0,919897081,3486456783,1166497390,724282411,2545151201,1987495286,1689262566,2189570690,4272533800,3604381654,3631691459,454781979,3243997044,3048599221,287916990,2947516079,2011157533,1785378154,3121455338,1347444048,307006039,1162152261,3407412024,4092849139,2649776301,808501296,729072580,4025457647,3854794458,1061157951,2451352263,1431652693,2031114715,2728571554,57002473,3941240810,267176554,1701153125,3110627587,3132805818,1704156746,791657519,1323801998,3233818560,3196166496,3739115486,3765188860,471625756,3140413254,4261270525,1382324767,1296902477,3839900022,2459071122,2411522810,1970653557,807275574,101062662,613943726,2324304522,4181752139,2998071986,1666830725,3873882086,1882594430,235812878,4167253735,522157087,938984533,1650627938,4003706170,3570694100,691162497,2829621928,3304337746,2526438038,2604330850,4193895417,1727436707,3318035397,900811280,623219749,4062229163,1499035993,1420694992,2223254148,3081233605,1920128370,3588059884,960095289,1516345366,1280060748,3392912532,1583244638,3884314783,2021195128,3721949413,943251512,344327576,2357987980,3333603095,3520160721,1091262436,2779098789,1129175457,3806506978,804831822,1633786209,4047862594,3014915763,363151924,555844641,2497062152,2627488412,4033232110,505313310,575833697,1128468803,1996264369,3351722951,3005998415,4244428796,538183716,67375108,2986910435,1364285777,3167170341,2576965273,1338300962,1835903341,1748572773,218969101,2201348473,4210741242,3062145897,3755957215,3617324201,2122245502,1035225113,606375972,3319232254,993782843,826100634,2880149163,1053917680,3469615054,2287280793,286344209,210305923,2408515215,1248566276,1313744206,3511776102,3082282679,190893024,3958082539,4258035905,1010626620,2092900349,2172731009,3573429568,2492754580,3943494428,4160224247,2707910424,3115966137,2556372619,320031763,2107398225,741126188,3602430725,3553848275,1801245580,3890723815,1472977977,1852745070,1861457322,3301193668,403637787,50531331,2316545244,1448494422,441026654,1145310532,3751739040,2139087231,557272968,2846465705,1300386919,707438634,2976738058,3149649595,1189257095,3250660289,2718082801,1397969235,2928387442,3705427932,1478956627,185281547,2631083777,2644332189,1203886123,1819061612,2515886756,825345073,2277107955,1953811828,3809079573,4143382518,172198988,1178993990,153503141,2896988844,1016532917,2307464841,2688821428,336875540,1531109306,3789661153,2957913254,370563094,3453121783,976939066,1875956230,1768536425,1210913345,151593993,2813190359,1886444912,3646189935,3065438902,3468147998,3503318992,998164438,3991770093,786138594,3435927500,710378600,1111627074,3032624428,2560121496,1225676269,2762255012,1569214581,673751080,3660691590,1549561180,2470440299,4177053688,1151603138,2256937606]),l=new Uint32Array([415266864,3625457760,587575110,639837068,3330210193,3100034623,3893587917,4226345095,2269946131,3414656806,3098108525,297318618,17302786,151060740,1329753758,223301409,917368428,2604021464,2790851665,4289111714,3537812921,215143023,4126869239,251000307,2045739250,2524543481,1868549854,812609441,2449272639,1838256510,1386874788,4166144597,1613233600,1197498525,3163125349,901561546,2611793195,932944726,2382662657,2324598274,2742097243,3533939638,207633432,1812728880,2080344822,2222685169,901112170,2150970836,501770554,4112326004,3763554269,3017859239,3623267507,567793531,3261001113,2630009391,778933852,1127100088,1264745110,692800305,4272103905,1576992479,1468143278,3579270977,363348266,3172275540,2006955758,3900143553,933620590,2453092316,3850065623,2665866675,2676807971,329228102,4040366077,602992871,1248493460,541739573,3667826089,1155193423,1492788656,2723698813,3372665487,3486107907,693472594,2083072420,173023764,1510607400,2984333183,1353822718,2691242589,3382747322,1803541206,342584241,2237442839,3649406254,3179377511,1019067854,1574057146,2405260649,276844576,2416971840,4109566965,133494007,3407265931,3721120523,1055770236,3544071928,86511882,755303700,1730143950,2020042625,3832763349,2548360375,656784206,36120476,1093818498,1933656345,2334956811,2810940182,2807103827,4138182566,2110756090,2994568681,2514287415,1234539886,3633225645,1457051719,4220203243,1895562187,3995300289,3454987935,2093453816,3145497837,1712841676,1902536325,3718680231,2078137683,397953838,2937526108,1191331470,1162299137,2659507233,446602818,3391014281,3570059791,762681690,1479355828,3213982051,784318406,121117454,1057425180,2902532935,2897063310,1525297076,2958711413,2204939547,4018373430,864419686,3056808908,1665135302,1550017425,34605572,302121480,2855876681,2477435538,1907337442,3731976665,3356413837,3335047175,432569650,3508083044,1232236690,994658617,3649477295,1608112451,4072873465,838005487,3813361883,2833507243,1541548726,3109772145,2285146637,3163064346,2594490409,1050319442,640532044,187049624,848165476,3207738056,2968078973,1504751866,3910888143,4075415939,259535646,1997475644,3588662967,869651827,2155133469,4102062138,3197729889,666812098,3441876615,3956133139,884860008,2301899984,1215985040,843597885,4289406179,1426063323,2063044596,2373614325,2431969853,1687195770,1606565566,2640273249,538812480,1025515648,1751635408,258500797,449868340,3390708328,2920885313,3081678466,3033095797,2108994794,1419385256,3461633101,2481775931,2140377974,571320900,790766216,1678240200,1667523725,4057666303,720499171,1941938918,3430118353,311450148,2182222408,1077566848,2051031069,138422288,1208485920,3277252763,2512634667,3962796997,3756846231,3684077739,1306254155,2707496799,3231818174,2367456007,2441973006,1039518074,3359456756,2546790707,1536661350,0,0,3476477059,4191145755,725976918,1848322988,1989653484,3782637253,2187636761,3867312690,3607013809,685168255,467171126,3273333612,3049347959,1958065646,2937137475,3199184774,1786240980,493513397,1354370464,3931131997,1158827146,1464157449,4090173691,955511787,815657056,2905616576,4012602563,3304058779,1072022398,3661578236,1435638954,3344258377,2725843033,3684868786,3926091209,3924486799,1695542474,1785030025,3132713065,62569170,795186014,1244606396,3226396573,2394996775,3737026977,1625218655,484469816,4229700720,4256902887,1191050707,1297245338,525159721,2464473145,1989317234,1972354282,4202001865,103816716,906364440,2317654025,2928314898,3002679417,1270002418,3865270737,2246502079,242234908,2114850360,536372030,3877576572,1647835076,1432511125,3572409269,987026551,2821272141,2175314074,2529489969,1385600610,4187699951,1660549571,3311859351,2747647283,624275786,270869908,1509040306,2874759545,2220142101,3498345514,1924638692,3312612053,970317170,3963173348,1280991640,374098989,1590311868,2489212517,2028439024,2675472637,954062960,3845667040,2350155269,2559347722,3519460031,399626595,2772503383,3836061102,3796061657,2716000943,1630533826,1315004825,3018933627,1119073270,555066690,874586500,2626999845,144481354,519071292,3994951288,1126322822,1631798033,3346463891,2982659899,4239600613,1341979863,69211144,604242960,1370622114,3813757273,2579285807,630823262,1833944282,577596841,224934170,1695354164,4202903017,2046491343,3753280675,1776279387,2128059388,2843639525,608023624,421799056,1002821494,4265294828,2872130891,2594941846,3460223361,4040085023,294147362,2568032580,2399963395,2207223558,1313500060,72240677,3083948403,1723316198,3943391435,3773557643,1023265912,3241950448,2172436255,4253122878,2496986677,1083479146,4159376627,486012923,3114362735,414824926,328752934,2333283148,746429528,1361849520,3554064571,97768299,3882573011,2364008379,1851247580,963538597,3295605653,2865022007,51908358,453182220,1451889580,3696645701,1142573448,1581532173,2145361662,2692710369,2837526351,2292820382,709722708,1730816680,3148967275,180075478,3242648223,2277622051,1403126438,4048769873,3702426533,1927076951,190326550,1393232684,2644300583,27106638,1816642008,728525997,831911266,2754687428,1955052008,4084495565,4142074353,368506623,1175077772,1279673861,2886280773,2779557002,2302449423,3045689630,346047528,3021214800,3780854495,3135365539,380653100,2786465368,986567284,4147788520,1768935634,107571641,155725074,1091111204,1890037216,3614470365,3067696241,1874245346,3503208381,517001319,3980099271,3605917075,3425622917,3805072407,1110071172,1749172757,2561983021,748197978,2756251221,3986990250,677218384,1965566112,1557803448,2254199917,4170399725,1811478727,2252645393,3263596066]),b=new Uint32Array([1612234872,819468312,2351105455,1176904483,1069973241,2444805830,2280133487,3455838440,646401185,332105607,3669535074,1829877944,67176453,34144513,558842478,2651672399,3627462126,1822111286,2728810756,1375708838,1876090557,3104625362,4092984070,4144952821,4185517952,4069947769,2708430798,3727716207,2123496687,1064145297,1431480839,2767737426,2640324605,3225903200,3401353590,1698020540,1453042893,725064603,42861708,25857678,3064164629,1540531107,806117436,409734156,4051435402,4135877499,3560289761,1786787125,1948117097,989142301,2816496455,3719553248,2077750956,3005339607,801267437,2577187522,3090050454,1547906606,827023994,2519288651,3758007073,3781033726,1096253974,2933217111,1410705473,717034773,3245842358,4008212343,3694634475,1855076151,3018160982,3617514981,1184861401,588488607,3891319575,4246991088,894069375,2485144138,1339727509,2839861978,2102983205,2963429464,63506122,2412759497,2754172301,1383868713,671764514,341445130,4273070415,2135994801,3131074842,1573494944,2976612314,3591662443,780491947,400131461,3468525939,1732033981,1767756340,3129957725,1074823248,546312208,4160025347,4110939380,197859008,2346568651,4164873670,2094218814,335882257,170722565,2171019238,3463997287,3085202259,3583501540,2619811259,1308763943,423703128,2188591425,378219677,195529611,2795983105,1408673703,3917336468,4206001533,1855315195,927569301,1205374623,2908149976,3422260016,3950050299,2683183985,3251498734,3984377745,4173036668,2238060515,3429983846,1407035022,2809912797,1545058379,783226647,21430854,2386904903,1117684956,555392670,264904389,2312424138,3022878105,1515728173,3334443385,1664008127,470235163,239011591,2393702691,1202498989,1968892463,3031456346,914582709,468681603,3425928703,1723216691,2439200754,3327943523,134352906,68289026,2460629304,1234414250,3648106408,3806228849,130551503,2378614984,1679411325,852564249,961114736,2453358921,1138329242,2942294489,4025664285,4180800242,2883799880,3685278691,1901847082,3065600859,445133970,230459528,1385866440,691968666,2552638910,1275799078,3358756346,1690251826,4205898058,2103029936,2213092202,3488803305,1007646771,511119119,1943398054,3073627605,981497018,502562944,3267271036,1629994686,332211934,2280377805,3493117412,1753822260,1028160117,2419214408,3690965796,3813998591,4118476687,4102912634,2056320234,1030000784,1633665598,3197984607,2149588384,1077747744,3177736149,3490670696,1746587762,885660186,2192447788,1102556846,3937716574,1971172532,1297390105,2832094292,1989405925,998216595,2283933098,1143939618,2372143081,3361956964,3824278290,4281004529,3514023842,3872158579,1209176154,612504082,490748509,2155495488,537411624,273156104,734222056,2610283459,2548839291,3319786732,1272682128,2874006491,3198247199,1606459809,244128899,126979469,4097701321,2059943229,1721224433,861640599,0,0,466564820,2214186959,2888516999,1450060587,3312883635,3974198902,847406256,434537090,2144796329,2972243670,1813764215,918756123,4004888923,2004137397,2259620137,1136570287,3043653599,3558697578,1565571597,2699710544,155521612,2320975173,3958623e3,4214813683,3224411632,1621962800,2616142708,3284463599,4232046019,2128232255,1230344732,2865190229,2996992272,1507566242,2414478181,3387550442,2305101804,3395970405,3535452520,1761852090,3157222803,1581920047,666914535,2643378368,1608433281,2707480286,1880940652,956046364,3556621102,3880189437,692933220,2585742669,1922229472,964072082,3379924924,3942282613,403058718,204867078,311043224,162433674,4071815488,2035004082,3219546969,3515213542,940470326,478023182,2082469987,1055334175,2506242039,3293930082,2010443427,3040531668,2594711858,1300342952,1654047988,827496086,3287915322,4016241145,868574966,2544092613,2485466545,1242572069,2035937824,2997573977,713315502,365986948,3581065127,3838145138,3828995549,1928083769,759978593,2551598156,1700710971,3163840094,4252559237,4036982904,3761823192,1894070328,176952454,93883532,1674692274,3206009297,2930065675,1474602405,2950841165,3651265250,2573283320,3259916641,4138987845,2067968947,2216760741,1110712609,1251775702,621321372,2015293542,1022238238,289612370,2254521155,1002927868,2477901767,3623662379,3847224572,268705812,136578052,1498526216,2732806481,1587133639,790993305,2842513348,3659689325,873293881,442830093,3489301301,3917085434,1541387908,2741624799,3850295195,4238966398,2418294196,1209607204,3963340247,1996372795,2527801661,1268427691,533610193,2180042446,1141999701,580456721,110038153,58953615,625887851,2617527886,3870806353,1936111543,2347436896,3420515307,4030528972,2025929788,1048673471,536707457,1788138750,893424788,4227328780,4078761975,3736707431,1863891385,1276352607,646648595,2955705756,1481714732,1809045176,3137721299,3152505692,3549226983,2775472075,3694751342,935620339,2510996676,201529359,102433539,1163299347,2900121174,222566985,2287879236,3783253918,4271931263,2661884215,1334356393,2821344642,1416047146,3602624877,1795865531,599869154,2676474305,1364435458,2800833363,1474080395,2775768284,738940967,374541067,1318952147,654417309,2909554625,3626724460,3291583989,1654927665,3446966201,3908269172,4294370057,4044748534,88476227,2353808966,2326530342,1168485548,512310423,263555465,1343529028,682890260,2749455170,3753566689,1477881934,749082134,3896167890,1962359354,3110694864,3523635561,604588077,306252041,3715147693,3772215408,3803634004,1903146678,1741737655,3172913360,2481798014,3352751597,399257307,2246233292,356657751,2221425218,1519957186,757897368,2862893326,1441637540,2686999944,1349855272,1834801713,3095813212,3354956607,3983276280,579224740,297961094]),p=new Uint32Array([408950976,2016466968,596386565,2940610083,3326068350,4187076806,3901220883,1875770344,2267449164,2702429063,3101341865,1651315128,17039624,84019457,1327583042,1855851855,920139437,4000095030,2795677273,72482726,3530543838,3183021266,4126406139,116854517,2046392815,2163381881,1872850783,3470667887,2440991228,4013911441,1381323434,128251986,1620926503,4257236832,3167403145,1986344380,2606144428,3442161563,2382532100,2348911246,2746655601,358339235,204475488,1008233484,2079423487,2331411579,903099829,3781853237,494149096,1765471517,3769098323,1205711840,3615217654,2897420759,3257909854,3986267330,783822445,2522628910,1261521762,2056661323,4276092579,568417790,1463900034,380556631,357832104,1093319957,2009167775,3069110391,937179045,3949892151,3853772155,1456971493,2672205708,3642954655,4041732307,402465776,1245006442,2140414026,3662666398,2510898394,1484609786,632332888,3372468486,3398422473,698624341,2370993193,170396240,571759114,2986258913,1333743793,2696585321,442354080,1806789503,3671463019,2234418524,2870466949,3184442753,1936145597,1567186386,884641629,272633984,1344311312,4109890803,66390004,3406547734,3230391755,1056456429,3330069310,85198120,285879557,1736533791,3872290919,3837256819,1406506980,664545061,3142451751,1092174130,1484944193,2333510444,2634786699,2812716881,22279847,2112454095,2499457661,2507052508,4214704533,3628587150,2678937304,4224449419,820736251,4003458595,1908526574,2095938759,2448997244,1720018455,3821826406,3713260966,2393340893,391911352,1261350679,1191266050,1183728967,2655166084,3693157022,3390032414,3314144458,766782837,2572834861,3217473425,2036543167,119277368,453918471,2911808769,591899821,1517640426,800370778,2201387884,3038506883,869020549,4284921395,1670472511,4073086051,34079248,168038914,2861738553,944346026,1910075823,2833440369,3355953166,3482175176,425990600,2100482329,1228491122,1888631625,3645102470,2595184601,4075811523,502870514,3819692875,1222355171,1534155746,716618075,2283440180,2450373768,2589104804,3358146202,647505453,3192654630,851980941,4200906546,2969219305,1249728944,3917736219,1792013033,255594360,857634575,3581138406,2797024213,2151317620,3122525312,3200433817,2086741950,3440626982,3733449677,886060221,3832056116,1211975802,1972384328,4292607915,618878207,2062908151,2415168890,2423951604,3929891984,1600217026,1052679519,545267741,2688564512,1757243495,3587182440,443030224,1916062234,2927799833,742504366,3035280585,1584758196,1414354074,430493268,2474021868,3845881747,579346957,2856595234,1686987783,3922223972,4058247643,318712561,1943106495,2733034611,306713232,1512342034,1075658810,1568700992,136316992,672155656,3274425174,3902510531,3969379379,2076565484,3679181718,2427145691,2713624929,526368929,2366541084,2198311309,1039416821,3380267069,2540083148,4046674839,0,0,3474706230,3565418959,732703557,2270588459,1992652439,3018645878,2184348260,2954487426,3598702334,2846959830,460069848,2000077595,3052320193,1534555317,2944839441,692305583,1790274167,3755220330,1348292794,228649552,1158235410,1284134725,4092326859,419117299,817901725,4032867632,4019973931,1958986991,1073496037,3279870527,1430869394,480954197,2729615993,274324386,3935300099,1707731434,1703503119,3972688485,3134372537,1751712698,800862053,2472430127,3223830606,3885862592,3730824894,2174836958,477109472,1815673884,4258528699,786908925,1294552402,1687822157,2456982244,3761862290,1976137103,3169516149,102237744,504116742,2316470820,2550771338,3002249977,1081691058,3871336035,1506903526,238554736,907836942,528228344,1665066783,1653957175,4156839266,3564623086,2746563284,2828707881,843940264,2523043524,4096873110,4190370203,988766969,3308504422,4137132997,630465845,2974421029,1501125106,548580185,2217378900,2920665220,1926591159,2816787826,971258325,3715296313,1278037082,1637357132,1583701706,1002214494,2029877479,2247139192,954218717,3631277368,2349501460,2248513676,3512979910,2998867921,2779686209,190309541,3803177539,1306108386,1637441839,4173483617,3019289585,1165705907,562307349,2772579361,2622135444,3592751260,511188720,1715269150,1125204770,1384538435,3342583670,4237537735,4242013363,736448508,68158496,336077828,1364808114,144892753,2573113788,3341755801,1839820111,3302629997,221515112,958031117,4207934083,904493562,3747340214,2225301983,2128969431,2617026942,613426237,3024623908,1005337541,3614899771,2878778161,1028364971,3458190910,3514953934,289673608,1428330769,2399571724,2298708879,1311067722,1805386830,3085350865,1366517431,3951815435,1623974123,1022377213,3430465852,2168357244,3206544769,2490012884,4264902804,4160485355,217259255,3118381473,1735334073,323752856,1596361491,749743229,2623033644,3547059158,3099264467,3887851371,1557368039,1856335447,3420207470,3291989102,4086672068,51118872,252058371,1447384714,330095702,1141720090,1233673796,2145484767,2667487359,2845747489,927959209,715663949,2186569514,3151412145,1835731643,3240345926,3802105793,1397838754,44495187,3696745646,2342875868,187435864,655774475,2639175068,3542548893,1823304775,3252169580,834941333,4116882481,1959621767,3119051636,4143970019,166794742,1174750730,1133268038,2894769161,642098604,2300479804,2534389129,340792480,1143518228,3785613659,1121958625,374871728,1311548950,988297933,3530880826,1773758831,3503425129,153356616,756171017,1893560487,2917193584,3068311257,1416720310,3496464590,3082624720,3985894715,2127025901,3424111662,3682984652,1108689450,1468295234,2556074164,3257740440,2762646601,240512420,681584733,2286974248,1550671066,834176604,4173854867,1072524280,2250409540,2752627334]);class m{constructor(){this.state=new Uint32Array(16),this.msg=new Uint32Array(16),this.block=e.alloc(64),this.size=-1}init(){for(let t=0;t<16;t++)this.state[t]=0;return this.size=0,this}update(t){return i(e.isBuffer(t)),this._update(t,t.length),this}final(){return this._final(e.alloc(64))}_update(t,e){i(-1!==this.size,"Context is not initialized.");let r=63&this.size,n=0;if(this.size+=e,r>0){let i=64-r;if(i>e&&(i=e),t.copy(this.block,r,n,n+i),r+=i,e-=i,n+=i,r<64)return;this._transform(this.block,0)}for(;e>=64;)this._transform(t,n),n+=64,e-=64;e>0&&t.copy(this.block,0,n,n+e)}_final(t){i(-1!==this.size,"Context is not initialized.");const e=63&this.size,r=8*this.size;g(s,r*(1/4294967296)>>>0,24),g(s,r>>>0,28),this._update(o,1+(95-e&63)),this._update(s,32);for(let e=0;e<16;e++)g(t,this.state[e],4*e),this.state[e]=0;for(let t=0;t<16;t++)this.msg[t]=0;for(let t=0;t<64;t++)this.block[t]=0;return this.size=-1,t}_transform(t,e){const r=this.msg;for(let s=0;s<16;s++)r[s]=(n=e+4*s,16777216*(i=t)[n++]+65536*i[n++]+256*i[n++]+i[n]);var i,n;const s=new Uint32Array(16),o=new Uint32Array(16),m=new Uint32Array(16);for(let t=0;t<16;t++)s[t]=this.state[t],m[t]=r[t]^s[t];for(let t=1;t<11;t++){for(let e=0;e<8;e++)o[2*e+0]=0^a[2*(s[(0+e)%8*2+0]>>>24&255)+0]^c[2*(s[(7+e)%8*2+0]>>>16&255)+0]^h[2*(s[(6+e)%8*2+0]>>>8&255)+0]^u[2*(s[(5+e)%8*2+0]>>>0&255)+0]^d[2*(s[(4+e)%8*2+1]>>>24&255)+0]^l[2*(s[(3+e)%8*2+1]>>>16&255)+0]^b[2*(s[(2+e)%8*2+1]>>>8&255)+0]^p[2*(s[(1+e)%8*2+1]>>>0&255)+0]^(0===e?f[2*t+0]:0),o[2*e+1]=0^a[2*(s[(0+e)%8*2+0]>>>24&255)+1]^c[2*(s[(7+e)%8*2+0]>>>16&255)+1]^h[2*(s[(6+e)%8*2+0]>>>8&255)+1]^u[2*(s[(5+e)%8*2+0]>>>0&255)+1]^d[2*(s[(4+e)%8*2+1]>>>24&255)+1]^l[2*(s[(3+e)%8*2+1]>>>16&255)+1]^b[2*(s[(2+e)%8*2+1]>>>8&255)+1]^p[2*(s[(1+e)%8*2+1]>>>0&255)+1]^(0===e?f[2*t+1]:0);for(let t=0;t<16;t++)s[t]=o[t];for(let t=0;t<8;t++)o[2*t+0]=0^a[2*(m[(0+t)%8*2+0]>>>24&255)+0]^c[2*(m[(7+t)%8*2+0]>>>16&255)+0]^h[2*(m[(6+t)%8*2+0]>>>8&255)+0]^u[2*(m[(5+t)%8*2+0]>>>0&255)+0]^d[2*(m[(4+t)%8*2+1]>>>24&255)+0]^l[2*(m[(3+t)%8*2+1]>>>16&255)+0]^b[2*(m[(2+t)%8*2+1]>>>8&255)+0]^p[2*(m[(1+t)%8*2+1]>>>0&255)+0]^s[2*t+0],o[2*t+1]=0^a[2*(m[(0+t)%8*2+0]>>>24&255)+1]^c[2*(m[(7+t)%8*2+0]>>>16&255)+1]^h[2*(m[(6+t)%8*2+0]>>>8&255)+1]^u[2*(m[(5+t)%8*2+0]>>>0&255)+1]^d[2*(m[(4+t)%8*2+1]>>>24&255)+1]^l[2*(m[(3+t)%8*2+1]>>>16&255)+1]^b[2*(m[(2+t)%8*2+1]>>>8&255)+1]^p[2*(m[(1+t)%8*2+1]>>>0&255)+1]^s[2*t+1];for(let t=0;t<16;t++)m[t]=o[t]}for(let t=0;t<16;t++)this.state[t]^=m[t]^r[t]}static hash(){return new m}static hmac(){return new n(m,64)}static digest(t){return m.ctx.init().update(t).final()}static root(t,r){return i(e.isBuffer(t)&&64===t.length),i(e.isBuffer(r)&&64===r.length),m.ctx.init().update(t).update(r).final()}static multi(t,e,r){const{ctx:i}=m;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return m.hmac().init(e).update(t).final()}}function g(t,e,r){return t[r++]=e>>>24,t[r++]=e>>>16,t[r++]=e>>>8,t[r++]=e,r}m.native=0,m.id="WHIRLPOOL",m.size=64,m.bits=512,m.blockSize=64,m.zero=e.alloc(64,0),m.ctx=new m,t.exports=m}).call(this,r(0).Buffer)},function(t,e,r){"use strict";
/*!
 * x448.js - x448 for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */t.exports=r(297)},function(t,e,r){"use strict";
/*!
 * x448.js - x448 for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Curve448
 *   https://eprint.iacr.org/2015/625.pdf
 *   https://tools.ietf.org/html/rfc7748#section-5
 */const i=r(80);t.exports=new i("X448","ED448")},function(t,e,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&i(e,t,r);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.encode=void 0;var o=s(r(299));function f(t,e,r,i){for(var n=0,s=0,o=[],f=(1<<r)-1,a=0;a<t.length;++a){var c=t[a];if(c<0||c>>e!=0)return null;for(n=n<<e|c,s+=e;s>=r;)s-=r,o.push(n>>s&f)}if(i)s>0&&o.push(n<<r-s&f);else if(s>=e||n<<r-s&f)return null;return o}e.encode=function(t,e,r){var i=o.encodings.BECH32;e>0&&(i=o.encodings.BECH32M);var n=o.encode(t,[e].concat(f(r,8,5,!0)),i);return null===function(t,e){var r=!1,i=o.decode(e,o.encodings.BECH32);if(null===i&&(i=o.decode(e,o.encodings.BECH32M),r=!0),null===i||i.hrp!==t||i.data.length<1||i.data[0]>16)return null;var n=f(i.data.slice(1),5,8,!1);return null===n||n.length<2||n.length>40||0===i.data[0]&&20!==n.length&&32!==n.length||0===i.data[0]&&r?null:0===i.data[0]||r?{version:i.data[0],program:n}:null}(t,n)?null:n}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decode=e.encode=e.encodings=void 0;var i="qpzry9x8gf2tvdw0s3jn54khce6mua7l",n=[996825010,642813549,513874426,1027748829,705979059];function s(t){return t==e.encodings.BECH32?1:t==e.encodings.BECH32M?734539939:null}function o(t){for(var e=1,r=0;r<t.length;++r){var i=e>>25;e=(33554431&e)<<5^t[r];for(var s=0;s<5;++s)i>>s&1&&(e^=n[s])}return e}function f(t){var e,r=[];for(e=0;e<t.length;++e)r.push(t.charCodeAt(e)>>5);for(r.push(0),e=0;e<t.length;++e)r.push(31&t.charCodeAt(e));return r}e.encodings={BECH32:"bech32",BECH32M:"bech32m"},e.encode=function(t,e,r){for(var n=e.concat(function(t,e,r){for(var i=o(f(t).concat(e).concat([0,0,0,0,0,0]))^(s(r)||0),n=[],a=0;a<6;++a)n.push(i>>5*(5-a)&31);return n}(t,e,r)),a=t+"1",c=0;c<n.length;++c)a+=i.charAt(n[c]);return a},e.decode=function(t,e){var r,n=!1,a=!1;for(r=0;r<t.length;++r){if(t.charCodeAt(r)<33||t.charCodeAt(r)>126)return null;t.charCodeAt(r)>=97&&t.charCodeAt(r)<=122&&(n=!0),t.charCodeAt(r)>=65&&t.charCodeAt(r)<=90&&(a=!0)}if(n&&a)return null;var c=(t=t.toLowerCase()).lastIndexOf("1");if(c<1||c+7>t.length||t.length>90)return null;var h=t.substring(0,c),u=[];for(r=c+1;r<t.length;++r){var d=i.indexOf(t.charAt(r));if(-1===d)return null;u.push(d)}return function(t,e,r){return o(f(t).concat(e))===s(r)}(h,u,e)?{hrp:h,data:u.slice(0,u.length-6)}:null}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TAPROOT_VERSION=void 0,function(t){t.BITCOIN="Bitcoin",t.LIQUID="LIQUID"}(e.TAPROOT_VERSION||(e.TAPROOT_VERSION={}))},function(t,e,r){"use strict";var i=r(302).Buffer;function n(t){if(t<0||t>9007199254740991||t%1!=0)throw new RangeError("value out of range")}function s(t){return n(t),t<253?1:t<=65535?3:t<=4294967295?5:9}t.exports={encode:function t(e,r,o){if(n(e),r||(r=i.allocUnsafe(s(e))),!i.isBuffer(r))throw new TypeError("buffer must be a Buffer instance");return o||(o=0),e<253?(r.writeUInt8(e,o),t.bytes=1):e<=65535?(r.writeUInt8(253,o),r.writeUInt16LE(e,o+1),t.bytes=3):e<=4294967295?(r.writeUInt8(254,o),r.writeUInt32LE(e,o+1),t.bytes=5):(r.writeUInt8(255,o),r.writeUInt32LE(e>>>0,o+1),r.writeUInt32LE(e/4294967296|0,o+5),t.bytes=9),r},decode:function t(e,r){if(!i.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");r||(r=0);var s=e.readUInt8(r);if(s<253)return t.bytes=1,s;if(253===s)return t.bytes=3,e.readUInt16LE(r+1);if(254===s)return t.bytes=5,e.readUInt32LE(r+1);t.bytes=9;var o=e.readUInt32LE(r+1),f=4294967296*e.readUInt32LE(r+5)+o;return n(f),f},encodingLength:s}},function(t,e,r){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var i=r(0),n=i.Buffer;function s(t,e){for(var r in t)e[r]=t[r]}function o(t,e,r){return n(t,e,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=i:(s(i,e),e.Buffer=o),o.prototype=Object.create(n.prototype),s(n,o),o.from=function(t,e,r){if("number"==typeof t)throw new TypeError("Argument must not be a number");return n(t,e,r)},o.alloc=function(t,e,r){if("number"!=typeof t)throw new TypeError("Argument must be a number");var i=n(t);return void 0!==e?"string"==typeof r?i.fill(e,r):i.fill(e):i.fill(0),i},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i.SlowBuffer(t)}},function(t,e,r){"use strict";(function(t){var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&i(e,t,r);return n(e,t),e},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.inspectOutputScriptPubKey=e.inspectOutputNonce=e.inspectOutputValue=e.inspectOutputAsset=e.inspectInputSequence=e.inspectInputIssuance=e.inspectInputScriptPubKey=e.inspectInputValue=e.inspectInputAsset=e.inspectInputOutPoint=void 0;var f=o(r(8)),a=s(r(42));e.inspectInputOutPoint=function(e,r){var i=e.number;"00"===e.hex&&(i=0);var n=r.length;if(void 0===i)throw"Invalid transaction input index!";if(i<0)throw"Invalid transaction input index must at least zero!";if(0===n)throw"Transaction input template must include at least an element.";if(n<i+1)throw"Input index must less than transaction inputs length!";var s=r[i].previousTxId,o=r[i].vout;if(!s)throw"Previous Tx Id not found! Check your transaction template.";if(!o)throw"Vout not found! Check your transaction template.";var a=t.from(s,"hex").reverse().toString("hex");return[f.default.fromHex(a),f.default.fromHex(o),f.default.fromHex("00")]};e.inspectInputAsset=function(e,r){var i=e.number;"00"===e.hex&&(i=0);var n=r.length;if(void 0===i)throw"Invalid transaction input index!";if(i<0)throw"Invalid transaction input index must at least zero!";if(0===n)throw"Transaction input template must include at least an element.";if(n<i+1)throw"Input index must less than transaction inputs length!";var s=r[i].assetId;if(!s)throw"Asset id not found! Check your transaction template.";var o=t.from(s,"hex").reverse().toString("hex");return[f.default.fromHex(o),f.default.fromNumber(1)]};e.inspectInputValue=function(t,e){var r=t.number;"00"===t.hex&&(r=0);var i=e.length;if(void 0===r)throw"Invalid transaction input index!";if(r<0)throw"Invalid transaction input index must at least zero!";if(0===i)throw"Transaction input template must include at least an element.";if(i<r+1)throw"Input index must less than transaction inputs length!";var n=e[r].amount;if(!n)throw"Amount not found! Check your transaction template.";return[f.default.fromHex(n),f.default.fromNumber(1)]};e.inspectInputScriptPubKey=function(t,e){var r=t.number;"00"===t.hex&&(r=0);var i=e.length;if(void 0===r)throw"Invalid transaction input index!";if(r<0)throw"Invalid transaction input index must at least zero!";if(0===i)throw"Transaction input template must include at least an element.";if(i<r+1)throw"Input index must less than transaction inputs length!";if(e[r].scriptPubKey){var n=e[r].scriptPubKey,s=n.substr(0,2),o=n.substring(4),c=f.default.fromHex(o).bytes.length,h=[];if("00"!==s||20!==c&&32!==c)if("51"===s&&32===c)h=[f.default.fromHex(o),f.default.fromNumber(1)];else{var u=a.sha256(f.default.fromHex(n)).toString();h=[f.default.fromHex(u),f.default.fromNumber(-1)]}else h=[f.default.fromHex(o),f.default.fromNumber(0)];return h}return[f.default.fromHex("e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"),f.default.fromNumber(-1)]};e.inspectInputIssuance=function(t,e){var r=t.number;"00"===t.hex&&(r=0);var i=e.length;if(void 0===r)throw"Invalid transaction input index!";if(r<0)throw"Invalid transaction input index must at least zero!";if(0===i)throw"Transaction input template must include at least an element.";if(i<r+1)throw"Input index must less than transaction inputs length!";return f.default.fromNumber(0)};e.inspectInputSequence=function(t,e){var r=t.number;"00"===t.hex&&(r=0);var i=e.length;if(void 0===r)throw"Invalid transaction input index!";if(r<0)throw"Invalid transaction input index must at least zero!";if(0===i)throw"Transaction input template must include at least an element.";if(i<r+1)throw"Input index must less than transaction inputs length!";var n=e[r].sequence;if(!n)throw"Sequence not found! Check your transaction template.";return f.default.fromHex(n)};e.inspectOutputAsset=function(e,r){var i=e.number;"00"===e.hex&&(i=0);var n=r.length;if(void 0===i)throw"Invalid transaction output index!";if(i<0)throw"Invalid transaction output index must at least zero!";if(0===n)throw"Transaction output template must include at least an element.";if(n<i+1)throw"Output index must less than transaction outputs length!";var s=r[i].assetId;if(!s)throw"Output Asset id not found! Check your transaction template.";var o=t.from(s,"hex").reverse().toString("hex");return[f.default.fromHex(o),f.default.fromNumber(1)]};e.inspectOutputValue=function(t,e){var r=t.number;"00"===t.hex&&(r=0);var i=e.length;if(void 0===r)throw"Invalid transaction output index!";if(r<0)throw"Invalid transaction output index must at least zero!";if(0===i)throw"Transaction output template must include at least an element.";if(i<r+1)throw"Output index must less than transaction outputs length!";var n=e[r].amount;if(!n)throw"Amount not found! Check your transaction template.";return[f.default.fromHex(n),f.default.fromNumber(1)]};e.inspectOutputNonce=function(t,e){var r=t.number;"00"===t.hex&&(r=0);var i=e.length;if(void 0===r)throw"Invalid transaction output index!";if(r<0)throw"Invalid transaction output index must at least zero!";if(0===i)throw"Transaction output template must include at least an element.";if(i<r+1)throw"Output index must less than transaction outputs length!";return f.default.fromNumber(0)};e.inspectOutputScriptPubKey=function(t,e){var r=t.number;"00"===t.hex&&(r=0);var i=e.length;if(void 0===r)throw"Invalid transaction output index!";if(r<0)throw"Invalid transaction output index must at least zero!";if(0===i)throw"Transaction output template must include at least an element.";if(i<r+1)throw"Output index must less than transaction outputs length!";if(e[r].scriptPubKey){var n=e[r].scriptPubKey,s=n.substr(0,2),o=n.substring(4),c=f.default.fromHex(o).bytes.length,h=[];if("00"!==s||20!==c&&32!==c)if("51"===s&&32===c)h=[f.default.fromHex(o),f.default.fromNumber(1)];else{var u=a.sha256(f.default.fromHex(n)).toString();h=[f.default.fromHex(u),f.default.fromNumber(-1)]}else h=[f.default.fromHex(o),f.default.fromNumber(0)];return h}return[f.default.fromHex("e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"),f.default.fromNumber(-1)]}}).call(this,r(0).Buffer)},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.checkSequenceVerify=e.checkLockTimeVerify=void 0;var n=i(r(8));e.checkLockTimeVerify=function(t){if(void 0!==t.number)return n.default.fromNumber(1);throw"Error: Invalid input: this operation requires a valid Script Number"};e.checkSequenceVerify=function(t){if(void 0!==t.number)return n.default.fromNumber(1);throw"Error: Invalid input: this operation requires a valid Script Number"}},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.substrLazy=e.size=e.left=e.right=e.substr=e.concatenate=void 0;var n=i(r(8));e.concatenate=function(t,e){return""===t.hex&&""===e.hex?n.default.fromNumber(0):n.default.fromHex(t.hex+e.hex)};e.substr=function(t,e,r){var i=t.hex,s=e.number,o=r.number;if(void 0!==s&&void 0!==o){var f=i.substr(2*s,2*o);return n.default.fromHex(f)}throw"Index and size must be number!"};e.right=function(t,e){if(void 0!==e.number){var r=t.hex,i=2*e.number;if(i<0)throw"Error: Size can't be negative integer!";if(r.length<i)throw"Error: Size can't higher than data length!";if(0===i)return n.default.fromNumber(0);var s=r.slice(-1*i);return n.default.fromHex(s)}throw"Size must be number!"};e.left=function(t,e){if(void 0!==e.number){var r=t.hex,i=2*e.number;if(i<0)throw"Error: Size can't be negative integer.!";if(r.length<i)throw"Error: Size can't higher than data length!";0===i&&n.default.fromNumber(0);var s=r.substr(0,i);return n.default.fromHex(s)}throw"Error: Size must be number!"};e.size=function(t){var e=t.hex.length/2;return n.default.fromNumber(e)};e.substrLazy=function(t,e,r){if(void 0!==e.number&&void 0!==r.number){var i=t.hex,s=2*e.number,o=2*r.number,f=i.length;s<0&&(s=0),o<0&&(o=0),s>=f&&n.default.fromNumber(0),s+o>f&&(o=f-s);var a=i.substr(s,o);return n.default.fromHex(a)}throw"Error: Index and size must be number!"}},function(t,e,r){"use strict";var i=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var i,n=0,s=e.length;n<s;n++)!i&&n in e||(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.tuck=e.swap=e.roll=e.pick=e.over=e.nip=e.ifDup=e.dup=e.depth=e.twoSwap=e.twoRot=e.rot=e.twoOver=e.threeDup=e.twoDup=e.fromAltStack=void 0;var s=n(r(8));e.fromAltStack=function(t){return t};e.twoDup=function(t,e){return[t,e]};e.threeDup=function(t,e,r){return[t,e,r]};e.twoOver=function(t,e){return[t,e]};e.rot=function(t,e,r){return[e,r,t]};e.twoRot=function(t,e,r,i,n,s){return[r,i,n,s,t,e]};e.twoSwap=function(t,e,r,i){return[e,t,i,r]};e.depth=function(t){return s.default.fromNumber(t)};e.dup=function(t){return t};e.ifDup=function(t){return void 0!==t.number&&0===t.number?{}:t};e.nip=function(t){return t};e.over=function(t){return t};e.pick=function(t,e){return i(i([],t,!0),[t.reverse()[e]],!1)};e.roll=function(t,e){var r=i([],t,!0).reverse(),n=r[e];return r.splice(e,1),r.unshift(n),r.reverse()};e.swap=function(t,e){return[t,e]};e.tuck=function(t,e){return[e,t,e]}}]);
//# sourceMappingURL=index.js.map